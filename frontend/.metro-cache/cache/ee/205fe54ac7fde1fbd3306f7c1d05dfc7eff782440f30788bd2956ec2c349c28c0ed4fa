{"dependencies":[{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":56,"index":56}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.prepareAndValidate = prepareAndValidate;\n  var _util = require(_dependencyMap[0], \"../util\");\n  /**\n   * Validate gather nd inputs.\n   *\n   * @param tensor The tensor contains the source values.\n   * @param indices The tensor contains the indices to slice the source.\n   *\n   * @returns [resultShape, numUpdates, sliceSize, strides]\n   */\n  function prepareAndValidate(tensor, indices) {\n    const tensorRank = tensor.shape.length;\n    const indicesRank = indices.shape.length;\n    if (tensorRank < 1) {\n      throw new Error('tf.gatherND() expects the input to be rank 1 or higher,' + ` but the rank was ${tensorRank}.`);\n    }\n    if (indicesRank < 1) {\n      throw new Error('tf.gatherND() expects the indices to be rank 1 or higher,' + ` but the rank was ${indicesRank}.`);\n    }\n    if (indices.dtype !== 'int32') {\n      throw new Error('tf.gatherND() expects the indices to be int32 type,' + ` but the dtype was ${indices.dtype}.`);\n    }\n    if (indices.shape[indicesRank - 1] > tensorRank) {\n      throw new Error('index innermost dimension length must be <= tensor rank; saw: ' + `${indices.shape[indicesRank - 1]} vs. ${tensorRank}`);\n    }\n    if ((0, _util.sizeFromShape)(tensor.shape) === 0) {\n      throw new Error('Requested more than 0 entries, but input is empty.' + ` Input shape: ${tensor.shape}.`);\n    }\n    const indicesShape = indices.shape;\n    const sliceRank = indicesShape[indicesShape.length - 1];\n    // The result shape is\n    //   indices.shape[:-1] + params.shape[indices.shape[-1]:]\n    let nResult = 1;\n    for (let i = 0; i < indicesShape.length - 1; ++i) {\n      nResult *= indicesShape[i];\n    }\n    const inputShape = tensor.shape;\n    const resultShape = indicesShape.slice();\n    resultShape.pop();\n    let sliceSize = 1;\n    for (let i = sliceRank; i < tensorRank; ++i) {\n      sliceSize *= inputShape[i];\n      resultShape.push(inputShape[i]);\n    }\n    const strides = [...(0, _util.computeStrides)(tensor.shape).map(stride => stride / sliceSize), 1].slice(0, sliceRank);\n    return [resultShape, nResult, sliceSize, strides];\n  }\n});","lineCount":54,"map":[[7,2,10,0,"exports"],[7,9,10,0],[7,10,10,0,"prepareAndValidate"],[7,28,10,0],[7,31,10,0,"prepareAndValidate"],[7,49,10,0],[8,2,1,0],[8,6,1,0,"_util"],[8,11,1,0],[8,14,1,0,"require"],[8,21,1,0],[8,22,1,0,"_dependencyMap"],[8,36,1,0],[9,2,2,0],[10,0,3,0],[11,0,4,0],[12,0,5,0],[13,0,6,0],[14,0,7,0],[15,0,8,0],[16,0,9,0],[17,2,10,7],[17,11,10,16,"prepareAndValidate"],[17,29,10,34,"prepareAndValidate"],[17,30,10,35,"tensor"],[17,36,10,41],[17,38,10,43,"indices"],[17,45,10,50],[17,47,10,52],[18,4,11,4],[18,10,11,10,"tensorRank"],[18,20,11,20],[18,23,11,23,"tensor"],[18,29,11,29],[18,30,11,30,"shape"],[18,35,11,35],[18,36,11,36,"length"],[18,42,11,42],[19,4,12,4],[19,10,12,10,"indicesRank"],[19,21,12,21],[19,24,12,24,"indices"],[19,31,12,31],[19,32,12,32,"shape"],[19,37,12,37],[19,38,12,38,"length"],[19,44,12,44],[20,4,13,4],[20,8,13,8,"tensorRank"],[20,18,13,18],[20,21,13,21],[20,22,13,22],[20,24,13,24],[21,6,14,8],[21,12,14,14],[21,16,14,18,"Error"],[21,21,14,23],[21,22,14,24],[21,79,14,81],[21,82,15,12],[21,103,15,33,"tensorRank"],[21,113,15,43],[21,116,15,46],[21,117,15,47],[22,4,16,4],[23,4,17,4],[23,8,17,8,"indicesRank"],[23,19,17,19],[23,22,17,22],[23,23,17,23],[23,25,17,25],[24,6,18,8],[24,12,18,14],[24,16,18,18,"Error"],[24,21,18,23],[24,22,18,24],[24,81,18,83],[24,84,19,12],[24,105,19,33,"indicesRank"],[24,116,19,44],[24,119,19,47],[24,120,19,48],[25,4,20,4],[26,4,21,4],[26,8,21,8,"indices"],[26,15,21,15],[26,16,21,16,"dtype"],[26,21,21,21],[26,26,21,26],[26,33,21,33],[26,35,21,35],[27,6,22,8],[27,12,22,14],[27,16,22,18,"Error"],[27,21,22,23],[27,22,22,24],[27,75,22,77],[27,78,23,12],[27,100,23,34,"indices"],[27,107,23,41],[27,108,23,42,"dtype"],[27,113,23,47],[27,116,23,50],[27,117,23,51],[28,4,24,4],[29,4,25,4],[29,8,25,8,"indices"],[29,15,25,15],[29,16,25,16,"shape"],[29,21,25,21],[29,22,25,22,"indicesRank"],[29,33,25,33],[29,36,25,36],[29,37,25,37],[29,38,25,38],[29,41,25,41,"tensorRank"],[29,51,25,51],[29,53,25,53],[30,6,26,8],[30,12,26,14],[30,16,26,18,"Error"],[30,21,26,23],[30,22,26,24],[30,86,26,88],[30,89,27,12],[30,92,27,15,"indices"],[30,99,27,22],[30,100,27,23,"shape"],[30,105,27,28],[30,106,27,29,"indicesRank"],[30,117,27,40],[30,120,27,43],[30,121,27,44],[30,122,27,45],[30,130,27,53,"tensorRank"],[30,140,27,63],[30,142,27,65],[30,143,27,66],[31,4,28,4],[32,4,29,4],[32,8,29,8],[32,12,29,8,"sizeFromShape"],[32,17,29,21],[32,18,29,21,"sizeFromShape"],[32,31,29,21],[32,33,29,22,"tensor"],[32,39,29,28],[32,40,29,29,"shape"],[32,45,29,34],[32,46,29,35],[32,51,29,40],[32,52,29,41],[32,54,29,43],[33,6,30,8],[33,12,30,14],[33,16,30,18,"Error"],[33,21,30,23],[33,22,30,24],[33,74,30,76],[33,77,31,12],[33,94,31,29,"tensor"],[33,100,31,35],[33,101,31,36,"shape"],[33,106,31,41],[33,109,31,44],[33,110,31,45],[34,4,32,4],[35,4,33,4],[35,10,33,10,"indicesShape"],[35,22,33,22],[35,25,33,25,"indices"],[35,32,33,32],[35,33,33,33,"shape"],[35,38,33,38],[36,4,34,4],[36,10,34,10,"sliceRank"],[36,19,34,19],[36,22,34,22,"indicesShape"],[36,34,34,34],[36,35,34,35,"indicesShape"],[36,47,34,47],[36,48,34,48,"length"],[36,54,34,54],[36,57,34,57],[36,58,34,58],[36,59,34,59],[37,4,35,4],[38,4,36,4],[39,4,37,4],[39,8,37,8,"nResult"],[39,15,37,15],[39,18,37,18],[39,19,37,19],[40,4,38,4],[40,9,38,9],[40,13,38,13,"i"],[40,14,38,14],[40,17,38,17],[40,18,38,18],[40,20,38,20,"i"],[40,21,38,21],[40,24,38,24,"indicesShape"],[40,36,38,36],[40,37,38,37,"length"],[40,43,38,43],[40,46,38,46],[40,47,38,47],[40,49,38,49],[40,51,38,51,"i"],[40,52,38,52],[40,54,38,54],[41,6,39,8,"nResult"],[41,13,39,15],[41,17,39,19,"indicesShape"],[41,29,39,31],[41,30,39,32,"i"],[41,31,39,33],[41,32,39,34],[42,4,40,4],[43,4,41,4],[43,10,41,10,"inputShape"],[43,20,41,20],[43,23,41,23,"tensor"],[43,29,41,29],[43,30,41,30,"shape"],[43,35,41,35],[44,4,42,4],[44,10,42,10,"resultShape"],[44,21,42,21],[44,24,42,24,"indicesShape"],[44,36,42,36],[44,37,42,37,"slice"],[44,42,42,42],[44,43,42,43],[44,44,42,44],[45,4,43,4,"resultShape"],[45,15,43,15],[45,16,43,16,"pop"],[45,19,43,19],[45,20,43,20],[45,21,43,21],[46,4,44,4],[46,8,44,8,"sliceSize"],[46,17,44,17],[46,20,44,20],[46,21,44,21],[47,4,45,4],[47,9,45,9],[47,13,45,13,"i"],[47,14,45,14],[47,17,45,17,"sliceRank"],[47,26,45,26],[47,28,45,28,"i"],[47,29,45,29],[47,32,45,32,"tensorRank"],[47,42,45,42],[47,44,45,44],[47,46,45,46,"i"],[47,47,45,47],[47,49,45,49],[48,6,46,8,"sliceSize"],[48,15,46,17],[48,19,46,21,"inputShape"],[48,29,46,31],[48,30,46,32,"i"],[48,31,46,33],[48,32,46,34],[49,6,47,8,"resultShape"],[49,17,47,19],[49,18,47,20,"push"],[49,22,47,24],[49,23,47,25,"inputShape"],[49,33,47,35],[49,34,47,36,"i"],[49,35,47,37],[49,36,47,38],[49,37,47,39],[50,4,48,4],[51,4,49,4],[51,10,49,10,"strides"],[51,17,49,17],[51,20,49,20],[51,21,49,21],[51,24,49,24],[51,28,49,24,"computeStrides"],[51,33,49,38],[51,34,49,38,"computeStrides"],[51,48,49,38],[51,50,49,39,"tensor"],[51,56,49,45],[51,57,49,46,"shape"],[51,62,49,51],[51,63,49,52],[51,64,49,53,"map"],[51,67,49,56],[51,68,49,57,"stride"],[51,74,49,63],[51,78,49,67,"stride"],[51,84,49,73],[51,87,49,76,"sliceSize"],[51,96,49,85],[51,97,49,86],[51,99,50,8],[51,100,50,9],[51,101,50,10],[51,102,50,11,"slice"],[51,107,50,16],[51,108,50,17],[51,109,50,18],[51,111,50,20,"sliceRank"],[51,120,50,29],[51,121,50,30],[52,4,51,4],[52,11,51,11],[52,12,51,12,"resultShape"],[52,23,51,23],[52,25,51,25,"nResult"],[52,32,51,32],[52,34,51,34,"sliceSize"],[52,43,51,43],[52,45,51,45,"strides"],[52,52,51,52],[52,53,51,53],[53,2,52,0],[54,0,52,1],[54,3]],"functionMap":{"names":["<global>","prepareAndValidate","computeStrides.map$argument_0"],"mappings":"AAA;OCS;yDCuC,4BD;CDG"},"hasCjsExports":false},"type":"js/module"}]}