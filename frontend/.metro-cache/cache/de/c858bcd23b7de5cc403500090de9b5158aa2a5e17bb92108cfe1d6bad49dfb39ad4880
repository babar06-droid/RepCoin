{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":52,"index":755}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../utils/fused_utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":756},"end":{"line":18,"column":55,"index":811}}],"key":"NIKyPrk9t4Z8kKTQ+oEMTYUcPoo=","exportNames":["*"],"imports":1}},{"name":"./Add","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":812},"end":{"line":19,"column":28,"index":840}}],"key":"exhW/7/uQnUxbVTq5qTlsNQPZN4=","exportNames":["*"],"imports":1}},{"name":"./Conv2D","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":841},"end":{"line":20,"column":34,"index":875}}],"key":"J6hToIUyhIesOgJEA3KXDGnUtY4=","exportNames":["*"],"imports":1}},{"name":"./Reshape","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":876},"end":{"line":21,"column":36,"index":912}}],"key":"EUWK+oKi/AwokPOQ1jng5DYfQSc=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.fusedConv2D = fusedConv2D;\n  Object.defineProperty(exports, \"fusedConv2DConfig\", {\n    enumerable: true,\n    get: function () {\n      return fusedConv2DConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _utilsFused_utils = require(_dependencyMap[1], \"../utils/fused_utils\");\n  var _Add = require(_dependencyMap[2], \"./Add\");\n  var _Conv2D = require(_dependencyMap[3], \"./Conv2D\");\n  var _Reshape = require(_dependencyMap[4], \"./Reshape\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function fusedConv2D(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x,\n      filter,\n      bias,\n      preluActivationWeights\n    } = inputs;\n    const {\n      strides,\n      pad,\n      dataFormat,\n      dilations,\n      dimRoundingMode,\n      activation,\n      leakyreluAlpha\n    } = attrs;\n    let result = (0, _Conv2D.conv2D)({\n      inputs: {\n        x,\n        filter\n      },\n      backend,\n      attrs: {\n        strides,\n        pad,\n        dataFormat,\n        dilations,\n        dimRoundingMode\n      }\n    });\n    if (bias) {\n      const resultOld = result;\n      // For NCHW format, if bias is a 1-D tensor, it is supposed to be aligned\n      // to the channel of the conv2d's result; if the bias is a scalar, the\n      // bias_add is computed as if the bias was broadcasted to the shape of the\n      // conv2d's result.\n      if (dataFormat === 'NCHW' && bias.shape.length === 1 && bias.shape[0] !== 1) {\n        const reshapedBias = (0, _Reshape.reshape)({\n          inputs: {\n            x: bias\n          },\n          backend,\n          attrs: {\n            shape: [bias.shape[0], 1, 1]\n          }\n        });\n        result = (0, _Add.add)({\n          inputs: {\n            a: result,\n            b: reshapedBias\n          },\n          backend\n        });\n        backend.disposeIntermediateTensorInfo(reshapedBias);\n      } else {\n        // This condition handles NHWC and NCHW (scalar case). The only other case\n        // for NCHW (1D case) is handled above.\n        result = (0, _Add.add)({\n          inputs: {\n            a: result,\n            b: bias\n          },\n          backend\n        });\n      }\n      backend.disposeIntermediateTensorInfo(resultOld);\n    }\n    if (activation) {\n      const resultOld = result;\n      // For NCHW format, if PReLu activation weights is a 1-D tensor, it is\n      // supposed to be aligned with the channel of the conv2d's result. For other\n      // cases, whether NCHW or NHWC data format, the conv2d result is\n      // already aligned with the activation weights.\n      if (dataFormat === 'NCHW' && activation === 'prelu' && preluActivationWeights.shape.length === 1 && preluActivationWeights.shape[0] !== 1) {\n        const reshapedAlpha = (0, _Reshape.reshape)({\n          inputs: {\n            x: preluActivationWeights\n          },\n          backend,\n          attrs: {\n            shape: [preluActivationWeights.shape[0], 1, 1]\n          }\n        });\n        result = (0, _utilsFused_utils.applyActivation)(backend, result, activation, reshapedAlpha, leakyreluAlpha);\n        backend.disposeIntermediateTensorInfo(reshapedAlpha);\n      } else {\n        result = (0, _utilsFused_utils.applyActivation)(backend, result, activation, preluActivationWeights, leakyreluAlpha);\n      }\n      backend.disposeIntermediateTensorInfo(resultOld);\n    }\n    return result;\n  }\n  const fusedConv2DConfig = {\n    kernelName: _tensorflowTfjsCore.FusedConv2D,\n    backendName: 'cpu',\n    kernelFunc: fusedConv2D\n  };\n});","lineCount":138,"map":[[7,2,22,0,"exports"],[7,9,22,0],[7,10,22,0,"fusedConv2D"],[7,21,22,0],[7,24,22,0,"fusedConv2D"],[7,35,22,0],[8,2,75,0,"Object"],[8,8,75,0],[8,9,75,0,"defineProperty"],[8,23,75,0],[8,24,75,0,"exports"],[8,31,75,0],[9,4,75,0,"enumerable"],[9,14,75,0],[10,4,75,0,"get"],[10,7,75,0],[10,18,75,0,"get"],[10,19,75,0],[11,6,75,0],[11,13,75,0,"fusedConv2DConfig"],[11,30,75,0],[12,4,75,0],[13,2,75,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_utilsFused_utils"],[15,23,18,0],[15,26,18,0,"require"],[15,33,18,0],[15,34,18,0,"_dependencyMap"],[15,48,18,0],[16,2,19,0],[16,6,19,0,"_Add"],[16,10,19,0],[16,13,19,0,"require"],[16,20,19,0],[16,21,19,0,"_dependencyMap"],[16,35,19,0],[17,2,20,0],[17,6,20,0,"_Conv2D"],[17,13,20,0],[17,16,20,0,"require"],[17,23,20,0],[17,24,20,0,"_dependencyMap"],[17,38,20,0],[18,2,21,0],[18,6,21,0,"_Reshape"],[18,14,21,0],[18,17,21,0,"require"],[18,24,21,0],[18,25,21,0,"_dependencyMap"],[18,39,21,0],[19,2,1,0],[20,0,2,0],[21,0,3,0],[22,0,4,0],[23,0,5,0],[24,0,6,0],[25,0,7,0],[26,0,8,0],[27,0,9,0],[28,0,10,0],[29,0,11,0],[30,0,12,0],[31,0,13,0],[32,0,14,0],[33,0,15,0],[34,0,16,0],[36,2,22,7],[36,11,22,16,"fusedConv2D"],[36,22,22,27,"fusedConv2D"],[36,23,22,28,"args"],[36,27,22,32],[36,29,22,34],[37,4,23,4],[37,10,23,10],[38,6,23,12,"inputs"],[38,12,23,18],[39,6,23,20,"backend"],[39,13,23,27],[40,6,23,29,"attrs"],[41,4,23,35],[41,5,23,36],[41,8,23,39,"args"],[41,12,23,43],[42,4,24,4],[42,10,24,10],[43,6,24,12,"x"],[43,7,24,13],[44,6,24,15,"filter"],[44,12,24,21],[45,6,24,23,"bias"],[45,10,24,27],[46,6,24,29,"preluActivationWeights"],[47,4,24,52],[47,5,24,53],[47,8,24,56,"inputs"],[47,14,24,62],[48,4,25,4],[48,10,25,10],[49,6,25,12,"strides"],[49,13,25,19],[50,6,25,21,"pad"],[50,9,25,24],[51,6,25,26,"dataFormat"],[51,16,25,36],[52,6,25,38,"dilations"],[52,15,25,47],[53,6,25,49,"dimRoundingMode"],[53,21,25,64],[54,6,25,66,"activation"],[54,16,25,76],[55,6,25,78,"leakyreluAlpha"],[56,4,25,93],[56,5,25,94],[56,8,25,97,"attrs"],[56,13,25,102],[57,4,26,4],[57,8,26,8,"result"],[57,14,26,14],[57,17,26,17],[57,21,26,17,"conv2D"],[57,28,26,23],[57,29,26,23,"conv2D"],[57,35,26,23],[57,37,26,24],[58,6,27,8,"inputs"],[58,12,27,14],[58,14,27,16],[59,8,27,18,"x"],[59,9,27,19],[60,8,27,21,"filter"],[61,6,27,28],[61,7,27,29],[62,6,28,8,"backend"],[62,13,28,15],[63,6,29,8,"attrs"],[63,11,29,13],[63,13,29,15],[64,8,29,17,"strides"],[64,15,29,24],[65,8,29,26,"pad"],[65,11,29,29],[66,8,29,31,"dataFormat"],[66,18,29,41],[67,8,29,43,"dilations"],[67,17,29,52],[68,8,29,54,"dimRoundingMode"],[69,6,29,70],[70,4,30,4],[70,5,30,5],[70,6,30,6],[71,4,31,4],[71,8,31,8,"bias"],[71,12,31,12],[71,14,31,14],[72,6,32,8],[72,12,32,14,"resultOld"],[72,21,32,23],[72,24,32,26,"result"],[72,30,32,32],[73,6,33,8],[74,6,34,8],[75,6,35,8],[76,6,36,8],[77,6,37,8],[77,10,37,12,"dataFormat"],[77,20,37,22],[77,25,37,27],[77,31,37,33],[77,35,37,37,"bias"],[77,39,37,41],[77,40,37,42,"shape"],[77,45,37,47],[77,46,37,48,"length"],[77,52,37,54],[77,57,37,59],[77,58,37,60],[77,62,38,12,"bias"],[77,66,38,16],[77,67,38,17,"shape"],[77,72,38,22],[77,73,38,23],[77,74,38,24],[77,75,38,25],[77,80,38,30],[77,81,38,31],[77,83,38,33],[78,8,39,12],[78,14,39,18,"reshapedBias"],[78,26,39,30],[78,29,39,33],[78,33,39,33,"reshape"],[78,41,39,40],[78,42,39,40,"reshape"],[78,49,39,40],[78,51,39,41],[79,10,39,43,"inputs"],[79,16,39,49],[79,18,39,51],[80,12,39,53,"x"],[80,13,39,54],[80,15,39,56,"bias"],[81,10,39,61],[81,11,39,62],[82,10,39,64,"backend"],[82,17,39,71],[83,10,39,73,"attrs"],[83,15,39,78],[83,17,39,80],[84,12,39,82,"shape"],[84,17,39,87],[84,19,39,89],[84,20,39,90,"bias"],[84,24,39,94],[84,25,39,95,"shape"],[84,30,39,100],[84,31,39,101],[84,32,39,102],[84,33,39,103],[84,35,39,105],[84,36,39,106],[84,38,39,108],[84,39,39,109],[85,10,39,111],[86,8,39,113],[86,9,39,114],[86,10,39,115],[87,8,40,12,"result"],[87,14,40,18],[87,17,41,16],[87,21,41,16,"add"],[87,25,41,19],[87,26,41,19,"add"],[87,29,41,19],[87,31,41,20],[88,10,41,22,"inputs"],[88,16,41,28],[88,18,41,30],[89,12,41,32,"a"],[89,13,41,33],[89,15,41,35,"result"],[89,21,41,41],[90,12,41,43,"b"],[90,13,41,44],[90,15,41,46,"reshapedBias"],[91,10,41,59],[91,11,41,60],[92,10,41,62,"backend"],[93,8,41,70],[93,9,41,71],[93,10,41,72],[94,8,42,12,"backend"],[94,15,42,19],[94,16,42,20,"disposeIntermediateTensorInfo"],[94,45,42,49],[94,46,42,50,"reshapedBias"],[94,58,42,62],[94,59,42,63],[95,6,43,8],[95,7,43,9],[95,13,44,13],[96,8,45,12],[97,8,46,12],[98,8,47,12,"result"],[98,14,47,18],[98,17,47,21],[98,21,47,21,"add"],[98,25,47,24],[98,26,47,24,"add"],[98,29,47,24],[98,31,47,25],[99,10,47,27,"inputs"],[99,16,47,33],[99,18,47,35],[100,12,47,37,"a"],[100,13,47,38],[100,15,47,40,"result"],[100,21,47,46],[101,12,47,48,"b"],[101,13,47,49],[101,15,47,51,"bias"],[102,10,47,56],[102,11,47,57],[103,10,47,59,"backend"],[104,8,47,67],[104,9,47,68],[104,10,47,69],[105,6,48,8],[106,6,49,8,"backend"],[106,13,49,15],[106,14,49,16,"disposeIntermediateTensorInfo"],[106,43,49,45],[106,44,49,46,"resultOld"],[106,53,49,55],[106,54,49,56],[107,4,50,4],[108,4,51,4],[108,8,51,8,"activation"],[108,18,51,18],[108,20,51,20],[109,6,52,8],[109,12,52,14,"resultOld"],[109,21,52,23],[109,24,52,26,"result"],[109,30,52,32],[110,6,53,8],[111,6,54,8],[112,6,55,8],[113,6,56,8],[114,6,57,8],[114,10,57,12,"dataFormat"],[114,20,57,22],[114,25,57,27],[114,31,57,33],[114,35,57,37,"activation"],[114,45,57,47],[114,50,57,52],[114,57,57,59],[114,61,58,12,"preluActivationWeights"],[114,83,58,34],[114,84,58,35,"shape"],[114,89,58,40],[114,90,58,41,"length"],[114,96,58,47],[114,101,58,52],[114,102,58,53],[114,106,59,12,"preluActivationWeights"],[114,128,59,34],[114,129,59,35,"shape"],[114,134,59,40],[114,135,59,41],[114,136,59,42],[114,137,59,43],[114,142,59,48],[114,143,59,49],[114,145,59,51],[115,8,60,12],[115,14,60,18,"reshapedAlpha"],[115,27,60,31],[115,30,60,34],[115,34,60,34,"reshape"],[115,42,60,41],[115,43,60,41,"reshape"],[115,50,60,41],[115,52,60,42],[116,10,61,16,"inputs"],[116,16,61,22],[116,18,61,24],[117,12,61,26,"x"],[117,13,61,27],[117,15,61,29,"preluActivationWeights"],[118,10,61,52],[118,11,61,53],[119,10,62,16,"backend"],[119,17,62,23],[120,10,63,16,"attrs"],[120,15,63,21],[120,17,63,23],[121,12,63,25,"shape"],[121,17,63,30],[121,19,63,32],[121,20,63,33,"preluActivationWeights"],[121,42,63,55],[121,43,63,56,"shape"],[121,48,63,61],[121,49,63,62],[121,50,63,63],[121,51,63,64],[121,53,63,66],[121,54,63,67],[121,56,63,69],[121,57,63,70],[122,10,63,72],[123,8,64,12],[123,9,64,13],[123,10,64,14],[124,8,65,12,"result"],[124,14,65,18],[124,17,65,21],[124,21,65,21,"applyActivation"],[124,38,65,36],[124,39,65,36,"applyActivation"],[124,54,65,36],[124,56,65,37,"backend"],[124,63,65,44],[124,65,65,46,"result"],[124,71,65,52],[124,73,65,54,"activation"],[124,83,65,64],[124,85,65,66,"reshapedAlpha"],[124,98,65,79],[124,100,65,81,"leakyreluAlpha"],[124,114,65,95],[124,115,65,96],[125,8,66,12,"backend"],[125,15,66,19],[125,16,66,20,"disposeIntermediateTensorInfo"],[125,45,66,49],[125,46,66,50,"reshapedAlpha"],[125,59,66,63],[125,60,66,64],[126,6,67,8],[126,7,67,9],[126,13,68,13],[127,8,69,12,"result"],[127,14,69,18],[127,17,69,21],[127,21,69,21,"applyActivation"],[127,38,69,36],[127,39,69,36,"applyActivation"],[127,54,69,36],[127,56,69,37,"backend"],[127,63,69,44],[127,65,69,46,"result"],[127,71,69,52],[127,73,69,54,"activation"],[127,83,69,64],[127,85,69,66,"preluActivationWeights"],[127,107,69,88],[127,109,69,90,"leakyreluAlpha"],[127,123,69,104],[127,124,69,105],[128,6,70,8],[129,6,71,8,"backend"],[129,13,71,15],[129,14,71,16,"disposeIntermediateTensorInfo"],[129,43,71,45],[129,44,71,46,"resultOld"],[129,53,71,55],[129,54,71,56],[130,4,72,4],[131,4,73,4],[131,11,73,11,"result"],[131,17,73,17],[132,2,74,0],[133,2,75,7],[133,8,75,13,"fusedConv2DConfig"],[133,25,75,30],[133,28,75,33],[134,4,76,4,"kernelName"],[134,14,76,14],[134,16,76,16,"FusedConv2D"],[134,35,76,27],[134,36,76,27,"FusedConv2D"],[134,47,76,27],[135,4,77,4,"backendName"],[135,15,77,15],[135,17,77,17],[135,22,77,22],[136,4,78,4,"kernelFunc"],[136,14,78,14],[136,16,78,16,"fusedConv2D"],[137,2,79,0],[137,3,79,1],[138,0,79,2],[138,3]],"functionMap":{"names":["<global>","fusedConv2D"],"mappings":"AAA;OCqB;CDoD"},"hasCjsExports":false},"type":"js/module"}]}