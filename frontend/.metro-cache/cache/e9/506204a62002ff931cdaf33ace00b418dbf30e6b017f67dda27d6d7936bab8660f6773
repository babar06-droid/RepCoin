{"dependencies":[{"name":"../../backends/non_max_suppression_impl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":82,"index":785}}],"key":"TMFCT59yYol80UUXw+t7G5ZgJ4Q=","exportNames":["*"],"imports":1}},{"name":"../../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":786},"end":{"line":18,"column":56,"index":842}}],"key":"xfSGNGkCJdZhfQ673y/6d+no2yU=","exportNames":["*"],"imports":1}},{"name":"../nonmax_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":843},"end":{"line":19,"column":55,"index":898}}],"key":"0KlOSQQJQ4cKLKTcUmdRliPcibs=","exportNames":["*"],"imports":1}},{"name":"../tensor1d","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":899},"end":{"line":20,"column":39,"index":938}}],"key":"kuefm5tuaz1jkFeHQbmB8ff4Z9E=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"nonMaxSuppressionAsync\", {\n    enumerable: true,\n    get: function () {\n      return nonMaxSuppressionAsync;\n    }\n  });\n  var _backendsNon_max_suppression_impl = require(_dependencyMap[0], \"../../backends/non_max_suppression_impl\");\n  var _tensor_util_env = require(_dependencyMap[1], \"../../tensor_util_env\");\n  var _nonmax_util = require(_dependencyMap[2], \"../nonmax_util\");\n  var _tensor1d = require(_dependencyMap[3], \"../tensor1d\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * Performs non maximum suppression of bounding boxes based on\n   * iou (intersection over union).\n   *\n   * This is the async version of `nonMaxSuppression`\n   *\n   * @param boxes a 2d tensor of shape `[numBoxes, 4]`. Each entry is\n   *     `[y1, x1, y2, x2]`, where `(y1, x1)` and `(y2, x2)` are the corners of\n   *     the bounding box.\n   * @param scores a 1d tensor providing the box scores of shape `[numBoxes]`.\n   * @param maxOutputSize The maximum number of boxes to be selected.\n   * @param iouThreshold A float representing the threshold for deciding whether\n   *     boxes overlap too much with respect to IOU. Must be between [0, 1].\n   *     Defaults to 0.5 (50% box overlap).\n   * @param scoreThreshold A threshold for deciding when to remove boxes based\n   *     on score. Defaults to -inf, which means any score is accepted.\n   * @return A 1D tensor with the selected box indices.\n   *\n   * @doc {heading: 'Operations', subheading: 'Images', namespace: 'image'}\n   */\n  async function nonMaxSuppressionAsync_(boxes, scores, maxOutputSize, iouThreshold = 0.5, scoreThreshold = Number.NEGATIVE_INFINITY) {\n    const $boxes = (0, _tensor_util_env.convertToTensor)(boxes, 'boxes', 'nonMaxSuppressionAsync');\n    const $scores = (0, _tensor_util_env.convertToTensor)(scores, 'scores', 'nonMaxSuppressionAsync');\n    const inputs = (0, _nonmax_util.nonMaxSuppSanityCheck)($boxes, $scores, maxOutputSize, iouThreshold, scoreThreshold);\n    maxOutputSize = inputs.maxOutputSize;\n    iouThreshold = inputs.iouThreshold;\n    scoreThreshold = inputs.scoreThreshold;\n    const boxesAndScores = await Promise.all([$boxes.data(), $scores.data()]);\n    const boxesVals = boxesAndScores[0];\n    const scoresVals = boxesAndScores[1];\n    // We call a cpu based impl directly with the typedarray data  here rather\n    // than a kernel because all kernels are synchronous (and thus cannot await\n    // .data()).\n    const {\n      selectedIndices\n    } = (0, _backendsNon_max_suppression_impl.nonMaxSuppressionV3Impl)(boxesVals, scoresVals, maxOutputSize, iouThreshold, scoreThreshold);\n    if ($boxes !== boxes) {\n      $boxes.dispose();\n    }\n    if ($scores !== scores) {\n      $scores.dispose();\n    }\n    return (0, _tensor1d.tensor1d)(selectedIndices, 'int32');\n  }\n  const nonMaxSuppressionAsync = nonMaxSuppressionAsync_;\n});","lineCount":79,"map":[[7,2,63,0,"Object"],[7,8,63,0],[7,9,63,0,"defineProperty"],[7,23,63,0],[7,24,63,0,"exports"],[7,31,63,0],[8,4,63,0,"enumerable"],[8,14,63,0],[9,4,63,0,"get"],[9,7,63,0],[9,18,63,0,"get"],[9,19,63,0],[10,6,63,0],[10,13,63,0,"nonMaxSuppressionAsync"],[10,35,63,0],[11,4,63,0],[12,2,63,0],[13,2,17,0],[13,6,17,0,"_backendsNon_max_suppression_impl"],[13,39,17,0],[13,42,17,0,"require"],[13,49,17,0],[13,50,17,0,"_dependencyMap"],[13,64,17,0],[14,2,18,0],[14,6,18,0,"_tensor_util_env"],[14,22,18,0],[14,25,18,0,"require"],[14,32,18,0],[14,33,18,0,"_dependencyMap"],[14,47,18,0],[15,2,19,0],[15,6,19,0,"_nonmax_util"],[15,18,19,0],[15,21,19,0,"require"],[15,28,19,0],[15,29,19,0,"_dependencyMap"],[15,43,19,0],[16,2,20,0],[16,6,20,0,"_tensor1d"],[16,15,20,0],[16,18,20,0,"require"],[16,25,20,0],[16,26,20,0,"_dependencyMap"],[16,40,20,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[22,0,6,0],[23,0,7,0],[24,0,8,0],[25,0,9,0],[26,0,10,0],[27,0,11,0],[28,0,12,0],[29,0,13,0],[30,0,14,0],[31,0,15,0],[32,0,16,0],[34,2,21,0],[35,0,22,0],[36,0,23,0],[37,0,24,0],[38,0,25,0],[39,0,26,0],[40,0,27,0],[41,0,28,0],[42,0,29,0],[43,0,30,0],[44,0,31,0],[45,0,32,0],[46,0,33,0],[47,0,34,0],[48,0,35,0],[49,0,36,0],[50,0,37,0],[51,0,38,0],[52,0,39,0],[53,0,40,0],[54,2,41,0],[54,17,41,15,"nonMaxSuppressionAsync_"],[54,40,41,38,"nonMaxSuppressionAsync_"],[54,41,41,39,"boxes"],[54,46,41,44],[54,48,41,46,"scores"],[54,54,41,52],[54,56,41,54,"maxOutputSize"],[54,69,41,67],[54,71,41,69,"iouThreshold"],[54,83,41,81],[54,86,41,84],[54,89,41,87],[54,91,41,89,"scoreThreshold"],[54,105,41,103],[54,108,41,106,"Number"],[54,114,41,112],[54,115,41,113,"NEGATIVE_INFINITY"],[54,132,41,130],[54,134,41,132],[55,4,42,4],[55,10,42,10,"$boxes"],[55,16,42,16],[55,19,42,19],[55,23,42,19,"convertToTensor"],[55,39,42,34],[55,40,42,34,"convertToTensor"],[55,55,42,34],[55,57,42,35,"boxes"],[55,62,42,40],[55,64,42,42],[55,71,42,49],[55,73,42,51],[55,97,42,75],[55,98,42,76],[56,4,43,4],[56,10,43,10,"$scores"],[56,17,43,17],[56,20,43,20],[56,24,43,20,"convertToTensor"],[56,40,43,35],[56,41,43,35,"convertToTensor"],[56,56,43,35],[56,58,43,36,"scores"],[56,64,43,42],[56,66,43,44],[56,74,43,52],[56,76,43,54],[56,100,43,78],[56,101,43,79],[57,4,44,4],[57,10,44,10,"inputs"],[57,16,44,16],[57,19,44,19],[57,23,44,19,"nonMaxSuppSanityCheck"],[57,35,44,40],[57,36,44,40,"nonMaxSuppSanityCheck"],[57,57,44,40],[57,59,44,41,"$boxes"],[57,65,44,47],[57,67,44,49,"$scores"],[57,74,44,56],[57,76,44,58,"maxOutputSize"],[57,89,44,71],[57,91,44,73,"iouThreshold"],[57,103,44,85],[57,105,44,87,"scoreThreshold"],[57,119,44,101],[57,120,44,102],[58,4,45,4,"maxOutputSize"],[58,17,45,17],[58,20,45,20,"inputs"],[58,26,45,26],[58,27,45,27,"maxOutputSize"],[58,40,45,40],[59,4,46,4,"iouThreshold"],[59,16,46,16],[59,19,46,19,"inputs"],[59,25,46,25],[59,26,46,26,"iouThreshold"],[59,38,46,38],[60,4,47,4,"scoreThreshold"],[60,18,47,18],[60,21,47,21,"inputs"],[60,27,47,27],[60,28,47,28,"scoreThreshold"],[60,42,47,42],[61,4,48,4],[61,10,48,10,"boxesAndScores"],[61,24,48,24],[61,27,48,27],[61,33,48,33,"Promise"],[61,40,48,40],[61,41,48,41,"all"],[61,44,48,44],[61,45,48,45],[61,46,48,46,"$boxes"],[61,52,48,52],[61,53,48,53,"data"],[61,57,48,57],[61,58,48,58],[61,59,48,59],[61,61,48,61,"$scores"],[61,68,48,68],[61,69,48,69,"data"],[61,73,48,73],[61,74,48,74],[61,75,48,75],[61,76,48,76],[61,77,48,77],[62,4,49,4],[62,10,49,10,"boxesVals"],[62,19,49,19],[62,22,49,22,"boxesAndScores"],[62,36,49,36],[62,37,49,37],[62,38,49,38],[62,39,49,39],[63,4,50,4],[63,10,50,10,"scoresVals"],[63,20,50,20],[63,23,50,23,"boxesAndScores"],[63,37,50,37],[63,38,50,38],[63,39,50,39],[63,40,50,40],[64,4,51,4],[65,4,52,4],[66,4,53,4],[67,4,54,4],[67,10,54,10],[68,6,54,12,"selectedIndices"],[69,4,54,28],[69,5,54,29],[69,8,54,32],[69,12,54,32,"nonMaxSuppressionV3Impl"],[69,45,54,55],[69,46,54,55,"nonMaxSuppressionV3Impl"],[69,69,54,55],[69,71,54,56,"boxesVals"],[69,80,54,65],[69,82,54,67,"scoresVals"],[69,92,54,77],[69,94,54,79,"maxOutputSize"],[69,107,54,92],[69,109,54,94,"iouThreshold"],[69,121,54,106],[69,123,54,108,"scoreThreshold"],[69,137,54,122],[69,138,54,123],[70,4,55,4],[70,8,55,8,"$boxes"],[70,14,55,14],[70,19,55,19,"boxes"],[70,24,55,24],[70,26,55,26],[71,6,56,8,"$boxes"],[71,12,56,14],[71,13,56,15,"dispose"],[71,20,56,22],[71,21,56,23],[71,22,56,24],[72,4,57,4],[73,4,58,4],[73,8,58,8,"$scores"],[73,15,58,15],[73,20,58,20,"scores"],[73,26,58,26],[73,28,58,28],[74,6,59,8,"$scores"],[74,13,59,15],[74,14,59,16,"dispose"],[74,21,59,23],[74,22,59,24],[74,23,59,25],[75,4,60,4],[76,4,61,4],[76,11,61,11],[76,15,61,11,"tensor1d"],[76,24,61,19],[76,25,61,19,"tensor1d"],[76,33,61,19],[76,35,61,20,"selectedIndices"],[76,50,61,35],[76,52,61,37],[76,59,61,44],[76,60,61,45],[77,2,62,0],[78,2,63,7],[78,8,63,13,"nonMaxSuppressionAsync"],[78,30,63,35],[78,33,63,38,"nonMaxSuppressionAsync_"],[78,56,63,61],[79,0,63,62],[79,3]],"functionMap":{"names":["<global>","nonMaxSuppressionAsync_"],"mappings":"AAA;ACwC;CDqB"},"hasCjsExports":false},"type":"js/module"}]}