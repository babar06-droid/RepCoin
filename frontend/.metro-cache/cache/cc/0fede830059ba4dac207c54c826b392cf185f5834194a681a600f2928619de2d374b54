{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":44,"index":747}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../kernel_utils/shared","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":808},"end":{"line":19,"column":52,"index":860}}],"key":"JzS9qfQGP0NvwhobUV8d6bPV3h4=","exportNames":["*"],"imports":1}},{"name":"./Max_impl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":861},"end":{"line":20,"column":37,"index":898}}],"key":"hMbx96xw0r/jhXbgJ6tKxYAyKjE=","exportNames":["*"],"imports":1}},{"name":"./Transpose_impl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":899},"end":{"line":21,"column":67,"index":966}}],"key":"14/1wfkCjW4iZnvkwkO0WFpRQ7E=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.max = max;\n  Object.defineProperty(exports, \"maxConfig\", {\n    enumerable: true,\n    get: function () {\n      return maxConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _kernel_utilsShared = require(_dependencyMap[1], \"../kernel_utils/shared\");\n  var _Max_impl = require(_dependencyMap[2], \"./Max_impl\");\n  var _Transpose_impl = require(_dependencyMap[3], \"./Transpose_impl\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function max(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x\n    } = inputs;\n    const {\n      reductionIndices,\n      keepDims\n    } = attrs;\n    const xRank = x.shape.length;\n    const origAxes = _tensorflowTfjsCore.util.parseAxisParam(reductionIndices, x.shape);\n    let axes = origAxes;\n    const permutedAxes = _tensorflowTfjsCore.backend_util.getAxesPermutation(axes, xRank);\n    const maxInputIsTransposed = permutedAxes != null;\n    const shouldExecuteOnCPU = backend.shouldExecuteOnCPU([x]);\n    let maxInput = x;\n    if (maxInputIsTransposed) {\n      if (shouldExecuteOnCPU) {\n        const xTexData = backend.texData.get(maxInput.dataId);\n        const values = xTexData.values;\n        const newShape = new Array(xRank);\n        for (let i = 0; i < newShape.length; i++) {\n          newShape[i] = x.shape[permutedAxes[i]];\n        }\n        const maxInputValues = (0, _Transpose_impl.transposeImplCPU)(values, x.shape, x.dtype, permutedAxes, newShape);\n        maxInput = backend.makeTensorInfo(newShape, x.dtype);\n        const maxInputData = backend.texData.get(maxInput.dataId);\n        maxInputData.values = maxInputValues;\n      } else {\n        maxInput = (0, _Transpose_impl.transposeImpl)(x, permutedAxes, backend);\n      }\n      axes = _tensorflowTfjsCore.backend_util.getInnerMostAxes(axes.length, xRank);\n    }\n    _tensorflowTfjsCore.backend_util.assertAxesAreInnerMostDims('max', axes, xRank);\n    const [maxOutShape, reduceShape] = _tensorflowTfjsCore.backend_util.computeOutAndReduceShapes(maxInput.shape, axes);\n    let outShape = maxOutShape;\n    if (keepDims) {\n      // rather than reshape at the end, set the target shape here.\n      outShape = _tensorflowTfjsCore.backend_util.expandShapeToKeepDim(maxOutShape, origAxes);\n    }\n    let out;\n    if (shouldExecuteOnCPU) {\n      const xTexData = backend.texData.get(maxInput.dataId);\n      const values = xTexData.values;\n      const outValues = (0, _kernel_utilsShared.maxImplCPU)(values, _tensorflowTfjsCore.util.sizeFromShape(reduceShape), outShape, x.dtype);\n      out = backend.makeTensorInfo(outShape, x.dtype);\n      const outData = backend.texData.get(out.dataId);\n      outData.values = outValues;\n    } else {\n      out = (0, _Max_impl.maxImpl)(maxInput, reduceShape, outShape, backend);\n    }\n    if (maxInputIsTransposed) {\n      backend.disposeIntermediateTensorInfo(maxInput);\n    }\n    return out;\n  }\n  const maxConfig = {\n    kernelName: _tensorflowTfjsCore.Max,\n    backendName: 'webgl',\n    kernelFunc: max\n  };\n});","lineCount":100,"map":[[7,2,22,0,"exports"],[7,9,22,0],[7,10,22,0,"max"],[7,13,22,0],[7,16,22,0,"max"],[7,19,22,0],[8,2,75,0,"Object"],[8,8,75,0],[8,9,75,0,"defineProperty"],[8,23,75,0],[8,24,75,0,"exports"],[8,31,75,0],[9,4,75,0,"enumerable"],[9,14,75,0],[10,4,75,0,"get"],[10,7,75,0],[10,18,75,0,"get"],[10,19,75,0],[11,6,75,0],[11,13,75,0,"maxConfig"],[11,22,75,0],[12,4,75,0],[13,2,75,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,19,0],[15,6,19,0,"_kernel_utilsShared"],[15,25,19,0],[15,28,19,0,"require"],[15,35,19,0],[15,36,19,0,"_dependencyMap"],[15,50,19,0],[16,2,20,0],[16,6,20,0,"_Max_impl"],[16,15,20,0],[16,18,20,0,"require"],[16,25,20,0],[16,26,20,0,"_dependencyMap"],[16,40,20,0],[17,2,21,0],[17,6,21,0,"_Transpose_impl"],[17,21,21,0],[17,24,21,0,"require"],[17,31,21,0],[17,32,21,0,"_dependencyMap"],[17,46,21,0],[18,2,1,0],[19,0,2,0],[20,0,3,0],[21,0,4,0],[22,0,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[35,2,22,7],[35,11,22,16,"max"],[35,14,22,19,"max"],[35,15,22,20,"args"],[35,19,22,24],[35,21,22,26],[36,4,23,4],[36,10,23,10],[37,6,23,12,"inputs"],[37,12,23,18],[38,6,23,20,"backend"],[38,13,23,27],[39,6,23,29,"attrs"],[40,4,23,35],[40,5,23,36],[40,8,23,39,"args"],[40,12,23,43],[41,4,24,4],[41,10,24,10],[42,6,24,12,"x"],[43,4,24,14],[43,5,24,15],[43,8,24,18,"inputs"],[43,14,24,24],[44,4,25,4],[44,10,25,10],[45,6,25,12,"reductionIndices"],[45,22,25,28],[46,6,25,30,"keepDims"],[47,4,25,39],[47,5,25,40],[47,8,25,43,"attrs"],[47,13,25,48],[48,4,26,4],[48,10,26,10,"xRank"],[48,15,26,15],[48,18,26,18,"x"],[48,19,26,19],[48,20,26,20,"shape"],[48,25,26,25],[48,26,26,26,"length"],[48,32,26,32],[49,4,27,4],[49,10,27,10,"origAxes"],[49,18,27,18],[49,21,27,21,"util"],[49,40,27,25],[49,41,27,25,"util"],[49,45,27,25],[49,46,27,26,"parseAxisParam"],[49,60,27,40],[49,61,27,41,"reductionIndices"],[49,77,27,57],[49,79,27,59,"x"],[49,80,27,60],[49,81,27,61,"shape"],[49,86,27,66],[49,87,27,67],[50,4,28,4],[50,8,28,8,"axes"],[50,12,28,12],[50,15,28,15,"origAxes"],[50,23,28,23],[51,4,29,4],[51,10,29,10,"permutedAxes"],[51,22,29,22],[51,25,29,25,"backend_util"],[51,44,29,37],[51,45,29,37,"backend_util"],[51,57,29,37],[51,58,29,38,"getAxesPermutation"],[51,76,29,56],[51,77,29,57,"axes"],[51,81,29,61],[51,83,29,63,"xRank"],[51,88,29,68],[51,89,29,69],[52,4,30,4],[52,10,30,10,"maxInputIsTransposed"],[52,30,30,30],[52,33,30,33,"permutedAxes"],[52,45,30,45],[52,49,30,49],[52,53,30,53],[53,4,31,4],[53,10,31,10,"shouldExecuteOnCPU"],[53,28,31,28],[53,31,31,31,"backend"],[53,38,31,38],[53,39,31,39,"shouldExecuteOnCPU"],[53,57,31,57],[53,58,31,58],[53,59,31,59,"x"],[53,60,31,60],[53,61,31,61],[53,62,31,62],[54,4,32,4],[54,8,32,8,"maxInput"],[54,16,32,16],[54,19,32,19,"x"],[54,20,32,20],[55,4,33,4],[55,8,33,8,"maxInputIsTransposed"],[55,28,33,28],[55,30,33,30],[56,6,34,8],[56,10,34,12,"shouldExecuteOnCPU"],[56,28,34,30],[56,30,34,32],[57,8,35,12],[57,14,35,18,"xTexData"],[57,22,35,26],[57,25,35,29,"backend"],[57,32,35,36],[57,33,35,37,"texData"],[57,40,35,44],[57,41,35,45,"get"],[57,44,35,48],[57,45,35,49,"maxInput"],[57,53,35,57],[57,54,35,58,"dataId"],[57,60,35,64],[57,61,35,65],[58,8,36,12],[58,14,36,18,"values"],[58,20,36,24],[58,23,36,27,"xTexData"],[58,31,36,35],[58,32,36,36,"values"],[58,38,36,42],[59,8,37,12],[59,14,37,18,"newShape"],[59,22,37,26],[59,25,37,29],[59,29,37,33,"Array"],[59,34,37,38],[59,35,37,39,"xRank"],[59,40,37,44],[59,41,37,45],[60,8,38,12],[60,13,38,17],[60,17,38,21,"i"],[60,18,38,22],[60,21,38,25],[60,22,38,26],[60,24,38,28,"i"],[60,25,38,29],[60,28,38,32,"newShape"],[60,36,38,40],[60,37,38,41,"length"],[60,43,38,47],[60,45,38,49,"i"],[60,46,38,50],[60,48,38,52],[60,50,38,54],[61,10,39,16,"newShape"],[61,18,39,24],[61,19,39,25,"i"],[61,20,39,26],[61,21,39,27],[61,24,39,30,"x"],[61,25,39,31],[61,26,39,32,"shape"],[61,31,39,37],[61,32,39,38,"permutedAxes"],[61,44,39,50],[61,45,39,51,"i"],[61,46,39,52],[61,47,39,53],[61,48,39,54],[62,8,40,12],[63,8,41,12],[63,14,41,18,"maxInputValues"],[63,28,41,32],[63,31,41,35],[63,35,41,35,"transposeImplCPU"],[63,50,41,51],[63,51,41,51,"transposeImplCPU"],[63,67,41,51],[63,69,41,52,"values"],[63,75,41,58],[63,77,41,60,"x"],[63,78,41,61],[63,79,41,62,"shape"],[63,84,41,67],[63,86,41,69,"x"],[63,87,41,70],[63,88,41,71,"dtype"],[63,93,41,76],[63,95,41,78,"permutedAxes"],[63,107,41,90],[63,109,41,92,"newShape"],[63,117,41,100],[63,118,41,101],[64,8,42,12,"maxInput"],[64,16,42,20],[64,19,42,23,"backend"],[64,26,42,30],[64,27,42,31,"makeTensorInfo"],[64,41,42,45],[64,42,42,46,"newShape"],[64,50,42,54],[64,52,42,56,"x"],[64,53,42,57],[64,54,42,58,"dtype"],[64,59,42,63],[64,60,42,64],[65,8,43,12],[65,14,43,18,"maxInputData"],[65,26,43,30],[65,29,43,33,"backend"],[65,36,43,40],[65,37,43,41,"texData"],[65,44,43,48],[65,45,43,49,"get"],[65,48,43,52],[65,49,43,53,"maxInput"],[65,57,43,61],[65,58,43,62,"dataId"],[65,64,43,68],[65,65,43,69],[66,8,44,12,"maxInputData"],[66,20,44,24],[66,21,44,25,"values"],[66,27,44,31],[66,30,44,34,"maxInputValues"],[66,44,44,48],[67,6,45,8],[67,7,45,9],[67,13,46,13],[68,8,47,12,"maxInput"],[68,16,47,20],[68,19,47,23],[68,23,47,23,"transposeImpl"],[68,38,47,36],[68,39,47,36,"transposeImpl"],[68,52,47,36],[68,54,47,37,"x"],[68,55,47,38],[68,57,47,40,"permutedAxes"],[68,69,47,52],[68,71,47,54,"backend"],[68,78,47,61],[68,79,47,62],[69,6,48,8],[70,6,49,8,"axes"],[70,10,49,12],[70,13,49,15,"backend_util"],[70,32,49,27],[70,33,49,27,"backend_util"],[70,45,49,27],[70,46,49,28,"getInnerMostAxes"],[70,62,49,44],[70,63,49,45,"axes"],[70,67,49,49],[70,68,49,50,"length"],[70,74,49,56],[70,76,49,58,"xRank"],[70,81,49,63],[70,82,49,64],[71,4,50,4],[72,4,51,4,"backend_util"],[72,23,51,16],[72,24,51,16,"backend_util"],[72,36,51,16],[72,37,51,17,"assertAxesAreInnerMostDims"],[72,63,51,43],[72,64,51,44],[72,69,51,49],[72,71,51,51,"axes"],[72,75,51,55],[72,77,51,57,"xRank"],[72,82,51,62],[72,83,51,63],[73,4,52,4],[73,10,52,10],[73,11,52,11,"maxOutShape"],[73,22,52,22],[73,24,52,24,"reduceShape"],[73,35,52,35],[73,36,52,36],[73,39,52,39,"backend_util"],[73,58,52,51],[73,59,52,51,"backend_util"],[73,71,52,51],[73,72,52,52,"computeOutAndReduceShapes"],[73,97,52,77],[73,98,52,78,"maxInput"],[73,106,52,86],[73,107,52,87,"shape"],[73,112,52,92],[73,114,52,94,"axes"],[73,118,52,98],[73,119,52,99],[74,4,53,4],[74,8,53,8,"outShape"],[74,16,53,16],[74,19,53,19,"maxOutShape"],[74,30,53,30],[75,4,54,4],[75,8,54,8,"keepDims"],[75,16,54,16],[75,18,54,18],[76,6,55,8],[77,6,56,8,"outShape"],[77,14,56,16],[77,17,56,19,"backend_util"],[77,36,56,31],[77,37,56,31,"backend_util"],[77,49,56,31],[77,50,56,32,"expandShapeToKeepDim"],[77,70,56,52],[77,71,56,53,"maxOutShape"],[77,82,56,64],[77,84,56,66,"origAxes"],[77,92,56,74],[77,93,56,75],[78,4,57,4],[79,4,58,4],[79,8,58,8,"out"],[79,11,58,11],[80,4,59,4],[80,8,59,8,"shouldExecuteOnCPU"],[80,26,59,26],[80,28,59,28],[81,6,60,8],[81,12,60,14,"xTexData"],[81,20,60,22],[81,23,60,25,"backend"],[81,30,60,32],[81,31,60,33,"texData"],[81,38,60,40],[81,39,60,41,"get"],[81,42,60,44],[81,43,60,45,"maxInput"],[81,51,60,53],[81,52,60,54,"dataId"],[81,58,60,60],[81,59,60,61],[82,6,61,8],[82,12,61,14,"values"],[82,18,61,20],[82,21,61,23,"xTexData"],[82,29,61,31],[82,30,61,32,"values"],[82,36,61,38],[83,6,62,8],[83,12,62,14,"outValues"],[83,21,62,23],[83,24,62,26],[83,28,62,26,"maxImplCPU"],[83,47,62,36],[83,48,62,36,"maxImplCPU"],[83,58,62,36],[83,60,62,37,"values"],[83,66,62,43],[83,68,62,45,"util"],[83,87,62,49],[83,88,62,49,"util"],[83,92,62,49],[83,93,62,50,"sizeFromShape"],[83,106,62,63],[83,107,62,64,"reduceShape"],[83,118,62,75],[83,119,62,76],[83,121,62,78,"outShape"],[83,129,62,86],[83,131,62,88,"x"],[83,132,62,89],[83,133,62,90,"dtype"],[83,138,62,95],[83,139,62,96],[84,6,63,8,"out"],[84,9,63,11],[84,12,63,14,"backend"],[84,19,63,21],[84,20,63,22,"makeTensorInfo"],[84,34,63,36],[84,35,63,37,"outShape"],[84,43,63,45],[84,45,63,47,"x"],[84,46,63,48],[84,47,63,49,"dtype"],[84,52,63,54],[84,53,63,55],[85,6,64,8],[85,12,64,14,"outData"],[85,19,64,21],[85,22,64,24,"backend"],[85,29,64,31],[85,30,64,32,"texData"],[85,37,64,39],[85,38,64,40,"get"],[85,41,64,43],[85,42,64,44,"out"],[85,45,64,47],[85,46,64,48,"dataId"],[85,52,64,54],[85,53,64,55],[86,6,65,8,"outData"],[86,13,65,15],[86,14,65,16,"values"],[86,20,65,22],[86,23,65,25,"outValues"],[86,32,65,34],[87,4,66,4],[87,5,66,5],[87,11,67,9],[88,6,68,8,"out"],[88,9,68,11],[88,12,68,14],[88,16,68,14,"maxImpl"],[88,25,68,21],[88,26,68,21,"maxImpl"],[88,33,68,21],[88,35,68,22,"maxInput"],[88,43,68,30],[88,45,68,32,"reduceShape"],[88,56,68,43],[88,58,68,45,"outShape"],[88,66,68,53],[88,68,68,55,"backend"],[88,75,68,62],[88,76,68,63],[89,4,69,4],[90,4,70,4],[90,8,70,8,"maxInputIsTransposed"],[90,28,70,28],[90,30,70,30],[91,6,71,8,"backend"],[91,13,71,15],[91,14,71,16,"disposeIntermediateTensorInfo"],[91,43,71,45],[91,44,71,46,"maxInput"],[91,52,71,54],[91,53,71,55],[92,4,72,4],[93,4,73,4],[93,11,73,11,"out"],[93,14,73,14],[94,2,74,0],[95,2,75,7],[95,8,75,13,"maxConfig"],[95,17,75,22],[95,20,75,25],[96,4,76,4,"kernelName"],[96,14,76,14],[96,16,76,16,"Max"],[96,35,76,19],[96,36,76,19,"Max"],[96,39,76,19],[97,4,77,4,"backendName"],[97,15,77,15],[97,17,77,17],[97,24,77,24],[98,4,78,4,"kernelFunc"],[98,14,78,14],[98,16,78,16,"max"],[99,2,79,0],[99,3,79,1],[100,0,79,2],[100,3]],"functionMap":{"names":["<global>","max"],"mappings":"AAA;OCqB;CDoD"},"hasCjsExports":false},"type":"js/module"}]}