{"dependencies":[{"name":"./packing_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":45,"index":748}}],"key":"XZxV38atso3t5pLpH4+paVH17Hc=","exportNames":["*"],"imports":1}},{"name":"./shader_compiler","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":749},"end":{"line":18,"column":54,"index":803}}],"key":"yVSKlvZSxQn3Ck2puzGVWEYPzq8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"SlicePackedProgram\", {\n    enumerable: true,\n    get: function () {\n      return SlicePackedProgram;\n    }\n  });\n  var _packing_util = require(_dependencyMap[0], \"./packing_util\");\n  var _shader_compiler = require(_dependencyMap[1], \"./shader_compiler\");\n  /**\n   * @license\n   * Copyright 2019 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  class SlicePackedProgram {\n    constructor(destSize) {\n      this.variableNames = ['source'];\n      this.packedInputs = true;\n      this.packedOutput = true;\n      this.outputShape = destSize;\n      this.rank = destSize.length;\n      this.customUniforms = [{\n        name: 'start',\n        arrayIndex: this.rank,\n        type: 'int'\n      }];\n      const dtype = (0, _shader_compiler.getCoordsDataType)(this.rank);\n      const coords = (0, _packing_util.getChannels)('coords', this.rank);\n      const sourceLoc = (0, _packing_util.getChannels)('sourceLoc', this.rank);\n      const innerDims = this.rank === 1 ? 'sourceLoc' : `vec2(${sourceLoc.slice(-2).join()})`;\n      const getChannel = `getChannel(getSource(${sourceLoc.join()}), ${innerDims})`;\n      const upperRow = `\n      result.x = ${getChannel};\n      if (++${coords[this.rank - 1]} < ${destSize[this.rank - 1]}) {\n        ++${sourceLoc[this.rank - 1]};\n        result.y = ${getChannel};\n        --${sourceLoc[this.rank - 1]};\n      }\n    `;\n      const lowerRow = this.rank === 1 ? '' : `\n      --${coords[this.rank - 1]};\n      if (++${coords[this.rank - 2]} < ${destSize[this.rank - 2]}) {\n        ++${sourceLoc[this.rank - 2]};\n        result.z = ${getChannel};\n        if (++${coords[this.rank - 1]} < ${destSize[this.rank - 1]}) {\n          ++${sourceLoc[this.rank - 1]};\n          result.w = ${getChannel};\n        }\n      }\n    `;\n      const sourceLocSetup = this.rank <= 4 ? `sourceLoc = coords +\n            ${dtype}(${destSize.map((_, i) => `start[${i}]`).join()});` : destSize.map((_, i) => `${sourceLoc[i]} = ${coords[i]} + start[${i}];`).join('\\n');\n      this.userCode = `\n      void main() {\n        ${dtype} coords = getOutputCoords();\n        ${dtype} sourceLoc;\n        ${sourceLocSetup}\n        vec4 result = vec4(0.);\n        ${upperRow}\n        ${lowerRow}\n        setOutput(result);\n      }\n    `;\n    }\n  }\n});","lineCount":83,"map":[[7,2,19,0,"Object"],[7,8,19,0],[7,9,19,0,"defineProperty"],[7,23,19,0],[7,24,19,0,"exports"],[7,31,19,0],[8,4,19,0,"enumerable"],[8,14,19,0],[9,4,19,0,"get"],[9,7,19,0],[9,18,19,0,"get"],[9,19,19,0],[10,6,19,0],[10,13,19,0,"SlicePackedProgram"],[10,31,19,0],[11,4,19,0],[12,2,19,0],[13,2,17,0],[13,6,17,0,"_packing_util"],[13,19,17,0],[13,22,17,0,"require"],[13,29,17,0],[13,30,17,0,"_dependencyMap"],[13,44,17,0],[14,2,18,0],[14,6,18,0,"_shader_compiler"],[14,22,18,0],[14,25,18,0,"require"],[14,32,18,0],[14,33,18,0,"_dependencyMap"],[14,47,18,0],[15,2,1,0],[16,0,2,0],[17,0,3,0],[18,0,4,0],[19,0,5,0],[20,0,6,0],[21,0,7,0],[22,0,8,0],[23,0,9,0],[24,0,10,0],[25,0,11,0],[26,0,12,0],[27,0,13,0],[28,0,14,0],[29,0,15,0],[30,0,16,0],[32,2,19,7],[32,8,19,13,"SlicePackedProgram"],[32,26,19,31],[32,27,19,32],[33,4,20,4,"constructor"],[33,15,20,15,"constructor"],[33,16,20,16,"destSize"],[33,24,20,24],[33,26,20,26],[34,6,21,8],[34,10,21,12],[34,11,21,13,"variableNames"],[34,24,21,26],[34,27,21,29],[34,28,21,30],[34,36,21,38],[34,37,21,39],[35,6,22,8],[35,10,22,12],[35,11,22,13,"packedInputs"],[35,23,22,25],[35,26,22,28],[35,30,22,32],[36,6,23,8],[36,10,23,12],[36,11,23,13,"packedOutput"],[36,23,23,25],[36,26,23,28],[36,30,23,32],[37,6,24,8],[37,10,24,12],[37,11,24,13,"outputShape"],[37,22,24,24],[37,25,24,27,"destSize"],[37,33,24,35],[38,6,25,8],[38,10,25,12],[38,11,25,13,"rank"],[38,15,25,17],[38,18,25,20,"destSize"],[38,26,25,28],[38,27,25,29,"length"],[38,33,25,35],[39,6,26,8],[39,10,26,12],[39,11,26,13,"customUniforms"],[39,25,26,27],[39,28,26,30],[39,29,26,31],[40,8,26,33,"name"],[40,12,26,37],[40,14,26,39],[40,21,26,46],[41,8,26,48,"arrayIndex"],[41,18,26,58],[41,20,26,60],[41,24,26,64],[41,25,26,65,"rank"],[41,29,26,69],[42,8,26,71,"type"],[42,12,26,75],[42,14,26,77],[43,6,26,83],[43,7,26,84],[43,8,26,85],[44,6,27,8],[44,12,27,14,"dtype"],[44,17,27,19],[44,20,27,22],[44,24,27,22,"getCoordsDataType"],[44,40,27,39],[44,41,27,39,"getCoordsDataType"],[44,58,27,39],[44,60,27,40],[44,64,27,44],[44,65,27,45,"rank"],[44,69,27,49],[44,70,27,50],[45,6,28,8],[45,12,28,14,"coords"],[45,18,28,20],[45,21,28,23],[45,25,28,23,"getChannels"],[45,38,28,34],[45,39,28,34,"getChannels"],[45,50,28,34],[45,52,28,35],[45,60,28,43],[45,62,28,45],[45,66,28,49],[45,67,28,50,"rank"],[45,71,28,54],[45,72,28,55],[46,6,29,8],[46,12,29,14,"sourceLoc"],[46,21,29,23],[46,24,29,26],[46,28,29,26,"getChannels"],[46,41,29,37],[46,42,29,37,"getChannels"],[46,53,29,37],[46,55,29,38],[46,66,29,49],[46,68,29,51],[46,72,29,55],[46,73,29,56,"rank"],[46,77,29,60],[46,78,29,61],[47,6,30,8],[47,12,30,14,"innerDims"],[47,21,30,23],[47,24,30,26],[47,28,30,30],[47,29,30,31,"rank"],[47,33,30,35],[47,38,30,40],[47,39,30,41],[47,42,30,44],[47,53,30,55],[47,56,30,58],[47,64,30,66,"sourceLoc"],[47,73,30,75],[47,74,30,76,"slice"],[47,79,30,81],[47,80,30,82],[47,81,30,83],[47,82,30,84],[47,83,30,85],[47,84,30,86,"join"],[47,88,30,90],[47,89,30,91],[47,90,30,92],[47,93,30,95],[48,6,31,8],[48,12,31,14,"getChannel"],[48,22,31,24],[48,25,31,27],[48,49,31,51,"sourceLoc"],[48,58,31,60],[48,59,31,61,"join"],[48,63,31,65],[48,64,31,66],[48,65,31,67],[48,71,31,73,"innerDims"],[48,80,31,82],[48,83,31,85],[49,6,32,8],[49,12,32,14,"upperRow"],[49,20,32,22],[49,23,32,25],[50,0,33,0],[50,19,33,19,"getChannel"],[50,29,33,29],[51,0,34,0],[51,14,34,14,"coords"],[51,20,34,20],[51,21,34,21],[51,25,34,25],[51,26,34,26,"rank"],[51,30,34,30],[51,33,34,33],[51,34,34,34],[51,35,34,35],[51,41,34,41,"destSize"],[51,49,34,49],[51,50,34,50],[51,54,34,54],[51,55,34,55,"rank"],[51,59,34,59],[51,62,34,62],[51,63,34,63],[51,64,34,64],[52,0,35,0],[52,12,35,12,"sourceLoc"],[52,21,35,21],[52,22,35,22],[52,26,35,26],[52,27,35,27,"rank"],[52,31,35,31],[52,34,35,34],[52,35,35,35],[52,36,35,36],[53,0,36,0],[53,21,36,21,"getChannel"],[53,31,36,31],[54,0,37,0],[54,12,37,12,"sourceLoc"],[54,21,37,21],[54,22,37,22],[54,26,37,26],[54,27,37,27,"rank"],[54,31,37,31],[54,34,37,34],[54,35,37,35],[54,36,37,36],[55,0,38,0],[56,0,39,0],[56,5,39,5],[57,6,40,8],[57,12,40,14,"lowerRow"],[57,20,40,22],[57,23,40,25],[57,27,40,29],[57,28,40,30,"rank"],[57,32,40,34],[57,37,40,39],[57,38,40,40],[57,41,40,43],[57,43,40,45],[57,46,40,48],[58,0,41,0],[58,10,41,10,"coords"],[58,16,41,16],[58,17,41,17],[58,21,41,21],[58,22,41,22,"rank"],[58,26,41,26],[58,29,41,29],[58,30,41,30],[58,31,41,31],[59,0,42,0],[59,14,42,14,"coords"],[59,20,42,20],[59,21,42,21],[59,25,42,25],[59,26,42,26,"rank"],[59,30,42,30],[59,33,42,33],[59,34,42,34],[59,35,42,35],[59,41,42,41,"destSize"],[59,49,42,49],[59,50,42,50],[59,54,42,54],[59,55,42,55,"rank"],[59,59,42,59],[59,62,42,62],[59,63,42,63],[59,64,42,64],[60,0,43,0],[60,12,43,12,"sourceLoc"],[60,21,43,21],[60,22,43,22],[60,26,43,26],[60,27,43,27,"rank"],[60,31,43,31],[60,34,43,34],[60,35,43,35],[60,36,43,36],[61,0,44,0],[61,21,44,21,"getChannel"],[61,31,44,31],[62,0,45,0],[62,16,45,16,"coords"],[62,22,45,22],[62,23,45,23],[62,27,45,27],[62,28,45,28,"rank"],[62,32,45,32],[62,35,45,35],[62,36,45,36],[62,37,45,37],[62,43,45,43,"destSize"],[62,51,45,51],[62,52,45,52],[62,56,45,56],[62,57,45,57,"rank"],[62,61,45,61],[62,64,45,64],[62,65,45,65],[62,66,45,66],[63,0,46,0],[63,14,46,14,"sourceLoc"],[63,23,46,23],[63,24,46,24],[63,28,46,28],[63,29,46,29,"rank"],[63,33,46,33],[63,36,46,36],[63,37,46,37],[63,38,46,38],[64,0,47,0],[64,23,47,23,"getChannel"],[64,33,47,33],[65,0,48,0],[66,0,49,0],[67,0,50,0],[67,5,50,5],[68,6,51,8],[68,12,51,14,"sourceLocSetup"],[68,26,51,28],[68,29,51,31],[68,33,51,35],[68,34,51,36,"rank"],[68,38,51,40],[68,42,51,44],[68,43,51,45],[68,46,52,12],[69,0,53,0],[69,14,53,14,"dtype"],[69,19,53,19],[69,23,53,23,"destSize"],[69,31,53,31],[69,32,53,32,"map"],[69,35,53,35],[69,36,53,36],[69,37,53,37,"_"],[69,38,53,38],[69,40,53,40,"i"],[69,41,53,41],[69,46,53,46],[69,55,53,55,"i"],[69,56,53,56],[69,59,53,59],[69,60,53,60],[69,61,53,61,"join"],[69,65,53,65],[69,66,53,66],[69,67,53,67],[69,71,53,71],[69,74,54,12,"destSize"],[69,82,54,20],[69,83,54,21,"map"],[69,86,54,24],[69,87,54,25],[69,88,54,26,"_"],[69,89,54,27],[69,91,54,29,"i"],[69,92,54,30],[69,97,54,35],[69,100,54,38,"sourceLoc"],[69,109,54,47],[69,110,54,48,"i"],[69,111,54,49],[69,112,54,50],[69,118,54,56,"coords"],[69,124,54,62],[69,125,54,63,"i"],[69,126,54,64],[69,127,54,65],[69,139,54,77,"i"],[69,140,54,78],[69,144,54,82],[69,145,54,83],[69,146,55,17,"join"],[69,150,55,21],[69,151,55,22],[69,155,55,26],[69,156,55,27],[70,6,56,8],[70,10,56,12],[70,11,56,13,"userCode"],[70,19,56,21],[70,22,56,24],[71,0,57,0],[72,0,58,0],[72,10,58,10,"dtype"],[72,15,58,15],[73,0,59,0],[73,10,59,10,"dtype"],[73,15,59,15],[74,0,60,0],[74,10,60,10,"sourceLocSetup"],[74,24,60,24],[75,0,61,0],[76,0,62,0],[76,10,62,10,"upperRow"],[76,18,62,18],[77,0,63,0],[77,10,63,10,"lowerRow"],[77,18,63,18],[78,0,64,0],[79,0,65,0],[80,0,66,0],[80,5,66,5],[81,4,67,4],[82,2,68,0],[83,0,68,1],[83,3]],"functionMap":{"names":["<global>","SlicePackedProgram","SlicePackedProgram#constructor","destSize.map$argument_0"],"mappings":"AAA;OCkB;ICC;oCCiC,uBD;yBCC,yDD;KDa;CDC"},"hasCjsExports":false},"type":"js/module"}]}