{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":65,"index":768}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"./Mean_impl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":769},"end":{"line":18,"column":39,"index":808}}],"key":"V+B9NGdTDIAP3uIHFUWp+dQOGTQ=","exportNames":["*"],"imports":1}},{"name":"./Transpose_impl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":809},"end":{"line":19,"column":67,"index":876}}],"key":"14/1wfkCjW4iZnvkwkO0WFpRQ7E=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"meanConfig\", {\n    enumerable: true,\n    get: function () {\n      return meanConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _Mean_impl = require(_dependencyMap[1], \"./Mean_impl\");\n  var _Transpose_impl = require(_dependencyMap[2], \"./Transpose_impl\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  const meanConfig = {\n    kernelName: _tensorflowTfjsCore.Mean,\n    backendName: 'webgl',\n    kernelFunc: ({\n      inputs,\n      attrs,\n      backend\n    }) => {\n      const {\n        x\n      } = inputs;\n      const {\n        keepDims,\n        axis\n      } = attrs;\n      const webglBackend = backend;\n      const xRank = x.shape.length;\n      const origAxes = _tensorflowTfjsCore.util.parseAxisParam(axis, x.shape);\n      let axes = origAxes;\n      const permutedAxes = _tensorflowTfjsCore.backend_util.getAxesPermutation(axes, xRank);\n      const meanInputIsTransposed = permutedAxes != null;\n      const shouldExecuteOnCPU = webglBackend.shouldExecuteOnCPU([x]);\n      const intermediates = [];\n      let meanInput = x;\n      if (meanInputIsTransposed) {\n        if (shouldExecuteOnCPU) {\n          const xTexData = webglBackend.texData.get(meanInput.dataId);\n          const values = xTexData.values;\n          const newShape = new Array(xRank);\n          for (let i = 0; i < newShape.length; i++) {\n            newShape[i] = x.shape[permutedAxes[i]];\n          }\n          const meanInputValues = (0, _Transpose_impl.transposeImplCPU)(values, x.shape, x.dtype, permutedAxes, newShape);\n          meanInput = webglBackend.makeTensorInfo(newShape, x.dtype);\n          const meanInputData = webglBackend.texData.get(meanInput.dataId);\n          meanInputData.values = meanInputValues;\n        } else {\n          meanInput = (0, _Transpose_impl.transposeImpl)(x, permutedAxes, webglBackend);\n        }\n        intermediates.push(meanInput);\n        axes = _tensorflowTfjsCore.backend_util.getInnerMostAxes(axes.length, xRank);\n      }\n      _tensorflowTfjsCore.backend_util.assertAxesAreInnerMostDims('sum', axes, xRank);\n      const [meanOutShape, reduceShape] = _tensorflowTfjsCore.backend_util.computeOutAndReduceShapes(meanInput.shape, axes);\n      let outShape = meanOutShape;\n      if (keepDims) {\n        // rather than reshape at the end, set the target shape here.\n        outShape = _tensorflowTfjsCore.backend_util.expandShapeToKeepDim(meanOutShape, origAxes);\n      }\n      const out = (0, _Mean_impl.meanImpl)(meanInput, reduceShape, outShape, webglBackend);\n      for (const i of intermediates) {\n        webglBackend.disposeIntermediateTensorInfo(i);\n      }\n      return out;\n    }\n  };\n});","lineCount":89,"map":[[7,2,20,0,"Object"],[7,8,20,0],[7,9,20,0,"defineProperty"],[7,23,20,0],[7,24,20,0,"exports"],[7,31,20,0],[8,4,20,0,"enumerable"],[8,14,20,0],[9,4,20,0,"get"],[9,7,20,0],[9,18,20,0,"get"],[9,19,20,0],[10,6,20,0],[10,13,20,0,"meanConfig"],[10,23,20,0],[11,4,20,0],[12,2,20,0],[13,2,17,0],[13,6,17,0,"_tensorflowTfjsCore"],[13,25,17,0],[13,28,17,0,"require"],[13,35,17,0],[13,36,17,0,"_dependencyMap"],[13,50,17,0],[14,2,18,0],[14,6,18,0,"_Mean_impl"],[14,16,18,0],[14,19,18,0,"require"],[14,26,18,0],[14,27,18,0,"_dependencyMap"],[14,41,18,0],[15,2,19,0],[15,6,19,0,"_Transpose_impl"],[15,21,19,0],[15,24,19,0,"require"],[15,31,19,0],[15,32,19,0,"_dependencyMap"],[15,46,19,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[25,0,10,0],[26,0,11,0],[27,0,12,0],[28,0,13,0],[29,0,14,0],[30,0,15,0],[31,0,16,0],[33,2,20,7],[33,8,20,13,"meanConfig"],[33,18,20,23],[33,21,20,26],[34,4,21,4,"kernelName"],[34,14,21,14],[34,16,21,16,"Mean"],[34,35,21,20],[34,36,21,20,"Mean"],[34,40,21,20],[35,4,22,4,"backendName"],[35,15,22,15],[35,17,22,17],[35,24,22,24],[36,4,23,4,"kernelFunc"],[36,14,23,14],[36,16,23,16,"kernelFunc"],[36,17,23,17],[37,6,23,19,"inputs"],[37,12,23,25],[38,6,23,27,"attrs"],[38,11,23,32],[39,6,23,34,"backend"],[40,4,23,42],[40,5,23,43],[40,10,23,48],[41,6,24,8],[41,12,24,14],[42,8,24,16,"x"],[43,6,24,18],[43,7,24,19],[43,10,24,22,"inputs"],[43,16,24,28],[44,6,25,8],[44,12,25,14],[45,8,25,16,"keepDims"],[45,16,25,24],[46,8,25,26,"axis"],[47,6,25,31],[47,7,25,32],[47,10,25,35,"attrs"],[47,15,25,40],[48,6,26,8],[48,12,26,14,"webglBackend"],[48,24,26,26],[48,27,26,29,"backend"],[48,34,26,36],[49,6,27,8],[49,12,27,14,"xRank"],[49,17,27,19],[49,20,27,22,"x"],[49,21,27,23],[49,22,27,24,"shape"],[49,27,27,29],[49,28,27,30,"length"],[49,34,27,36],[50,6,28,8],[50,12,28,14,"origAxes"],[50,20,28,22],[50,23,28,25,"util"],[50,42,28,29],[50,43,28,29,"util"],[50,47,28,29],[50,48,28,30,"parseAxisParam"],[50,62,28,44],[50,63,28,45,"axis"],[50,67,28,49],[50,69,28,51,"x"],[50,70,28,52],[50,71,28,53,"shape"],[50,76,28,58],[50,77,28,59],[51,6,29,8],[51,10,29,12,"axes"],[51,14,29,16],[51,17,29,19,"origAxes"],[51,25,29,27],[52,6,30,8],[52,12,30,14,"permutedAxes"],[52,24,30,26],[52,27,30,29,"backend_util"],[52,46,30,41],[52,47,30,41,"backend_util"],[52,59,30,41],[52,60,30,42,"getAxesPermutation"],[52,78,30,60],[52,79,30,61,"axes"],[52,83,30,65],[52,85,30,67,"xRank"],[52,90,30,72],[52,91,30,73],[53,6,31,8],[53,12,31,14,"meanInputIsTransposed"],[53,33,31,35],[53,36,31,38,"permutedAxes"],[53,48,31,50],[53,52,31,54],[53,56,31,58],[54,6,32,8],[54,12,32,14,"shouldExecuteOnCPU"],[54,30,32,32],[54,33,32,35,"webglBackend"],[54,45,32,47],[54,46,32,48,"shouldExecuteOnCPU"],[54,64,32,66],[54,65,32,67],[54,66,32,68,"x"],[54,67,32,69],[54,68,32,70],[54,69,32,71],[55,6,33,8],[55,12,33,14,"intermediates"],[55,25,33,27],[55,28,33,30],[55,30,33,32],[56,6,34,8],[56,10,34,12,"meanInput"],[56,19,34,21],[56,22,34,24,"x"],[56,23,34,25],[57,6,35,8],[57,10,35,12,"meanInputIsTransposed"],[57,31,35,33],[57,33,35,35],[58,8,36,12],[58,12,36,16,"shouldExecuteOnCPU"],[58,30,36,34],[58,32,36,36],[59,10,37,16],[59,16,37,22,"xTexData"],[59,24,37,30],[59,27,37,33,"webglBackend"],[59,39,37,45],[59,40,37,46,"texData"],[59,47,37,53],[59,48,37,54,"get"],[59,51,37,57],[59,52,37,58,"meanInput"],[59,61,37,67],[59,62,37,68,"dataId"],[59,68,37,74],[59,69,37,75],[60,10,38,16],[60,16,38,22,"values"],[60,22,38,28],[60,25,38,31,"xTexData"],[60,33,38,39],[60,34,38,40,"values"],[60,40,38,46],[61,10,39,16],[61,16,39,22,"newShape"],[61,24,39,30],[61,27,39,33],[61,31,39,37,"Array"],[61,36,39,42],[61,37,39,43,"xRank"],[61,42,39,48],[61,43,39,49],[62,10,40,16],[62,15,40,21],[62,19,40,25,"i"],[62,20,40,26],[62,23,40,29],[62,24,40,30],[62,26,40,32,"i"],[62,27,40,33],[62,30,40,36,"newShape"],[62,38,40,44],[62,39,40,45,"length"],[62,45,40,51],[62,47,40,53,"i"],[62,48,40,54],[62,50,40,56],[62,52,40,58],[63,12,41,20,"newShape"],[63,20,41,28],[63,21,41,29,"i"],[63,22,41,30],[63,23,41,31],[63,26,41,34,"x"],[63,27,41,35],[63,28,41,36,"shape"],[63,33,41,41],[63,34,41,42,"permutedAxes"],[63,46,41,54],[63,47,41,55,"i"],[63,48,41,56],[63,49,41,57],[63,50,41,58],[64,10,42,16],[65,10,43,16],[65,16,43,22,"meanInputValues"],[65,31,43,37],[65,34,43,40],[65,38,43,40,"transposeImplCPU"],[65,53,43,56],[65,54,43,56,"transposeImplCPU"],[65,70,43,56],[65,72,43,57,"values"],[65,78,43,63],[65,80,43,65,"x"],[65,81,43,66],[65,82,43,67,"shape"],[65,87,43,72],[65,89,43,74,"x"],[65,90,43,75],[65,91,43,76,"dtype"],[65,96,43,81],[65,98,43,83,"permutedAxes"],[65,110,43,95],[65,112,43,97,"newShape"],[65,120,43,105],[65,121,43,106],[66,10,44,16,"meanInput"],[66,19,44,25],[66,22,44,28,"webglBackend"],[66,34,44,40],[66,35,44,41,"makeTensorInfo"],[66,49,44,55],[66,50,44,56,"newShape"],[66,58,44,64],[66,60,44,66,"x"],[66,61,44,67],[66,62,44,68,"dtype"],[66,67,44,73],[66,68,44,74],[67,10,45,16],[67,16,45,22,"meanInputData"],[67,29,45,35],[67,32,45,38,"webglBackend"],[67,44,45,50],[67,45,45,51,"texData"],[67,52,45,58],[67,53,45,59,"get"],[67,56,45,62],[67,57,45,63,"meanInput"],[67,66,45,72],[67,67,45,73,"dataId"],[67,73,45,79],[67,74,45,80],[68,10,46,16,"meanInputData"],[68,23,46,29],[68,24,46,30,"values"],[68,30,46,36],[68,33,46,39,"meanInputValues"],[68,48,46,54],[69,8,47,12],[69,9,47,13],[69,15,48,17],[70,10,49,16,"meanInput"],[70,19,49,25],[70,22,49,28],[70,26,49,28,"transposeImpl"],[70,41,49,41],[70,42,49,41,"transposeImpl"],[70,55,49,41],[70,57,49,42,"x"],[70,58,49,43],[70,60,49,45,"permutedAxes"],[70,72,49,57],[70,74,49,59,"webglBackend"],[70,86,49,71],[70,87,49,72],[71,8,50,12],[72,8,51,12,"intermediates"],[72,21,51,25],[72,22,51,26,"push"],[72,26,51,30],[72,27,51,31,"meanInput"],[72,36,51,40],[72,37,51,41],[73,8,52,12,"axes"],[73,12,52,16],[73,15,52,19,"backend_util"],[73,34,52,31],[73,35,52,31,"backend_util"],[73,47,52,31],[73,48,52,32,"getInnerMostAxes"],[73,64,52,48],[73,65,52,49,"axes"],[73,69,52,53],[73,70,52,54,"length"],[73,76,52,60],[73,78,52,62,"xRank"],[73,83,52,67],[73,84,52,68],[74,6,53,8],[75,6,54,8,"backend_util"],[75,25,54,20],[75,26,54,20,"backend_util"],[75,38,54,20],[75,39,54,21,"assertAxesAreInnerMostDims"],[75,65,54,47],[75,66,54,48],[75,71,54,53],[75,73,54,55,"axes"],[75,77,54,59],[75,79,54,61,"xRank"],[75,84,54,66],[75,85,54,67],[76,6,55,8],[76,12,55,14],[76,13,55,15,"meanOutShape"],[76,25,55,27],[76,27,55,29,"reduceShape"],[76,38,55,40],[76,39,55,41],[76,42,55,44,"backend_util"],[76,61,55,56],[76,62,55,56,"backend_util"],[76,74,55,56],[76,75,55,57,"computeOutAndReduceShapes"],[76,100,55,82],[76,101,55,83,"meanInput"],[76,110,55,92],[76,111,55,93,"shape"],[76,116,55,98],[76,118,55,100,"axes"],[76,122,55,104],[76,123,55,105],[77,6,56,8],[77,10,56,12,"outShape"],[77,18,56,20],[77,21,56,23,"meanOutShape"],[77,33,56,35],[78,6,57,8],[78,10,57,12,"keepDims"],[78,18,57,20],[78,20,57,22],[79,8,58,12],[80,8,59,12,"outShape"],[80,16,59,20],[80,19,59,23,"backend_util"],[80,38,59,35],[80,39,59,35,"backend_util"],[80,51,59,35],[80,52,59,36,"expandShapeToKeepDim"],[80,72,59,56],[80,73,59,57,"meanOutShape"],[80,85,59,69],[80,87,59,71,"origAxes"],[80,95,59,79],[80,96,59,80],[81,6,60,8],[82,6,61,8],[82,12,61,14,"out"],[82,15,61,17],[82,18,61,20],[82,22,61,20,"meanImpl"],[82,32,61,28],[82,33,61,28,"meanImpl"],[82,41,61,28],[82,43,61,29,"meanInput"],[82,52,61,38],[82,54,61,40,"reduceShape"],[82,65,61,51],[82,67,61,53,"outShape"],[82,75,61,61],[82,77,61,63,"webglBackend"],[82,89,61,75],[82,90,61,76],[83,6,62,8],[83,11,62,13],[83,17,62,19,"i"],[83,18,62,20],[83,22,62,24,"intermediates"],[83,35,62,37],[83,37,62,39],[84,8,63,12,"webglBackend"],[84,20,63,24],[84,21,63,25,"disposeIntermediateTensorInfo"],[84,50,63,54],[84,51,63,55,"i"],[84,52,63,56],[84,53,63,57],[85,6,64,8],[86,6,65,8],[86,13,65,15,"out"],[86,16,65,18],[87,4,66,4],[88,2,67,0],[88,3,67,1],[89,0,67,2],[89,3]],"functionMap":{"names":["<global>","meanConfig.kernelFunc"],"mappings":"AAA;gBCsB;KD2C"},"hasCjsExports":false},"type":"js/module"}]}