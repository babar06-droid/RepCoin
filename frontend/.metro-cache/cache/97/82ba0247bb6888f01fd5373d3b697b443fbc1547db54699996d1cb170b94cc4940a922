{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"ResizeNearestNeighborPackedProgram\", {\n    enumerable: true,\n    get: function () {\n      return ResizeNearestNeighborPackedProgram;\n    }\n  });\n  /**\n   * @license\n   * Copyright 2019 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n  class ResizeNearestNeighborPackedProgram {\n    constructor(inputShape, newHeight, newWidth, alignCorners, halfPixelCenters) {\n      this.variableNames = ['A'];\n      this.packedInputs = true;\n      this.packedOutput = true;\n      this.outputShape = [];\n      const [batch, oldHeight, oldWidth, depth] = inputShape;\n      this.outputShape = [batch, newHeight, newWidth, depth];\n      const effectiveInSize = [alignCorners && newHeight > 1 ? oldHeight - 1 : oldHeight, alignCorners && newWidth > 1 ? oldWidth - 1 : oldWidth];\n      const effectiveOutSize = [alignCorners && newHeight > 1 ? newHeight - 1 : newHeight, alignCorners && newWidth > 1 ? newWidth - 1 : newWidth];\n      // When align corners is false, we rounds the value with floor.\n      const roundBase = alignCorners ? '0.5' : '0.0';\n      let sourceFracIndexRC;\n      if (halfPixelCenters) {\n        sourceFracIndexRC = `max((vec3(yRC) + vec3(0.5)) * ` + `effectiveInputOverOutputRatioRC, vec3(0.0))`;\n      } else {\n        sourceFracIndexRC = `vec3(yRC) * effectiveInputOverOutputRatioRC`;\n      }\n      this.userCode = `\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${effectiveInSize[0] / effectiveOutSize[0]},\n          ${effectiveInSize[1] / effectiveOutSize[1]},\n          ${effectiveInSize[1] / effectiveOutSize[1]});\n      const vec3 inputShapeRC = vec3(${oldHeight}.0, ${oldWidth}.0,\n                                     ${oldWidth}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${sourceFracIndexRC};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${roundBase})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${depth - 1};\n        bool hasNextRow = coords.z < ${newWidth - 1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `;\n    }\n  }\n});","lineCount":91,"map":[[7,2,17,0,"Object"],[7,8,17,0],[7,9,17,0,"defineProperty"],[7,23,17,0],[7,24,17,0,"exports"],[7,31,17,0],[8,4,17,0,"enumerable"],[8,14,17,0],[9,4,17,0,"get"],[9,7,17,0],[9,18,17,0,"get"],[9,19,17,0],[10,6,17,0],[10,13,17,0,"ResizeNearestNeighborPackedProgram"],[10,47,17,0],[11,4,17,0],[12,2,17,0],[13,2,1,0],[14,0,2,0],[15,0,3,0],[16,0,4,0],[17,0,5,0],[18,0,6,0],[19,0,7,0],[20,0,8,0],[21,0,9,0],[22,0,10,0],[23,0,11,0],[24,0,12,0],[25,0,13,0],[26,0,14,0],[27,0,15,0],[28,0,16,0],[29,2,17,7],[29,8,17,13,"ResizeNearestNeighborPackedProgram"],[29,42,17,47],[29,43,17,48],[30,4,18,4,"constructor"],[30,15,18,15,"constructor"],[30,16,18,16,"inputShape"],[30,26,18,26],[30,28,18,28,"newHeight"],[30,37,18,37],[30,39,18,39,"newWidth"],[30,47,18,47],[30,49,18,49,"alignCorners"],[30,61,18,61],[30,63,18,63,"halfPixelCenters"],[30,79,18,79],[30,81,18,81],[31,6,19,8],[31,10,19,12],[31,11,19,13,"variableNames"],[31,24,19,26],[31,27,19,29],[31,28,19,30],[31,31,19,33],[31,32,19,34],[32,6,20,8],[32,10,20,12],[32,11,20,13,"packedInputs"],[32,23,20,25],[32,26,20,28],[32,30,20,32],[33,6,21,8],[33,10,21,12],[33,11,21,13,"packedOutput"],[33,23,21,25],[33,26,21,28],[33,30,21,32],[34,6,22,8],[34,10,22,12],[34,11,22,13,"outputShape"],[34,22,22,24],[34,25,22,27],[34,27,22,29],[35,6,23,8],[35,12,23,14],[35,13,23,15,"batch"],[35,18,23,20],[35,20,23,22,"oldHeight"],[35,29,23,31],[35,31,23,33,"oldWidth"],[35,39,23,41],[35,41,23,43,"depth"],[35,46,23,48],[35,47,23,49],[35,50,23,52,"inputShape"],[35,60,23,62],[36,6,24,8],[36,10,24,12],[36,11,24,13,"outputShape"],[36,22,24,24],[36,25,24,27],[36,26,24,28,"batch"],[36,31,24,33],[36,33,24,35,"newHeight"],[36,42,24,44],[36,44,24,46,"newWidth"],[36,52,24,54],[36,54,24,56,"depth"],[36,59,24,61],[36,60,24,62],[37,6,25,8],[37,12,25,14,"effectiveInSize"],[37,27,25,29],[37,30,25,32],[37,31,26,13,"alignCorners"],[37,43,26,25],[37,47,26,29,"newHeight"],[37,56,26,38],[37,59,26,41],[37,60,26,42],[37,63,26,46,"oldHeight"],[37,72,26,55],[37,75,26,58],[37,76,26,59],[37,79,26,62,"oldHeight"],[37,88,26,71],[37,90,27,13,"alignCorners"],[37,102,27,25],[37,106,27,29,"newWidth"],[37,114,27,37],[37,117,27,40],[37,118,27,41],[37,121,27,45,"oldWidth"],[37,129,27,53],[37,132,27,56],[37,133,27,57],[37,136,27,60,"oldWidth"],[37,144,27,68],[37,145,28,9],[38,6,29,8],[38,12,29,14,"effectiveOutSize"],[38,28,29,30],[38,31,29,33],[38,32,30,13,"alignCorners"],[38,44,30,25],[38,48,30,29,"newHeight"],[38,57,30,38],[38,60,30,41],[38,61,30,42],[38,64,30,46,"newHeight"],[38,73,30,55],[38,76,30,58],[38,77,30,59],[38,80,30,62,"newHeight"],[38,89,30,71],[38,91,31,13,"alignCorners"],[38,103,31,25],[38,107,31,29,"newWidth"],[38,115,31,37],[38,118,31,40],[38,119,31,41],[38,122,31,45,"newWidth"],[38,130,31,53],[38,133,31,56],[38,134,31,57],[38,137,31,60,"newWidth"],[38,145,31,68],[38,146,32,9],[39,6,33,8],[40,6,34,8],[40,12,34,14,"roundBase"],[40,21,34,23],[40,24,34,26,"alignCorners"],[40,36,34,38],[40,39,34,41],[40,44,34,46],[40,47,34,49],[40,52,34,54],[41,6,35,8],[41,10,35,12,"sourceFracIndexRC"],[41,27,35,29],[42,6,36,8],[42,10,36,12,"halfPixelCenters"],[42,26,36,28],[42,28,36,30],[43,8,37,12,"sourceFracIndexRC"],[43,25,37,29],[43,28,37,32],[43,60,37,64],[43,63,38,16],[43,108,38,61],[44,6,39,8],[44,7,39,9],[44,13,40,13],[45,8,41,12,"sourceFracIndexRC"],[45,25,41,29],[45,28,41,32],[45,73,41,77],[46,6,42,8],[47,6,43,8],[47,10,43,12],[47,11,43,13,"userCode"],[47,19,43,21],[47,22,43,24],[48,0,44,0],[49,0,45,0],[49,12,45,12,"effectiveInSize"],[49,27,45,27],[49,28,45,28],[49,29,45,29],[49,30,45,30],[49,33,45,33,"effectiveOutSize"],[49,49,45,49],[49,50,45,50],[49,51,45,51],[49,52,45,52],[50,0,46,0],[50,12,46,12,"effectiveInSize"],[50,27,46,27],[50,28,46,28],[50,29,46,29],[50,30,46,30],[50,33,46,33,"effectiveOutSize"],[50,49,46,49],[50,50,46,50],[50,51,46,51],[50,52,46,52],[51,0,47,0],[51,12,47,12,"effectiveInSize"],[51,27,47,27],[51,28,47,28],[51,29,47,29],[51,30,47,30],[51,33,47,33,"effectiveOutSize"],[51,49,47,49],[51,50,47,50],[51,51,47,51],[51,52,47,52],[52,0,48,0],[52,39,48,39,"oldHeight"],[52,48,48,48],[52,55,48,55,"oldWidth"],[52,63,48,63],[53,0,49,0],[53,39,49,39,"oldWidth"],[53,47,49,47],[54,0,50,0],[55,0,51,0],[56,0,52,0],[57,0,53,0],[58,0,54,0],[59,0,55,0],[60,0,56,0],[61,0,57,0],[62,0,58,0],[63,0,59,0],[64,0,60,0],[65,0,61,0],[66,0,62,0],[67,0,63,0],[67,35,63,35,"sourceFracIndexRC"],[67,52,63,52],[68,0,64,0],[69,0,65,0],[70,0,66,0],[71,0,67,0],[71,62,67,62,"roundBase"],[71,71,67,71],[72,0,68,0],[73,0,69,0],[74,0,70,0],[74,32,70,32,"depth"],[74,37,70,37],[74,40,70,40],[74,41,70,41],[75,0,71,0],[75,39,71,39,"newWidth"],[75,47,71,47],[75,50,71,50],[75,51,71,51],[76,0,72,0],[77,0,73,0],[78,0,74,0],[79,0,75,0],[80,0,76,0],[81,0,77,0],[82,0,78,0],[83,0,79,0],[84,0,80,0],[85,0,81,0],[86,0,82,0],[87,0,83,0],[88,0,84,0],[88,5,84,5],[89,4,85,4],[90,2,86,0],[91,0,86,1],[91,3]],"functionMap":{"names":["<global>","ResizeNearestNeighborPackedProgram","ResizeNearestNeighborPackedProgram#constructor"],"mappings":"AAA;OCgB;ICC;KDmE;CDC"},"hasCjsExports":false},"type":"js/module"}]}