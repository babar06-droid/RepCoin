{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":45,"index":748}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"MeanProgram\", {\n    enumerable: true,\n    get: function () {\n      return MeanProgram;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  class MeanProgram {\n    constructor(reduceInfo, divisor) {\n      this.variableNames = ['x'];\n      const {\n        windowSize,\n        batchSize,\n        inSize,\n        outSize\n      } = reduceInfo;\n      this.outputShape = [batchSize, outSize];\n      const windowSizeNearestVec4 = Math.floor(windowSize / 4) * 4;\n      const windowSizeVec4Remainder = windowSize % 4;\n      let updateSnippet = `sumValue += dot(values, ones);`;\n      if (divisor != null) {\n        const denominator = 1 / divisor;\n        updateSnippet = `sumValue += dot(values * ${_tensorflowTfjsCore.util.isInt(denominator) ? denominator.toPrecision(2) : denominator}, ones);`;\n      }\n      let checkOutOfBounds = '';\n      if (inSize % windowSize > 0) {\n        checkOutOfBounds = `\n        if (inIdx < 0 || inIdx >= ${inSize}) {\n          return 0.0;\n        }\n      `;\n      }\n      this.userCode = `\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${checkOutOfBounds}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${windowSize};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${windowSizeNearestVec4}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${updateSnippet}\n        }\n\n        int inIdx = inOffset + ${windowSizeNearestVec4};\n        if (${windowSizeVec4Remainder === 1}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${updateSnippet}\n        } else if (${windowSizeVec4Remainder === 2}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${updateSnippet}\n        } else if (${windowSizeVec4Remainder === 3}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${updateSnippet}\n        }\n        setOutput(sumValue);\n      }\n    `;\n    }\n  }\n});","lineCount":108,"map":[[7,2,18,0,"Object"],[7,8,18,0],[7,9,18,0,"defineProperty"],[7,23,18,0],[7,24,18,0,"exports"],[7,31,18,0],[8,4,18,0,"enumerable"],[8,14,18,0],[9,4,18,0,"get"],[9,7,18,0],[9,18,18,0,"get"],[9,19,18,0],[10,6,18,0],[10,13,18,0,"MeanProgram"],[10,24,18,0],[11,4,18,0],[12,2,18,0],[13,2,17,0],[13,6,17,0,"_tensorflowTfjsCore"],[13,25,17,0],[13,28,17,0,"require"],[13,35,17,0],[13,36,17,0,"_dependencyMap"],[13,50,17,0],[14,2,1,0],[15,0,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[20,0,7,0],[21,0,8,0],[22,0,9,0],[23,0,10,0],[24,0,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[31,2,18,7],[31,8,18,13,"MeanProgram"],[31,19,18,24],[31,20,18,25],[32,4,19,4,"constructor"],[32,15,19,15,"constructor"],[32,16,19,16,"reduceInfo"],[32,26,19,26],[32,28,19,28,"divisor"],[32,35,19,35],[32,37,19,37],[33,6,20,8],[33,10,20,12],[33,11,20,13,"variableNames"],[33,24,20,26],[33,27,20,29],[33,28,20,30],[33,31,20,33],[33,32,20,34],[34,6,21,8],[34,12,21,14],[35,8,21,16,"windowSize"],[35,18,21,26],[36,8,21,28,"batchSize"],[36,17,21,37],[37,8,21,39,"inSize"],[37,14,21,45],[38,8,21,47,"outSize"],[39,6,21,55],[39,7,21,56],[39,10,21,59,"reduceInfo"],[39,20,21,69],[40,6,22,8],[40,10,22,12],[40,11,22,13,"outputShape"],[40,22,22,24],[40,25,22,27],[40,26,22,28,"batchSize"],[40,35,22,37],[40,37,22,39,"outSize"],[40,44,22,46],[40,45,22,47],[41,6,23,8],[41,12,23,14,"windowSizeNearestVec4"],[41,33,23,35],[41,36,23,38,"Math"],[41,40,23,42],[41,41,23,43,"floor"],[41,46,23,48],[41,47,23,49,"windowSize"],[41,57,23,59],[41,60,23,62],[41,61,23,63],[41,62,23,64],[41,65,23,67],[41,66,23,68],[42,6,24,8],[42,12,24,14,"windowSizeVec4Remainder"],[42,35,24,37],[42,38,24,40,"windowSize"],[42,48,24,50],[42,51,24,53],[42,52,24,54],[43,6,25,8],[43,10,25,12,"updateSnippet"],[43,23,25,25],[43,26,25,28],[43,58,25,60],[44,6,26,8],[44,10,26,12,"divisor"],[44,17,26,19],[44,21,26,23],[44,25,26,27],[44,27,26,29],[45,8,27,12],[45,14,27,18,"denominator"],[45,25,27,29],[45,28,27,32],[45,29,27,33],[45,32,27,36,"divisor"],[45,39,27,43],[46,8,28,12,"updateSnippet"],[46,21,28,25],[46,24,28,28],[46,52,28,56,"util"],[46,71,28,60],[46,72,28,60,"util"],[46,76,28,60],[46,77,28,61,"isInt"],[46,82,28,66],[46,83,28,67,"denominator"],[46,94,28,78],[46,95,28,79],[46,98,28,82,"denominator"],[46,109,28,93],[46,110,28,94,"toPrecision"],[46,121,28,105],[46,122,28,106],[46,123,28,107],[46,124,28,108],[46,127,29,16,"denominator"],[46,138,29,27],[46,148,29,37],[47,6,30,8],[48,6,31,8],[48,10,31,12,"checkOutOfBounds"],[48,26,31,28],[48,29,31,31],[48,31,31,33],[49,6,32,8],[49,10,32,12,"inSize"],[49,16,32,18],[49,19,32,21,"windowSize"],[49,29,32,31],[49,32,32,34],[49,33,32,35],[49,35,32,37],[50,8,33,12,"checkOutOfBounds"],[50,24,33,28],[50,27,33,31],[51,0,34,0],[51,36,34,36,"inSize"],[51,42,34,42],[52,0,35,0],[53,0,36,0],[54,0,37,0],[54,7,37,7],[55,6,38,8],[56,6,39,8],[56,10,39,12],[56,11,39,13,"userCode"],[56,19,39,21],[56,22,39,24],[57,0,40,0],[58,0,41,0],[59,0,42,0],[60,0,43,0],[60,10,43,10,"checkOutOfBounds"],[60,26,43,26],[61,0,44,0],[62,0,45,0],[63,0,46,0],[64,0,47,0],[65,0,48,0],[66,0,49,0],[67,0,50,0],[68,0,51,0],[68,34,51,34,"windowSize"],[68,44,51,44],[69,0,52,0],[70,0,53,0],[71,0,54,0],[72,0,55,0],[72,30,55,30,"windowSizeNearestVec4"],[72,51,55,51],[73,0,56,0],[74,0,57,0],[75,0,58,0],[76,0,59,0],[77,0,60,0],[78,0,61,0],[79,0,62,0],[80,0,63,0],[81,0,64,0],[81,12,64,12,"updateSnippet"],[81,25,64,25],[82,0,65,0],[83,0,66,0],[84,0,67,0],[84,33,67,33,"windowSizeNearestVec4"],[84,54,67,54],[85,0,68,0],[85,14,68,14,"windowSizeVec4Remainder"],[85,37,68,37],[85,42,68,42],[85,43,68,43],[86,0,69,0],[87,0,70,0],[88,0,71,0],[88,12,71,12,"updateSnippet"],[88,25,71,25],[89,0,72,0],[89,21,72,21,"windowSizeVec4Remainder"],[89,44,72,44],[89,49,72,49],[89,50,72,50],[90,0,73,0],[91,0,74,0],[92,0,75,0],[93,0,76,0],[94,0,77,0],[94,12,77,12,"updateSnippet"],[94,25,77,25],[95,0,78,0],[95,21,78,21,"windowSizeVec4Remainder"],[95,44,78,44],[95,49,78,49],[95,50,78,50],[96,0,79,0],[97,0,80,0],[98,0,81,0],[99,0,82,0],[100,0,83,0],[101,0,84,0],[101,12,84,12,"updateSnippet"],[101,25,84,25],[102,0,85,0],[103,0,86,0],[104,0,87,0],[105,0,88,0],[105,5,88,5],[106,4,89,4],[107,2,90,0],[108,0,90,1],[108,3]],"functionMap":{"names":["<global>","MeanProgram","MeanProgram#constructor"],"mappings":"AAA;OCiB;ICC;KDsE;CDC"},"hasCjsExports":false},"type":"js/module"}]}