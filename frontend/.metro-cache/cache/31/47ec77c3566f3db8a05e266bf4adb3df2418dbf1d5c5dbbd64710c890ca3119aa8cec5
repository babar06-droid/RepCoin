{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.getReshaped = getReshaped;\n  exports.getPermuted = getPermuted;\n  exports.getReshapedPermuted = getReshapedPermuted;\n  exports.getSliceBeginCoords = getSliceBeginCoords;\n  exports.getSliceSize = getSliceSize;\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n  /**\n   * Gets the new shape of the input Tensor after it's been reshaped\n   * to:\n   * [blockShape[0], ..., blockShape[M-1], batch / prod(blockShape),\n   * inputShape[1], ..., inputShape[N-1]]\n   *\n   * See step 1: https://www.tensorflow.org/api_docs/python/tf/batch_to_space_nd\n   */\n  function getReshaped(inputShape, blockShape, prod, batchToSpace = true) {\n    let reshaped = [];\n    if (batchToSpace) {\n      reshaped = reshaped.concat(blockShape.slice(0));\n      reshaped.push(inputShape[0] / prod);\n      reshaped = reshaped.concat(inputShape.slice(1));\n    } else {\n      reshaped = reshaped.concat(inputShape[0]);\n      const spatialLength = blockShape.length;\n      for (let i = 0; i < spatialLength; ++i) {\n        reshaped = reshaped.concat([inputShape[i + 1] / blockShape[i], blockShape[i]]);\n      }\n      reshaped = reshaped.concat(inputShape.slice(spatialLength + 1));\n    }\n    return reshaped;\n  }\n  /**\n   * Gets the permutation that will transpose the dimensions of the\n   * reshaped tensor to shape:\n   *\n   * [batch / prod(block_shape),inputShape[1], blockShape[0], ...,\n   * inputShape[M], blockShape[M-1],inputShape[M+1], ..., inputShape[N-1]]\n   *\n   * see step 2: https://www.tensorflow.org/api_docs/python/tf/batch_to_space_nd\n   */\n  function getPermuted(reshapedRank, blockShapeRank, batchToSpace = true) {\n    const permuted = [];\n    if (batchToSpace) {\n      permuted.push(blockShapeRank);\n      for (let i = blockShapeRank + 1; i < reshapedRank; ++i) {\n        if (i <= 2 * blockShapeRank) {\n          permuted.push(i);\n          permuted.push(i - (blockShapeRank + 1));\n        } else {\n          permuted.push(i);\n        }\n      }\n    } else {\n      const permutedBeforeBatch = [];\n      const permutedAfterBatch = [];\n      for (let i = 1; i < reshapedRank; ++i) {\n        if (i >= blockShapeRank * 2 + 1 || i % 2 === 1) {\n          permutedAfterBatch.push(i);\n        } else {\n          permutedBeforeBatch.push(i);\n        }\n      }\n      permuted.push(...permutedBeforeBatch);\n      permuted.push(0);\n      permuted.push(...permutedAfterBatch);\n    }\n    return permuted;\n  }\n  /**\n   * Gets the shape of the reshaped and permuted input Tensor before any cropping\n   * is applied.  The new shape will be:\n   *\n   * [batch / prod(blockShape),inputShape[1] * blockShape[0], ...,\n   * inputShape[M] * blockShape[M-1],inputShape[M+1], ..., inputShape[N-1]]\n   *\n   * See step 3: https://www.tensorflow.org/api_docs/python/tf/batch_to_space_nd\n   */\n  function getReshapedPermuted(inputShape, blockShape, prod, batchToSpace = true) {\n    const reshapedPermuted = [];\n    if (batchToSpace) {\n      reshapedPermuted.push(inputShape[0] / prod);\n    } else {\n      reshapedPermuted.push(inputShape[0] * prod);\n    }\n    for (let i = 1; i < inputShape.length; ++i) {\n      if (i <= blockShape.length) {\n        if (batchToSpace) {\n          reshapedPermuted.push(blockShape[i - 1] * inputShape[i]);\n        } else {\n          reshapedPermuted.push(inputShape[i] / blockShape[i - 1]);\n        }\n      } else {\n        reshapedPermuted.push(inputShape[i]);\n      }\n    }\n    return reshapedPermuted;\n  }\n  /**\n   * Converts the crops argument into the beginning coordinates of a slice\n   * operation.\n   */\n  function getSliceBeginCoords(crops, blockShape) {\n    const sliceBeginCoords = [0];\n    for (let i = 0; i < blockShape; ++i) {\n      sliceBeginCoords.push(crops[i][0]);\n    }\n    return sliceBeginCoords;\n  }\n  /**\n   * Converts the crops argument into the size of a slice operation.  When\n   * combined with getSliceBeginCoords this function allows the reshaped and\n   * permuted Tensor to be cropped to its final output shape of:\n   *\n   * inputShape[1] * blockShape[0] - crops[0,0] - crops[0,1], ...,\n   * inputShape[M] * blockShape[M-1] -crops[M-1,0] -\n   * crops[M-1,1],inputShape[M+1], ..., inputShape[N-1]]\n   *\n   * See step 4: https://www.tensorflow.org/api_docs/python/tf/batch_to_space_nd\n   */\n  function getSliceSize(uncroppedShape, crops, blockShape) {\n    const sliceSize = uncroppedShape.slice(0, 1);\n    for (let i = 0; i < blockShape; ++i) {\n      sliceSize.push(uncroppedShape[i + 1] - crops[i][0] - crops[i][1]);\n    }\n    return sliceSize;\n  }\n});","lineCount":147,"map":[[7,2,25,0,"exports"],[7,9,25,0],[7,10,25,0,"getReshaped"],[7,21,25,0],[7,24,25,0,"getReshaped"],[7,35,25,0],[8,2,52,0,"exports"],[8,9,52,0],[8,10,52,0,"getPermuted"],[8,21,52,0],[8,24,52,0,"getPermuted"],[8,35,52,0],[9,2,92,0,"exports"],[9,9,92,0],[9,10,92,0,"getReshapedPermuted"],[9,29,92,0],[9,32,92,0,"getReshapedPermuted"],[9,51,92,0],[10,2,119,0,"exports"],[10,9,119,0],[10,10,119,0,"getSliceBeginCoords"],[10,29,119,0],[10,32,119,0,"getSliceBeginCoords"],[10,51,119,0],[11,2,137,0,"exports"],[11,9,137,0],[11,10,137,0,"getSliceSize"],[11,22,137,0],[11,25,137,0,"getSliceSize"],[11,37,137,0],[12,2,1,0],[13,0,2,0],[14,0,3,0],[15,0,4,0],[16,0,5,0],[17,0,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,0,15,0],[27,0,16,0],[28,2,17,0],[29,0,18,0],[30,0,19,0],[31,0,20,0],[32,0,21,0],[33,0,22,0],[34,0,23,0],[35,0,24,0],[36,2,25,7],[36,11,25,16,"getReshaped"],[36,22,25,27,"getReshaped"],[36,23,25,28,"inputShape"],[36,33,25,38],[36,35,25,40,"blockShape"],[36,45,25,50],[36,47,25,52,"prod"],[36,51,25,56],[36,53,25,58,"batchToSpace"],[36,65,25,70],[36,68,25,73],[36,72,25,77],[36,74,25,79],[37,4,26,4],[37,8,26,8,"reshaped"],[37,16,26,16],[37,19,26,19],[37,21,26,21],[38,4,27,4],[38,8,27,8,"batchToSpace"],[38,20,27,20],[38,22,27,22],[39,6,28,8,"reshaped"],[39,14,28,16],[39,17,28,19,"reshaped"],[39,25,28,27],[39,26,28,28,"concat"],[39,32,28,34],[39,33,28,35,"blockShape"],[39,43,28,45],[39,44,28,46,"slice"],[39,49,28,51],[39,50,28,52],[39,51,28,53],[39,52,28,54],[39,53,28,55],[40,6,29,8,"reshaped"],[40,14,29,16],[40,15,29,17,"push"],[40,19,29,21],[40,20,29,22,"inputShape"],[40,30,29,32],[40,31,29,33],[40,32,29,34],[40,33,29,35],[40,36,29,38,"prod"],[40,40,29,42],[40,41,29,43],[41,6,30,8,"reshaped"],[41,14,30,16],[41,17,30,19,"reshaped"],[41,25,30,27],[41,26,30,28,"concat"],[41,32,30,34],[41,33,30,35,"inputShape"],[41,43,30,45],[41,44,30,46,"slice"],[41,49,30,51],[41,50,30,52],[41,51,30,53],[41,52,30,54],[41,53,30,55],[42,4,31,4],[42,5,31,5],[42,11,32,9],[43,6,33,8,"reshaped"],[43,14,33,16],[43,17,33,19,"reshaped"],[43,25,33,27],[43,26,33,28,"concat"],[43,32,33,34],[43,33,33,35,"inputShape"],[43,43,33,45],[43,44,33,46],[43,45,33,47],[43,46,33,48],[43,47,33,49],[44,6,34,8],[44,12,34,14,"spatialLength"],[44,25,34,27],[44,28,34,30,"blockShape"],[44,38,34,40],[44,39,34,41,"length"],[44,45,34,47],[45,6,35,8],[45,11,35,13],[45,15,35,17,"i"],[45,16,35,18],[45,19,35,21],[45,20,35,22],[45,22,35,24,"i"],[45,23,35,25],[45,26,35,28,"spatialLength"],[45,39,35,41],[45,41,35,43],[45,43,35,45,"i"],[45,44,35,46],[45,46,35,48],[46,8,36,12,"reshaped"],[46,16,36,20],[46,19,37,16,"reshaped"],[46,27,37,24],[46,28,37,25,"concat"],[46,34,37,31],[46,35,37,32],[46,36,37,33,"inputShape"],[46,46,37,43],[46,47,37,44,"i"],[46,48,37,45],[46,51,37,48],[46,52,37,49],[46,53,37,50],[46,56,37,53,"blockShape"],[46,66,37,63],[46,67,37,64,"i"],[46,68,37,65],[46,69,37,66],[46,71,37,68,"blockShape"],[46,81,37,78],[46,82,37,79,"i"],[46,83,37,80],[46,84,37,81],[46,85,37,82],[46,86,37,83],[47,6,38,8],[48,6,39,8,"reshaped"],[48,14,39,16],[48,17,39,19,"reshaped"],[48,25,39,27],[48,26,39,28,"concat"],[48,32,39,34],[48,33,39,35,"inputShape"],[48,43,39,45],[48,44,39,46,"slice"],[48,49,39,51],[48,50,39,52,"spatialLength"],[48,63,39,65],[48,66,39,68],[48,67,39,69],[48,68,39,70],[48,69,39,71],[49,4,40,4],[50,4,41,4],[50,11,41,11,"reshaped"],[50,19,41,19],[51,2,42,0],[52,2,43,0],[53,0,44,0],[54,0,45,0],[55,0,46,0],[56,0,47,0],[57,0,48,0],[58,0,49,0],[59,0,50,0],[60,0,51,0],[61,2,52,7],[61,11,52,16,"getPermuted"],[61,22,52,27,"getPermuted"],[61,23,52,28,"reshapedRank"],[61,35,52,40],[61,37,52,42,"blockShapeRank"],[61,51,52,56],[61,53,52,58,"batchToSpace"],[61,65,52,70],[61,68,52,73],[61,72,52,77],[61,74,52,79],[62,4,53,4],[62,10,53,10,"permuted"],[62,18,53,18],[62,21,53,21],[62,23,53,23],[63,4,54,4],[63,8,54,8,"batchToSpace"],[63,20,54,20],[63,22,54,22],[64,6,55,8,"permuted"],[64,14,55,16],[64,15,55,17,"push"],[64,19,55,21],[64,20,55,22,"blockShapeRank"],[64,34,55,36],[64,35,55,37],[65,6,56,8],[65,11,56,13],[65,15,56,17,"i"],[65,16,56,18],[65,19,56,21,"blockShapeRank"],[65,33,56,35],[65,36,56,38],[65,37,56,39],[65,39,56,41,"i"],[65,40,56,42],[65,43,56,45,"reshapedRank"],[65,55,56,57],[65,57,56,59],[65,59,56,61,"i"],[65,60,56,62],[65,62,56,64],[66,8,57,12],[66,12,57,16,"i"],[66,13,57,17],[66,17,57,21],[66,18,57,22],[66,21,57,25,"blockShapeRank"],[66,35,57,39],[66,37,57,41],[67,10,58,16,"permuted"],[67,18,58,24],[67,19,58,25,"push"],[67,23,58,29],[67,24,58,30,"i"],[67,25,58,31],[67,26,58,32],[68,10,59,16,"permuted"],[68,18,59,24],[68,19,59,25,"push"],[68,23,59,29],[68,24,59,30,"i"],[68,25,59,31],[68,29,59,35,"blockShapeRank"],[68,43,59,49],[68,46,59,52],[68,47,59,53],[68,48,59,54],[68,49,59,55],[69,8,60,12],[69,9,60,13],[69,15,61,17],[70,10,62,16,"permuted"],[70,18,62,24],[70,19,62,25,"push"],[70,23,62,29],[70,24,62,30,"i"],[70,25,62,31],[70,26,62,32],[71,8,63,12],[72,6,64,8],[73,4,65,4],[73,5,65,5],[73,11,66,9],[74,6,67,8],[74,12,67,14,"permutedBeforeBatch"],[74,31,67,33],[74,34,67,36],[74,36,67,38],[75,6,68,8],[75,12,68,14,"permutedAfterBatch"],[75,30,68,32],[75,33,68,35],[75,35,68,37],[76,6,69,8],[76,11,69,13],[76,15,69,17,"i"],[76,16,69,18],[76,19,69,21],[76,20,69,22],[76,22,69,24,"i"],[76,23,69,25],[76,26,69,28,"reshapedRank"],[76,38,69,40],[76,40,69,42],[76,42,69,44,"i"],[76,43,69,45],[76,45,69,47],[77,8,70,12],[77,12,70,16,"i"],[77,13,70,17],[77,17,70,21,"blockShapeRank"],[77,31,70,35],[77,34,70,38],[77,35,70,39],[77,38,70,42],[77,39,70,43],[77,43,70,47,"i"],[77,44,70,48],[77,47,70,51],[77,48,70,52],[77,53,70,57],[77,54,70,58],[77,56,70,60],[78,10,71,16,"permutedAfterBatch"],[78,28,71,34],[78,29,71,35,"push"],[78,33,71,39],[78,34,71,40,"i"],[78,35,71,41],[78,36,71,42],[79,8,72,12],[79,9,72,13],[79,15,73,17],[80,10,74,16,"permutedBeforeBatch"],[80,29,74,35],[80,30,74,36,"push"],[80,34,74,40],[80,35,74,41,"i"],[80,36,74,42],[80,37,74,43],[81,8,75,12],[82,6,76,8],[83,6,77,8,"permuted"],[83,14,77,16],[83,15,77,17,"push"],[83,19,77,21],[83,20,77,22],[83,23,77,25,"permutedBeforeBatch"],[83,42,77,44],[83,43,77,45],[84,6,78,8,"permuted"],[84,14,78,16],[84,15,78,17,"push"],[84,19,78,21],[84,20,78,22],[84,21,78,23],[84,22,78,24],[85,6,79,8,"permuted"],[85,14,79,16],[85,15,79,17,"push"],[85,19,79,21],[85,20,79,22],[85,23,79,25,"permutedAfterBatch"],[85,41,79,43],[85,42,79,44],[86,4,80,4],[87,4,81,4],[87,11,81,11,"permuted"],[87,19,81,19],[88,2,82,0],[89,2,83,0],[90,0,84,0],[91,0,85,0],[92,0,86,0],[93,0,87,0],[94,0,88,0],[95,0,89,0],[96,0,90,0],[97,0,91,0],[98,2,92,7],[98,11,92,16,"getReshapedPermuted"],[98,30,92,35,"getReshapedPermuted"],[98,31,92,36,"inputShape"],[98,41,92,46],[98,43,92,48,"blockShape"],[98,53,92,58],[98,55,92,60,"prod"],[98,59,92,64],[98,61,92,66,"batchToSpace"],[98,73,92,78],[98,76,92,81],[98,80,92,85],[98,82,92,87],[99,4,93,4],[99,10,93,10,"reshapedPermuted"],[99,26,93,26],[99,29,93,29],[99,31,93,31],[100,4,94,4],[100,8,94,8,"batchToSpace"],[100,20,94,20],[100,22,94,22],[101,6,95,8,"reshapedPermuted"],[101,22,95,24],[101,23,95,25,"push"],[101,27,95,29],[101,28,95,30,"inputShape"],[101,38,95,40],[101,39,95,41],[101,40,95,42],[101,41,95,43],[101,44,95,46,"prod"],[101,48,95,50],[101,49,95,51],[102,4,96,4],[102,5,96,5],[102,11,97,9],[103,6,98,8,"reshapedPermuted"],[103,22,98,24],[103,23,98,25,"push"],[103,27,98,29],[103,28,98,30,"inputShape"],[103,38,98,40],[103,39,98,41],[103,40,98,42],[103,41,98,43],[103,44,98,46,"prod"],[103,48,98,50],[103,49,98,51],[104,4,99,4],[105,4,100,4],[105,9,100,9],[105,13,100,13,"i"],[105,14,100,14],[105,17,100,17],[105,18,100,18],[105,20,100,20,"i"],[105,21,100,21],[105,24,100,24,"inputShape"],[105,34,100,34],[105,35,100,35,"length"],[105,41,100,41],[105,43,100,43],[105,45,100,45,"i"],[105,46,100,46],[105,48,100,48],[106,6,101,8],[106,10,101,12,"i"],[106,11,101,13],[106,15,101,17,"blockShape"],[106,25,101,27],[106,26,101,28,"length"],[106,32,101,34],[106,34,101,36],[107,8,102,12],[107,12,102,16,"batchToSpace"],[107,24,102,28],[107,26,102,30],[108,10,103,16,"reshapedPermuted"],[108,26,103,32],[108,27,103,33,"push"],[108,31,103,37],[108,32,103,38,"blockShape"],[108,42,103,48],[108,43,103,49,"i"],[108,44,103,50],[108,47,103,53],[108,48,103,54],[108,49,103,55],[108,52,103,58,"inputShape"],[108,62,103,68],[108,63,103,69,"i"],[108,64,103,70],[108,65,103,71],[108,66,103,72],[109,8,104,12],[109,9,104,13],[109,15,105,17],[110,10,106,16,"reshapedPermuted"],[110,26,106,32],[110,27,106,33,"push"],[110,31,106,37],[110,32,106,38,"inputShape"],[110,42,106,48],[110,43,106,49,"i"],[110,44,106,50],[110,45,106,51],[110,48,106,54,"blockShape"],[110,58,106,64],[110,59,106,65,"i"],[110,60,106,66],[110,63,106,69],[110,64,106,70],[110,65,106,71],[110,66,106,72],[111,8,107,12],[112,6,108,8],[112,7,108,9],[112,13,109,13],[113,8,110,12,"reshapedPermuted"],[113,24,110,28],[113,25,110,29,"push"],[113,29,110,33],[113,30,110,34,"inputShape"],[113,40,110,44],[113,41,110,45,"i"],[113,42,110,46],[113,43,110,47],[113,44,110,48],[114,6,111,8],[115,4,112,4],[116,4,113,4],[116,11,113,11,"reshapedPermuted"],[116,27,113,27],[117,2,114,0],[118,2,115,0],[119,0,116,0],[120,0,117,0],[121,0,118,0],[122,2,119,7],[122,11,119,16,"getSliceBeginCoords"],[122,30,119,35,"getSliceBeginCoords"],[122,31,119,36,"crops"],[122,36,119,41],[122,38,119,43,"blockShape"],[122,48,119,53],[122,50,119,55],[123,4,120,4],[123,10,120,10,"sliceBeginCoords"],[123,26,120,26],[123,29,120,29],[123,30,120,30],[123,31,120,31],[123,32,120,32],[124,4,121,4],[124,9,121,9],[124,13,121,13,"i"],[124,14,121,14],[124,17,121,17],[124,18,121,18],[124,20,121,20,"i"],[124,21,121,21],[124,24,121,24,"blockShape"],[124,34,121,34],[124,36,121,36],[124,38,121,38,"i"],[124,39,121,39],[124,41,121,41],[125,6,122,8,"sliceBeginCoords"],[125,22,122,24],[125,23,122,25,"push"],[125,27,122,29],[125,28,122,30,"crops"],[125,33,122,35],[125,34,122,36,"i"],[125,35,122,37],[125,36,122,38],[125,37,122,39],[125,38,122,40],[125,39,122,41],[125,40,122,42],[126,4,123,4],[127,4,124,4],[127,11,124,11,"sliceBeginCoords"],[127,27,124,27],[128,2,125,0],[129,2,126,0],[130,0,127,0],[131,0,128,0],[132,0,129,0],[133,0,130,0],[134,0,131,0],[135,0,132,0],[136,0,133,0],[137,0,134,0],[138,0,135,0],[139,0,136,0],[140,2,137,7],[140,11,137,16,"getSliceSize"],[140,23,137,28,"getSliceSize"],[140,24,137,29,"uncroppedShape"],[140,38,137,43],[140,40,137,45,"crops"],[140,45,137,50],[140,47,137,52,"blockShape"],[140,57,137,62],[140,59,137,64],[141,4,138,4],[141,10,138,10,"sliceSize"],[141,19,138,19],[141,22,138,22,"uncroppedShape"],[141,36,138,36],[141,37,138,37,"slice"],[141,42,138,42],[141,43,138,43],[141,44,138,44],[141,46,138,46],[141,47,138,47],[141,48,138,48],[142,4,139,4],[142,9,139,9],[142,13,139,13,"i"],[142,14,139,14],[142,17,139,17],[142,18,139,18],[142,20,139,20,"i"],[142,21,139,21],[142,24,139,24,"blockShape"],[142,34,139,34],[142,36,139,36],[142,38,139,38,"i"],[142,39,139,39],[142,41,139,41],[143,6,140,8,"sliceSize"],[143,15,140,17],[143,16,140,18,"push"],[143,20,140,22],[143,21,140,23,"uncroppedShape"],[143,35,140,37],[143,36,140,38,"i"],[143,37,140,39],[143,40,140,42],[143,41,140,43],[143,42,140,44],[143,45,140,47,"crops"],[143,50,140,52],[143,51,140,53,"i"],[143,52,140,54],[143,53,140,55],[143,54,140,56],[143,55,140,57],[143,56,140,58],[143,59,140,61,"crops"],[143,64,140,66],[143,65,140,67,"i"],[143,66,140,68],[143,67,140,69],[143,68,140,70],[143,69,140,71],[143,70,140,72],[143,71,140,73],[144,4,141,4],[145,4,142,4],[145,11,142,11,"sliceSize"],[145,20,142,20],[146,2,143,0],[147,0,143,1],[147,3]],"functionMap":{"names":["<global>","getReshaped","getPermuted","getReshapedPermuted","getSliceBeginCoords","getSliceSize"],"mappings":"AAA;OCwB;CDiB;OEU;CF8B;OGU;CHsB;OIK;CJM;OKY;CLM"},"hasCjsExports":false},"type":"js/module"}]}