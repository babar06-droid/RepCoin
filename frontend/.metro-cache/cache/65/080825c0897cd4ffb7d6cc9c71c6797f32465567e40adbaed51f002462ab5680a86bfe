{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":706},"end":{"line":18,"column":44,"index":750}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"./lazy_iterator","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":751},"end":{"line":19,"column":66,"index":817}}],"key":"q2hxzZKS96FYTd6539vU0OZjvFs=","exportNames":["*"],"imports":1}},{"name":"./string_iterator","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":818},"end":{"line":20,"column":51,"index":869}}],"key":"ZfAK6GuApYZrdAoghiFGnvQWEYg=","exportNames":["*"],"imports":1}},{"name":"string_decoder","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":88,"column":38,"index":3900},"end":{"line":88,"column":63,"index":3925}}],"key":"Czn9Pd3w4g4vQh6KJoZw1JzHmic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"ByteChunkIterator\", {\n    enumerable: true,\n    get: function () {\n      return ByteChunkIterator;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _lazy_iterator = require(_dependencyMap[1], \"./lazy_iterator\");\n  var _string_iterator = require(_dependencyMap[2], \"./string_iterator\");\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   *\n   * =============================================================================\n   */\n\n  class ByteChunkIterator extends _lazy_iterator.LazyIterator {\n    /**\n     * Decode a stream of UTF8-encoded byte arrays to a stream of strings.\n     *\n     * The byte arrays producetd from the ByteChunkIterator on which this is\n     * called will be interpreted as concatenated.  No assumptions are made about\n     * the boundaries of the incoming chunks, so a multi-byte UTF8 encoding of a\n     * character may span the boundary between chunks.  This naturally happens,\n     * for instance, when reading fixed-size byte arrays from a file.\n     */\n    decodeUTF8() {\n      return new Utf8Iterator(this);\n    }\n  }\n  // ============================================================================\n  // The following private classes serve to implement the chainable methods\n  // on ByteChunkIterator.  Unfortunately they can't be placed in separate files,\n  // due to resulting trouble with circular imports.\n  // ============================================================================\n  // We wanted multiple inheritance, e.g.\n  //   class Utf8Iterator extends QueueIterator<string>, StringIterator\n  // but the TypeScript mixin approach is a bit hacky, so we take this adapter\n  // approach instead.\n  class Utf8Iterator extends _string_iterator.StringIterator {\n    constructor(upstream) {\n      super();\n      this.upstream = upstream;\n      this.impl = new Utf8IteratorImpl(upstream);\n    }\n    summary() {\n      return this.impl.summary();\n    }\n    async next() {\n      return this.impl.next();\n    }\n  }\n  /**\n   * Decode a stream of UTF8-encoded byte arrays to a stream of strings.\n   *\n   * This is tricky because the incoming byte array boundaries may disrupt a\n   * multi-byte UTF8 character. Thus any incomplete character data at the end of\n   * a chunk must be carried over and prepended to the next chunk before\n   * decoding. Luckily with native decoder, TextDecoder in browser and\n   * string_decoder in node, byte array boundaries are handled automatically.\n   *\n   * In the context of an input pipeline for machine learning, UTF8 decoding is\n   * needed to parse text files containing training examples or prediction\n   * requests (e.g., formatted as CSV or JSON). We cannot use the built-in\n   * decoding provided by FileReader.readAsText() because here we are in a\n   * streaming context, which FileReader does not support.\n   *\n   * @param upstream A `LazyIterator` of `Uint8Arrays` containing UTF8-encoded\n   *   text, which should be interpreted as concatenated.  No assumptions are\n   *   made about the boundaries of the incoming chunks, so a multi-byte UTF8\n   *   encoding of a character may span the boundary between chunks.  This\n   *   naturally happens, for instance, when reading fixed-size byte arrays from a\n   *   file.\n   */\n  class Utf8IteratorImpl extends _lazy_iterator.OneToManyIterator {\n    constructor(upstream) {\n      super();\n      this.upstream = upstream;\n      if ((0, _tensorflowTfjsCore.env)().get('IS_BROWSER')) {\n        this.decoder = new TextDecoder('utf-8');\n      } else {\n        // tslint:disable-next-line:no-require-imports\n        const {\n          StringDecoder\n        } = require(_dependencyMap[3], \"string_decoder\");\n        this.decoder = new StringDecoder('utf8');\n      }\n    }\n    summary() {\n      return `${this.upstream.summary()} -> Utf8`;\n    }\n    async pump() {\n      const chunkResult = await this.upstream.next();\n      let chunk;\n      if (chunkResult.done) {\n        return false;\n      } else {\n        chunk = chunkResult.value;\n      }\n      let text;\n      if ((0, _tensorflowTfjsCore.env)().get('IS_BROWSER')) {\n        text = this.decoder.decode(chunk, {\n          stream: true\n        });\n      } else {\n        text = this.decoder.write(Buffer.from(chunk.buffer));\n      }\n      this.outputQueue.push(text);\n      return true;\n    }\n  }\n});","lineCount":129,"map":[[7,2,21,0,"Object"],[7,8,21,0],[7,9,21,0,"defineProperty"],[7,23,21,0],[7,24,21,0,"exports"],[7,31,21,0],[8,4,21,0,"enumerable"],[8,14,21,0],[9,4,21,0,"get"],[9,7,21,0],[9,18,21,0,"get"],[9,19,21,0],[10,6,21,0],[10,13,21,0,"ByteChunkIterator"],[10,30,21,0],[11,4,21,0],[12,2,21,0],[13,2,18,0],[13,6,18,0,"_tensorflowTfjsCore"],[13,25,18,0],[13,28,18,0,"require"],[13,35,18,0],[13,36,18,0,"_dependencyMap"],[13,50,18,0],[14,2,19,0],[14,6,19,0,"_lazy_iterator"],[14,20,19,0],[14,23,19,0,"require"],[14,30,19,0],[14,31,19,0,"_dependencyMap"],[14,45,19,0],[15,2,20,0],[15,6,20,0,"_string_iterator"],[15,22,20,0],[15,25,20,0,"require"],[15,32,20,0],[15,33,20,0,"_dependencyMap"],[15,47,20,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[25,0,10,0],[26,0,11,0],[27,0,12,0],[28,0,13,0],[29,0,14,0],[30,0,15,0],[31,0,16,0],[32,0,17,0],[34,2,21,7],[34,8,21,13,"ByteChunkIterator"],[34,25,21,30],[34,34,21,39,"LazyIterator"],[34,48,21,51],[34,49,21,51,"LazyIterator"],[34,61,21,51],[34,62,21,52],[35,4,22,4],[36,0,23,0],[37,0,24,0],[38,0,25,0],[39,0,26,0],[40,0,27,0],[41,0,28,0],[42,0,29,0],[43,0,30,0],[44,4,31,4,"decodeUTF8"],[44,14,31,14,"decodeUTF8"],[44,15,31,14],[44,17,31,17],[45,6,32,8],[45,13,32,15],[45,17,32,19,"Utf8Iterator"],[45,29,32,31],[45,30,32,32],[45,34,32,36],[45,35,32,37],[46,4,33,4],[47,2,34,0],[48,2,35,0],[49,2,36,0],[50,2,37,0],[51,2,38,0],[52,2,39,0],[53,2,40,0],[54,2,41,0],[55,2,42,0],[56,2,43,0],[57,2,44,0],[57,8,44,6,"Utf8Iterator"],[57,20,44,18],[57,29,44,27,"StringIterator"],[57,45,44,41],[57,46,44,41,"StringIterator"],[57,60,44,41],[57,61,44,42],[58,4,45,4,"constructor"],[58,15,45,15,"constructor"],[58,16,45,16,"upstream"],[58,24,45,24],[58,26,45,26],[59,6,46,8],[59,11,46,13],[59,12,46,14],[59,13,46,15],[60,6,47,8],[60,10,47,12],[60,11,47,13,"upstream"],[60,19,47,21],[60,22,47,24,"upstream"],[60,30,47,32],[61,6,48,8],[61,10,48,12],[61,11,48,13,"impl"],[61,15,48,17],[61,18,48,20],[61,22,48,24,"Utf8IteratorImpl"],[61,38,48,40],[61,39,48,41,"upstream"],[61,47,48,49],[61,48,48,50],[62,4,49,4],[63,4,50,4,"summary"],[63,11,50,11,"summary"],[63,12,50,11],[63,14,50,14],[64,6,51,8],[64,13,51,15],[64,17,51,19],[64,18,51,20,"impl"],[64,22,51,24],[64,23,51,25,"summary"],[64,30,51,32],[64,31,51,33],[64,32,51,34],[65,4,52,4],[66,4,53,4],[66,10,53,10,"next"],[66,14,53,14,"next"],[66,15,53,14],[66,17,53,17],[67,6,54,8],[67,13,54,15],[67,17,54,19],[67,18,54,20,"impl"],[67,22,54,24],[67,23,54,25,"next"],[67,27,54,29],[67,28,54,30],[67,29,54,31],[68,4,55,4],[69,2,56,0],[70,2,57,0],[71,0,58,0],[72,0,59,0],[73,0,60,0],[74,0,61,0],[75,0,62,0],[76,0,63,0],[77,0,64,0],[78,0,65,0],[79,0,66,0],[80,0,67,0],[81,0,68,0],[82,0,69,0],[83,0,70,0],[84,0,71,0],[85,0,72,0],[86,0,73,0],[87,0,74,0],[88,0,75,0],[89,0,76,0],[90,0,77,0],[91,0,78,0],[92,2,79,0],[92,8,79,6,"Utf8IteratorImpl"],[92,24,79,22],[92,33,79,31,"OneToManyIterator"],[92,47,79,48],[92,48,79,48,"OneToManyIterator"],[92,65,79,48],[92,66,79,49],[93,4,80,4,"constructor"],[93,15,80,15,"constructor"],[93,16,80,16,"upstream"],[93,24,80,24],[93,26,80,26],[94,6,81,8],[94,11,81,13],[94,12,81,14],[94,13,81,15],[95,6,82,8],[95,10,82,12],[95,11,82,13,"upstream"],[95,19,82,21],[95,22,82,24,"upstream"],[95,30,82,32],[96,6,83,8],[96,10,83,12],[96,14,83,12,"env"],[96,33,83,15],[96,34,83,15,"env"],[96,37,83,15],[96,39,83,16],[96,40,83,17],[96,41,83,18,"get"],[96,44,83,21],[96,45,83,22],[96,57,83,34],[96,58,83,35],[96,60,83,37],[97,8,84,12],[97,12,84,16],[97,13,84,17,"decoder"],[97,20,84,24],[97,23,84,27],[97,27,84,31,"TextDecoder"],[97,38,84,42],[97,39,84,43],[97,46,84,50],[97,47,84,51],[98,6,85,8],[98,7,85,9],[98,13,86,13],[99,8,87,12],[100,8,88,12],[100,14,88,18],[101,10,88,20,"StringDecoder"],[102,8,88,34],[102,9,88,35],[102,12,88,38,"require"],[102,19,88,45],[102,20,88,45,"_dependencyMap"],[102,34,88,45],[102,55,88,62],[102,56,88,63],[103,8,89,12],[103,12,89,16],[103,13,89,17,"decoder"],[103,20,89,24],[103,23,89,27],[103,27,89,31,"StringDecoder"],[103,40,89,44],[103,41,89,45],[103,47,89,51],[103,48,89,52],[104,6,90,8],[105,4,91,4],[106,4,92,4,"summary"],[106,11,92,11,"summary"],[106,12,92,11],[106,14,92,14],[107,6,93,8],[107,13,93,15],[107,16,93,18],[107,20,93,22],[107,21,93,23,"upstream"],[107,29,93,31],[107,30,93,32,"summary"],[107,37,93,39],[107,38,93,40],[107,39,93,41],[107,49,93,51],[108,4,94,4],[109,4,95,4],[109,10,95,10,"pump"],[109,14,95,14,"pump"],[109,15,95,14],[109,17,95,17],[110,6,96,8],[110,12,96,14,"chunkResult"],[110,23,96,25],[110,26,96,28],[110,32,96,34],[110,36,96,38],[110,37,96,39,"upstream"],[110,45,96,47],[110,46,96,48,"next"],[110,50,96,52],[110,51,96,53],[110,52,96,54],[111,6,97,8],[111,10,97,12,"chunk"],[111,15,97,17],[112,6,98,8],[112,10,98,12,"chunkResult"],[112,21,98,23],[112,22,98,24,"done"],[112,26,98,28],[112,28,98,30],[113,8,99,12],[113,15,99,19],[113,20,99,24],[114,6,100,8],[114,7,100,9],[114,13,101,13],[115,8,102,12,"chunk"],[115,13,102,17],[115,16,102,20,"chunkResult"],[115,27,102,31],[115,28,102,32,"value"],[115,33,102,37],[116,6,103,8],[117,6,104,8],[117,10,104,12,"text"],[117,14,104,16],[118,6,105,8],[118,10,105,12],[118,14,105,12,"env"],[118,33,105,15],[118,34,105,15,"env"],[118,37,105,15],[118,39,105,16],[118,40,105,17],[118,41,105,18,"get"],[118,44,105,21],[118,45,105,22],[118,57,105,34],[118,58,105,35],[118,60,105,37],[119,8,106,12,"text"],[119,12,106,16],[119,15,106,19],[119,19,106,23],[119,20,106,24,"decoder"],[119,27,106,31],[119,28,106,32,"decode"],[119,34,106,38],[119,35,106,39,"chunk"],[119,40,106,44],[119,42,106,46],[120,10,106,48,"stream"],[120,16,106,54],[120,18,106,56],[121,8,106,61],[121,9,106,62],[121,10,106,63],[122,6,107,8],[122,7,107,9],[122,13,108,13],[123,8,109,12,"text"],[123,12,109,16],[123,15,109,19],[123,19,109,23],[123,20,109,24,"decoder"],[123,27,109,31],[123,28,109,32,"write"],[123,33,109,37],[123,34,109,38,"Buffer"],[123,40,109,44],[123,41,109,45,"from"],[123,45,109,49],[123,46,109,50,"chunk"],[123,51,109,55],[123,52,109,56,"buffer"],[123,58,109,62],[123,59,109,63],[123,60,109,64],[124,6,110,8],[125,6,111,8],[125,10,111,12],[125,11,111,13,"outputQueue"],[125,22,111,24],[125,23,111,25,"push"],[125,27,111,29],[125,28,111,30,"text"],[125,32,111,34],[125,33,111,35],[126,6,112,8],[126,13,112,15],[126,17,112,19],[127,4,113,4],[128,2,114,0],[129,0,114,1],[129,3]],"functionMap":{"names":["<global>","ByteChunkIterator","ByteChunkIterator#decodeUTF8","Utf8Iterator","Utf8Iterator#constructor","Utf8Iterator#summary","Utf8Iterator#next","Utf8IteratorImpl","Utf8IteratorImpl#constructor","Utf8IteratorImpl#summary","Utf8IteratorImpl#pump"],"mappings":"AAA;OCoB;ICU;KDE;CDC;AGU;ICC;KDI;IEC;KFE;IGC;KHE;CHC;AOuB;ICC;KDW;IEC;KFE;IGC;KHkB;CPC"},"hasCjsExports":false},"type":"js/module"}]}