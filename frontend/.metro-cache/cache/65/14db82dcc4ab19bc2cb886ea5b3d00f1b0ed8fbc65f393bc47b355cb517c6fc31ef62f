{"dependencies":[{"name":"../kernel_names","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":53,"index":756}}],"key":"gQVznmdGA0uoBQvR5Q4/qW+ITHg=","exportNames":["*"],"imports":1}},{"name":"../ops/expand_dims","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":757},"end":{"line":18,"column":48,"index":805}}],"key":"GoC8i2/87Fo2bZz0IG2k4yo5UZU=","exportNames":["*"],"imports":1}},{"name":"../ops/gather","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":806},"end":{"line":19,"column":39,"index":845}}],"key":"4rYsLbEQnSuYf+gLFam8fl5ZEDY=","exportNames":["*"],"imports":1}},{"name":"../ops/greater_equal","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":846},"end":{"line":20,"column":52,"index":898}}],"key":"M5U5x2z9vNokLV5/W+EWcB0EHvI=","exportNames":["*"],"imports":1}},{"name":"../ops/logical_and","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":899},"end":{"line":21,"column":48,"index":947}}],"key":"NIRytryVEmuYjI02STW50ff8BWo=","exportNames":["*"],"imports":1}},{"name":"../ops/maximum","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":948},"end":{"line":22,"column":41,"index":989}}],"key":"i3AxNWIoG6L80+x4htSl/kpVWbE=","exportNames":["*"],"imports":1}},{"name":"../ops/ones","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":23,"column":0,"index":990},"end":{"line":23,"column":35,"index":1025}}],"key":"bZaEZrfr42lrPP7Nlij13+rxuxE=","exportNames":["*"],"imports":1}},{"name":"../ops/scalar","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":24,"column":0,"index":1026},"end":{"line":24,"column":39,"index":1065}}],"key":"rZXFtHeZMGskUzCIeY9ReIRgRNY=","exportNames":["*"],"imports":1}},{"name":"../ops/where","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":25,"column":0,"index":1066},"end":{"line":25,"column":37,"index":1103}}],"key":"U8ANkW0botEoUQtAy7zxZOgP0oc=","exportNames":["*"],"imports":1}},{"name":"../ops/zeros_like","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":26,"column":0,"index":1104},"end":{"line":26,"column":46,"index":1150}}],"key":"W8oXMgkxT4zTnXtvBRWiid+nzbc=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"unsortedSegmentSumGradConfig\", {\n    enumerable: true,\n    get: function () {\n      return unsortedSegmentSumGradConfig;\n    }\n  });\n  var _kernel_names = require(_dependencyMap[0], \"../kernel_names\");\n  var _opsExpand_dims = require(_dependencyMap[1], \"../ops/expand_dims\");\n  var _opsGather = require(_dependencyMap[2], \"../ops/gather\");\n  var _opsGreater_equal = require(_dependencyMap[3], \"../ops/greater_equal\");\n  var _opsLogical_and = require(_dependencyMap[4], \"../ops/logical_and\");\n  var _opsMaximum = require(_dependencyMap[5], \"../ops/maximum\");\n  var _opsOnes = require(_dependencyMap[6], \"../ops/ones\");\n  var _opsScalar = require(_dependencyMap[7], \"../ops/scalar\");\n  var _opsWhere = require(_dependencyMap[8], \"../ops/where\");\n  var _opsZeros_like = require(_dependencyMap[9], \"../ops/zeros_like\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  const unsortedSegmentSumGradConfig = {\n    kernelName: _kernel_names.UnsortedSegmentSum,\n    inputsToSave: ['segmentIds'],\n    gradFunc: (dy, saved) => {\n      const [segmentIds] = saved;\n      const derX = () => {\n        return gatherDropNegatives(dy, segmentIds);\n      };\n      return {\n        x: derX\n      };\n    }\n  };\n  function gatherDropNegatives(x, indices) {\n    // Helper function for unsorted segment ops. Gathers params for\n    // positive segment ids and gathers 0 for inputs with negative segment id.\n    // Mirrors _GatherDropNegatives from tensorflow/python/ops/math_grad.py\n    const zeroClippedIndices = (0, _opsMaximum.maximum)(indices, (0, _opsZeros_like.zerosLike)(indices));\n    const gathered = (0, _opsGather.gather)(x, zeroClippedIndices);\n    let isPositive = (0, _opsGreater_equal.greaterEqual)(indices, (0, _opsScalar.scalar)(0, 'int32'));\n    const numIters = gathered.rank - isPositive.rank;\n    for (let i = 0; i < numIters; ++i) {\n      isPositive = (0, _opsExpand_dims.expandDims)(isPositive, i + 1);\n    }\n    isPositive = (0, _opsLogical_and.logicalAnd)(isPositive, (0, _opsOnes.ones)(gathered.shape, 'bool'));\n    const zeroSlice = (0, _opsZeros_like.zerosLike)(gathered);\n    return (0, _opsWhere.where)(isPositive, gathered, zeroSlice);\n  }\n});","lineCount":68,"map":[[7,2,27,0,"Object"],[7,8,27,0],[7,9,27,0,"defineProperty"],[7,23,27,0],[7,24,27,0,"exports"],[7,31,27,0],[8,4,27,0,"enumerable"],[8,14,27,0],[9,4,27,0,"get"],[9,7,27,0],[9,18,27,0,"get"],[9,19,27,0],[10,6,27,0],[10,13,27,0,"unsortedSegmentSumGradConfig"],[10,41,27,0],[11,4,27,0],[12,2,27,0],[13,2,17,0],[13,6,17,0,"_kernel_names"],[13,19,17,0],[13,22,17,0,"require"],[13,29,17,0],[13,30,17,0,"_dependencyMap"],[13,44,17,0],[14,2,18,0],[14,6,18,0,"_opsExpand_dims"],[14,21,18,0],[14,24,18,0,"require"],[14,31,18,0],[14,32,18,0,"_dependencyMap"],[14,46,18,0],[15,2,19,0],[15,6,19,0,"_opsGather"],[15,16,19,0],[15,19,19,0,"require"],[15,26,19,0],[15,27,19,0,"_dependencyMap"],[15,41,19,0],[16,2,20,0],[16,6,20,0,"_opsGreater_equal"],[16,23,20,0],[16,26,20,0,"require"],[16,33,20,0],[16,34,20,0,"_dependencyMap"],[16,48,20,0],[17,2,21,0],[17,6,21,0,"_opsLogical_and"],[17,21,21,0],[17,24,21,0,"require"],[17,31,21,0],[17,32,21,0,"_dependencyMap"],[17,46,21,0],[18,2,22,0],[18,6,22,0,"_opsMaximum"],[18,17,22,0],[18,20,22,0,"require"],[18,27,22,0],[18,28,22,0,"_dependencyMap"],[18,42,22,0],[19,2,23,0],[19,6,23,0,"_opsOnes"],[19,14,23,0],[19,17,23,0,"require"],[19,24,23,0],[19,25,23,0,"_dependencyMap"],[19,39,23,0],[20,2,24,0],[20,6,24,0,"_opsScalar"],[20,16,24,0],[20,19,24,0,"require"],[20,26,24,0],[20,27,24,0,"_dependencyMap"],[20,41,24,0],[21,2,25,0],[21,6,25,0,"_opsWhere"],[21,15,25,0],[21,18,25,0,"require"],[21,25,25,0],[21,26,25,0,"_dependencyMap"],[21,40,25,0],[22,2,26,0],[22,6,26,0,"_opsZeros_like"],[22,20,26,0],[22,23,26,0,"require"],[22,30,26,0],[22,31,26,0,"_dependencyMap"],[22,45,26,0],[23,2,1,0],[24,0,2,0],[25,0,3,0],[26,0,4,0],[27,0,5,0],[28,0,6,0],[29,0,7,0],[30,0,8,0],[31,0,9,0],[32,0,10,0],[33,0,11,0],[34,0,12,0],[35,0,13,0],[36,0,14,0],[37,0,15,0],[38,0,16,0],[40,2,27,7],[40,8,27,13,"unsortedSegmentSumGradConfig"],[40,36,27,41],[40,39,27,44],[41,4,28,4,"kernelName"],[41,14,28,14],[41,16,28,16,"UnsortedSegmentSum"],[41,29,28,34],[41,30,28,34,"UnsortedSegmentSum"],[41,48,28,34],[42,4,29,4,"inputsToSave"],[42,16,29,16],[42,18,29,18],[42,19,29,19],[42,31,29,31],[42,32,29,32],[43,4,30,4,"gradFunc"],[43,12,30,12],[43,14,30,14,"gradFunc"],[43,15,30,15,"dy"],[43,17,30,17],[43,19,30,19,"saved"],[43,24,30,24],[43,29,30,29],[44,6,31,8],[44,12,31,14],[44,13,31,15,"segmentIds"],[44,23,31,25],[44,24,31,26],[44,27,31,29,"saved"],[44,32,31,34],[45,6,32,8],[45,12,32,14,"derX"],[45,16,32,18],[45,19,32,21,"derX"],[45,20,32,21],[45,25,32,27],[46,8,33,12],[46,15,33,19,"gatherDropNegatives"],[46,34,33,38],[46,35,33,39,"dy"],[46,37,33,41],[46,39,33,43,"segmentIds"],[46,49,33,53],[46,50,33,54],[47,6,34,8],[47,7,34,9],[48,6,35,8],[48,13,35,15],[49,8,35,17,"x"],[49,9,35,18],[49,11,35,20,"derX"],[50,6,35,25],[50,7,35,26],[51,4,36,4],[52,2,37,0],[52,3,37,1],[53,2,38,0],[53,11,38,9,"gatherDropNegatives"],[53,30,38,28,"gatherDropNegatives"],[53,31,38,29,"x"],[53,32,38,30],[53,34,38,32,"indices"],[53,41,38,39],[53,43,38,41],[54,4,39,4],[55,4,40,4],[56,4,41,4],[57,4,42,4],[57,10,42,10,"zeroClippedIndices"],[57,28,42,28],[57,31,42,31],[57,35,42,31,"maximum"],[57,46,42,38],[57,47,42,38,"maximum"],[57,54,42,38],[57,56,42,39,"indices"],[57,63,42,46],[57,65,42,48],[57,69,42,48,"zerosLike"],[57,83,42,57],[57,84,42,57,"zerosLike"],[57,93,42,57],[57,95,42,58,"indices"],[57,102,42,65],[57,103,42,66],[57,104,42,67],[58,4,43,4],[58,10,43,10,"gathered"],[58,18,43,18],[58,21,43,21],[58,25,43,21,"gather"],[58,35,43,27],[58,36,43,27,"gather"],[58,42,43,27],[58,44,43,28,"x"],[58,45,43,29],[58,47,43,31,"zeroClippedIndices"],[58,65,43,49],[58,66,43,50],[59,4,44,4],[59,8,44,8,"isPositive"],[59,18,44,18],[59,21,44,21],[59,25,44,21,"greaterEqual"],[59,42,44,33],[59,43,44,33,"greaterEqual"],[59,55,44,33],[59,57,44,34,"indices"],[59,64,44,41],[59,66,44,43],[59,70,44,43,"scalar"],[59,80,44,49],[59,81,44,49,"scalar"],[59,87,44,49],[59,89,44,50],[59,90,44,51],[59,92,44,53],[59,99,44,60],[59,100,44,61],[59,101,44,62],[60,4,45,4],[60,10,45,10,"numIters"],[60,18,45,18],[60,21,45,21,"gathered"],[60,29,45,29],[60,30,45,30,"rank"],[60,34,45,34],[60,37,45,37,"isPositive"],[60,47,45,47],[60,48,45,48,"rank"],[60,52,45,52],[61,4,46,4],[61,9,46,9],[61,13,46,13,"i"],[61,14,46,14],[61,17,46,17],[61,18,46,18],[61,20,46,20,"i"],[61,21,46,21],[61,24,46,24,"numIters"],[61,32,46,32],[61,34,46,34],[61,36,46,36,"i"],[61,37,46,37],[61,39,46,39],[62,6,47,8,"isPositive"],[62,16,47,18],[62,19,47,21],[62,23,47,21,"expandDims"],[62,38,47,31],[62,39,47,31,"expandDims"],[62,49,47,31],[62,51,47,32,"isPositive"],[62,61,47,42],[62,63,47,44,"i"],[62,64,47,45],[62,67,47,48],[62,68,47,49],[62,69,47,50],[63,4,48,4],[64,4,49,4,"isPositive"],[64,14,49,14],[64,17,49,17],[64,21,49,17,"logicalAnd"],[64,36,49,27],[64,37,49,27,"logicalAnd"],[64,47,49,27],[64,49,49,28,"isPositive"],[64,59,49,38],[64,61,49,40],[64,65,49,40,"ones"],[64,73,49,44],[64,74,49,44,"ones"],[64,78,49,44],[64,80,49,45,"gathered"],[64,88,49,53],[64,89,49,54,"shape"],[64,94,49,59],[64,96,49,61],[64,102,49,67],[64,103,49,68],[64,104,49,69],[65,4,50,4],[65,10,50,10,"zeroSlice"],[65,19,50,19],[65,22,50,22],[65,26,50,22,"zerosLike"],[65,40,50,31],[65,41,50,31,"zerosLike"],[65,50,50,31],[65,52,50,32,"gathered"],[65,60,50,40],[65,61,50,41],[66,4,51,4],[66,11,51,11],[66,15,51,11,"where"],[66,24,51,16],[66,25,51,16,"where"],[66,30,51,16],[66,32,51,17,"isPositive"],[66,42,51,27],[66,44,51,29,"gathered"],[66,52,51,37],[66,54,51,39,"zeroSlice"],[66,63,51,48],[66,64,51,49],[67,2,52,0],[68,0,52,1],[68,3]],"functionMap":{"names":["<global>","unsortedSegmentSumGradConfig.gradFunc","derX","gatherDropNegatives"],"mappings":"AAA;cC6B;qBCE;SDE;KDE;AGE;CHc"},"hasCjsExports":false},"type":"js/module"}]}