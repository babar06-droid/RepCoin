{"dependencies":[{"name":"./packing_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":45,"index":748}}],"key":"XZxV38atso3t5pLpH4+paVH17Hc=","exportNames":["*"],"imports":1}},{"name":"./shader_compiler","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":749},"end":{"line":18,"column":54,"index":803}}],"key":"yVSKlvZSxQn3Ck2puzGVWEYPzq8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"ReversePackedProgram\", {\n    enumerable: true,\n    get: function () {\n      return ReversePackedProgram;\n    }\n  });\n  var _packing_util = require(_dependencyMap[0], \"./packing_util\");\n  var _shader_compiler = require(_dependencyMap[1], \"./shader_compiler\");\n  /**\n   * @license\n   * Copyright 2019 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  class ReversePackedProgram {\n    constructor(xShape, axis) {\n      this.variableNames = ['x'];\n      this.packedInputs = true;\n      this.packedOutput = true;\n      const rank = xShape.length;\n      if (rank > 4) {\n        throw new Error(`WebGL backend: Reverse of rank-${rank} tensor is not yet supported`);\n      }\n      this.outputShape = xShape;\n      const channels = (0, _packing_util.getChannels)('rc', rank);\n      const nextColumn = `${channels[rank - 1]} + 1 < ${this.outputShape[rank - 1]}`;\n      const nextRow = `${channels[rank - 2]} + 1 < ${this.outputShape[rank - 2]}`;\n      const type = (0, _shader_compiler.getCoordsDataType)(rank);\n      if (rank === 1) {\n        this.userCode = `\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${xShape[0]} - rc - 1),\n            ${xShape[0]} - rc - 1);\n          if(${nextColumn}){\n              result.g = getChannel(getX(${xShape[0]} - (rc  + 1) - 1),\n                ${xShape[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `;\n      } else {\n        this.userCode = `\n        void main() {\n          ${type} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${getR(channels.slice())};\n          if(${nextColumn}){\n            result.g = ${getG(channels.slice())};\n          }\n          if(${nextRow}) {\n            result.b = ${getB(channels.slice())};\n            if(${nextColumn}) {\n              result.a = ${getA(channels.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `;\n      }\n      function getR(channels) {\n        return getChannel(channels);\n      }\n      function getG(channels) {\n        channels[rank - 1] = '(' + channels[rank - 1] + ` + 1)`;\n        return getChannel(channels);\n      }\n      function getB(channels) {\n        channels[rank - 2] = '(' + channels[rank - 2] + ` + 1)`;\n        return getChannel(channels);\n      }\n      function getA(channels) {\n        channels[rank - 1] = '(' + channels[rank - 1] + ` + 1)`;\n        channels[rank - 2] = '(' + channels[rank - 2] + ` + 1)`;\n        return getChannel(channels);\n      }\n      function getChannel(channels) {\n        const inCoordsArray = xShape.map((_, i) => getInCoord(i, channels));\n        const inCoords = inCoordsArray.join(',');\n        const innerDims = inCoordsArray.slice(-2).join(',');\n        return `getChannel(getX(${inCoords}), vec2(${innerDims}))`;\n      }\n      function getInCoord(i, channels1) {\n        if (axis.indexOf(i) !== -1 && xShape[i] !== 1) {\n          return `${xShape[i]} - ${channels1[i]} - 1`;\n        } else {\n          return `${channels1[i]}`;\n        }\n      }\n    }\n  }\n});","lineCount":110,"map":[[7,2,19,0,"Object"],[7,8,19,0],[7,9,19,0,"defineProperty"],[7,23,19,0],[7,24,19,0,"exports"],[7,31,19,0],[8,4,19,0,"enumerable"],[8,14,19,0],[9,4,19,0,"get"],[9,7,19,0],[9,18,19,0,"get"],[9,19,19,0],[10,6,19,0],[10,13,19,0,"ReversePackedProgram"],[10,33,19,0],[11,4,19,0],[12,2,19,0],[13,2,17,0],[13,6,17,0,"_packing_util"],[13,19,17,0],[13,22,17,0,"require"],[13,29,17,0],[13,30,17,0,"_dependencyMap"],[13,44,17,0],[14,2,18,0],[14,6,18,0,"_shader_compiler"],[14,22,18,0],[14,25,18,0,"require"],[14,32,18,0],[14,33,18,0,"_dependencyMap"],[14,47,18,0],[15,2,1,0],[16,0,2,0],[17,0,3,0],[18,0,4,0],[19,0,5,0],[20,0,6,0],[21,0,7,0],[22,0,8,0],[23,0,9,0],[24,0,10,0],[25,0,11,0],[26,0,12,0],[27,0,13,0],[28,0,14,0],[29,0,15,0],[30,0,16,0],[32,2,19,7],[32,8,19,13,"ReversePackedProgram"],[32,28,19,33],[32,29,19,34],[33,4,20,4,"constructor"],[33,15,20,15,"constructor"],[33,16,20,16,"xShape"],[33,22,20,22],[33,24,20,24,"axis"],[33,28,20,28],[33,30,20,30],[34,6,21,8],[34,10,21,12],[34,11,21,13,"variableNames"],[34,24,21,26],[34,27,21,29],[34,28,21,30],[34,31,21,33],[34,32,21,34],[35,6,22,8],[35,10,22,12],[35,11,22,13,"packedInputs"],[35,23,22,25],[35,26,22,28],[35,30,22,32],[36,6,23,8],[36,10,23,12],[36,11,23,13,"packedOutput"],[36,23,23,25],[36,26,23,28],[36,30,23,32],[37,6,24,8],[37,12,24,14,"rank"],[37,16,24,18],[37,19,24,21,"xShape"],[37,25,24,27],[37,26,24,28,"length"],[37,32,24,34],[38,6,25,8],[38,10,25,12,"rank"],[38,14,25,16],[38,17,25,19],[38,18,25,20],[38,20,25,22],[39,8,26,12],[39,14,26,18],[39,18,26,22,"Error"],[39,23,26,27],[39,24,26,28],[39,58,26,62,"rank"],[39,62,26,66],[39,92,26,96],[39,93,26,97],[40,6,27,8],[41,6,28,8],[41,10,28,12],[41,11,28,13,"outputShape"],[41,22,28,24],[41,25,28,27,"xShape"],[41,31,28,33],[42,6,29,8],[42,12,29,14,"channels"],[42,20,29,22],[42,23,29,25],[42,27,29,25,"getChannels"],[42,40,29,36],[42,41,29,36,"getChannels"],[42,52,29,36],[42,54,29,37],[42,58,29,41],[42,60,29,43,"rank"],[42,64,29,47],[42,65,29,48],[43,6,30,8],[43,12,30,14,"nextColumn"],[43,22,30,24],[43,25,30,27],[43,28,30,30,"channels"],[43,36,30,38],[43,37,30,39,"rank"],[43,41,30,43],[43,44,30,46],[43,45,30,47],[43,46,30,48],[43,56,30,58],[43,60,30,62],[43,61,30,63,"outputShape"],[43,72,30,74],[43,73,30,75,"rank"],[43,77,30,79],[43,80,30,82],[43,81,30,83],[43,82,30,84],[43,84,30,86],[44,6,31,8],[44,12,31,14,"nextRow"],[44,19,31,21],[44,22,31,24],[44,25,31,27,"channels"],[44,33,31,35],[44,34,31,36,"rank"],[44,38,31,40],[44,41,31,43],[44,42,31,44],[44,43,31,45],[44,53,31,55],[44,57,31,59],[44,58,31,60,"outputShape"],[44,69,31,71],[44,70,31,72,"rank"],[44,74,31,76],[44,77,31,79],[44,78,31,80],[44,79,31,81],[44,81,31,83],[45,6,32,8],[45,12,32,14,"type"],[45,16,32,18],[45,19,32,21],[45,23,32,21,"getCoordsDataType"],[45,39,32,38],[45,40,32,38,"getCoordsDataType"],[45,57,32,38],[45,59,32,39,"rank"],[45,63,32,43],[45,64,32,44],[46,6,33,8],[46,10,33,12,"rank"],[46,14,33,16],[46,19,33,21],[46,20,33,22],[46,22,33,24],[47,8,34,12],[47,12,34,16],[47,13,34,17,"userCode"],[47,21,34,25],[47,24,34,28],[48,0,35,0],[49,0,36,0],[50,0,37,0],[51,0,38,0],[51,39,38,39,"xShape"],[51,45,38,45],[51,46,38,46],[51,47,38,47],[51,48,38,48],[52,0,39,0],[52,14,39,14,"xShape"],[52,20,39,20],[52,21,39,21],[52,22,39,22],[52,23,39,23],[53,0,40,0],[53,15,40,15,"nextColumn"],[53,25,40,25],[54,0,41,0],[54,43,41,43,"xShape"],[54,49,41,49],[54,50,41,50],[54,51,41,51],[54,52,41,52],[55,0,42,0],[55,18,42,18,"xShape"],[55,24,42,24],[55,25,42,25],[55,26,42,26],[55,27,42,27],[56,0,43,0],[57,0,44,0],[58,0,45,0],[59,0,46,0],[59,7,46,7],[60,6,47,8],[60,7,47,9],[60,13,48,13],[61,8,49,12],[61,12,49,16],[61,13,49,17,"userCode"],[61,21,49,25],[61,24,49,28],[62,0,50,0],[63,0,51,0],[63,12,51,12,"type"],[63,16,51,16],[64,0,52,0],[65,0,53,0],[65,23,53,23,"getR"],[65,27,53,27],[65,28,53,28,"channels"],[65,36,53,36],[65,37,53,37,"slice"],[65,42,53,42],[65,43,53,43],[65,44,53,44],[65,45,53,45],[66,0,54,0],[66,15,54,15,"nextColumn"],[66,25,54,25],[67,0,55,0],[67,25,55,25,"getG"],[67,29,55,29],[67,30,55,30,"channels"],[67,38,55,38],[67,39,55,39,"slice"],[67,44,55,44],[67,45,55,45],[67,46,55,46],[67,47,55,47],[68,0,56,0],[69,0,57,0],[69,15,57,15,"nextRow"],[69,22,57,22],[70,0,58,0],[70,25,58,25,"getB"],[70,29,58,29],[70,30,58,30,"channels"],[70,38,58,38],[70,39,58,39,"slice"],[70,44,58,44],[70,45,58,45],[70,46,58,46],[70,47,58,47],[71,0,59,0],[71,17,59,17,"nextColumn"],[71,27,59,27],[72,0,60,0],[72,27,60,27,"getA"],[72,31,60,31],[72,32,60,32,"channels"],[72,40,60,40],[72,41,60,41,"slice"],[72,46,60,46],[72,47,60,47],[72,48,60,48],[72,49,60,49],[73,0,61,0],[74,0,62,0],[75,0,63,0],[76,0,64,0],[77,0,65,0],[77,5,65,5],[78,6,66,8],[79,6,67,8],[79,15,67,17,"getR"],[79,19,67,21,"getR"],[79,20,67,22,"channels"],[79,28,67,30],[79,30,67,32],[80,8,68,12],[80,15,68,19,"getChannel"],[80,25,68,29],[80,26,68,30,"channels"],[80,34,68,38],[80,35,68,39],[81,6,69,8],[82,6,70,8],[82,15,70,17,"getG"],[82,19,70,21,"getG"],[82,20,70,22,"channels"],[82,28,70,30],[82,30,70,32],[83,8,71,12,"channels"],[83,16,71,20],[83,17,71,21,"rank"],[83,21,71,25],[83,24,71,28],[83,25,71,29],[83,26,71,30],[83,29,71,33],[83,32,71,36],[83,35,71,39,"channels"],[83,43,71,47],[83,44,71,48,"rank"],[83,48,71,52],[83,51,71,55],[83,52,71,56],[83,53,71,57],[83,56,71,60],[83,63,71,67],[84,8,72,12],[84,15,72,19,"getChannel"],[84,25,72,29],[84,26,72,30,"channels"],[84,34,72,38],[84,35,72,39],[85,6,73,8],[86,6,74,8],[86,15,74,17,"getB"],[86,19,74,21,"getB"],[86,20,74,22,"channels"],[86,28,74,30],[86,30,74,32],[87,8,75,12,"channels"],[87,16,75,20],[87,17,75,21,"rank"],[87,21,75,25],[87,24,75,28],[87,25,75,29],[87,26,75,30],[87,29,75,33],[87,32,75,36],[87,35,75,39,"channels"],[87,43,75,47],[87,44,75,48,"rank"],[87,48,75,52],[87,51,75,55],[87,52,75,56],[87,53,75,57],[87,56,75,60],[87,63,75,67],[88,8,76,12],[88,15,76,19,"getChannel"],[88,25,76,29],[88,26,76,30,"channels"],[88,34,76,38],[88,35,76,39],[89,6,77,8],[90,6,78,8],[90,15,78,17,"getA"],[90,19,78,21,"getA"],[90,20,78,22,"channels"],[90,28,78,30],[90,30,78,32],[91,8,79,12,"channels"],[91,16,79,20],[91,17,79,21,"rank"],[91,21,79,25],[91,24,79,28],[91,25,79,29],[91,26,79,30],[91,29,79,33],[91,32,79,36],[91,35,79,39,"channels"],[91,43,79,47],[91,44,79,48,"rank"],[91,48,79,52],[91,51,79,55],[91,52,79,56],[91,53,79,57],[91,56,79,60],[91,63,79,67],[92,8,80,12,"channels"],[92,16,80,20],[92,17,80,21,"rank"],[92,21,80,25],[92,24,80,28],[92,25,80,29],[92,26,80,30],[92,29,80,33],[92,32,80,36],[92,35,80,39,"channels"],[92,43,80,47],[92,44,80,48,"rank"],[92,48,80,52],[92,51,80,55],[92,52,80,56],[92,53,80,57],[92,56,80,60],[92,63,80,67],[93,8,81,12],[93,15,81,19,"getChannel"],[93,25,81,29],[93,26,81,30,"channels"],[93,34,81,38],[93,35,81,39],[94,6,82,8],[95,6,83,8],[95,15,83,17,"getChannel"],[95,25,83,27,"getChannel"],[95,26,83,28,"channels"],[95,34,83,36],[95,36,83,38],[96,8,84,12],[96,14,84,18,"inCoordsArray"],[96,27,84,31],[96,30,84,34,"xShape"],[96,36,84,40],[96,37,84,41,"map"],[96,40,84,44],[96,41,84,45],[96,42,84,46,"_"],[96,43,84,47],[96,45,84,49,"i"],[96,46,84,50],[96,51,84,55,"getInCoord"],[96,61,84,65],[96,62,84,66,"i"],[96,63,84,67],[96,65,84,69,"channels"],[96,73,84,77],[96,74,84,78],[96,75,84,79],[97,8,85,12],[97,14,85,18,"inCoords"],[97,22,85,26],[97,25,85,29,"inCoordsArray"],[97,38,85,42],[97,39,85,43,"join"],[97,43,85,47],[97,44,85,48],[97,47,85,51],[97,48,85,52],[98,8,86,12],[98,14,86,18,"innerDims"],[98,23,86,27],[98,26,86,30,"inCoordsArray"],[98,39,86,43],[98,40,86,44,"slice"],[98,45,86,49],[98,46,86,50],[98,47,86,51],[98,48,86,52],[98,49,86,53],[98,50,86,54,"join"],[98,54,86,58],[98,55,86,59],[98,58,86,62],[98,59,86,63],[99,8,87,12],[99,15,87,19],[99,34,87,38,"inCoords"],[99,42,87,46],[99,53,87,57,"innerDims"],[99,62,87,66],[99,66,87,70],[100,6,88,8],[101,6,89,8],[101,15,89,17,"getInCoord"],[101,25,89,27,"getInCoord"],[101,26,89,28,"i"],[101,27,89,29],[101,29,89,31,"channels1"],[101,38,89,40],[101,40,89,42],[102,8,90,12],[102,12,90,16,"axis"],[102,16,90,20],[102,17,90,21,"indexOf"],[102,24,90,28],[102,25,90,29,"i"],[102,26,90,30],[102,27,90,31],[102,32,90,36],[102,33,90,37],[102,34,90,38],[102,38,90,42,"xShape"],[102,44,90,48],[102,45,90,49,"i"],[102,46,90,50],[102,47,90,51],[102,52,90,56],[102,53,90,57],[102,55,90,59],[103,10,91,16],[103,17,91,23],[103,20,91,26,"xShape"],[103,26,91,32],[103,27,91,33,"i"],[103,28,91,34],[103,29,91,35],[103,35,91,41,"channels1"],[103,44,91,50],[103,45,91,51,"i"],[103,46,91,52],[103,47,91,53],[103,53,91,59],[104,8,92,12],[104,9,92,13],[104,15,93,17],[105,10,94,16],[105,17,94,23],[105,20,94,26,"channels1"],[105,29,94,35],[105,30,94,36,"i"],[105,31,94,37],[105,32,94,38],[105,34,94,40],[106,8,95,12],[107,6,96,8],[108,4,97,4],[109,2,98,0],[110,0,98,1],[110,3]],"functionMap":{"names":["<global>","ReversePackedProgram","ReversePackedProgram#constructor","getR","getG","getB","getA","getChannel","xShape.map$argument_0","getInCoord"],"mappings":"AAA;OCkB;ICC;QC+C;SDE;QEC;SFG;QGC;SHG;QIC;SJI;QKC;6CCC,iCD;SLI;QOC;SPO;KDC;CDC"},"hasCjsExports":false},"type":"js/module"}]}