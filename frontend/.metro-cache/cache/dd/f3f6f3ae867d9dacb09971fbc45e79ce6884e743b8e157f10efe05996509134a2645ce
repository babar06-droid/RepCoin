{"dependencies":[{"name":"../../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":56,"index":56}}],"key":"xfSGNGkCJdZhfQ673y/6d+no2yU=","exportNames":["*"],"imports":1}},{"name":"../../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":57},"end":{"line":2,"column":47,"index":104}}],"key":"OiLVMoS12Mp3xgHkQeTdnQIBX6Q=","exportNames":["*"],"imports":1}},{"name":"../loss_ops_utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":105},"end":{"line":3,"column":46,"index":151}}],"key":"DAPyQ0ldu7pmRn3jRz+wBfmq/uQ=","exportNames":["*"],"imports":1}},{"name":"../mul","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":152},"end":{"line":4,"column":29,"index":181}}],"key":"IV74B7MBUPoSZUTM5ocGXe9fIRE=","exportNames":["*"],"imports":1}},{"name":"../operation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":182},"end":{"line":5,"column":34,"index":216}}],"key":"fQilPqfSvhAHjyfKT0P4wel7jE4=","exportNames":["*"],"imports":1}},{"name":"../scalar","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":217},"end":{"line":6,"column":35,"index":252}}],"key":"u3TTm6Tdu30WLt+AMD6qMWu+U20=","exportNames":["*"],"imports":1}},{"name":"../sub","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":253},"end":{"line":7,"column":29,"index":282}}],"key":"VHM5JuAkEzgPhqMJH9y/GvrNozc=","exportNames":["*"],"imports":1}},{"name":"../sum","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":283},"end":{"line":8,"column":29,"index":312}}],"key":"iMzhCilxhON+Kq66I0CtH0j3scg=","exportNames":["*"],"imports":1}},{"name":"./compute_weighted_loss","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":313},"end":{"line":9,"column":62,"index":375}}],"key":"GQ6sNEw27lLpLYC7mByWPpwMOcY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"cosineDistance\", {\n    enumerable: true,\n    get: function () {\n      return cosineDistance;\n    }\n  });\n  var _tensor_util_env = require(_dependencyMap[0], \"../../tensor_util_env\");\n  var _util = require(_dependencyMap[1], \"../../util\");\n  var _loss_ops_utils = require(_dependencyMap[2], \"../loss_ops_utils\");\n  var _mul = require(_dependencyMap[3], \"../mul\");\n  var _operation = require(_dependencyMap[4], \"../operation\");\n  var _scalar = require(_dependencyMap[5], \"../scalar\");\n  var _sub = require(_dependencyMap[6], \"../sub\");\n  var _sum = require(_dependencyMap[7], \"../sum\");\n  var _compute_weighted_loss = require(_dependencyMap[8], \"./compute_weighted_loss\");\n  /**\n   * Computes the cosine distance loss between two tensors.\n   *\n   * @param labels The ground truth output tensor, same dimensions as\n   *    'predictions'.\n   * @param predictions The predicted outputs.\n   * @param axis The dimension along which the cosine distance is computed.\n   * @param weights Tensor whose rank is either 0, or the same rank as\n   *    `labels`, and must be broadcastable to `labels` (i.e., all dimensions\n   *    must be either `1`, or the same as the corresponding `losses`\n   *    dimension).\n   * @param reduction Type of reduction to apply to loss. Should be of type\n   *    `Reduction`\n   *\n   * @doc {heading: 'Training', subheading: 'Losses', namespace: 'losses'}\n   */\n  function cosineDistance_(labels, predictions, axis, weights, reduction = _loss_ops_utils.Reduction.SUM_BY_NONZERO_WEIGHTS) {\n    const $labels = (0, _tensor_util_env.convertToTensor)(labels, 'labels', 'cosineDistance');\n    const $predictions = (0, _tensor_util_env.convertToTensor)(predictions, 'predictions', 'cosineDistance');\n    let $weights = null;\n    if (weights != null) {\n      $weights = (0, _tensor_util_env.convertToTensor)(weights, 'weights', 'cosineDistance');\n    }\n    (0, _util.assertShapesMatch)($labels.shape, $predictions.shape, 'Error in cosineDistance: ');\n    const one = (0, _scalar.scalar)(1);\n    const losses = (0, _sub.sub)(one, (0, _sum.sum)((0, _mul.mul)($labels, $predictions), axis, true));\n    return (0, _compute_weighted_loss.computeWeightedLoss)(losses, $weights, reduction);\n  }\n  const cosineDistance = /* @__PURE__ */(0, _operation.op)({\n    cosineDistance_\n  });\n});","lineCount":53,"map":[[7,2,38,0,"Object"],[7,8,38,0],[7,9,38,0,"defineProperty"],[7,23,38,0],[7,24,38,0,"exports"],[7,31,38,0],[8,4,38,0,"enumerable"],[8,14,38,0],[9,4,38,0,"get"],[9,7,38,0],[9,18,38,0,"get"],[9,19,38,0],[10,6,38,0],[10,13,38,0,"cosineDistance"],[10,27,38,0],[11,4,38,0],[12,2,38,0],[13,2,1,0],[13,6,1,0,"_tensor_util_env"],[13,22,1,0],[13,25,1,0,"require"],[13,32,1,0],[13,33,1,0,"_dependencyMap"],[13,47,1,0],[14,2,2,0],[14,6,2,0,"_util"],[14,11,2,0],[14,14,2,0,"require"],[14,21,2,0],[14,22,2,0,"_dependencyMap"],[14,36,2,0],[15,2,3,0],[15,6,3,0,"_loss_ops_utils"],[15,21,3,0],[15,24,3,0,"require"],[15,31,3,0],[15,32,3,0,"_dependencyMap"],[15,46,3,0],[16,2,4,0],[16,6,4,0,"_mul"],[16,10,4,0],[16,13,4,0,"require"],[16,20,4,0],[16,21,4,0,"_dependencyMap"],[16,35,4,0],[17,2,5,0],[17,6,5,0,"_operation"],[17,16,5,0],[17,19,5,0,"require"],[17,26,5,0],[17,27,5,0,"_dependencyMap"],[17,41,5,0],[18,2,6,0],[18,6,6,0,"_scalar"],[18,13,6,0],[18,16,6,0,"require"],[18,23,6,0],[18,24,6,0,"_dependencyMap"],[18,38,6,0],[19,2,7,0],[19,6,7,0,"_sub"],[19,10,7,0],[19,13,7,0,"require"],[19,20,7,0],[19,21,7,0,"_dependencyMap"],[19,35,7,0],[20,2,8,0],[20,6,8,0,"_sum"],[20,10,8,0],[20,13,8,0,"require"],[20,20,8,0],[20,21,8,0,"_dependencyMap"],[20,35,8,0],[21,2,9,0],[21,6,9,0,"_compute_weighted_loss"],[21,28,9,0],[21,31,9,0,"require"],[21,38,9,0],[21,39,9,0,"_dependencyMap"],[21,53,9,0],[22,2,10,0],[23,0,11,0],[24,0,12,0],[25,0,13,0],[26,0,14,0],[27,0,15,0],[28,0,16,0],[29,0,17,0],[30,0,18,0],[31,0,19,0],[32,0,20,0],[33,0,21,0],[34,0,22,0],[35,0,23,0],[36,0,24,0],[37,0,25,0],[38,2,26,0],[38,11,26,9,"cosineDistance_"],[38,26,26,24,"cosineDistance_"],[38,27,26,25,"labels"],[38,33,26,31],[38,35,26,33,"predictions"],[38,46,26,44],[38,48,26,46,"axis"],[38,52,26,50],[38,54,26,52,"weights"],[38,61,26,59],[38,63,26,61,"reduction"],[38,72,26,70],[38,75,26,73,"Reduction"],[38,90,26,82],[38,91,26,82,"Reduction"],[38,100,26,82],[38,101,26,83,"SUM_BY_NONZERO_WEIGHTS"],[38,123,26,105],[38,125,26,107],[39,4,27,4],[39,10,27,10,"$labels"],[39,17,27,17],[39,20,27,20],[39,24,27,20,"convertToTensor"],[39,40,27,35],[39,41,27,35,"convertToTensor"],[39,56,27,35],[39,58,27,36,"labels"],[39,64,27,42],[39,66,27,44],[39,74,27,52],[39,76,27,54],[39,92,27,70],[39,93,27,71],[40,4,28,4],[40,10,28,10,"$predictions"],[40,22,28,22],[40,25,28,25],[40,29,28,25,"convertToTensor"],[40,45,28,40],[40,46,28,40,"convertToTensor"],[40,61,28,40],[40,63,28,41,"predictions"],[40,74,28,52],[40,76,28,54],[40,89,28,67],[40,91,28,69],[40,107,28,85],[40,108,28,86],[41,4,29,4],[41,8,29,8,"$weights"],[41,16,29,16],[41,19,29,19],[41,23,29,23],[42,4,30,4],[42,8,30,8,"weights"],[42,15,30,15],[42,19,30,19],[42,23,30,23],[42,25,30,25],[43,6,31,8,"$weights"],[43,14,31,16],[43,17,31,19],[43,21,31,19,"convertToTensor"],[43,37,31,34],[43,38,31,34,"convertToTensor"],[43,53,31,34],[43,55,31,35,"weights"],[43,62,31,42],[43,64,31,44],[43,73,31,53],[43,75,31,55],[43,91,31,71],[43,92,31,72],[44,4,32,4],[45,4,33,4],[45,8,33,4,"assertShapesMatch"],[45,13,33,21],[45,14,33,21,"assertShapesMatch"],[45,31,33,21],[45,33,33,22,"$labels"],[45,40,33,29],[45,41,33,30,"shape"],[45,46,33,35],[45,48,33,37,"$predictions"],[45,60,33,49],[45,61,33,50,"shape"],[45,66,33,55],[45,68,33,57],[45,95,33,84],[45,96,33,85],[46,4,34,4],[46,10,34,10,"one"],[46,13,34,13],[46,16,34,16],[46,20,34,16,"scalar"],[46,27,34,22],[46,28,34,22,"scalar"],[46,34,34,22],[46,36,34,23],[46,37,34,24],[46,38,34,25],[47,4,35,4],[47,10,35,10,"losses"],[47,16,35,16],[47,19,35,19],[47,23,35,19,"sub"],[47,27,35,22],[47,28,35,22,"sub"],[47,31,35,22],[47,33,35,23,"one"],[47,36,35,26],[47,38,35,28],[47,42,35,28,"sum"],[47,46,35,31],[47,47,35,31,"sum"],[47,50,35,31],[47,52,35,32],[47,56,35,32,"mul"],[47,60,35,35],[47,61,35,35,"mul"],[47,64,35,35],[47,66,35,36,"$labels"],[47,73,35,43],[47,75,35,45,"$predictions"],[47,87,35,57],[47,88,35,58],[47,90,35,60,"axis"],[47,94,35,64],[47,96,35,66],[47,100,35,70],[47,101,35,71],[47,102,35,72],[48,4,36,4],[48,11,36,11],[48,15,36,11,"computeWeightedLoss"],[48,37,36,30],[48,38,36,30,"computeWeightedLoss"],[48,57,36,30],[48,59,36,31,"losses"],[48,65,36,37],[48,67,36,39,"$weights"],[48,75,36,47],[48,77,36,49,"reduction"],[48,86,36,58],[48,87,36,59],[49,2,37,0],[50,2,38,7],[50,8,38,13,"cosineDistance"],[50,22,38,27],[50,25,38,30],[50,40,38,46],[50,44,38,46,"op"],[50,54,38,48],[50,55,38,48,"op"],[50,57,38,48],[50,59,38,49],[51,4,38,51,"cosineDistance_"],[52,2,38,67],[52,3,38,68],[52,4,38,69],[53,0,38,70],[53,3]],"functionMap":{"names":["<global>","cosineDistance_"],"mappings":"AAA;ACyB;CDW"},"hasCjsExports":false},"type":"js/module"}]}