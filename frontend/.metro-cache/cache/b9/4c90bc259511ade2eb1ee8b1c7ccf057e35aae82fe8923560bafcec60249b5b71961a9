{"dependencies":[{"name":"../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":53,"index":53}}],"key":"UCKDOr/oOGi3nbD26ZhyAVW61qk=","exportNames":["*"],"imports":1}},{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":54},"end":{"line":2,"column":32,"index":86}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}},{"name":"./conv2d","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":87},"end":{"line":3,"column":34,"index":121}}],"key":"oqJbny/3Y1K0NqrYfJ1Kp/oE/kg=","exportNames":["*"],"imports":1}},{"name":"./depthwise_conv2d","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":122},"end":{"line":4,"column":53,"index":175}}],"key":"ocAFG2rUbsqzzHGLVV62SkLq8A0=","exportNames":["*"],"imports":1}},{"name":"./operation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":176},"end":{"line":5,"column":33,"index":209}}],"key":"lmmEAb6oR3TWnrsrETceKUovfkM=","exportNames":["*"],"imports":1}},{"name":"./reshape","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":210},"end":{"line":6,"column":36,"index":246}}],"key":"dz8GCsFShMGnHX1Wj7bBySjBnSE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"separableConv2d\", {\n    enumerable: true,\n    get: function () {\n      return separableConv2d;\n    }\n  });\n  var _tensor_util_env = require(_dependencyMap[0], \"../tensor_util_env\");\n  var _util = require(_dependencyMap[1], \"../util\");\n  var util = _interopNamespace(_util);\n  var _conv2d = require(_dependencyMap[2], \"./conv2d\");\n  var _depthwise_conv2d = require(_dependencyMap[3], \"./depthwise_conv2d\");\n  var _operation = require(_dependencyMap[4], \"./operation\");\n  var _reshape = require(_dependencyMap[5], \"./reshape\");\n  /**\n   * 2-D convolution with separable filters.\n   *\n   * Performs a depthwise convolution that acts separately on channels followed\n   * by a pointwise convolution that mixes channels. Note that this is\n   * separability between dimensions [1, 2] and 3, not spatial separability\n   * between dimensions 1 and 2.\n   *\n   * See\n   * [https://www.tensorflow.org/api_docs/python/tf/nn/separable_conv2d](\n   *     https://www.tensorflow.org/api_docs/python/tf/nn/separable_conv2d)\n   * for more details.\n   *\n   * @param x The input tensor, of rank 4 or rank 3, of shape\n   *     `[batch, height, width, inChannels]`. If rank 3, batch of 1 is\n   * assumed.\n   * @param depthwiseFilter The depthwise filter tensor, rank 4, of shape\n   *     `[filterHeight, filterWidth, inChannels, channelMultiplier]`. This is\n   *     the filter used in the first step.\n   * @param pointwiseFilter The pointwise filter tensor, rank 4, of shape\n   *     `[1, 1, inChannels * channelMultiplier, outChannels]`. This is\n   *     the filter used in the second step.\n   * @param strides The strides of the convolution: `[strideHeight,\n   * strideWidth]`. If strides is a single number, then `strideHeight ==\n   * strideWidth`.\n   * @param pad The type of padding algorithm.\n   *   - `same` and stride 1: output will be of same size as input,\n   *       regardless of filter size.\n   *   - `valid`: output will be smaller than input if filter is larger\n   *       than 1x1.\n   *   - For more info, see this guide:\n   *     [https://www.tensorflow.org/api_docs/python/tf/nn/convolution](\n   *          https://www.tensorflow.org/api_docs/python/tf/nn/convolution)\n   * @param dilations The dilation rates: `[dilationHeight, dilationWidth]`\n   *     in which we sample input values across the height and width dimensions\n   *     in atrous convolution. Defaults to `[1, 1]`. If `rate` is a single\n   *     number, then `dilationHeight == dilationWidth`. If it is greater than\n   *     1, then all values of `strides` must be 1.\n   * @param dataFormat: An optional string from: \"NHWC\", \"NCHW\". Defaults to\n   *     \"NHWC\". Specify the data format of the input and output data. With the\n   *     default format \"NHWC\", the data is stored in the order of: [batch,\n   *     height, width, channels]. Only \"NHWC\" is currently supported.\n   *\n   * @doc {heading: 'Operations', subheading: 'Convolution'}\n   */\n  function separableConv2d_(x, depthwiseFilter, pointwiseFilter, strides, pad, dilation = [1, 1], dataFormat = 'NHWC') {\n    const $x = (0, _tensor_util_env.convertToTensor)(x, 'x', 'separableConv2d');\n    const $depthwiseFilter = (0, _tensor_util_env.convertToTensor)(depthwiseFilter, 'depthwiseFilter', 'separableConv2d');\n    const $pointwiseFilter = (0, _tensor_util_env.convertToTensor)(pointwiseFilter, 'pointwiseFilter', 'separableConv2d');\n    let x4D = $x;\n    let reshapedTo4D = false;\n    if ($x.rank === 3) {\n      reshapedTo4D = true;\n      x4D = (0, _reshape.reshape)($x, [1, $x.shape[0], $x.shape[1], $x.shape[2]]);\n    }\n    if (dataFormat === 'NCHW') {\n      throw new Error('separableConv2d currently does not support dataFormat NCHW; only ' + 'NHWC is supported');\n    }\n    util.assert(x4D.rank === 4, () => `Error in separableConv2d: input must be rank 4, but got ` + `rank ${x4D.rank}.`);\n    util.assert($depthwiseFilter.rank === 4, () => `Error in separableConv2d: depthwise filter must be rank 4, but ` + `got rank ${$depthwiseFilter.rank}.`);\n    util.assert($pointwiseFilter.rank === 4, () => `Error in separableConv2d: pointwise filter must be rank 4, but ` + `got rank ${$depthwiseFilter.rank}.`);\n    util.assert($pointwiseFilter.shape[0] === 1, () => `Error in separableConv2d: the first dimension of pointwise filter ` + ` must be 1, but got ${$pointwiseFilter.shape[0]}.`);\n    util.assert($pointwiseFilter.shape[1] === 1, () => `Error in separableConv2d: the second dimension of pointwise ` + `filter must be 1, but got ${$pointwiseFilter.shape[1]}.`);\n    const inChannels = $depthwiseFilter.shape[2];\n    const channelMultiplier = $depthwiseFilter.shape[3];\n    util.assert($pointwiseFilter.shape[2] === inChannels * channelMultiplier, () => `Error in separableConv2d: the third dimension of pointwise filter ` + `must be ${inChannels * channelMultiplier}, ` + `but got ${$pointwiseFilter.shape[2]}.`);\n    const depthwise = (0, _depthwise_conv2d.depthwiseConv2d)(x4D, $depthwiseFilter, strides, pad, dataFormat, dilation);\n    const pointwiseStride = 1;\n    const res = (0, _conv2d.conv2d)(depthwise, $pointwiseFilter, pointwiseStride, 'valid', dataFormat);\n    if (reshapedTo4D) {\n      return (0, _reshape.reshape)(res, [res.shape[1], res.shape[2], res.shape[3]]);\n    }\n    return res;\n  }\n  const separableConv2d = /* @__PURE__ */(0, _operation.op)({\n    separableConv2d_\n  });\n});","lineCount":112,"map":[[22,2,89,0,"Object"],[22,8,89,0],[22,9,89,0,"defineProperty"],[22,23,89,0],[22,24,89,0,"exports"],[22,31,89,0],[23,4,89,0,"enumerable"],[23,14,89,0],[24,4,89,0,"get"],[24,7,89,0],[24,18,89,0,"get"],[24,19,89,0],[25,6,89,0],[25,13,89,0,"separableConv2d"],[25,28,89,0],[26,4,89,0],[27,2,89,0],[28,2,1,0],[28,6,1,0,"_tensor_util_env"],[28,22,1,0],[28,25,1,0,"require"],[28,32,1,0],[28,33,1,0,"_dependencyMap"],[28,47,1,0],[29,2,2,0],[29,6,2,0,"_util"],[29,11,2,0],[29,14,2,0,"require"],[29,21,2,0],[29,22,2,0,"_dependencyMap"],[29,36,2,0],[30,2,2,0],[30,6,2,0,"util"],[30,10,2,0],[30,13,2,0,"_interopNamespace"],[30,30,2,0],[30,31,2,0,"_util"],[30,36,2,0],[31,2,3,0],[31,6,3,0,"_conv2d"],[31,13,3,0],[31,16,3,0,"require"],[31,23,3,0],[31,24,3,0,"_dependencyMap"],[31,38,3,0],[32,2,4,0],[32,6,4,0,"_depthwise_conv2d"],[32,23,4,0],[32,26,4,0,"require"],[32,33,4,0],[32,34,4,0,"_dependencyMap"],[32,48,4,0],[33,2,5,0],[33,6,5,0,"_operation"],[33,16,5,0],[33,19,5,0,"require"],[33,26,5,0],[33,27,5,0,"_dependencyMap"],[33,41,5,0],[34,2,6,0],[34,6,6,0,"_reshape"],[34,14,6,0],[34,17,6,0,"require"],[34,24,6,0],[34,25,6,0,"_dependencyMap"],[34,39,6,0],[35,2,7,0],[36,0,8,0],[37,0,9,0],[38,0,10,0],[39,0,11,0],[40,0,12,0],[41,0,13,0],[42,0,14,0],[43,0,15,0],[44,0,16,0],[45,0,17,0],[46,0,18,0],[47,0,19,0],[48,0,20,0],[49,0,21,0],[50,0,22,0],[51,0,23,0],[52,0,24,0],[53,0,25,0],[54,0,26,0],[55,0,27,0],[56,0,28,0],[57,0,29,0],[58,0,30,0],[59,0,31,0],[60,0,32,0],[61,0,33,0],[62,0,34,0],[63,0,35,0],[64,0,36,0],[65,0,37,0],[66,0,38,0],[67,0,39,0],[68,0,40,0],[69,0,41,0],[70,0,42,0],[71,0,43,0],[72,0,44,0],[73,0,45,0],[74,0,46,0],[75,0,47,0],[76,0,48,0],[77,0,49,0],[78,0,50,0],[79,0,51,0],[80,2,52,0],[80,11,52,9,"separableConv2d_"],[80,27,52,25,"separableConv2d_"],[80,28,52,26,"x"],[80,29,52,27],[80,31,52,29,"depthwiseFilter"],[80,46,52,44],[80,48,52,46,"pointwiseFilter"],[80,63,52,61],[80,65,52,63,"strides"],[80,72,52,70],[80,74,52,72,"pad"],[80,77,52,75],[80,79,52,77,"dilation"],[80,87,52,85],[80,90,52,88],[80,91,52,89],[80,92,52,90],[80,94,52,92],[80,95,52,93],[80,96,52,94],[80,98,52,96,"dataFormat"],[80,108,52,106],[80,111,52,109],[80,117,52,115],[80,119,52,117],[81,4,53,4],[81,10,53,10,"$x"],[81,12,53,12],[81,15,53,15],[81,19,53,15,"convertToTensor"],[81,35,53,30],[81,36,53,30,"convertToTensor"],[81,51,53,30],[81,53,53,31,"x"],[81,54,53,32],[81,56,53,34],[81,59,53,37],[81,61,53,39],[81,78,53,56],[81,79,53,57],[82,4,54,4],[82,10,54,10,"$depthwiseFilter"],[82,26,54,26],[82,29,54,29],[82,33,54,29,"convertToTensor"],[82,49,54,44],[82,50,54,44,"convertToTensor"],[82,65,54,44],[82,67,54,45,"depthwiseFilter"],[82,82,54,60],[82,84,54,62],[82,101,54,79],[82,103,54,81],[82,120,54,98],[82,121,54,99],[83,4,55,4],[83,10,55,10,"$pointwiseFilter"],[83,26,55,26],[83,29,55,29],[83,33,55,29,"convertToTensor"],[83,49,55,44],[83,50,55,44,"convertToTensor"],[83,65,55,44],[83,67,55,45,"pointwiseFilter"],[83,82,55,60],[83,84,55,62],[83,101,55,79],[83,103,55,81],[83,120,55,98],[83,121,55,99],[84,4,56,4],[84,8,56,8,"x4D"],[84,11,56,11],[84,14,56,14,"$x"],[84,16,56,16],[85,4,57,4],[85,8,57,8,"reshapedTo4D"],[85,20,57,20],[85,23,57,23],[85,28,57,28],[86,4,58,4],[86,8,58,8,"$x"],[86,10,58,10],[86,11,58,11,"rank"],[86,15,58,15],[86,20,58,20],[86,21,58,21],[86,23,58,23],[87,6,59,8,"reshapedTo4D"],[87,18,59,20],[87,21,59,23],[87,25,59,27],[88,6,60,8,"x4D"],[88,9,60,11],[88,12,60,14],[88,16,60,14,"reshape"],[88,24,60,21],[88,25,60,21,"reshape"],[88,32,60,21],[88,34,60,22,"$x"],[88,36,60,24],[88,38,60,26],[88,39,60,27],[88,40,60,28],[88,42,60,30,"$x"],[88,44,60,32],[88,45,60,33,"shape"],[88,50,60,38],[88,51,60,39],[88,52,60,40],[88,53,60,41],[88,55,60,43,"$x"],[88,57,60,45],[88,58,60,46,"shape"],[88,63,60,51],[88,64,60,52],[88,65,60,53],[88,66,60,54],[88,68,60,56,"$x"],[88,70,60,58],[88,71,60,59,"shape"],[88,76,60,64],[88,77,60,65],[88,78,60,66],[88,79,60,67],[88,80,60,68],[88,81,60,69],[89,4,61,4],[90,4,62,4],[90,8,62,8,"dataFormat"],[90,18,62,18],[90,23,62,23],[90,29,62,29],[90,31,62,31],[91,6,63,8],[91,12,63,14],[91,16,63,18,"Error"],[91,21,63,23],[91,22,63,24],[91,89,63,91],[91,92,64,12],[91,111,64,31],[91,112,64,32],[92,4,65,4],[93,4,66,4,"util"],[93,8,66,8],[93,9,66,9,"assert"],[93,15,66,15],[93,16,66,16,"x4D"],[93,19,66,19],[93,20,66,20,"rank"],[93,24,66,24],[93,29,66,29],[93,30,66,30],[93,32,66,32],[93,38,66,38],[93,96,66,96],[93,99,67,8],[93,107,67,16,"x4D"],[93,110,67,19],[93,111,67,20,"rank"],[93,115,67,24],[93,118,67,27],[93,119,67,28],[94,4,68,4,"util"],[94,8,68,8],[94,9,68,9,"assert"],[94,15,68,15],[94,16,68,16,"$depthwiseFilter"],[94,32,68,32],[94,33,68,33,"rank"],[94,37,68,37],[94,42,68,42],[94,43,68,43],[94,45,68,45],[94,51,68,51],[94,116,68,116],[94,119,69,8],[94,131,69,20,"$depthwiseFilter"],[94,147,69,36],[94,148,69,37,"rank"],[94,152,69,41],[94,155,69,44],[94,156,69,45],[95,4,70,4,"util"],[95,8,70,8],[95,9,70,9,"assert"],[95,15,70,15],[95,16,70,16,"$pointwiseFilter"],[95,32,70,32],[95,33,70,33,"rank"],[95,37,70,37],[95,42,70,42],[95,43,70,43],[95,45,70,45],[95,51,70,51],[95,116,70,116],[95,119,71,8],[95,131,71,20,"$depthwiseFilter"],[95,147,71,36],[95,148,71,37,"rank"],[95,152,71,41],[95,155,71,44],[95,156,71,45],[96,4,72,4,"util"],[96,8,72,8],[96,9,72,9,"assert"],[96,15,72,15],[96,16,72,16,"$pointwiseFilter"],[96,32,72,32],[96,33,72,33,"shape"],[96,38,72,38],[96,39,72,39],[96,40,72,40],[96,41,72,41],[96,46,72,46],[96,47,72,47],[96,49,72,49],[96,55,72,55],[96,123,72,123],[96,126,73,8],[96,149,73,31,"$pointwiseFilter"],[96,165,73,47],[96,166,73,48,"shape"],[96,171,73,53],[96,172,73,54],[96,173,73,55],[96,174,73,56],[96,177,73,59],[96,178,73,60],[97,4,74,4,"util"],[97,8,74,8],[97,9,74,9,"assert"],[97,15,74,15],[97,16,74,16,"$pointwiseFilter"],[97,32,74,32],[97,33,74,33,"shape"],[97,38,74,38],[97,39,74,39],[97,40,74,40],[97,41,74,41],[97,46,74,46],[97,47,74,47],[97,49,74,49],[97,55,74,55],[97,117,74,117],[97,120,75,8],[97,149,75,37,"$pointwiseFilter"],[97,165,75,53],[97,166,75,54,"shape"],[97,171,75,59],[97,172,75,60],[97,173,75,61],[97,174,75,62],[97,177,75,65],[97,178,75,66],[98,4,76,4],[98,10,76,10,"inChannels"],[98,20,76,20],[98,23,76,23,"$depthwiseFilter"],[98,39,76,39],[98,40,76,40,"shape"],[98,45,76,45],[98,46,76,46],[98,47,76,47],[98,48,76,48],[99,4,77,4],[99,10,77,10,"channelMultiplier"],[99,27,77,27],[99,30,77,30,"$depthwiseFilter"],[99,46,77,46],[99,47,77,47,"shape"],[99,52,77,52],[99,53,77,53],[99,54,77,54],[99,55,77,55],[100,4,78,4,"util"],[100,8,78,8],[100,9,78,9,"assert"],[100,15,78,15],[100,16,78,16,"$pointwiseFilter"],[100,32,78,32],[100,33,78,33,"shape"],[100,38,78,38],[100,39,78,39],[100,40,78,40],[100,41,78,41],[100,46,78,46,"inChannels"],[100,56,78,56],[100,59,78,59,"channelMultiplier"],[100,76,78,76],[100,78,78,78],[100,84,78,84],[100,152,78,152],[100,155,79,8],[100,166,79,19,"inChannels"],[100,176,79,29],[100,179,79,32,"channelMultiplier"],[100,196,79,49],[100,200,79,53],[100,203,80,8],[100,214,80,19,"$pointwiseFilter"],[100,230,80,35],[100,231,80,36,"shape"],[100,236,80,41],[100,237,80,42],[100,238,80,43],[100,239,80,44],[100,242,80,47],[100,243,80,48],[101,4,81,4],[101,10,81,10,"depthwise"],[101,19,81,19],[101,22,81,22],[101,26,81,22,"depthwiseConv2d"],[101,43,81,37],[101,44,81,37,"depthwiseConv2d"],[101,59,81,37],[101,61,81,38,"x4D"],[101,64,81,41],[101,66,81,43,"$depthwiseFilter"],[101,82,81,59],[101,84,81,61,"strides"],[101,91,81,68],[101,93,81,70,"pad"],[101,96,81,73],[101,98,81,75,"dataFormat"],[101,108,81,85],[101,110,81,87,"dilation"],[101,118,81,95],[101,119,81,96],[102,4,82,4],[102,10,82,10,"pointwiseStride"],[102,25,82,25],[102,28,82,28],[102,29,82,29],[103,4,83,4],[103,10,83,10,"res"],[103,13,83,13],[103,16,83,16],[103,20,83,16,"conv2d"],[103,27,83,22],[103,28,83,22,"conv2d"],[103,34,83,22],[103,36,83,23,"depthwise"],[103,45,83,32],[103,47,83,34,"$pointwiseFilter"],[103,63,83,50],[103,65,83,52,"pointwiseStride"],[103,80,83,67],[103,82,83,69],[103,89,83,76],[103,91,83,78,"dataFormat"],[103,101,83,88],[103,102,83,89],[104,4,84,4],[104,8,84,8,"reshapedTo4D"],[104,20,84,20],[104,22,84,22],[105,6,85,8],[105,13,85,15],[105,17,85,15,"reshape"],[105,25,85,22],[105,26,85,22,"reshape"],[105,33,85,22],[105,35,85,23,"res"],[105,38,85,26],[105,40,85,28],[105,41,85,29,"res"],[105,44,85,32],[105,45,85,33,"shape"],[105,50,85,38],[105,51,85,39],[105,52,85,40],[105,53,85,41],[105,55,85,43,"res"],[105,58,85,46],[105,59,85,47,"shape"],[105,64,85,52],[105,65,85,53],[105,66,85,54],[105,67,85,55],[105,69,85,57,"res"],[105,72,85,60],[105,73,85,61,"shape"],[105,78,85,66],[105,79,85,67],[105,80,85,68],[105,81,85,69],[105,82,85,70],[105,83,85,71],[106,4,86,4],[107,4,87,4],[107,11,87,11,"res"],[107,14,87,14],[108,2,88,0],[109,2,89,7],[109,8,89,13,"separableConv2d"],[109,23,89,28],[109,26,89,31],[109,41,89,47],[109,45,89,47,"op"],[109,55,89,49],[109,56,89,49,"op"],[109,58,89,49],[109,60,89,50],[110,4,89,52,"separableConv2d_"],[111,2,89,69],[111,3,89,70],[111,4,89,71],[112,0,89,72],[112,3]],"functionMap":{"names":["<global>","separableConv2d_","util.assert$argument_1"],"mappings":"AAA;ACmD;gCCc;2BDC;6CCC;4CDC;6CCC;4CDC;iDCC;2DDC;iDCC;iEDC;8ECG;+CDE;CDQ"},"hasCjsExports":false},"type":"js/module"}]}