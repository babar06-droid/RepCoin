{"dependencies":[{"name":"../engine","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":35,"index":738}}],"key":"zbTTi8rtwr8rjl75PzEo829Yvss=","exportNames":["*"],"imports":1}},{"name":"../globals","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":739},"end":{"line":18,"column":40,"index":779}}],"key":"rU7cy1Ex6BVXJU7MHjl4QiD+5lg=","exportNames":["*"],"imports":1}},{"name":"../ops/add","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":780},"end":{"line":19,"column":33,"index":813}}],"key":"7ECkFW8cIZ5BD7vBhwC0T14nXmk=","exportNames":["*"],"imports":1}},{"name":"../ops/mul","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":814},"end":{"line":20,"column":33,"index":847}}],"key":"8VMM/o0r3nOvGtT2jgKf2KxknFk=","exportNames":["*"],"imports":1}},{"name":"../ops/scalar","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":848},"end":{"line":21,"column":39,"index":887}}],"key":"rZXFtHeZMGskUzCIeY9ReIRgRNY=","exportNames":["*"],"imports":1}},{"name":"./optimizer","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":888},"end":{"line":22,"column":40,"index":928}}],"key":"hbQXeB4H5XapH+aEsxZCo0wGw68=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"SGDOptimizer\", {\n    enumerable: true,\n    get: function () {\n      return SGDOptimizer;\n    }\n  });\n  var _engine = require(_dependencyMap[0], \"../engine\");\n  var _globals = require(_dependencyMap[1], \"../globals\");\n  var _opsAdd = require(_dependencyMap[2], \"../ops/add\");\n  var _opsMul = require(_dependencyMap[3], \"../ops/mul\");\n  var _opsScalar = require(_dependencyMap[4], \"../ops/scalar\");\n  var _optimizer = require(_dependencyMap[5], \"./optimizer\");\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /** @doclink Optimizer */\n  class SGDOptimizer extends _optimizer.Optimizer {\n    /** @nocollapse */\n    static get className() {\n      // Name matters for Python compatibility.\n      // This is a getter instead of a property because when it's a property, it\n      // prevents the entire class from being tree-shaken.\n      return 'SGD';\n    }\n    constructor(learningRate) {\n      super();\n      this.learningRate = learningRate;\n      this.setLearningRate(learningRate);\n    }\n    applyGradients(variableGradients) {\n      const varNames = Array.isArray(variableGradients) ? variableGradients.map(v => v.name) : Object.keys(variableGradients);\n      varNames.forEach((name, i) => {\n        const gradient = Array.isArray(variableGradients) ? variableGradients[i].tensor : variableGradients[name];\n        if (gradient == null) {\n          return;\n        }\n        const value = _engine.ENGINE.registeredVariables[name];\n        (0, _globals.tidy)(() => {\n          const newValue = (0, _opsAdd.add)((0, _opsMul.mul)(this.c, gradient), value);\n          value.assign(newValue);\n        });\n      });\n      this.incrementIterations();\n    }\n    /**\n     * Sets the learning rate of the optimizer.\n     */\n    setLearningRate(learningRate) {\n      this.learningRate = learningRate;\n      if (this.c != null) {\n        this.c.dispose();\n      }\n      this.c = (0, _globals.keep)((0, _opsScalar.scalar)(-learningRate));\n    }\n    dispose() {\n      this.c.dispose();\n    }\n    async getWeights() {\n      return [await this.saveIterations()];\n    }\n    async setWeights(weightValues) {\n      weightValues = await this.extractIterations(weightValues);\n      if (weightValues.length !== 0) {\n        throw new Error('SGD optimizer does not have settable weights.');\n      }\n    }\n    getConfig() {\n      return {\n        'learningRate': this.learningRate\n      };\n    }\n    /** @nocollapse */\n    static fromConfig(cls, config) {\n      return new cls(config['learningRate']);\n    }\n  }\n});","lineCount":97,"map":[[7,2,24,0,"Object"],[7,8,24,0],[7,9,24,0,"defineProperty"],[7,23,24,0],[7,24,24,0,"exports"],[7,31,24,0],[8,4,24,0,"enumerable"],[8,14,24,0],[9,4,24,0,"get"],[9,7,24,0],[9,18,24,0,"get"],[9,19,24,0],[10,6,24,0],[10,13,24,0,"SGDOptimizer"],[10,25,24,0],[11,4,24,0],[12,2,24,0],[13,2,17,0],[13,6,17,0,"_engine"],[13,13,17,0],[13,16,17,0,"require"],[13,23,17,0],[13,24,17,0,"_dependencyMap"],[13,38,17,0],[14,2,18,0],[14,6,18,0,"_globals"],[14,14,18,0],[14,17,18,0,"require"],[14,24,18,0],[14,25,18,0,"_dependencyMap"],[14,39,18,0],[15,2,19,0],[15,6,19,0,"_opsAdd"],[15,13,19,0],[15,16,19,0,"require"],[15,23,19,0],[15,24,19,0,"_dependencyMap"],[15,38,19,0],[16,2,20,0],[16,6,20,0,"_opsMul"],[16,13,20,0],[16,16,20,0,"require"],[16,23,20,0],[16,24,20,0,"_dependencyMap"],[16,38,20,0],[17,2,21,0],[17,6,21,0,"_opsScalar"],[17,16,21,0],[17,19,21,0,"require"],[17,26,21,0],[17,27,21,0,"_dependencyMap"],[17,41,21,0],[18,2,22,0],[18,6,22,0,"_optimizer"],[18,16,22,0],[18,19,22,0,"require"],[18,26,22,0],[18,27,22,0,"_dependencyMap"],[18,41,22,0],[19,2,1,0],[20,0,2,0],[21,0,3,0],[22,0,4,0],[23,0,5,0],[24,0,6,0],[25,0,7,0],[26,0,8,0],[27,0,9,0],[28,0,10,0],[29,0,11,0],[30,0,12,0],[31,0,13,0],[32,0,14,0],[33,0,15,0],[34,0,16,0],[36,2,23,0],[37,2,24,7],[37,8,24,13,"SGDOptimizer"],[37,20,24,25],[37,29,24,34,"Optimizer"],[37,39,24,43],[37,40,24,43,"Optimizer"],[37,49,24,43],[37,50,24,44],[38,4,25,4],[39,4,26,4],[39,15,26,15,"className"],[39,24,26,24,"className"],[39,25,26,24],[39,27,26,27],[40,6,27,8],[41,6,28,8],[42,6,29,8],[43,6,30,8],[43,13,30,15],[43,18,30,20],[44,4,31,4],[45,4,32,4,"constructor"],[45,15,32,15,"constructor"],[45,16,32,16,"learningRate"],[45,28,32,28],[45,30,32,30],[46,6,33,8],[46,11,33,13],[46,12,33,14],[46,13,33,15],[47,6,34,8],[47,10,34,12],[47,11,34,13,"learningRate"],[47,23,34,25],[47,26,34,28,"learningRate"],[47,38,34,40],[48,6,35,8],[48,10,35,12],[48,11,35,13,"setLearningRate"],[48,26,35,28],[48,27,35,29,"learningRate"],[48,39,35,41],[48,40,35,42],[49,4,36,4],[50,4,37,4,"applyGradients"],[50,18,37,18,"applyGradients"],[50,19,37,19,"variableGradients"],[50,36,37,36],[50,38,37,38],[51,6,38,8],[51,12,38,14,"varNames"],[51,20,38,22],[51,23,38,25,"Array"],[51,28,38,30],[51,29,38,31,"isArray"],[51,36,38,38],[51,37,38,39,"variableGradients"],[51,54,38,56],[51,55,38,57],[51,58,39,12,"variableGradients"],[51,75,39,29],[51,76,39,30,"map"],[51,79,39,33],[51,80,39,34,"v"],[51,81,39,35],[51,85,39,39,"v"],[51,86,39,40],[51,87,39,41,"name"],[51,91,39,45],[51,92,39,46],[51,95,40,12,"Object"],[51,101,40,18],[51,102,40,19,"keys"],[51,106,40,23],[51,107,40,24,"variableGradients"],[51,124,40,41],[51,125,40,42],[52,6,41,8,"varNames"],[52,14,41,16],[52,15,41,17,"forEach"],[52,22,41,24],[52,23,41,25],[52,24,41,26,"name"],[52,28,41,30],[52,30,41,32,"i"],[52,31,41,33],[52,36,41,38],[53,8,42,12],[53,14,42,18,"gradient"],[53,22,42,26],[53,25,42,29,"Array"],[53,30,42,34],[53,31,42,35,"isArray"],[53,38,42,42],[53,39,42,43,"variableGradients"],[53,56,42,60],[53,57,42,61],[53,60,43,16,"variableGradients"],[53,77,43,33],[53,78,43,34,"i"],[53,79,43,35],[53,80,43,36],[53,81,43,37,"tensor"],[53,87,43,43],[53,90,44,16,"variableGradients"],[53,107,44,33],[53,108,44,34,"name"],[53,112,44,38],[53,113,44,39],[54,8,45,12],[54,12,45,16,"gradient"],[54,20,45,24],[54,24,45,28],[54,28,45,32],[54,30,45,34],[55,10,46,16],[56,8,47,12],[57,8,48,12],[57,14,48,18,"value"],[57,19,48,23],[57,22,48,26,"ENGINE"],[57,29,48,32],[57,30,48,32,"ENGINE"],[57,36,48,32],[57,37,48,33,"registeredVariables"],[57,56,48,52],[57,57,48,53,"name"],[57,61,48,57],[57,62,48,58],[58,8,49,12],[58,12,49,12,"tidy"],[58,20,49,16],[58,21,49,16,"tidy"],[58,25,49,16],[58,27,49,17],[58,33,49,23],[59,10,50,16],[59,16,50,22,"newValue"],[59,24,50,30],[59,27,50,33],[59,31,50,33,"add"],[59,38,50,36],[59,39,50,36,"add"],[59,42,50,36],[59,44,50,37],[59,48,50,37,"mul"],[59,55,50,40],[59,56,50,40,"mul"],[59,59,50,40],[59,61,50,41],[59,65,50,45],[59,66,50,46,"c"],[59,67,50,47],[59,69,50,49,"gradient"],[59,77,50,57],[59,78,50,58],[59,80,50,60,"value"],[59,85,50,65],[59,86,50,66],[60,10,51,16,"value"],[60,15,51,21],[60,16,51,22,"assign"],[60,22,51,28],[60,23,51,29,"newValue"],[60,31,51,37],[60,32,51,38],[61,8,52,12],[61,9,52,13],[61,10,52,14],[62,6,53,8],[62,7,53,9],[62,8,53,10],[63,6,54,8],[63,10,54,12],[63,11,54,13,"incrementIterations"],[63,30,54,32],[63,31,54,33],[63,32,54,34],[64,4,55,4],[65,4,56,4],[66,0,57,0],[67,0,58,0],[68,4,59,4,"setLearningRate"],[68,19,59,19,"setLearningRate"],[68,20,59,20,"learningRate"],[68,32,59,32],[68,34,59,34],[69,6,60,8],[69,10,60,12],[69,11,60,13,"learningRate"],[69,23,60,25],[69,26,60,28,"learningRate"],[69,38,60,40],[70,6,61,8],[70,10,61,12],[70,14,61,16],[70,15,61,17,"c"],[70,16,61,18],[70,20,61,22],[70,24,61,26],[70,26,61,28],[71,8,62,12],[71,12,62,16],[71,13,62,17,"c"],[71,14,62,18],[71,15,62,19,"dispose"],[71,22,62,26],[71,23,62,27],[71,24,62,28],[72,6,63,8],[73,6,64,8],[73,10,64,12],[73,11,64,13,"c"],[73,12,64,14],[73,15,64,17],[73,19,64,17,"keep"],[73,27,64,21],[73,28,64,21,"keep"],[73,32,64,21],[73,34,64,22],[73,38,64,22,"scalar"],[73,48,64,28],[73,49,64,28,"scalar"],[73,55,64,28],[73,57,64,29],[73,58,64,30,"learningRate"],[73,70,64,42],[73,71,64,43],[73,72,64,44],[74,4,65,4],[75,4,66,4,"dispose"],[75,11,66,11,"dispose"],[75,12,66,11],[75,14,66,14],[76,6,67,8],[76,10,67,12],[76,11,67,13,"c"],[76,12,67,14],[76,13,67,15,"dispose"],[76,20,67,22],[76,21,67,23],[76,22,67,24],[77,4,68,4],[78,4,69,4],[78,10,69,10,"getWeights"],[78,20,69,20,"getWeights"],[78,21,69,20],[78,23,69,23],[79,6,70,8],[79,13,70,15],[79,14,70,16],[79,20,70,22],[79,24,70,26],[79,25,70,27,"saveIterations"],[79,39,70,41],[79,40,70,42],[79,41,70,43],[79,42,70,44],[80,4,71,4],[81,4,72,4],[81,10,72,10,"setWeights"],[81,20,72,20,"setWeights"],[81,21,72,21,"weightValues"],[81,33,72,33],[81,35,72,35],[82,6,73,8,"weightValues"],[82,18,73,20],[82,21,73,23],[82,27,73,29],[82,31,73,33],[82,32,73,34,"extractIterations"],[82,49,73,51],[82,50,73,52,"weightValues"],[82,62,73,64],[82,63,73,65],[83,6,74,8],[83,10,74,12,"weightValues"],[83,22,74,24],[83,23,74,25,"length"],[83,29,74,31],[83,34,74,36],[83,35,74,37],[83,37,74,39],[84,8,75,12],[84,14,75,18],[84,18,75,22,"Error"],[84,23,75,27],[84,24,75,28],[84,71,75,75],[84,72,75,76],[85,6,76,8],[86,4,77,4],[87,4,78,4,"getConfig"],[87,13,78,13,"getConfig"],[87,14,78,13],[87,16,78,16],[88,6,79,8],[88,13,79,15],[89,8,79,17],[89,22,79,31],[89,24,79,33],[89,28,79,37],[89,29,79,38,"learningRate"],[90,6,79,51],[90,7,79,52],[91,4,80,4],[92,4,81,4],[93,4,82,4],[93,11,82,11,"fromConfig"],[93,21,82,21,"fromConfig"],[93,22,82,22,"cls"],[93,25,82,25],[93,27,82,27,"config"],[93,33,82,33],[93,35,82,35],[94,6,83,8],[94,13,83,15],[94,17,83,19,"cls"],[94,20,83,22],[94,21,83,23,"config"],[94,27,83,29],[94,28,83,30],[94,42,83,44],[94,43,83,45],[94,44,83,46],[95,4,84,4],[96,2,85,0],[97,0,85,1],[97,3]],"functionMap":{"names":["<global>","SGDOptimizer","SGDOptimizer.get__className","SGDOptimizer#constructor","SGDOptimizer#applyGradients","variableGradients.map$argument_0","varNames.forEach$argument_0","tidy$argument_0","SGDOptimizer#setLearningRate","SGDOptimizer#dispose","SGDOptimizer#getWeights","SGDOptimizer#setWeights","SGDOptimizer#getConfig","SGDOptimizer.fromConfig"],"mappings":"AAA;OCuB;ICE;KDK;IEC;KFI;IGC;kCCE,WD;yBEE;iBCQ;aDG;SFC;KHE;IOI;KPM;IQC;KRE;ISC;KTE;IUC;KVK;IWC;KXE;IYE;KZE;CDC"},"hasCjsExports":false},"type":"js/module"}]}