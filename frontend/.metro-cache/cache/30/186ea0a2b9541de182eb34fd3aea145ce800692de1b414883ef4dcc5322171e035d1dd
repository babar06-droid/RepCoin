{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":104,"index":807}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":808},"end":{"line":18,"column":47,"index":855}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.depthwiseConv2dNativeBackpropFilter = depthwiseConv2dNativeBackpropFilter;\n  Object.defineProperty(exports, \"depthwiseConv2dNativeBackpropFilterConfig\", {\n    enumerable: true,\n    get: function () {\n      return depthwiseConv2dNativeBackpropFilterConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function depthwiseConv2dNativeBackpropFilter(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x,\n      dy\n    } = inputs;\n    const {\n      strides,\n      dilations,\n      pad,\n      dimRoundingMode,\n      filterShape\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)([x, dy], 'depthwiseConv2dNativeBackpropFilter');\n    const convInfo = _tensorflowTfjsCore.backend_util.computeConv2DInfo(x.shape, filterShape, strides, dilations, pad, dimRoundingMode, true /* depthwise */);\n    const {\n      strideHeight,\n      strideWidth,\n      filterHeight,\n      filterWidth\n    } = convInfo;\n    const dW = new _tensorflowTfjsCore.TensorBuffer(convInfo.filterShape, 'float32');\n    const leftPad = convInfo.padInfo.left;\n    const topPad = convInfo.padInfo.top;\n    const chMul = convInfo.outChannels / convInfo.inChannels;\n    const xVals = backend.data.get(x.dataId).values;\n    const xBuf = new _tensorflowTfjsCore.TensorBuffer(x.shape, x.dtype, xVals);\n    const dyVals = backend.data.get(dy.dataId).values;\n    const dyBuf = new _tensorflowTfjsCore.TensorBuffer(dy.shape, dy.dtype, dyVals);\n    for (let wR = 0; wR < filterHeight; ++wR) {\n      const yRMin = Math.max(0, Math.ceil((topPad - wR) / strideHeight));\n      const yRMax = Math.min(convInfo.outHeight, (convInfo.inHeight + topPad - wR) / strideHeight);\n      for (let wC = 0; wC < filterWidth; ++wC) {\n        const yCMin = Math.max(0, Math.ceil((leftPad - wC) / strideWidth));\n        const yCMax = Math.min(convInfo.outWidth, (convInfo.inWidth + leftPad - wC) / strideWidth);\n        for (let d2 = 0; d2 < convInfo.outChannels; ++d2) {\n          const d1 = Math.trunc(d2 / chMul);\n          const dm = d2 % chMul;\n          let dotProd = 0;\n          for (let b = 0; b < convInfo.batchSize; ++b) {\n            for (let yR = yRMin; yR < yRMax; ++yR) {\n              const xR = wR + yR * strideHeight - topPad;\n              for (let yC = yCMin; yC < yCMax; ++yC) {\n                const xC = wC + yC * strideWidth - leftPad;\n                dotProd += xBuf.get(b, xR, xC, d1) * dyBuf.get(b, yR, yC, d2);\n              }\n            }\n          }\n          dW.set(dotProd, wR, wC, d1, dm);\n        }\n      }\n    }\n    return backend.makeTensorInfo(dW.shape, dW.dtype, dW.values);\n  }\n  const depthwiseConv2dNativeBackpropFilterConfig = {\n    kernelName: _tensorflowTfjsCore.DepthwiseConv2dNativeBackpropFilter,\n    backendName: 'cpu',\n    kernelFunc: depthwiseConv2dNativeBackpropFilter\n  };\n});","lineCount":96,"map":[[7,2,19,0,"exports"],[7,9,19,0],[7,10,19,0,"depthwiseConv2dNativeBackpropFilter"],[7,45,19,0],[7,48,19,0,"depthwiseConv2dNativeBackpropFilter"],[7,83,19,0],[8,2,60,0,"Object"],[8,8,60,0],[8,9,60,0,"defineProperty"],[8,23,60,0],[8,24,60,0,"exports"],[8,31,60,0],[9,4,60,0,"enumerable"],[9,14,60,0],[10,4,60,0,"get"],[10,7,60,0],[10,18,60,0,"get"],[10,19,60,0],[11,6,60,0],[11,13,60,0,"depthwiseConv2dNativeBackpropFilterConfig"],[11,54,60,0],[12,4,60,0],[13,2,60,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[25,0,10,0],[26,0,11,0],[27,0,12,0],[28,0,13,0],[29,0,14,0],[30,0,15,0],[31,0,16,0],[33,2,19,7],[33,11,19,16,"depthwiseConv2dNativeBackpropFilter"],[33,46,19,51,"depthwiseConv2dNativeBackpropFilter"],[33,47,19,52,"args"],[33,51,19,56],[33,53,19,58],[34,4,20,4],[34,10,20,10],[35,6,20,12,"inputs"],[35,12,20,18],[36,6,20,20,"backend"],[36,13,20,27],[37,6,20,29,"attrs"],[38,4,20,35],[38,5,20,36],[38,8,20,39,"args"],[38,12,20,43],[39,4,21,4],[39,10,21,10],[40,6,21,12,"x"],[40,7,21,13],[41,6,21,15,"dy"],[42,4,21,18],[42,5,21,19],[42,8,21,22,"inputs"],[42,14,21,28],[43,4,22,4],[43,10,22,10],[44,6,22,12,"strides"],[44,13,22,19],[45,6,22,21,"dilations"],[45,15,22,30],[46,6,22,32,"pad"],[46,9,22,35],[47,6,22,37,"dimRoundingMode"],[47,21,22,52],[48,6,22,54,"filterShape"],[49,4,22,66],[49,5,22,67],[49,8,22,70,"attrs"],[49,13,22,75],[50,4,23,4],[50,8,23,4,"assertNotComplex"],[50,17,23,20],[50,18,23,20,"assertNotComplex"],[50,34,23,20],[50,36,23,21],[50,37,23,22,"x"],[50,38,23,23],[50,40,23,25,"dy"],[50,42,23,27],[50,43,23,28],[50,45,23,30],[50,82,23,67],[50,83,23,68],[51,4,24,4],[51,10,24,10,"convInfo"],[51,18,24,18],[51,21,24,21,"backend_util"],[51,40,24,33],[51,41,24,33,"backend_util"],[51,53,24,33],[51,54,24,34,"computeConv2DInfo"],[51,71,24,51],[51,72,24,52,"x"],[51,73,24,53],[51,74,24,54,"shape"],[51,79,24,59],[51,81,24,61,"filterShape"],[51,92,24,72],[51,94,24,74,"strides"],[51,101,24,81],[51,103,24,83,"dilations"],[51,112,24,92],[51,114,24,94,"pad"],[51,117,24,97],[51,119,24,99,"dimRoundingMode"],[51,134,24,114],[51,136,24,116],[51,140,24,120],[51,141,24,121],[51,156,24,136],[51,157,24,137],[52,4,25,4],[52,10,25,10],[53,6,25,12,"strideHeight"],[53,18,25,24],[54,6,25,26,"strideWidth"],[54,17,25,37],[55,6,25,39,"filterHeight"],[55,18,25,51],[56,6,25,53,"filterWidth"],[57,4,25,65],[57,5,25,66],[57,8,25,69,"convInfo"],[57,16,25,77],[58,4,26,4],[58,10,26,10,"dW"],[58,12,26,12],[58,15,26,15],[58,19,26,19,"TensorBuffer"],[58,38,26,31],[58,39,26,31,"TensorBuffer"],[58,51,26,31],[58,52,26,32,"convInfo"],[58,60,26,40],[58,61,26,41,"filterShape"],[58,72,26,52],[58,74,26,54],[58,83,26,63],[58,84,26,64],[59,4,27,4],[59,10,27,10,"leftPad"],[59,17,27,17],[59,20,27,20,"convInfo"],[59,28,27,28],[59,29,27,29,"padInfo"],[59,36,27,36],[59,37,27,37,"left"],[59,41,27,41],[60,4,28,4],[60,10,28,10,"topPad"],[60,16,28,16],[60,19,28,19,"convInfo"],[60,27,28,27],[60,28,28,28,"padInfo"],[60,35,28,35],[60,36,28,36,"top"],[60,39,28,39],[61,4,29,4],[61,10,29,10,"chMul"],[61,15,29,15],[61,18,29,18,"convInfo"],[61,26,29,26],[61,27,29,27,"outChannels"],[61,38,29,38],[61,41,29,41,"convInfo"],[61,49,29,49],[61,50,29,50,"inChannels"],[61,60,29,60],[62,4,30,4],[62,10,30,10,"xVals"],[62,15,30,15],[62,18,30,18,"backend"],[62,25,30,25],[62,26,30,26,"data"],[62,30,30,30],[62,31,30,31,"get"],[62,34,30,34],[62,35,30,35,"x"],[62,36,30,36],[62,37,30,37,"dataId"],[62,43,30,43],[62,44,30,44],[62,45,30,45,"values"],[62,51,30,51],[63,4,31,4],[63,10,31,10,"xBuf"],[63,14,31,14],[63,17,31,17],[63,21,31,21,"TensorBuffer"],[63,40,31,33],[63,41,31,33,"TensorBuffer"],[63,53,31,33],[63,54,31,34,"x"],[63,55,31,35],[63,56,31,36,"shape"],[63,61,31,41],[63,63,31,43,"x"],[63,64,31,44],[63,65,31,45,"dtype"],[63,70,31,50],[63,72,31,52,"xVals"],[63,77,31,57],[63,78,31,58],[64,4,32,4],[64,10,32,10,"dyVals"],[64,16,32,16],[64,19,32,19,"backend"],[64,26,32,26],[64,27,32,27,"data"],[64,31,32,31],[64,32,32,32,"get"],[64,35,32,35],[64,36,32,36,"dy"],[64,38,32,38],[64,39,32,39,"dataId"],[64,45,32,45],[64,46,32,46],[64,47,32,47,"values"],[64,53,32,53],[65,4,33,4],[65,10,33,10,"dyBuf"],[65,15,33,15],[65,18,33,18],[65,22,33,22,"TensorBuffer"],[65,41,33,34],[65,42,33,34,"TensorBuffer"],[65,54,33,34],[65,55,33,35,"dy"],[65,57,33,37],[65,58,33,38,"shape"],[65,63,33,43],[65,65,33,45,"dy"],[65,67,33,47],[65,68,33,48,"dtype"],[65,73,33,53],[65,75,33,55,"dyVals"],[65,81,33,61],[65,82,33,62],[66,4,34,4],[66,9,34,9],[66,13,34,13,"wR"],[66,15,34,15],[66,18,34,18],[66,19,34,19],[66,21,34,21,"wR"],[66,23,34,23],[66,26,34,26,"filterHeight"],[66,38,34,38],[66,40,34,40],[66,42,34,42,"wR"],[66,44,34,44],[66,46,34,46],[67,6,35,8],[67,12,35,14,"yRMin"],[67,17,35,19],[67,20,35,22,"Math"],[67,24,35,26],[67,25,35,27,"max"],[67,28,35,30],[67,29,35,31],[67,30,35,32],[67,32,35,34,"Math"],[67,36,35,38],[67,37,35,39,"ceil"],[67,41,35,43],[67,42,35,44],[67,43,35,45,"topPad"],[67,49,35,51],[67,52,35,54,"wR"],[67,54,35,56],[67,58,35,60,"strideHeight"],[67,70,35,72],[67,71,35,73],[67,72,35,74],[68,6,36,8],[68,12,36,14,"yRMax"],[68,17,36,19],[68,20,36,22,"Math"],[68,24,36,26],[68,25,36,27,"min"],[68,28,36,30],[68,29,36,31,"convInfo"],[68,37,36,39],[68,38,36,40,"outHeight"],[68,47,36,49],[68,49,36,51],[68,50,36,52,"convInfo"],[68,58,36,60],[68,59,36,61,"inHeight"],[68,67,36,69],[68,70,36,72,"topPad"],[68,76,36,78],[68,79,36,81,"wR"],[68,81,36,83],[68,85,36,87,"strideHeight"],[68,97,36,99],[68,98,36,100],[69,6,37,8],[69,11,37,13],[69,15,37,17,"wC"],[69,17,37,19],[69,20,37,22],[69,21,37,23],[69,23,37,25,"wC"],[69,25,37,27],[69,28,37,30,"filterWidth"],[69,39,37,41],[69,41,37,43],[69,43,37,45,"wC"],[69,45,37,47],[69,47,37,49],[70,8,38,12],[70,14,38,18,"yCMin"],[70,19,38,23],[70,22,38,26,"Math"],[70,26,38,30],[70,27,38,31,"max"],[70,30,38,34],[70,31,38,35],[70,32,38,36],[70,34,38,38,"Math"],[70,38,38,42],[70,39,38,43,"ceil"],[70,43,38,47],[70,44,38,48],[70,45,38,49,"leftPad"],[70,52,38,56],[70,55,38,59,"wC"],[70,57,38,61],[70,61,38,65,"strideWidth"],[70,72,38,76],[70,73,38,77],[70,74,38,78],[71,8,39,12],[71,14,39,18,"yCMax"],[71,19,39,23],[71,22,39,26,"Math"],[71,26,39,30],[71,27,39,31,"min"],[71,30,39,34],[71,31,39,35,"convInfo"],[71,39,39,43],[71,40,39,44,"outWidth"],[71,48,39,52],[71,50,39,54],[71,51,39,55,"convInfo"],[71,59,39,63],[71,60,39,64,"inWidth"],[71,67,39,71],[71,70,39,74,"leftPad"],[71,77,39,81],[71,80,39,84,"wC"],[71,82,39,86],[71,86,39,90,"strideWidth"],[71,97,39,101],[71,98,39,102],[72,8,40,12],[72,13,40,17],[72,17,40,21,"d2"],[72,19,40,23],[72,22,40,26],[72,23,40,27],[72,25,40,29,"d2"],[72,27,40,31],[72,30,40,34,"convInfo"],[72,38,40,42],[72,39,40,43,"outChannels"],[72,50,40,54],[72,52,40,56],[72,54,40,58,"d2"],[72,56,40,60],[72,58,40,62],[73,10,41,16],[73,16,41,22,"d1"],[73,18,41,24],[73,21,41,27,"Math"],[73,25,41,31],[73,26,41,32,"trunc"],[73,31,41,37],[73,32,41,38,"d2"],[73,34,41,40],[73,37,41,43,"chMul"],[73,42,41,48],[73,43,41,49],[74,10,42,16],[74,16,42,22,"dm"],[74,18,42,24],[74,21,42,27,"d2"],[74,23,42,29],[74,26,42,32,"chMul"],[74,31,42,37],[75,10,43,16],[75,14,43,20,"dotProd"],[75,21,43,27],[75,24,43,30],[75,25,43,31],[76,10,44,16],[76,15,44,21],[76,19,44,25,"b"],[76,20,44,26],[76,23,44,29],[76,24,44,30],[76,26,44,32,"b"],[76,27,44,33],[76,30,44,36,"convInfo"],[76,38,44,44],[76,39,44,45,"batchSize"],[76,48,44,54],[76,50,44,56],[76,52,44,58,"b"],[76,53,44,59],[76,55,44,61],[77,12,45,20],[77,17,45,25],[77,21,45,29,"yR"],[77,23,45,31],[77,26,45,34,"yRMin"],[77,31,45,39],[77,33,45,41,"yR"],[77,35,45,43],[77,38,45,46,"yRMax"],[77,43,45,51],[77,45,45,53],[77,47,45,55,"yR"],[77,49,45,57],[77,51,45,59],[78,14,46,24],[78,20,46,30,"xR"],[78,22,46,32],[78,25,46,35,"wR"],[78,27,46,37],[78,30,46,40,"yR"],[78,32,46,42],[78,35,46,45,"strideHeight"],[78,47,46,57],[78,50,46,60,"topPad"],[78,56,46,66],[79,14,47,24],[79,19,47,29],[79,23,47,33,"yC"],[79,25,47,35],[79,28,47,38,"yCMin"],[79,33,47,43],[79,35,47,45,"yC"],[79,37,47,47],[79,40,47,50,"yCMax"],[79,45,47,55],[79,47,47,57],[79,49,47,59,"yC"],[79,51,47,61],[79,53,47,63],[80,16,48,28],[80,22,48,34,"xC"],[80,24,48,36],[80,27,48,39,"wC"],[80,29,48,41],[80,32,48,44,"yC"],[80,34,48,46],[80,37,48,49,"strideWidth"],[80,48,48,60],[80,51,48,63,"leftPad"],[80,58,48,70],[81,16,49,28,"dotProd"],[81,23,49,35],[81,27,49,39,"xBuf"],[81,31,49,43],[81,32,49,44,"get"],[81,35,49,47],[81,36,49,48,"b"],[81,37,49,49],[81,39,49,51,"xR"],[81,41,49,53],[81,43,49,55,"xC"],[81,45,49,57],[81,47,49,59,"d1"],[81,49,49,61],[81,50,49,62],[81,53,50,32,"dyBuf"],[81,58,50,37],[81,59,50,38,"get"],[81,62,50,41],[81,63,50,42,"b"],[81,64,50,43],[81,66,50,45,"yR"],[81,68,50,47],[81,70,50,49,"yC"],[81,72,50,51],[81,74,50,53,"d2"],[81,76,50,55],[81,77,50,56],[82,14,51,24],[83,12,52,20],[84,10,53,16],[85,10,54,16,"dW"],[85,12,54,18],[85,13,54,19,"set"],[85,16,54,22],[85,17,54,23,"dotProd"],[85,24,54,30],[85,26,54,32,"wR"],[85,28,54,34],[85,30,54,36,"wC"],[85,32,54,38],[85,34,54,40,"d1"],[85,36,54,42],[85,38,54,44,"dm"],[85,40,54,46],[85,41,54,47],[86,8,55,12],[87,6,56,8],[88,4,57,4],[89,4,58,4],[89,11,58,11,"backend"],[89,18,58,18],[89,19,58,19,"makeTensorInfo"],[89,33,58,33],[89,34,58,34,"dW"],[89,36,58,36],[89,37,58,37,"shape"],[89,42,58,42],[89,44,58,44,"dW"],[89,46,58,46],[89,47,58,47,"dtype"],[89,52,58,52],[89,54,58,54,"dW"],[89,56,58,56],[89,57,58,57,"values"],[89,63,58,63],[89,64,58,64],[90,2,59,0],[91,2,60,7],[91,8,60,13,"depthwiseConv2dNativeBackpropFilterConfig"],[91,49,60,54],[91,52,60,57],[92,4,61,4,"kernelName"],[92,14,61,14],[92,16,61,16,"DepthwiseConv2dNativeBackpropFilter"],[92,35,61,51],[92,36,61,51,"DepthwiseConv2dNativeBackpropFilter"],[92,71,61,51],[93,4,62,4,"backendName"],[93,15,62,15],[93,17,62,17],[93,22,62,22],[94,4,63,4,"kernelFunc"],[94,14,63,14],[94,16,63,16,"depthwiseConv2dNativeBackpropFilter"],[95,2,64,0],[95,3,64,1],[96,0,64,2],[96,3]],"functionMap":{"names":["<global>","depthwiseConv2dNativeBackpropFilter"],"mappings":"AAA;OCkB;CDwC"},"hasCjsExports":false},"type":"js/module"}]}