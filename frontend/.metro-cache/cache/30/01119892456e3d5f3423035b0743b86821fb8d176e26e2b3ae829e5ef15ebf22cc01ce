{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":69,"index":772}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../gather_nd_gpu","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":773},"end":{"line":18,"column":51,"index":824}}],"key":"QX9SzxOGl9FdGsXcJI21eySQwOw=","exportNames":["*"],"imports":1}},{"name":"../kernel_utils/shared","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":825},"end":{"line":19,"column":57,"index":882}}],"key":"JzS9qfQGP0NvwhobUV8d6bPV3h4=","exportNames":["*"],"imports":1}},{"name":"./Reshape","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":883},"end":{"line":20,"column":36,"index":919}}],"key":"EUWK+oKi/AwokPOQ1jng5DYfQSc=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.gatherNd = gatherNd;\n  Object.defineProperty(exports, \"gatherNdConfig\", {\n    enumerable: true,\n    get: function () {\n      return gatherNdConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _gather_nd_gpu = require(_dependencyMap[1], \"../gather_nd_gpu\");\n  var _kernel_utilsShared = require(_dependencyMap[2], \"../kernel_utils/shared\");\n  var _Reshape = require(_dependencyMap[3], \"./Reshape\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function gatherNd(args) {\n    const {\n      inputs,\n      backend\n    } = args;\n    const {\n      params,\n      indices\n    } = inputs;\n    const indicesShape = indices.shape;\n    const sliceRank = indicesShape[indicesShape.length - 1];\n    const paramsSize = _tensorflowTfjsCore.util.sizeFromShape(params.shape);\n    const [resultShape, numSlices, sliceSize, strides] = _tensorflowTfjsCore.backend_util.prepareAndValidate(params, indices);\n    const flattenIndices = (0, _Reshape.reshape)({\n      inputs: {\n        x: indices\n      },\n      backend,\n      attrs: {\n        shape: [numSlices, sliceRank]\n      }\n    });\n    const flattenX = (0, _Reshape.reshape)({\n      inputs: {\n        x: params\n      },\n      backend,\n      attrs: {\n        shape: [_tensorflowTfjsCore.util.sizeFromShape(params.shape) / sliceSize, sliceSize]\n      }\n    });\n    if (backend.shouldExecuteOnCPU([params, indices]) || params.dtype === 'string') {\n      const indicesData = backend.readSync(indices.dataId);\n      const paramsBuf = backend.bufferSync(params);\n      const outValue = (0, _kernel_utilsShared.gatherNdImplCPU)(indicesData, paramsBuf, params.dtype, numSlices, sliceRank, sliceSize, strides, params.shape, paramsSize);\n      return backend.makeTensorInfo(resultShape, params.dtype, outValue.values);\n    }\n    const program = new _gather_nd_gpu.GatherNDProgram(sliceRank, strides, [numSlices, sliceSize], params.shape);\n    const res = backend.runWebGLProgram(program, [flattenX, flattenIndices], flattenX.dtype);\n    const reshaped = (0, _Reshape.reshape)({\n      inputs: {\n        x: res\n      },\n      backend,\n      attrs: {\n        shape: resultShape\n      }\n    });\n    backend.disposeIntermediateTensorInfo(flattenIndices);\n    backend.disposeIntermediateTensorInfo(flattenX);\n    backend.disposeIntermediateTensorInfo(res);\n    return reshaped;\n  }\n  const gatherNdConfig = {\n    kernelName: _tensorflowTfjsCore.GatherNd,\n    backendName: 'webgl',\n    kernelFunc: gatherNd\n  };\n});","lineCount":93,"map":[[7,2,21,0,"exports"],[7,9,21,0],[7,10,21,0,"gatherNd"],[7,18,21,0],[7,21,21,0,"gatherNd"],[7,29,21,0],[8,2,49,0,"Object"],[8,8,49,0],[8,9,49,0,"defineProperty"],[8,23,49,0],[8,24,49,0,"exports"],[8,31,49,0],[9,4,49,0,"enumerable"],[9,14,49,0],[10,4,49,0,"get"],[10,7,49,0],[10,18,49,0,"get"],[10,19,49,0],[11,6,49,0],[11,13,49,0,"gatherNdConfig"],[11,27,49,0],[12,4,49,0],[13,2,49,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_gather_nd_gpu"],[15,20,18,0],[15,23,18,0,"require"],[15,30,18,0],[15,31,18,0,"_dependencyMap"],[15,45,18,0],[16,2,19,0],[16,6,19,0,"_kernel_utilsShared"],[16,25,19,0],[16,28,19,0,"require"],[16,35,19,0],[16,36,19,0,"_dependencyMap"],[16,50,19,0],[17,2,20,0],[17,6,20,0,"_Reshape"],[17,14,20,0],[17,17,20,0,"require"],[17,24,20,0],[17,25,20,0,"_dependencyMap"],[17,39,20,0],[18,2,1,0],[19,0,2,0],[20,0,3,0],[21,0,4,0],[22,0,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[35,2,21,7],[35,11,21,16,"gatherNd"],[35,19,21,24,"gatherNd"],[35,20,21,25,"args"],[35,24,21,29],[35,26,21,31],[36,4,22,4],[36,10,22,10],[37,6,22,12,"inputs"],[37,12,22,18],[38,6,22,20,"backend"],[39,4,22,28],[39,5,22,29],[39,8,22,32,"args"],[39,12,22,36],[40,4,23,4],[40,10,23,10],[41,6,23,12,"params"],[41,12,23,18],[42,6,23,20,"indices"],[43,4,23,28],[43,5,23,29],[43,8,23,32,"inputs"],[43,14,23,38],[44,4,24,4],[44,10,24,10,"indicesShape"],[44,22,24,22],[44,25,24,25,"indices"],[44,32,24,32],[44,33,24,33,"shape"],[44,38,24,38],[45,4,25,4],[45,10,25,10,"sliceRank"],[45,19,25,19],[45,22,25,22,"indicesShape"],[45,34,25,34],[45,35,25,35,"indicesShape"],[45,47,25,47],[45,48,25,48,"length"],[45,54,25,54],[45,57,25,57],[45,58,25,58],[45,59,25,59],[46,4,26,4],[46,10,26,10,"paramsSize"],[46,20,26,20],[46,23,26,23,"util"],[46,42,26,27],[46,43,26,27,"util"],[46,47,26,27],[46,48,26,28,"sizeFromShape"],[46,61,26,41],[46,62,26,42,"params"],[46,68,26,48],[46,69,26,49,"shape"],[46,74,26,54],[46,75,26,55],[47,4,27,4],[47,10,27,10],[47,11,27,11,"resultShape"],[47,22,27,22],[47,24,27,24,"numSlices"],[47,33,27,33],[47,35,27,35,"sliceSize"],[47,44,27,44],[47,46,27,46,"strides"],[47,53,27,53],[47,54,27,54],[47,57,27,57,"backend_util"],[47,76,27,69],[47,77,27,69,"backend_util"],[47,89,27,69],[47,90,27,70,"prepareAndValidate"],[47,108,27,88],[47,109,27,89,"params"],[47,115,27,95],[47,117,27,97,"indices"],[47,124,27,104],[47,125,27,105],[48,4,28,4],[48,10,28,10,"flattenIndices"],[48,24,28,24],[48,27,28,27],[48,31,28,27,"reshape"],[48,39,28,34],[48,40,28,34,"reshape"],[48,47,28,34],[48,49,28,35],[49,6,28,37,"inputs"],[49,12,28,43],[49,14,28,45],[50,8,28,47,"x"],[50,9,28,48],[50,11,28,50,"indices"],[51,6,28,58],[51,7,28,59],[52,6,28,61,"backend"],[52,13,28,68],[53,6,28,70,"attrs"],[53,11,28,75],[53,13,28,77],[54,8,28,79,"shape"],[54,13,28,84],[54,15,28,86],[54,16,28,87,"numSlices"],[54,25,28,96],[54,27,28,98,"sliceRank"],[54,36,28,107],[55,6,28,109],[56,4,28,111],[56,5,28,112],[56,6,28,113],[57,4,29,4],[57,10,29,10,"flattenX"],[57,18,29,18],[57,21,29,21],[57,25,29,21,"reshape"],[57,33,29,28],[57,34,29,28,"reshape"],[57,41,29,28],[57,43,29,29],[58,6,30,8,"inputs"],[58,12,30,14],[58,14,30,16],[59,8,30,18,"x"],[59,9,30,19],[59,11,30,21,"params"],[60,6,30,28],[60,7,30,29],[61,6,31,8,"backend"],[61,13,31,15],[62,6,32,8,"attrs"],[62,11,32,13],[62,13,32,15],[63,8,32,17,"shape"],[63,13,32,22],[63,15,32,24],[63,16,32,26,"util"],[63,35,32,30],[63,36,32,30,"util"],[63,40,32,30],[63,41,32,31,"sizeFromShape"],[63,54,32,44],[63,55,32,45,"params"],[63,61,32,51],[63,62,32,52,"shape"],[63,67,32,57],[63,68,32,58],[63,71,32,61,"sliceSize"],[63,80,32,70],[63,82,32,73,"sliceSize"],[63,91,32,82],[64,6,32,84],[65,4,33,4],[65,5,33,5],[65,6,33,6],[66,4,34,4],[66,8,34,8,"backend"],[66,15,34,15],[66,16,34,16,"shouldExecuteOnCPU"],[66,34,34,34],[66,35,34,35],[66,36,34,36,"params"],[66,42,34,42],[66,44,34,44,"indices"],[66,51,34,51],[66,52,34,52],[66,53,34,53],[66,57,35,8,"params"],[66,63,35,14],[66,64,35,15,"dtype"],[66,69,35,20],[66,74,35,25],[66,82,35,33],[66,84,35,35],[67,6,36,8],[67,12,36,14,"indicesData"],[67,23,36,25],[67,26,36,28,"backend"],[67,33,36,35],[67,34,36,36,"readSync"],[67,42,36,44],[67,43,36,45,"indices"],[67,50,36,52],[67,51,36,53,"dataId"],[67,57,36,59],[67,58,36,60],[68,6,37,8],[68,12,37,14,"paramsBuf"],[68,21,37,23],[68,24,37,26,"backend"],[68,31,37,33],[68,32,37,34,"bufferSync"],[68,42,37,44],[68,43,37,45,"params"],[68,49,37,51],[68,50,37,52],[69,6,38,8],[69,12,38,14,"outValue"],[69,20,38,22],[69,23,38,25],[69,27,38,25,"gatherNdImplCPU"],[69,46,38,40],[69,47,38,40,"gatherNdImplCPU"],[69,62,38,40],[69,64,38,41,"indicesData"],[69,75,38,52],[69,77,38,54,"paramsBuf"],[69,86,38,63],[69,88,38,65,"params"],[69,94,38,71],[69,95,38,72,"dtype"],[69,100,38,77],[69,102,38,79,"numSlices"],[69,111,38,88],[69,113,38,90,"sliceRank"],[69,122,38,99],[69,124,38,101,"sliceSize"],[69,133,38,110],[69,135,38,112,"strides"],[69,142,38,119],[69,144,38,121,"params"],[69,150,38,127],[69,151,38,128,"shape"],[69,156,38,133],[69,158,38,135,"paramsSize"],[69,168,38,145],[69,169,38,146],[70,6,39,8],[70,13,39,15,"backend"],[70,20,39,22],[70,21,39,23,"makeTensorInfo"],[70,35,39,37],[70,36,39,38,"resultShape"],[70,47,39,49],[70,49,39,51,"params"],[70,55,39,57],[70,56,39,58,"dtype"],[70,61,39,63],[70,63,39,65,"outValue"],[70,71,39,73],[70,72,39,74,"values"],[70,78,39,80],[70,79,39,81],[71,4,40,4],[72,4,41,4],[72,10,41,10,"program"],[72,17,41,17],[72,20,41,20],[72,24,41,24,"GatherNDProgram"],[72,38,41,39],[72,39,41,39,"GatherNDProgram"],[72,54,41,39],[72,55,41,40,"sliceRank"],[72,64,41,49],[72,66,41,51,"strides"],[72,73,41,58],[72,75,41,60],[72,76,41,61,"numSlices"],[72,85,41,70],[72,87,41,72,"sliceSize"],[72,96,41,81],[72,97,41,82],[72,99,41,84,"params"],[72,105,41,90],[72,106,41,91,"shape"],[72,111,41,96],[72,112,41,97],[73,4,42,4],[73,10,42,10,"res"],[73,13,42,13],[73,16,42,16,"backend"],[73,23,42,23],[73,24,42,24,"runWebGLProgram"],[73,39,42,39],[73,40,42,40,"program"],[73,47,42,47],[73,49,42,49],[73,50,42,50,"flattenX"],[73,58,42,58],[73,60,42,60,"flattenIndices"],[73,74,42,74],[73,75,42,75],[73,77,42,77,"flattenX"],[73,85,42,85],[73,86,42,86,"dtype"],[73,91,42,91],[73,92,42,92],[74,4,43,4],[74,10,43,10,"reshaped"],[74,18,43,18],[74,21,43,21],[74,25,43,21,"reshape"],[74,33,43,28],[74,34,43,28,"reshape"],[74,41,43,28],[74,43,43,29],[75,6,43,31,"inputs"],[75,12,43,37],[75,14,43,39],[76,8,43,41,"x"],[76,9,43,42],[76,11,43,44,"res"],[77,6,43,48],[77,7,43,49],[78,6,43,51,"backend"],[78,13,43,58],[79,6,43,60,"attrs"],[79,11,43,65],[79,13,43,67],[80,8,43,69,"shape"],[80,13,43,74],[80,15,43,76,"resultShape"],[81,6,43,88],[82,4,43,90],[82,5,43,91],[82,6,43,92],[83,4,44,4,"backend"],[83,11,44,11],[83,12,44,12,"disposeIntermediateTensorInfo"],[83,41,44,41],[83,42,44,42,"flattenIndices"],[83,56,44,56],[83,57,44,57],[84,4,45,4,"backend"],[84,11,45,11],[84,12,45,12,"disposeIntermediateTensorInfo"],[84,41,45,41],[84,42,45,42,"flattenX"],[84,50,45,50],[84,51,45,51],[85,4,46,4,"backend"],[85,11,46,11],[85,12,46,12,"disposeIntermediateTensorInfo"],[85,41,46,41],[85,42,46,42,"res"],[85,45,46,45],[85,46,46,46],[86,4,47,4],[86,11,47,11,"reshaped"],[86,19,47,19],[87,2,48,0],[88,2,49,7],[88,8,49,13,"gatherNdConfig"],[88,22,49,27],[88,25,49,30],[89,4,50,4,"kernelName"],[89,14,50,14],[89,16,50,16,"GatherNd"],[89,35,50,24],[89,36,50,24,"GatherNd"],[89,44,50,24],[90,4,51,4,"backendName"],[90,15,51,15],[90,17,51,17],[90,24,51,24],[91,4,52,4,"kernelFunc"],[91,14,52,14],[91,16,52,16,"gatherNd"],[92,2,53,0],[92,3,53,1],[93,0,53,2],[93,3]],"functionMap":{"names":["<global>","gatherNd"],"mappings":"AAA;OCoB;CD2B"},"hasCjsExports":false},"type":"js/module"}]}