{"dependencies":[{"name":"../../engine","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":38,"index":741}}],"key":"v39fFCcPTN6kCKPiVEOA5hKbvfQ=","exportNames":["*"],"imports":1}},{"name":"../../kernel_names","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":742},"end":{"line":18,"column":57,"index":799}}],"key":"rL3QmnnDJzxi3tNgrJ9K3IiMDQ8=","exportNames":["*"],"imports":1}},{"name":"../../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":800},"end":{"line":19,"column":56,"index":856}}],"key":"xfSGNGkCJdZhfQ673y/6d+no2yU=","exportNames":["*"],"imports":1}},{"name":"../nonmax_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":857},"end":{"line":20,"column":55,"index":912}}],"key":"0KlOSQQJQ4cKLKTcUmdRliPcibs=","exportNames":["*"],"imports":1}},{"name":"../operation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":913},"end":{"line":21,"column":34,"index":947}}],"key":"fQilPqfSvhAHjyfKT0P4wel7jE4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"nonMaxSuppressionWithScore\", {\n    enumerable: true,\n    get: function () {\n      return nonMaxSuppressionWithScore;\n    }\n  });\n  var _engine = require(_dependencyMap[0], \"../../engine\");\n  var _kernel_names = require(_dependencyMap[1], \"../../kernel_names\");\n  var _tensor_util_env = require(_dependencyMap[2], \"../../tensor_util_env\");\n  var _nonmax_util = require(_dependencyMap[3], \"../nonmax_util\");\n  var _operation = require(_dependencyMap[4], \"../operation\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * Performs non maximum suppression of bounding boxes based on\n   * iou (intersection over union).\n   *\n   * This op also supports a Soft-NMS mode (cf.\n   * Bodla et al, https://arxiv.org/abs/1704.04503) where boxes reduce the score\n   * of other overlapping boxes, therefore favoring different regions of the image\n   * with high scores. To enable this Soft-NMS mode, set the `softNmsSigma`\n   * parameter to be larger than 0.\n   *\n   * @param boxes a 2d tensor of shape `[numBoxes, 4]`. Each entry is\n   *     `[y1, x1, y2, x2]`, where `(y1, x1)` and `(y2, x2)` are the corners of\n   *     the bounding box.\n   * @param scores a 1d tensor providing the box scores of shape `[numBoxes]`.\n   * @param maxOutputSize The maximum number of boxes to be selected.\n   * @param iouThreshold A float representing the threshold for deciding whether\n   *     boxes overlap too much with respect to IOU. Must be between [0, 1].\n   *     Defaults to 0.5 (50% box overlap).\n   * @param scoreThreshold A threshold for deciding when to remove boxes based\n   *     on score. Defaults to -inf, which means any score is accepted.\n   * @param softNmsSigma A float representing the sigma parameter for Soft NMS.\n   *     When sigma is 0, it falls back to nonMaxSuppression.\n   * @return A map with the following properties:\n   *     - selectedIndices: A 1D tensor with the selected box indices.\n   *     - selectedScores: A 1D tensor with the corresponding scores for each\n   *       selected box.\n   *\n   * @doc {heading: 'Operations', subheading: 'Images', namespace: 'image'}\n   */\n  function nonMaxSuppressionWithScore_(boxes, scores, maxOutputSize, iouThreshold = 0.5, scoreThreshold = Number.NEGATIVE_INFINITY, softNmsSigma = 0.0) {\n    const $boxes = (0, _tensor_util_env.convertToTensor)(boxes, 'boxes', 'nonMaxSuppression');\n    const $scores = (0, _tensor_util_env.convertToTensor)(scores, 'scores', 'nonMaxSuppression');\n    const params = (0, _nonmax_util.nonMaxSuppSanityCheck)($boxes, $scores, maxOutputSize, iouThreshold, scoreThreshold, softNmsSigma);\n    maxOutputSize = params.maxOutputSize;\n    iouThreshold = params.iouThreshold;\n    scoreThreshold = params.scoreThreshold;\n    softNmsSigma = params.softNmsSigma;\n    const inputs = {\n      boxes: $boxes,\n      scores: $scores\n    };\n    const attrs = {\n      maxOutputSize,\n      iouThreshold,\n      scoreThreshold,\n      softNmsSigma\n    };\n    // tslint:disable-next-line: no-unnecessary-type-assertion\n    const result = _engine.ENGINE.runKernel(_kernel_names.NonMaxSuppressionV5, inputs, attrs);\n    return {\n      selectedIndices: result[0],\n      selectedScores: result[1]\n    };\n  }\n  const nonMaxSuppressionWithScore = /* @__PURE__ */(0, _operation.op)({\n    nonMaxSuppressionWithScore_\n  });\n});","lineCount":92,"map":[[7,2,65,0,"Object"],[7,8,65,0],[7,9,65,0,"defineProperty"],[7,23,65,0],[7,24,65,0,"exports"],[7,31,65,0],[8,4,65,0,"enumerable"],[8,14,65,0],[9,4,65,0,"get"],[9,7,65,0],[9,18,65,0,"get"],[9,19,65,0],[10,6,65,0],[10,13,65,0,"nonMaxSuppressionWithScore"],[10,39,65,0],[11,4,65,0],[12,2,65,0],[13,2,17,0],[13,6,17,0,"_engine"],[13,13,17,0],[13,16,17,0,"require"],[13,23,17,0],[13,24,17,0,"_dependencyMap"],[13,38,17,0],[14,2,18,0],[14,6,18,0,"_kernel_names"],[14,19,18,0],[14,22,18,0,"require"],[14,29,18,0],[14,30,18,0,"_dependencyMap"],[14,44,18,0],[15,2,19,0],[15,6,19,0,"_tensor_util_env"],[15,22,19,0],[15,25,19,0,"require"],[15,32,19,0],[15,33,19,0,"_dependencyMap"],[15,47,19,0],[16,2,20,0],[16,6,20,0,"_nonmax_util"],[16,18,20,0],[16,21,20,0,"require"],[16,28,20,0],[16,29,20,0,"_dependencyMap"],[16,43,20,0],[17,2,21,0],[17,6,21,0,"_operation"],[17,16,21,0],[17,19,21,0,"require"],[17,26,21,0],[17,27,21,0,"_dependencyMap"],[17,41,21,0],[18,2,1,0],[19,0,2,0],[20,0,3,0],[21,0,4,0],[22,0,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[35,2,22,0],[36,0,23,0],[37,0,24,0],[38,0,25,0],[39,0,26,0],[40,0,27,0],[41,0,28,0],[42,0,29,0],[43,0,30,0],[44,0,31,0],[45,0,32,0],[46,0,33,0],[47,0,34,0],[48,0,35,0],[49,0,36,0],[50,0,37,0],[51,0,38,0],[52,0,39,0],[53,0,40,0],[54,0,41,0],[55,0,42,0],[56,0,43,0],[57,0,44,0],[58,0,45,0],[59,0,46,0],[60,0,47,0],[61,0,48,0],[62,0,49,0],[63,0,50,0],[64,2,51,0],[64,11,51,9,"nonMaxSuppressionWithScore_"],[64,38,51,36,"nonMaxSuppressionWithScore_"],[64,39,51,37,"boxes"],[64,44,51,42],[64,46,51,44,"scores"],[64,52,51,50],[64,54,51,52,"maxOutputSize"],[64,67,51,65],[64,69,51,67,"iouThreshold"],[64,81,51,79],[64,84,51,82],[64,87,51,85],[64,89,51,87,"scoreThreshold"],[64,103,51,101],[64,106,51,104,"Number"],[64,112,51,110],[64,113,51,111,"NEGATIVE_INFINITY"],[64,130,51,128],[64,132,51,130,"softNmsSigma"],[64,144,51,142],[64,147,51,145],[64,150,51,148],[64,152,51,150],[65,4,52,4],[65,10,52,10,"$boxes"],[65,16,52,16],[65,19,52,19],[65,23,52,19,"convertToTensor"],[65,39,52,34],[65,40,52,34,"convertToTensor"],[65,55,52,34],[65,57,52,35,"boxes"],[65,62,52,40],[65,64,52,42],[65,71,52,49],[65,73,52,51],[65,92,52,70],[65,93,52,71],[66,4,53,4],[66,10,53,10,"$scores"],[66,17,53,17],[66,20,53,20],[66,24,53,20,"convertToTensor"],[66,40,53,35],[66,41,53,35,"convertToTensor"],[66,56,53,35],[66,58,53,36,"scores"],[66,64,53,42],[66,66,53,44],[66,74,53,52],[66,76,53,54],[66,95,53,73],[66,96,53,74],[67,4,54,4],[67,10,54,10,"params"],[67,16,54,16],[67,19,54,19],[67,23,54,19,"nonMaxSuppSanityCheck"],[67,35,54,40],[67,36,54,40,"nonMaxSuppSanityCheck"],[67,57,54,40],[67,59,54,41,"$boxes"],[67,65,54,47],[67,67,54,49,"$scores"],[67,74,54,56],[67,76,54,58,"maxOutputSize"],[67,89,54,71],[67,91,54,73,"iouThreshold"],[67,103,54,85],[67,105,54,87,"scoreThreshold"],[67,119,54,101],[67,121,54,103,"softNmsSigma"],[67,133,54,115],[67,134,54,116],[68,4,55,4,"maxOutputSize"],[68,17,55,17],[68,20,55,20,"params"],[68,26,55,26],[68,27,55,27,"maxOutputSize"],[68,40,55,40],[69,4,56,4,"iouThreshold"],[69,16,56,16],[69,19,56,19,"params"],[69,25,56,25],[69,26,56,26,"iouThreshold"],[69,38,56,38],[70,4,57,4,"scoreThreshold"],[70,18,57,18],[70,21,57,21,"params"],[70,27,57,27],[70,28,57,28,"scoreThreshold"],[70,42,57,42],[71,4,58,4,"softNmsSigma"],[71,16,58,16],[71,19,58,19,"params"],[71,25,58,25],[71,26,58,26,"softNmsSigma"],[71,38,58,38],[72,4,59,4],[72,10,59,10,"inputs"],[72,16,59,16],[72,19,59,19],[73,6,59,21,"boxes"],[73,11,59,26],[73,13,59,28,"$boxes"],[73,19,59,34],[74,6,59,36,"scores"],[74,12,59,42],[74,14,59,44,"$scores"],[75,4,59,52],[75,5,59,53],[76,4,60,4],[76,10,60,10,"attrs"],[76,15,60,15],[76,18,60,18],[77,6,60,20,"maxOutputSize"],[77,19,60,33],[78,6,60,35,"iouThreshold"],[78,18,60,47],[79,6,60,49,"scoreThreshold"],[79,20,60,63],[80,6,60,65,"softNmsSigma"],[81,4,60,78],[81,5,60,79],[82,4,61,4],[83,4,62,4],[83,10,62,10,"result"],[83,16,62,16],[83,19,62,19,"ENGINE"],[83,26,62,25],[83,27,62,25,"ENGINE"],[83,33,62,25],[83,34,62,26,"runKernel"],[83,43,62,35],[83,44,62,36,"NonMaxSuppressionV5"],[83,57,62,55],[83,58,62,55,"NonMaxSuppressionV5"],[83,77,62,55],[83,79,62,57,"inputs"],[83,85,62,63],[83,87,62,65,"attrs"],[83,92,62,70],[83,93,62,71],[84,4,63,4],[84,11,63,11],[85,6,63,13,"selectedIndices"],[85,21,63,28],[85,23,63,30,"result"],[85,29,63,36],[85,30,63,37],[85,31,63,38],[85,32,63,39],[86,6,63,41,"selectedScores"],[86,20,63,55],[86,22,63,57,"result"],[86,28,63,63],[86,29,63,64],[86,30,63,65],[87,4,63,67],[87,5,63,68],[88,2,64,0],[89,2,65,7],[89,8,65,13,"nonMaxSuppressionWithScore"],[89,34,65,39],[89,37,65,42],[89,52,65,58],[89,56,65,58,"op"],[89,66,65,60],[89,67,65,60,"op"],[89,69,65,60],[89,71,65,61],[90,4,65,63,"nonMaxSuppressionWithScore_"],[91,2,65,91],[91,3,65,92],[91,4,65,93],[92,0,65,94],[92,3]],"functionMap":{"names":["<global>","nonMaxSuppressionWithScore_"],"mappings":"AAA;ACkD;CDa"},"hasCjsExports":false},"type":"js/module"}]}