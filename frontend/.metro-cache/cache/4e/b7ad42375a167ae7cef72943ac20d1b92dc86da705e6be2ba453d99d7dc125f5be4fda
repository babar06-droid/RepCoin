{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":86,"index":789}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../conv_gpu_depthwise","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":790},"end":{"line":18,"column":63,"index":853}}],"key":"o79GvcOWuZCil6hXtOpffp5Pqo8=","exportNames":["*"],"imports":1}},{"name":"../conv_packed_gpu_depthwise","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":854},"end":{"line":19,"column":76,"index":930}}],"key":"gUNAsToxhXfsBkRNa4mYa8k+rbo=","exportNames":["*"],"imports":1}},{"name":"../kernel_utils/kernel_funcs_utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":931},"end":{"line":20,"column":82,"index":1013}}],"key":"TkLShRIzGpc/AaE27S68+1rwBL4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.fusedDepthwiseConv2D = fusedDepthwiseConv2D;\n  Object.defineProperty(exports, \"fusedDepthwiseConv2DConfig\", {\n    enumerable: true,\n    get: function () {\n      return fusedDepthwiseConv2DConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _conv_gpu_depthwise = require(_dependencyMap[1], \"../conv_gpu_depthwise\");\n  var _conv_packed_gpu_depthwise = require(_dependencyMap[2], \"../conv_packed_gpu_depthwise\");\n  var _kernel_utilsKernel_funcs_utils = require(_dependencyMap[3], \"../kernel_utils/kernel_funcs_utils\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function fusedDepthwiseConv2D(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x,\n      filter,\n      bias,\n      preluActivationWeights\n    } = inputs;\n    const {\n      strides,\n      pad,\n      dilations,\n      dimRoundingMode,\n      activation,\n      leakyreluAlpha\n    } = attrs;\n    const intermediates = [];\n    let $dilations = dilations;\n    if ($dilations == null) {\n      $dilations = [1, 1];\n    }\n    _tensorflowTfjsCore.util.assert(_tensorflowTfjsCore.backend_util.eitherStridesOrDilationsAreOne(strides, $dilations), () => 'Error in depthwiseConv2d: Either strides or dilations must be ' + `1. Got strides ${strides} and dilations '${$dilations}'`);\n    const convInfo = _tensorflowTfjsCore.backend_util.computeConv2DInfo(x.shape, filter.shape, strides, $dilations, pad, dimRoundingMode, true /* depthwise */);\n    const shouldPackDepthwiseConv = (0, _tensorflowTfjsCore.env)().getBool('WEBGL_PACK_DEPTHWISECONV') && convInfo.strideWidth <= 2 && convInfo.outChannels / convInfo.inChannels === 1;\n    const fusedActivation = activation ? (0, _kernel_utilsKernel_funcs_utils.mapActivationToShaderProgram)(activation, shouldPackDepthwiseConv) : null;\n    const programInputs = [x, filter];\n    const hasBias = bias != null;\n    const hasPreluActivationWeights = preluActivationWeights != null;\n    const hasLeakyreluAlpha = activation === 'leakyrelu';\n    if (hasBias) {\n      programInputs.push(bias);\n    }\n    if (hasPreluActivationWeights) {\n      programInputs.push(preluActivationWeights);\n    }\n    if (hasLeakyreluAlpha) {\n      const $leakyreluAlpha = backend.makeTensorInfo([], 'float32', _tensorflowTfjsCore.util.createScalarValue(leakyreluAlpha, 'float32'));\n      programInputs.push($leakyreluAlpha);\n      intermediates.push($leakyreluAlpha);\n    }\n    let program;\n    if (shouldPackDepthwiseConv) {\n      program = new _conv_packed_gpu_depthwise.DepthwiseConvPacked2DProgram(convInfo, hasBias, fusedActivation, hasPreluActivationWeights, hasLeakyreluAlpha);\n    } else {\n      program = new _conv_gpu_depthwise.DepthwiseConv2DProgram(convInfo, hasBias, fusedActivation, hasPreluActivationWeights, hasLeakyreluAlpha);\n    }\n    const customValues = [[convInfo.padInfo.top, convInfo.padInfo.left], [convInfo.strideHeight, convInfo.strideWidth], [convInfo.dilationHeight, convInfo.dilationWidth], [convInfo.inHeight, convInfo.inWidth]];\n    const result = backend.runWebGLProgram(program, programInputs, 'float32', customValues);\n    intermediates.forEach(t => backend.disposeIntermediateTensorInfo(t));\n    return result;\n  }\n  const fusedDepthwiseConv2DConfig = {\n    kernelName: _tensorflowTfjsCore.FusedDepthwiseConv2D,\n    backendName: 'webgl',\n    kernelFunc: fusedDepthwiseConv2D\n  };\n});","lineCount":95,"map":[[7,2,21,0,"exports"],[7,9,21,0],[7,10,21,0,"fusedDepthwiseConv2D"],[7,30,21,0],[7,33,21,0,"fusedDepthwiseConv2D"],[7,53,21,0],[8,2,71,0,"Object"],[8,8,71,0],[8,9,71,0,"defineProperty"],[8,23,71,0],[8,24,71,0,"exports"],[8,31,71,0],[9,4,71,0,"enumerable"],[9,14,71,0],[10,4,71,0,"get"],[10,7,71,0],[10,18,71,0,"get"],[10,19,71,0],[11,6,71,0],[11,13,71,0,"fusedDepthwiseConv2DConfig"],[11,39,71,0],[12,4,71,0],[13,2,71,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_conv_gpu_depthwise"],[15,25,18,0],[15,28,18,0,"require"],[15,35,18,0],[15,36,18,0,"_dependencyMap"],[15,50,18,0],[16,2,19,0],[16,6,19,0,"_conv_packed_gpu_depthwise"],[16,32,19,0],[16,35,19,0,"require"],[16,42,19,0],[16,43,19,0,"_dependencyMap"],[16,57,19,0],[17,2,20,0],[17,6,20,0,"_kernel_utilsKernel_funcs_utils"],[17,37,20,0],[17,40,20,0,"require"],[17,47,20,0],[17,48,20,0,"_dependencyMap"],[17,62,20,0],[18,2,1,0],[19,0,2,0],[20,0,3,0],[21,0,4,0],[22,0,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[35,2,21,7],[35,11,21,16,"fusedDepthwiseConv2D"],[35,31,21,36,"fusedDepthwiseConv2D"],[35,32,21,37,"args"],[35,36,21,41],[35,38,21,43],[36,4,22,4],[36,10,22,10],[37,6,22,12,"inputs"],[37,12,22,18],[38,6,22,20,"backend"],[38,13,22,27],[39,6,22,29,"attrs"],[40,4,22,35],[40,5,22,36],[40,8,22,39,"args"],[40,12,22,43],[41,4,23,4],[41,10,23,10],[42,6,23,12,"x"],[42,7,23,13],[43,6,23,15,"filter"],[43,12,23,21],[44,6,23,23,"bias"],[44,10,23,27],[45,6,23,29,"preluActivationWeights"],[46,4,23,52],[46,5,23,53],[46,8,23,56,"inputs"],[46,14,23,62],[47,4,24,4],[47,10,24,10],[48,6,24,12,"strides"],[48,13,24,19],[49,6,24,21,"pad"],[49,9,24,24],[50,6,24,26,"dilations"],[50,15,24,35],[51,6,24,37,"dimRoundingMode"],[51,21,24,52],[52,6,24,54,"activation"],[52,16,24,64],[53,6,24,66,"leakyreluAlpha"],[54,4,24,81],[54,5,24,82],[54,8,24,85,"attrs"],[54,13,24,90],[55,4,25,4],[55,10,25,10,"intermediates"],[55,23,25,23],[55,26,25,26],[55,28,25,28],[56,4,26,4],[56,8,26,8,"$dilations"],[56,18,26,18],[56,21,26,21,"dilations"],[56,30,26,30],[57,4,27,4],[57,8,27,8,"$dilations"],[57,18,27,18],[57,22,27,22],[57,26,27,26],[57,28,27,28],[58,6,28,8,"$dilations"],[58,16,28,18],[58,19,28,21],[58,20,28,22],[58,21,28,23],[58,23,28,25],[58,24,28,26],[58,25,28,27],[59,4,29,4],[60,4,30,4,"util"],[60,23,30,8],[60,24,30,8,"util"],[60,28,30,8],[60,29,30,9,"assert"],[60,35,30,15],[60,36,30,16,"backend_util"],[60,55,30,28],[60,56,30,28,"backend_util"],[60,68,30,28],[60,69,30,29,"eitherStridesOrDilationsAreOne"],[60,99,30,59],[60,100,30,60,"strides"],[60,107,30,67],[60,109,30,69,"$dilations"],[60,119,30,79],[60,120,30,80],[60,122,30,82],[60,128,30,88],[60,192,30,152],[60,195,31,8],[60,213,31,26,"strides"],[60,220,31,33],[60,239,31,52,"$dilations"],[60,249,31,62],[60,252,31,65],[60,253,31,66],[61,4,32,4],[61,10,32,10,"convInfo"],[61,18,32,18],[61,21,32,21,"backend_util"],[61,40,32,33],[61,41,32,33,"backend_util"],[61,53,32,33],[61,54,32,34,"computeConv2DInfo"],[61,71,32,51],[61,72,32,52,"x"],[61,73,32,53],[61,74,32,54,"shape"],[61,79,32,59],[61,81,32,61,"filter"],[61,87,32,67],[61,88,32,68,"shape"],[61,93,32,73],[61,95,32,75,"strides"],[61,102,32,82],[61,104,32,84,"$dilations"],[61,114,32,94],[61,116,32,96,"pad"],[61,119,32,99],[61,121,32,101,"dimRoundingMode"],[61,136,32,116],[61,138,32,118],[61,142,32,122],[61,143,32,123],[61,158,32,138],[61,159,32,139],[62,4,33,4],[62,10,33,10,"shouldPackDepthwiseConv"],[62,33,33,33],[62,36,33,36],[62,40,33,36,"env"],[62,59,33,39],[62,60,33,39,"env"],[62,63,33,39],[62,65,33,40],[62,66,33,41],[62,67,33,42,"getBool"],[62,74,33,49],[62,75,33,50],[62,101,33,76],[62,102,33,77],[62,106,34,8,"convInfo"],[62,114,34,16],[62,115,34,17,"strideWidth"],[62,126,34,28],[62,130,34,32],[62,131,34,33],[62,135,35,8,"convInfo"],[62,143,35,16],[62,144,35,17,"outChannels"],[62,155,35,28],[62,158,35,31,"convInfo"],[62,166,35,39],[62,167,35,40,"inChannels"],[62,177,35,50],[62,182,35,55],[62,183,35,56],[63,4,36,4],[63,10,36,10,"fusedActivation"],[63,25,36,25],[63,28,36,28,"activation"],[63,38,36,38],[63,41,37,8],[63,45,37,8,"mapActivationToShaderProgram"],[63,76,37,36],[63,77,37,36,"mapActivationToShaderProgram"],[63,105,37,36],[63,107,37,37,"activation"],[63,117,37,47],[63,119,37,49,"shouldPackDepthwiseConv"],[63,142,37,72],[63,143,37,73],[63,146,38,8],[63,150,38,12],[64,4,39,4],[64,10,39,10,"programInputs"],[64,23,39,23],[64,26,39,26],[64,27,39,27,"x"],[64,28,39,28],[64,30,39,30,"filter"],[64,36,39,36],[64,37,39,37],[65,4,40,4],[65,10,40,10,"hasBias"],[65,17,40,17],[65,20,40,20,"bias"],[65,24,40,24],[65,28,40,28],[65,32,40,32],[66,4,41,4],[66,10,41,10,"hasPreluActivationWeights"],[66,35,41,35],[66,38,41,38,"preluActivationWeights"],[66,60,41,60],[66,64,41,64],[66,68,41,68],[67,4,42,4],[67,10,42,10,"hasLeakyreluAlpha"],[67,27,42,27],[67,30,42,30,"activation"],[67,40,42,40],[67,45,42,45],[67,56,42,56],[68,4,43,4],[68,8,43,8,"hasBias"],[68,15,43,15],[68,17,43,17],[69,6,44,8,"programInputs"],[69,19,44,21],[69,20,44,22,"push"],[69,24,44,26],[69,25,44,27,"bias"],[69,29,44,31],[69,30,44,32],[70,4,45,4],[71,4,46,4],[71,8,46,8,"hasPreluActivationWeights"],[71,33,46,33],[71,35,46,35],[72,6,47,8,"programInputs"],[72,19,47,21],[72,20,47,22,"push"],[72,24,47,26],[72,25,47,27,"preluActivationWeights"],[72,47,47,49],[72,48,47,50],[73,4,48,4],[74,4,49,4],[74,8,49,8,"hasLeakyreluAlpha"],[74,25,49,25],[74,27,49,27],[75,6,50,8],[75,12,50,14,"$leakyreluAlpha"],[75,27,50,29],[75,30,50,32,"backend"],[75,37,50,39],[75,38,50,40,"makeTensorInfo"],[75,52,50,54],[75,53,50,55],[75,55,50,57],[75,57,50,59],[75,66,50,68],[75,68,50,70,"util"],[75,87,50,74],[75,88,50,74,"util"],[75,92,50,74],[75,93,50,75,"createScalarValue"],[75,110,50,92],[75,111,50,93,"leakyreluAlpha"],[75,125,50,107],[75,127,50,109],[75,136,50,118],[75,137,50,119],[75,138,50,120],[76,6,51,8,"programInputs"],[76,19,51,21],[76,20,51,22,"push"],[76,24,51,26],[76,25,51,27,"$leakyreluAlpha"],[76,40,51,42],[76,41,51,43],[77,6,52,8,"intermediates"],[77,19,52,21],[77,20,52,22,"push"],[77,24,52,26],[77,25,52,27,"$leakyreluAlpha"],[77,40,52,42],[77,41,52,43],[78,4,53,4],[79,4,54,4],[79,8,54,8,"program"],[79,15,54,15],[80,4,55,4],[80,8,55,8,"shouldPackDepthwiseConv"],[80,31,55,31],[80,33,55,33],[81,6,56,8,"program"],[81,13,56,15],[81,16,56,18],[81,20,56,22,"DepthwiseConvPacked2DProgram"],[81,46,56,50],[81,47,56,50,"DepthwiseConvPacked2DProgram"],[81,75,56,50],[81,76,56,51,"convInfo"],[81,84,56,59],[81,86,56,61,"hasBias"],[81,93,56,68],[81,95,56,70,"fusedActivation"],[81,110,56,85],[81,112,56,87,"hasPreluActivationWeights"],[81,137,56,112],[81,139,56,114,"hasLeakyreluAlpha"],[81,156,56,131],[81,157,56,132],[82,4,57,4],[82,5,57,5],[82,11,58,9],[83,6,59,8,"program"],[83,13,59,15],[83,16,59,18],[83,20,59,22,"DepthwiseConv2DProgram"],[83,39,59,44],[83,40,59,44,"DepthwiseConv2DProgram"],[83,62,59,44],[83,63,59,45,"convInfo"],[83,71,59,53],[83,73,59,55,"hasBias"],[83,80,59,62],[83,82,59,64,"fusedActivation"],[83,97,59,79],[83,99,59,81,"hasPreluActivationWeights"],[83,124,59,106],[83,126,59,108,"hasLeakyreluAlpha"],[83,143,59,125],[83,144,59,126],[84,4,60,4],[85,4,61,4],[85,10,61,10,"customValues"],[85,22,61,22],[85,25,61,25],[85,26,62,8],[85,27,62,9,"convInfo"],[85,35,62,17],[85,36,62,18,"padInfo"],[85,43,62,25],[85,44,62,26,"top"],[85,47,62,29],[85,49,62,31,"convInfo"],[85,57,62,39],[85,58,62,40,"padInfo"],[85,65,62,47],[85,66,62,48,"left"],[85,70,62,52],[85,71,62,53],[85,73,63,8],[85,74,63,9,"convInfo"],[85,82,63,17],[85,83,63,18,"strideHeight"],[85,95,63,30],[85,97,63,32,"convInfo"],[85,105,63,40],[85,106,63,41,"strideWidth"],[85,117,63,52],[85,118,63,53],[85,120,64,8],[85,121,64,9,"convInfo"],[85,129,64,17],[85,130,64,18,"dilationHeight"],[85,144,64,32],[85,146,64,34,"convInfo"],[85,154,64,42],[85,155,64,43,"dilationWidth"],[85,168,64,56],[85,169,64,57],[85,171,65,8],[85,172,65,9,"convInfo"],[85,180,65,17],[85,181,65,18,"inHeight"],[85,189,65,26],[85,191,65,28,"convInfo"],[85,199,65,36],[85,200,65,37,"inWidth"],[85,207,65,44],[85,208,65,45],[85,209,66,5],[86,4,67,4],[86,10,67,10,"result"],[86,16,67,16],[86,19,67,19,"backend"],[86,26,67,26],[86,27,67,27,"runWebGLProgram"],[86,42,67,42],[86,43,67,43,"program"],[86,50,67,50],[86,52,67,52,"programInputs"],[86,65,67,65],[86,67,67,67],[86,76,67,76],[86,78,67,78,"customValues"],[86,90,67,90],[86,91,67,91],[87,4,68,4,"intermediates"],[87,17,68,17],[87,18,68,18,"forEach"],[87,25,68,25],[87,26,68,26,"t"],[87,27,68,27],[87,31,68,31,"backend"],[87,38,68,38],[87,39,68,39,"disposeIntermediateTensorInfo"],[87,68,68,68],[87,69,68,69,"t"],[87,70,68,70],[87,71,68,71],[87,72,68,72],[88,4,69,4],[88,11,69,11,"result"],[88,17,69,17],[89,2,70,0],[90,2,71,7],[90,8,71,13,"fusedDepthwiseConv2DConfig"],[90,34,71,39],[90,37,71,42],[91,4,72,4,"kernelName"],[91,14,72,14],[91,16,72,16,"FusedDepthwiseConv2D"],[91,35,72,36],[91,36,72,36,"FusedDepthwiseConv2D"],[91,56,72,36],[92,4,73,4,"backendName"],[92,15,73,15],[92,17,73,17],[92,24,73,24],[93,4,74,4,"kernelFunc"],[93,14,74,14],[93,16,74,16,"fusedDepthwiseConv2D"],[94,2,75,0],[94,3,75,1],[95,0,75,2],[95,3]],"functionMap":{"names":["<global>","fusedDepthwiseConv2D","util.assert$argument_1","intermediates.forEach$argument_0"],"mappings":"AAA;OCoB;kFCS;iEDC;0BEqC,6CF;CDE"},"hasCjsExports":false},"type":"js/module"}]}