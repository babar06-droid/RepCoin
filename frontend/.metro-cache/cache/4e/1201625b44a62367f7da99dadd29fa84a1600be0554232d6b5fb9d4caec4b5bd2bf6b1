{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":66,"index":769}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../batchnorm_gpu","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":770},"end":{"line":18,"column":52,"index":822}}],"key":"4I/7cwWtRcAktSAMi6HINPZgYgA=","exportNames":["*"],"imports":1}},{"name":"../batchnorm_packed_gpu","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":823},"end":{"line":19,"column":65,"index":888}}],"key":"DZrafzkNiB7pAxWgpczc2D8bscg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"batchNorm\", {\n    enumerable: true,\n    get: function () {\n      return batchNorm;\n    }\n  });\n  Object.defineProperty(exports, \"batchNormConfig\", {\n    enumerable: true,\n    get: function () {\n      return batchNormConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _batchnorm_gpu = require(_dependencyMap[1], \"../batchnorm_gpu\");\n  var _batchnorm_packed_gpu = require(_dependencyMap[2], \"../batchnorm_packed_gpu\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  const batchNorm = ({\n    inputs,\n    backend,\n    attrs\n  }) => {\n    const {\n      x,\n      mean,\n      variance,\n      offset,\n      scale\n    } = inputs;\n    _tensorflowTfjsCore.util.assert(mean.shape.length === variance.shape.length, () => 'Batch normalization gradient requires mean and variance to have ' + 'equal ranks.');\n    _tensorflowTfjsCore.util.assert(offset == null || mean.shape.length === offset.shape.length, () => 'Batch normalization gradient requires mean and offset to have ' + 'equal ranks.');\n    _tensorflowTfjsCore.util.assert(scale == null || mean.shape.length === scale.shape.length, () => 'Batch normalization gradient requires mean and scale to have ' + 'equal ranks.');\n    let {\n      varianceEpsilon\n    } = attrs;\n    if (varianceEpsilon == null) {\n      varianceEpsilon = 0.001;\n    }\n    const finalInputs = [x, mean, variance];\n    let offsetShape = null;\n    if (offset != null) {\n      offsetShape = offset.shape;\n      finalInputs.push(offset);\n    }\n    let scaleShape = null;\n    if (scale != null) {\n      scaleShape = scale.shape;\n      finalInputs.push(scale);\n    }\n    const program = (0, _tensorflowTfjsCore.env)().getBool('WEBGL_PACK_NORMALIZATION') ? new _batchnorm_packed_gpu.BatchNormPackedProgram(x.shape, mean.shape, variance.shape, offsetShape, scaleShape, varianceEpsilon) : new _batchnorm_gpu.BatchNormProgram(x.shape, mean.shape, variance.shape, offsetShape, scaleShape, varianceEpsilon);\n    const output = backend.runWebGLProgram(program, finalInputs, finalInputs[0].dtype);\n    return output;\n  };\n  const batchNormConfig = {\n    kernelName: _tensorflowTfjsCore.FusedBatchNorm,\n    backendName: 'webgl',\n    kernelFunc: batchNorm\n  };\n});","lineCount":80,"map":[[7,2,20,0,"Object"],[7,8,20,0],[7,9,20,0,"defineProperty"],[7,23,20,0],[7,24,20,0,"exports"],[7,31,20,0],[8,4,20,0,"enumerable"],[8,14,20,0],[9,4,20,0,"get"],[9,7,20,0],[9,18,20,0,"get"],[9,19,20,0],[10,6,20,0],[10,13,20,0,"batchNorm"],[10,22,20,0],[11,4,20,0],[12,2,20,0],[13,2,49,0,"Object"],[13,8,49,0],[13,9,49,0,"defineProperty"],[13,23,49,0],[13,24,49,0,"exports"],[13,31,49,0],[14,4,49,0,"enumerable"],[14,14,49,0],[15,4,49,0,"get"],[15,7,49,0],[15,18,49,0,"get"],[15,19,49,0],[16,6,49,0],[16,13,49,0,"batchNormConfig"],[16,28,49,0],[17,4,49,0],[18,2,49,0],[19,2,17,0],[19,6,17,0,"_tensorflowTfjsCore"],[19,25,17,0],[19,28,17,0,"require"],[19,35,17,0],[19,36,17,0,"_dependencyMap"],[19,50,17,0],[20,2,18,0],[20,6,18,0,"_batchnorm_gpu"],[20,20,18,0],[20,23,18,0,"require"],[20,30,18,0],[20,31,18,0,"_dependencyMap"],[20,45,18,0],[21,2,19,0],[21,6,19,0,"_batchnorm_packed_gpu"],[21,27,19,0],[21,30,19,0,"require"],[21,37,19,0],[21,38,19,0,"_dependencyMap"],[21,52,19,0],[22,2,1,0],[23,0,2,0],[24,0,3,0],[25,0,4,0],[26,0,5,0],[27,0,6,0],[28,0,7,0],[29,0,8,0],[30,0,9,0],[31,0,10,0],[32,0,11,0],[33,0,12,0],[34,0,13,0],[35,0,14,0],[36,0,15,0],[37,0,16,0],[39,2,20,7],[39,8,20,13,"batchNorm"],[39,17,20,22],[39,20,20,25,"batchNorm"],[39,21,20,26],[40,4,20,28,"inputs"],[40,10,20,34],[41,4,20,36,"backend"],[41,11,20,43],[42,4,20,45,"attrs"],[43,2,20,51],[43,3,20,52],[43,8,20,57],[44,4,21,4],[44,10,21,10],[45,6,21,12,"x"],[45,7,21,13],[46,6,21,15,"mean"],[46,10,21,19],[47,6,21,21,"variance"],[47,14,21,29],[48,6,21,31,"offset"],[48,12,21,37],[49,6,21,39,"scale"],[50,4,21,45],[50,5,21,46],[50,8,21,49,"inputs"],[50,14,21,55],[51,4,22,4,"util"],[51,23,22,8],[51,24,22,8,"util"],[51,28,22,8],[51,29,22,9,"assert"],[51,35,22,15],[51,36,22,16,"mean"],[51,40,22,20],[51,41,22,21,"shape"],[51,46,22,26],[51,47,22,27,"length"],[51,53,22,33],[51,58,22,38,"variance"],[51,66,22,46],[51,67,22,47,"shape"],[51,72,22,52],[51,73,22,53,"length"],[51,79,22,59],[51,81,22,61],[51,87,22,67],[51,153,22,133],[51,156,23,8],[51,170,23,22],[51,171,23,23],[52,4,24,4,"util"],[52,23,24,8],[52,24,24,8,"util"],[52,28,24,8],[52,29,24,9,"assert"],[52,35,24,15],[52,36,24,16,"offset"],[52,42,24,22],[52,46,24,26],[52,50,24,30],[52,54,24,34,"mean"],[52,58,24,38],[52,59,24,39,"shape"],[52,64,24,44],[52,65,24,45,"length"],[52,71,24,51],[52,76,24,56,"offset"],[52,82,24,62],[52,83,24,63,"shape"],[52,88,24,68],[52,89,24,69,"length"],[52,95,24,75],[52,97,24,77],[52,103,24,83],[52,167,24,147],[52,170,25,8],[52,184,25,22],[52,185,25,23],[53,4,26,4,"util"],[53,23,26,8],[53,24,26,8,"util"],[53,28,26,8],[53,29,26,9,"assert"],[53,35,26,15],[53,36,26,16,"scale"],[53,41,26,21],[53,45,26,25],[53,49,26,29],[53,53,26,33,"mean"],[53,57,26,37],[53,58,26,38,"shape"],[53,63,26,43],[53,64,26,44,"length"],[53,70,26,50],[53,75,26,55,"scale"],[53,80,26,60],[53,81,26,61,"shape"],[53,86,26,66],[53,87,26,67,"length"],[53,93,26,73],[53,95,26,75],[53,101,26,81],[53,164,26,144],[53,167,27,8],[53,181,27,22],[53,182,27,23],[54,4,28,4],[54,8,28,8],[55,6,28,10,"varianceEpsilon"],[56,4,28,26],[56,5,28,27],[56,8,28,30,"attrs"],[56,13,28,35],[57,4,29,4],[57,8,29,8,"varianceEpsilon"],[57,23,29,23],[57,27,29,27],[57,31,29,31],[57,33,29,33],[58,6,30,8,"varianceEpsilon"],[58,21,30,23],[58,24,30,26],[58,29,30,31],[59,4,31,4],[60,4,32,4],[60,10,32,10,"finalInputs"],[60,21,32,21],[60,24,32,24],[60,25,32,25,"x"],[60,26,32,26],[60,28,32,28,"mean"],[60,32,32,32],[60,34,32,34,"variance"],[60,42,32,42],[60,43,32,43],[61,4,33,4],[61,8,33,8,"offsetShape"],[61,19,33,19],[61,22,33,22],[61,26,33,26],[62,4,34,4],[62,8,34,8,"offset"],[62,14,34,14],[62,18,34,18],[62,22,34,22],[62,24,34,24],[63,6,35,8,"offsetShape"],[63,17,35,19],[63,20,35,22,"offset"],[63,26,35,28],[63,27,35,29,"shape"],[63,32,35,34],[64,6,36,8,"finalInputs"],[64,17,36,19],[64,18,36,20,"push"],[64,22,36,24],[64,23,36,25,"offset"],[64,29,36,31],[64,30,36,32],[65,4,37,4],[66,4,38,4],[66,8,38,8,"scaleShape"],[66,18,38,18],[66,21,38,21],[66,25,38,25],[67,4,39,4],[67,8,39,8,"scale"],[67,13,39,13],[67,17,39,17],[67,21,39,21],[67,23,39,23],[68,6,40,8,"scaleShape"],[68,16,40,18],[68,19,40,21,"scale"],[68,24,40,26],[68,25,40,27,"shape"],[68,30,40,32],[69,6,41,8,"finalInputs"],[69,17,41,19],[69,18,41,20,"push"],[69,22,41,24],[69,23,41,25,"scale"],[69,28,41,30],[69,29,41,31],[70,4,42,4],[71,4,43,4],[71,10,43,10,"program"],[71,17,43,17],[71,20,43,20],[71,24,43,20,"env"],[71,43,43,23],[71,44,43,23,"env"],[71,47,43,23],[71,49,43,24],[71,50,43,25],[71,51,43,26,"getBool"],[71,58,43,33],[71,59,43,34],[71,85,43,60],[71,86,43,61],[71,89,44,8],[71,93,44,12,"BatchNormPackedProgram"],[71,114,44,34],[71,115,44,34,"BatchNormPackedProgram"],[71,137,44,34],[71,138,44,35,"x"],[71,139,44,36],[71,140,44,37,"shape"],[71,145,44,42],[71,147,44,44,"mean"],[71,151,44,48],[71,152,44,49,"shape"],[71,157,44,54],[71,159,44,56,"variance"],[71,167,44,64],[71,168,44,65,"shape"],[71,173,44,70],[71,175,44,72,"offsetShape"],[71,186,44,83],[71,188,44,85,"scaleShape"],[71,198,44,95],[71,200,44,97,"varianceEpsilon"],[71,215,44,112],[71,216,44,113],[71,219,45,8],[71,223,45,12,"BatchNormProgram"],[71,237,45,28],[71,238,45,28,"BatchNormProgram"],[71,254,45,28],[71,255,45,29,"x"],[71,256,45,30],[71,257,45,31,"shape"],[71,262,45,36],[71,264,45,38,"mean"],[71,268,45,42],[71,269,45,43,"shape"],[71,274,45,48],[71,276,45,50,"variance"],[71,284,45,58],[71,285,45,59,"shape"],[71,290,45,64],[71,292,45,66,"offsetShape"],[71,303,45,77],[71,305,45,79,"scaleShape"],[71,315,45,89],[71,317,45,91,"varianceEpsilon"],[71,332,45,106],[71,333,45,107],[72,4,46,4],[72,10,46,10,"output"],[72,16,46,16],[72,19,46,19,"backend"],[72,26,46,26],[72,27,46,27,"runWebGLProgram"],[72,42,46,42],[72,43,46,43,"program"],[72,50,46,50],[72,52,46,52,"finalInputs"],[72,63,46,63],[72,65,46,65,"finalInputs"],[72,76,46,76],[72,77,46,77],[72,78,46,78],[72,79,46,79],[72,80,46,80,"dtype"],[72,85,46,85],[72,86,46,86],[73,4,47,4],[73,11,47,11,"output"],[73,17,47,17],[74,2,48,0],[74,3,48,1],[75,2,49,7],[75,8,49,13,"batchNormConfig"],[75,23,49,28],[75,26,49,31],[76,4,50,4,"kernelName"],[76,14,50,14],[76,16,50,16,"FusedBatchNorm"],[76,35,50,30],[76,36,50,30,"FusedBatchNorm"],[76,50,50,30],[77,4,51,4,"backendName"],[77,15,51,15],[77,17,51,17],[77,24,51,24],[78,4,52,4,"kernelFunc"],[78,14,52,14],[78,16,52,16,"batchNorm"],[79,2,53,0],[79,3,53,1],[80,0,53,2],[80,3]],"functionMap":{"names":["<global>","batchNorm","util.assert$argument_1"],"mappings":"AAA;yBCmB;6DCE;sBDC;6ECC;sBDC;2ECC;sBDC;CDqB"},"hasCjsExports":false},"type":"js/module"}]}