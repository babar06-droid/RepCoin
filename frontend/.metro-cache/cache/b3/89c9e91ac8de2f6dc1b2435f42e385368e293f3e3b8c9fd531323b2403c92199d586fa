{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":55,"index":55}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"jpeg-js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":56},"end":{"line":2,"column":32,"index":88}}],"key":"L1047NRJY14hrZCfJpW8MExEdME=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.decodeJpeg = decodeJpeg;\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _jpegJs = require(_dependencyMap[1], \"jpeg-js\");\n  var jpeg = _interopNamespace(_jpegJs);\n  var ImageType;\n  (function (ImageType) {\n    ImageType[\"JPEG\"] = \"jpeg\";\n    ImageType[\"PNG\"] = \"png\";\n    ImageType[\"GIF\"] = \"gif\";\n    ImageType[\"BMP\"] = \"BMP\";\n  })(ImageType || (ImageType = {}));\n  /**\n   * Decode a JPEG-encoded image to a 3D Tensor of dtype `int32`.\n   *\n   * ```js\n   * // Load an image as a Uint8Array\n   * const imageUri = 'http://image-uri-here.example.com/image.jpg'; *\n   * const response = await fetch(imageUri, {}, { isBinary: true });\n   * const imageDataArrayBuffer = await response.arrayBuffer();\n   * const imageData = new Uint8Array(imageDataArrayBuffer);\n   *\n   * // Decode image data to a tensor\n   * const imageTensor = decodeJpeg(imageData);\n   * ```\n   *\n   * @param contents The JPEG-encoded image in an Uint8Array.\n   * @param channels An optional int. Defaults to 3. Accepted values are\n   *     0: use the number of channels in the JPG-encoded image.\n   *     1: output a grayscale image.\n   *     3: output an RGB image.\n   * @returns A 3D Tensor of dtype `int32` with shape [height, width, 1/3].\n   *\n   * @doc {heading: 'Media', subheading: 'Images'}\n   */\n  function decodeJpeg(contents, channels = 3) {\n    _tensorflowTfjsCore.util.assert(getImageType(contents) === ImageType.JPEG, () => 'The passed contents are not a valid JPEG image');\n    _tensorflowTfjsCore.util.assert(channels === 3, () => 'Only 3 channels is supported at this time');\n    const {\n      width,\n      height,\n      data\n    } = jpeg.decode(contents, {\n      useTArray: true\n    });\n    // Drop the alpha channel info because jpeg.decode always returns a typedArray\n    // with 255\n    const buffer = new Uint8Array(width * height * 3);\n    let offset = 0; // offset into original data\n    for (let i = 0; i < buffer.length; i += 3) {\n      buffer[i] = data[offset];\n      buffer[i + 1] = data[offset + 1];\n      buffer[i + 2] = data[offset + 2];\n      offset += 4;\n    }\n    return (0, _tensorflowTfjsCore.tensor3d)(buffer, [height, width, channels]);\n  }\n  /**\n   * Helper function to get image type based on starting bytes of the image file.\n   */\n  function getImageType(content) {\n    // Classify the contents of a file based on starting bytes (aka magic number:\n    // tslint:disable-next-line:max-line-length\n    // https://en.wikipedia.org/wiki/Magic_number_(programming)#Magic_numbers_in_files)\n    // This aligns with TensorFlow Core code:\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/tensorflow/tensorflow/blob/4213d5c1bd921f8d5b7b2dc4bbf1eea78d0b5258/tensorflow/core/kernels/decode_image_op.cc#L44\n    if (content.length > 3 && content[0] === 255 && content[1] === 216 && content[2] === 255) {\n      // JPEG byte chunk starts with `ff d8 ff`\n      return ImageType.JPEG;\n    } else if (content.length > 4 && content[0] === 71 && content[1] === 73 && content[2] === 70 && content[3] === 56) {\n      // GIF byte chunk starts with `47 49 46 38`\n      return ImageType.GIF;\n    } else if (content.length > 8 && content[0] === 137 && content[1] === 80 && content[2] === 78 && content[3] === 71 && content[4] === 13 && content[5] === 10 && content[6] === 26 && content[7] === 10) {\n      // PNG byte chunk starts with `\\211 P N G \\r \\n \\032 \\n (89 50 4E 47 0D 0A\n      // 1A 0A)`\n      return ImageType.PNG;\n    } else if (content.length > 3 && content[0] === 66 && content[1] === 77) {\n      // BMP byte chunk starts with `42 4d`\n      return ImageType.BMP;\n    } else {\n      throw new Error('Expected image (JPEG, PNG, or GIF), but got unsupported image type');\n    }\n  }\n});","lineCount":105,"map":[[22,2,33,0,"exports"],[22,9,33,0],[22,10,33,0,"decodeJpeg"],[22,20,33,0],[22,23,33,0,"decodeJpeg"],[22,33,33,0],[23,2,1,0],[23,6,1,0,"_tensorflowTfjsCore"],[23,25,1,0],[23,28,1,0,"require"],[23,35,1,0],[23,36,1,0,"_dependencyMap"],[23,50,1,0],[24,2,2,0],[24,6,2,0,"_jpegJs"],[24,13,2,0],[24,16,2,0,"require"],[24,23,2,0],[24,24,2,0,"_dependencyMap"],[24,38,2,0],[25,2,2,0],[25,6,2,0,"jpeg"],[25,10,2,0],[25,13,2,0,"_interopNamespace"],[25,30,2,0],[25,31,2,0,"_jpegJs"],[25,38,2,0],[26,2,3,0],[26,6,3,4,"ImageType"],[26,15,3,13],[27,2,4,0],[27,3,4,1],[27,13,4,11,"ImageType"],[27,22,4,20],[27,24,4,22],[28,4,5,4,"ImageType"],[28,13,5,13],[28,14,5,14],[28,20,5,20],[28,21,5,21],[28,24,5,24],[28,30,5,30],[29,4,6,4,"ImageType"],[29,13,6,13],[29,14,6,14],[29,19,6,19],[29,20,6,20],[29,23,6,23],[29,28,6,28],[30,4,7,4,"ImageType"],[30,13,7,13],[30,14,7,14],[30,19,7,19],[30,20,7,20],[30,23,7,23],[30,28,7,28],[31,4,8,4,"ImageType"],[31,13,8,13],[31,14,8,14],[31,19,8,19],[31,20,8,20],[31,23,8,23],[31,28,8,28],[32,2,9,0],[32,3,9,1],[32,5,9,3,"ImageType"],[32,14,9,12],[32,19,9,17,"ImageType"],[32,28,9,26],[32,31,9,29],[32,32,9,30],[32,33,9,31],[32,34,9,32],[32,35,9,33],[33,2,10,0],[34,0,11,0],[35,0,12,0],[36,0,13,0],[37,0,14,0],[38,0,15,0],[39,0,16,0],[40,0,17,0],[41,0,18,0],[42,0,19,0],[43,0,20,0],[44,0,21,0],[45,0,22,0],[46,0,23,0],[47,0,24,0],[48,0,25,0],[49,0,26,0],[50,0,27,0],[51,0,28,0],[52,0,29,0],[53,0,30,0],[54,0,31,0],[55,0,32,0],[56,2,33,7],[56,11,33,16,"decodeJpeg"],[56,21,33,26,"decodeJpeg"],[56,22,33,27,"contents"],[56,30,33,35],[56,32,33,37,"channels"],[56,40,33,45],[56,43,33,48],[56,44,33,49],[56,46,33,51],[57,4,34,4,"util"],[57,23,34,8],[57,24,34,8,"util"],[57,28,34,8],[57,29,34,9,"assert"],[57,35,34,15],[57,36,34,16,"getImageType"],[57,48,34,28],[57,49,34,29,"contents"],[57,57,34,37],[57,58,34,38],[57,63,34,43,"ImageType"],[57,72,34,52],[57,73,34,53,"JPEG"],[57,77,34,57],[57,79,34,59],[57,85,34,65],[57,133,34,113],[57,134,34,114],[58,4,35,4,"util"],[58,23,35,8],[58,24,35,8,"util"],[58,28,35,8],[58,29,35,9,"assert"],[58,35,35,15],[58,36,35,16,"channels"],[58,44,35,24],[58,49,35,29],[58,50,35,30],[58,52,35,32],[58,58,35,38],[58,101,35,81],[58,102,35,82],[59,4,36,4],[59,10,36,10],[60,6,36,12,"width"],[60,11,36,17],[61,6,36,19,"height"],[61,12,36,25],[62,6,36,27,"data"],[63,4,36,32],[63,5,36,33],[63,8,36,36,"jpeg"],[63,12,36,40],[63,13,36,41,"decode"],[63,19,36,47],[63,20,36,48,"contents"],[63,28,36,56],[63,30,36,58],[64,6,36,60,"useTArray"],[64,15,36,69],[64,17,36,71],[65,4,36,76],[65,5,36,77],[65,6,36,78],[66,4,37,4],[67,4,38,4],[68,4,39,4],[68,10,39,10,"buffer"],[68,16,39,16],[68,19,39,19],[68,23,39,23,"Uint8Array"],[68,33,39,33],[68,34,39,34,"width"],[68,39,39,39],[68,42,39,42,"height"],[68,48,39,48],[68,51,39,51],[68,52,39,52],[68,53,39,53],[69,4,40,4],[69,8,40,8,"offset"],[69,14,40,14],[69,17,40,17],[69,18,40,18],[69,19,40,19],[69,20,40,20],[70,4,41,4],[70,9,41,9],[70,13,41,13,"i"],[70,14,41,14],[70,17,41,17],[70,18,41,18],[70,20,41,20,"i"],[70,21,41,21],[70,24,41,24,"buffer"],[70,30,41,30],[70,31,41,31,"length"],[70,37,41,37],[70,39,41,39,"i"],[70,40,41,40],[70,44,41,44],[70,45,41,45],[70,47,41,47],[71,6,42,8,"buffer"],[71,12,42,14],[71,13,42,15,"i"],[71,14,42,16],[71,15,42,17],[71,18,42,20,"data"],[71,22,42,24],[71,23,42,25,"offset"],[71,29,42,31],[71,30,42,32],[72,6,43,8,"buffer"],[72,12,43,14],[72,13,43,15,"i"],[72,14,43,16],[72,17,43,19],[72,18,43,20],[72,19,43,21],[72,22,43,24,"data"],[72,26,43,28],[72,27,43,29,"offset"],[72,33,43,35],[72,36,43,38],[72,37,43,39],[72,38,43,40],[73,6,44,8,"buffer"],[73,12,44,14],[73,13,44,15,"i"],[73,14,44,16],[73,17,44,19],[73,18,44,20],[73,19,44,21],[73,22,44,24,"data"],[73,26,44,28],[73,27,44,29,"offset"],[73,33,44,35],[73,36,44,38],[73,37,44,39],[73,38,44,40],[74,6,45,8,"offset"],[74,12,45,14],[74,16,45,18],[74,17,45,19],[75,4,46,4],[76,4,47,4],[76,11,47,11],[76,15,47,11,"tensor3d"],[76,34,47,19],[76,35,47,19,"tensor3d"],[76,43,47,19],[76,45,47,20,"buffer"],[76,51,47,26],[76,53,47,28],[76,54,47,29,"height"],[76,60,47,35],[76,62,47,37,"width"],[76,67,47,42],[76,69,47,44,"channels"],[76,77,47,52],[76,78,47,53],[76,79,47,54],[77,2,48,0],[78,2,49,0],[79,0,50,0],[80,0,51,0],[81,2,52,0],[81,11,52,9,"getImageType"],[81,23,52,21,"getImageType"],[81,24,52,22,"content"],[81,31,52,29],[81,33,52,31],[82,4,53,4],[83,4,54,4],[84,4,55,4],[85,4,56,4],[86,4,57,4],[87,4,58,4],[88,4,59,4],[88,8,59,8,"content"],[88,15,59,15],[88,16,59,16,"length"],[88,22,59,22],[88,25,59,25],[88,26,59,26],[88,30,59,30,"content"],[88,37,59,37],[88,38,59,38],[88,39,59,39],[88,40,59,40],[88,45,59,45],[88,48,59,48],[88,52,59,52,"content"],[88,59,59,59],[88,60,59,60],[88,61,59,61],[88,62,59,62],[88,67,59,67],[88,70,59,70],[88,74,60,8,"content"],[88,81,60,15],[88,82,60,16],[88,83,60,17],[88,84,60,18],[88,89,60,23],[88,92,60,26],[88,94,60,28],[89,6,61,8],[90,6,62,8],[90,13,62,15,"ImageType"],[90,22,62,24],[90,23,62,25,"JPEG"],[90,27,62,29],[91,4,63,4],[91,5,63,5],[91,11,64,9],[91,15,64,13,"content"],[91,22,64,20],[91,23,64,21,"length"],[91,29,64,27],[91,32,64,30],[91,33,64,31],[91,37,64,35,"content"],[91,44,64,42],[91,45,64,43],[91,46,64,44],[91,47,64,45],[91,52,64,50],[91,54,64,52],[91,58,64,56,"content"],[91,65,64,63],[91,66,64,64],[91,67,64,65],[91,68,64,66],[91,73,64,71],[91,75,64,73],[91,79,65,8,"content"],[91,86,65,15],[91,87,65,16],[91,88,65,17],[91,89,65,18],[91,94,65,23],[91,96,65,25],[91,100,65,29,"content"],[91,107,65,36],[91,108,65,37],[91,109,65,38],[91,110,65,39],[91,115,65,44],[91,117,65,46],[91,119,65,48],[92,6,66,8],[93,6,67,8],[93,13,67,15,"ImageType"],[93,22,67,24],[93,23,67,25,"GIF"],[93,26,67,28],[94,4,68,4],[94,5,68,5],[94,11,69,9],[94,15,69,13,"content"],[94,22,69,20],[94,23,69,21,"length"],[94,29,69,27],[94,32,69,30],[94,33,69,31],[94,37,69,35,"content"],[94,44,69,42],[94,45,69,43],[94,46,69,44],[94,47,69,45],[94,52,69,50],[94,55,69,53],[94,59,69,57,"content"],[94,66,69,64],[94,67,69,65],[94,68,69,66],[94,69,69,67],[94,74,69,72],[94,76,69,74],[94,80,70,8,"content"],[94,87,70,15],[94,88,70,16],[94,89,70,17],[94,90,70,18],[94,95,70,23],[94,97,70,25],[94,101,70,29,"content"],[94,108,70,36],[94,109,70,37],[94,110,70,38],[94,111,70,39],[94,116,70,44],[94,118,70,46],[94,122,70,50,"content"],[94,129,70,57],[94,130,70,58],[94,131,70,59],[94,132,70,60],[94,137,70,65],[94,139,70,67],[94,143,71,8,"content"],[94,150,71,15],[94,151,71,16],[94,152,71,17],[94,153,71,18],[94,158,71,23],[94,160,71,25],[94,164,71,29,"content"],[94,171,71,36],[94,172,71,37],[94,173,71,38],[94,174,71,39],[94,179,71,44],[94,181,71,46],[94,185,71,50,"content"],[94,192,71,57],[94,193,71,58],[94,194,71,59],[94,195,71,60],[94,200,71,65],[94,202,71,67],[94,204,71,69],[95,6,72,8],[96,6,73,8],[97,6,74,8],[97,13,74,15,"ImageType"],[97,22,74,24],[97,23,74,25,"PNG"],[97,26,74,28],[98,4,75,4],[98,5,75,5],[98,11,76,9],[98,15,76,13,"content"],[98,22,76,20],[98,23,76,21,"length"],[98,29,76,27],[98,32,76,30],[98,33,76,31],[98,37,76,35,"content"],[98,44,76,42],[98,45,76,43],[98,46,76,44],[98,47,76,45],[98,52,76,50],[98,54,76,52],[98,58,76,56,"content"],[98,65,76,63],[98,66,76,64],[98,67,76,65],[98,68,76,66],[98,73,76,71],[98,75,76,73],[98,77,76,75],[99,6,77,8],[100,6,78,8],[100,13,78,15,"ImageType"],[100,22,78,24],[100,23,78,25,"BMP"],[100,26,78,28],[101,4,79,4],[101,5,79,5],[101,11,80,9],[102,6,81,8],[102,12,81,14],[102,16,81,18,"Error"],[102,21,81,23],[102,22,81,24],[102,90,81,92],[102,91,81,93],[103,4,82,4],[104,2,83,0],[105,0,83,1],[105,3]],"functionMap":{"names":["<global>","<anonymous>","decodeJpeg","util.assert$argument_1","getImageType"],"mappings":"AAA;CCG;CDK;OEwB;2DCC,sDD;gCCC,iDD;CFa;AII;CJ+B"},"hasCjsExports":false},"type":"js/module"}]}