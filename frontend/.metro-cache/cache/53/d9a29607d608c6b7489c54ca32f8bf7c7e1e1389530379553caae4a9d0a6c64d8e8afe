{"dependencies":[{"name":"../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":53,"index":756}}],"key":"UCKDOr/oOGi3nbD26ZhyAVW61qk=","exportNames":["*"],"imports":1}},{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":757},"end":{"line":18,"column":32,"index":789}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}},{"name":"./gather","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":790},"end":{"line":19,"column":34,"index":824}}],"key":"FueVOSmNQfJjVJM/9T7Aysi21JM=","exportNames":["*"],"imports":1}},{"name":"./reshape","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":825},"end":{"line":20,"column":36,"index":861}}],"key":"dz8GCsFShMGnHX1Wj7bBySjBnSE=","exportNames":["*"],"imports":1}},{"name":"./squeeze","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":862},"end":{"line":21,"column":36,"index":898}}],"key":"8nB7BfbreUvJYfNQ7Ye01aiSREk=","exportNames":["*"],"imports":1}},{"name":"./where_async","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":899},"end":{"line":22,"column":43,"index":942}}],"key":"sFKGhxH7orPJK+25Iv1+ujaPiag=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"booleanMaskAsync\", {\n    enumerable: true,\n    get: function () {\n      return booleanMaskAsync;\n    }\n  });\n  var _tensor_util_env = require(_dependencyMap[0], \"../tensor_util_env\");\n  var _util = require(_dependencyMap[1], \"../util\");\n  var util = _interopNamespace(_util);\n  var _gather = require(_dependencyMap[2], \"./gather\");\n  var _reshape = require(_dependencyMap[3], \"./reshape\");\n  var _squeeze = require(_dependencyMap[4], \"./squeeze\");\n  var _where_async = require(_dependencyMap[5], \"./where_async\");\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * Apply boolean mask to tensor.\n   *\n   * ```js\n   * const tensor = tf.tensor2d([1, 2, 3, 4, 5, 6], [3, 2]);\n   * const mask = tf.tensor1d([1, 0, 1], 'bool');\n   * const result = await tf.booleanMaskAsync(tensor, mask);\n   * result.print();\n   * ```\n   *\n   * @param tensor N-D tensor.\n   * @param mask K-D boolean tensor, K <= N and K must be known statically.\n   * @param axis A 0-D int Tensor representing the axis in tensor to mask from.\n   *     By default, axis is 0 which will mask from the first dimension.\n   *     Otherwise K + axis <= N.\n   *\n   * @doc {heading: 'Tensors', subheading: 'Slicing and Joining'}\n   */\n  async function booleanMaskAsync_(tensor, mask, axis) {\n    const $tensor = (0, _tensor_util_env.convertToTensor)(tensor, 'tensor', 'boolMask');\n    const $mask = (0, _tensor_util_env.convertToTensor)(mask, 'mask', 'boolMask', 'bool');\n    const axisFrom = axis == null ? 0 : axis;\n    const maskDim = $mask.rank;\n    const tensorShape = $tensor.shape;\n    util.assert(maskDim > 0, () => 'mask cannot be scalar');\n    util.assertShapesMatch(tensorShape.slice(axisFrom, axisFrom + maskDim), $mask.shape, `mask's shape must match the first K dimensions of tensor's shape,`);\n    let leadingSize = 1;\n    for (let i = axisFrom; i < axisFrom + maskDim; i++) {\n      leadingSize *= tensorShape[i];\n    }\n    const targetTensorShape = tensorShape.slice(0, axisFrom).concat([leadingSize], tensorShape.slice(axisFrom + maskDim));\n    const reshapedTensor = (0, _reshape.reshape)($tensor, targetTensorShape);\n    const reshapedMask = (0, _reshape.reshape)($mask, [-1]);\n    const positivePositions = await (0, _where_async.whereAsync)(reshapedMask);\n    const indices = (0, _squeeze.squeeze)(positivePositions, [1]);\n    const res = (0, _gather.gather)(reshapedTensor, indices, axisFrom);\n    // Ensure no memory leak.\n    if (tensor !== $tensor) {\n      $tensor.dispose();\n    }\n    if (mask !== $mask) {\n      $mask.dispose();\n    }\n    indices.dispose();\n    reshapedTensor.dispose();\n    reshapedMask.dispose();\n    positivePositions.dispose();\n    return res;\n  }\n  const booleanMaskAsync = booleanMaskAsync_;\n});","lineCount":102,"map":[[22,2,73,0,"Object"],[22,8,73,0],[22,9,73,0,"defineProperty"],[22,23,73,0],[22,24,73,0,"exports"],[22,31,73,0],[23,4,73,0,"enumerable"],[23,14,73,0],[24,4,73,0,"get"],[24,7,73,0],[24,18,73,0,"get"],[24,19,73,0],[25,6,73,0],[25,13,73,0,"booleanMaskAsync"],[25,29,73,0],[26,4,73,0],[27,2,73,0],[28,2,17,0],[28,6,17,0,"_tensor_util_env"],[28,22,17,0],[28,25,17,0,"require"],[28,32,17,0],[28,33,17,0,"_dependencyMap"],[28,47,17,0],[29,2,18,0],[29,6,18,0,"_util"],[29,11,18,0],[29,14,18,0,"require"],[29,21,18,0],[29,22,18,0,"_dependencyMap"],[29,36,18,0],[30,2,18,0],[30,6,18,0,"util"],[30,10,18,0],[30,13,18,0,"_interopNamespace"],[30,30,18,0],[30,31,18,0,"_util"],[30,36,18,0],[31,2,19,0],[31,6,19,0,"_gather"],[31,13,19,0],[31,16,19,0,"require"],[31,23,19,0],[31,24,19,0,"_dependencyMap"],[31,38,19,0],[32,2,20,0],[32,6,20,0,"_reshape"],[32,14,20,0],[32,17,20,0,"require"],[32,24,20,0],[32,25,20,0,"_dependencyMap"],[32,39,20,0],[33,2,21,0],[33,6,21,0,"_squeeze"],[33,14,21,0],[33,17,21,0,"require"],[33,24,21,0],[33,25,21,0,"_dependencyMap"],[33,39,21,0],[34,2,22,0],[34,6,22,0,"_where_async"],[34,18,22,0],[34,21,22,0,"require"],[34,28,22,0],[34,29,22,0,"_dependencyMap"],[34,43,22,0],[35,2,1,0],[36,0,2,0],[37,0,3,0],[38,0,4,0],[39,0,5,0],[40,0,6,0],[41,0,7,0],[42,0,8,0],[43,0,9,0],[44,0,10,0],[45,0,11,0],[46,0,12,0],[47,0,13,0],[48,0,14,0],[49,0,15,0],[50,0,16,0],[52,2,23,0],[53,0,24,0],[54,0,25,0],[55,0,26,0],[56,0,27,0],[57,0,28,0],[58,0,29,0],[59,0,30,0],[60,0,31,0],[61,0,32,0],[62,0,33,0],[63,0,34,0],[64,0,35,0],[65,0,36,0],[66,0,37,0],[67,0,38,0],[68,0,39,0],[69,0,40,0],[70,2,41,0],[70,17,41,15,"booleanMaskAsync_"],[70,34,41,32,"booleanMaskAsync_"],[70,35,41,33,"tensor"],[70,41,41,39],[70,43,41,41,"mask"],[70,47,41,45],[70,49,41,47,"axis"],[70,53,41,51],[70,55,41,53],[71,4,42,4],[71,10,42,10,"$tensor"],[71,17,42,17],[71,20,42,20],[71,24,42,20,"convertToTensor"],[71,40,42,35],[71,41,42,35,"convertToTensor"],[71,56,42,35],[71,58,42,36,"tensor"],[71,64,42,42],[71,66,42,44],[71,74,42,52],[71,76,42,54],[71,86,42,64],[71,87,42,65],[72,4,43,4],[72,10,43,10,"$mask"],[72,15,43,15],[72,18,43,18],[72,22,43,18,"convertToTensor"],[72,38,43,33],[72,39,43,33,"convertToTensor"],[72,54,43,33],[72,56,43,34,"mask"],[72,60,43,38],[72,62,43,40],[72,68,43,46],[72,70,43,48],[72,80,43,58],[72,82,43,60],[72,88,43,66],[72,89,43,67],[73,4,44,4],[73,10,44,10,"axisFrom"],[73,18,44,18],[73,21,44,21,"axis"],[73,25,44,25],[73,29,44,29],[73,33,44,33],[73,36,44,36],[73,37,44,37],[73,40,44,40,"axis"],[73,44,44,44],[74,4,45,4],[74,10,45,10,"maskDim"],[74,17,45,17],[74,20,45,20,"$mask"],[74,25,45,25],[74,26,45,26,"rank"],[74,30,45,30],[75,4,46,4],[75,10,46,10,"tensorShape"],[75,21,46,21],[75,24,46,24,"$tensor"],[75,31,46,31],[75,32,46,32,"shape"],[75,37,46,37],[76,4,47,4,"util"],[76,8,47,8],[76,9,47,9,"assert"],[76,15,47,15],[76,16,47,16,"maskDim"],[76,23,47,23],[76,26,47,26],[76,27,47,27],[76,29,47,29],[76,35,47,35],[76,58,47,58],[76,59,47,59],[77,4,48,4,"util"],[77,8,48,8],[77,9,48,9,"assertShapesMatch"],[77,26,48,26],[77,27,48,27,"tensorShape"],[77,38,48,38],[77,39,48,39,"slice"],[77,44,48,44],[77,45,48,45,"axisFrom"],[77,53,48,53],[77,55,48,55,"axisFrom"],[77,63,48,63],[77,66,48,66,"maskDim"],[77,73,48,73],[77,74,48,74],[77,76,48,76,"$mask"],[77,81,48,81],[77,82,48,82,"shape"],[77,87,48,87],[77,89,48,89],[77,156,48,156],[77,157,48,157],[78,4,49,4],[78,8,49,8,"leadingSize"],[78,19,49,19],[78,22,49,22],[78,23,49,23],[79,4,50,4],[79,9,50,9],[79,13,50,13,"i"],[79,14,50,14],[79,17,50,17,"axisFrom"],[79,25,50,25],[79,27,50,27,"i"],[79,28,50,28],[79,31,50,31,"axisFrom"],[79,39,50,39],[79,42,50,42,"maskDim"],[79,49,50,49],[79,51,50,51,"i"],[79,52,50,52],[79,54,50,54],[79,56,50,56],[80,6,51,8,"leadingSize"],[80,17,51,19],[80,21,51,23,"tensorShape"],[80,32,51,34],[80,33,51,35,"i"],[80,34,51,36],[80,35,51,37],[81,4,52,4],[82,4,53,4],[82,10,53,10,"targetTensorShape"],[82,27,53,27],[82,30,53,30,"tensorShape"],[82,41,53,41],[82,42,53,42,"slice"],[82,47,53,47],[82,48,53,48],[82,49,53,49],[82,51,53,51,"axisFrom"],[82,59,53,59],[82,60,53,60],[82,61,54,9,"concat"],[82,67,54,15],[82,68,54,16],[82,69,54,17,"leadingSize"],[82,80,54,28],[82,81,54,29],[82,83,54,31,"tensorShape"],[82,94,54,42],[82,95,54,43,"slice"],[82,100,54,48],[82,101,54,49,"axisFrom"],[82,109,54,57],[82,112,54,60,"maskDim"],[82,119,54,67],[82,120,54,68],[82,121,54,69],[83,4,55,4],[83,10,55,10,"reshapedTensor"],[83,24,55,24],[83,27,55,27],[83,31,55,27,"reshape"],[83,39,55,34],[83,40,55,34,"reshape"],[83,47,55,34],[83,49,55,35,"$tensor"],[83,56,55,42],[83,58,55,44,"targetTensorShape"],[83,75,55,61],[83,76,55,62],[84,4,56,4],[84,10,56,10,"reshapedMask"],[84,22,56,22],[84,25,56,25],[84,29,56,25,"reshape"],[84,37,56,32],[84,38,56,32,"reshape"],[84,45,56,32],[84,47,56,33,"$mask"],[84,52,56,38],[84,54,56,40],[84,55,56,41],[84,56,56,42],[84,57,56,43],[84,58,56,44],[84,59,56,45],[85,4,57,4],[85,10,57,10,"positivePositions"],[85,27,57,27],[85,30,57,30],[85,36,57,36],[85,40,57,36,"whereAsync"],[85,52,57,46],[85,53,57,46,"whereAsync"],[85,63,57,46],[85,65,57,47,"reshapedMask"],[85,77,57,59],[85,78,57,60],[86,4,58,4],[86,10,58,10,"indices"],[86,17,58,17],[86,20,58,20],[86,24,58,20,"squeeze"],[86,32,58,27],[86,33,58,27,"squeeze"],[86,40,58,27],[86,42,58,28,"positivePositions"],[86,59,58,45],[86,61,58,47],[86,62,58,48],[86,63,58,49],[86,64,58,50],[86,65,58,51],[87,4,59,4],[87,10,59,10,"res"],[87,13,59,13],[87,16,59,16],[87,20,59,16,"gather"],[87,27,59,22],[87,28,59,22,"gather"],[87,34,59,22],[87,36,59,23,"reshapedTensor"],[87,50,59,37],[87,52,59,39,"indices"],[87,59,59,46],[87,61,59,48,"axisFrom"],[87,69,59,56],[87,70,59,57],[88,4,60,4],[89,4,61,4],[89,8,61,8,"tensor"],[89,14,61,14],[89,19,61,19,"$tensor"],[89,26,61,26],[89,28,61,28],[90,6,62,8,"$tensor"],[90,13,62,15],[90,14,62,16,"dispose"],[90,21,62,23],[90,22,62,24],[90,23,62,25],[91,4,63,4],[92,4,64,4],[92,8,64,8,"mask"],[92,12,64,12],[92,17,64,17,"$mask"],[92,22,64,22],[92,24,64,24],[93,6,65,8,"$mask"],[93,11,65,13],[93,12,65,14,"dispose"],[93,19,65,21],[93,20,65,22],[93,21,65,23],[94,4,66,4],[95,4,67,4,"indices"],[95,11,67,11],[95,12,67,12,"dispose"],[95,19,67,19],[95,20,67,20],[95,21,67,21],[96,4,68,4,"reshapedTensor"],[96,18,68,18],[96,19,68,19,"dispose"],[96,26,68,26],[96,27,68,27],[96,28,68,28],[97,4,69,4,"reshapedMask"],[97,16,69,16],[97,17,69,17,"dispose"],[97,24,69,24],[97,25,69,25],[97,26,69,26],[98,4,70,4,"positivePositions"],[98,21,70,21],[98,22,70,22,"dispose"],[98,29,70,29],[98,30,70,30],[98,31,70,31],[99,4,71,4],[99,11,71,11,"res"],[99,14,71,14],[100,2,72,0],[101,2,73,7],[101,8,73,13,"booleanMaskAsync"],[101,24,73,29],[101,27,73,32,"booleanMaskAsync_"],[101,44,73,49],[102,0,73,50],[102,3]],"functionMap":{"names":["<global>","booleanMaskAsync_","util.assert$argument_1"],"mappings":"AAA;ACwC;6BCM,6BD;CDyB"},"hasCjsExports":false},"type":"js/module"}]}