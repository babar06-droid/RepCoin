{"dependencies":[{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":56,"index":56}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.validateUpdateShape = validateUpdateShape;\n  exports.validateInput = validateInput;\n  exports.calculateShapes = calculateShapes;\n  var _util = require(_dependencyMap[0], \"../util\");\n  /**\n   * Check whether updates.shape = indices.shape[:batchDim] +\n   * shape[sliceDim:]\n   *\n   * @param x The input tensor.\n   */\n  function validateUpdateShape(shape, indices, updates) {\n    const sliceDim = indices.rank > 1 ? indices.shape[indices.rank - 1] : 1;\n    const batchDim = indices.rank > 1 ? indices.rank - 1 : 1;\n    const shapeError = 'Must have updates.shape = indices.shape[:batchDim] + ' + `shape[sliceDim:], got updates.shape: ${updates.shape}` + `, indices.shape: ${indices.shape}, shape: ${shape}` + `, sliceDim: ${sliceDim}, and batchDim: ${batchDim}.`;\n    if (updates.rank < batchDim) {\n      throw new Error(shapeError + ` update.rank < ${batchDim}. `);\n    }\n    if (shape.length < sliceDim + (updates.rank - batchDim)) {\n      throw new Error(shapeError + ` Output shape length < ${sliceDim + (updates.rank - batchDim)}`);\n    }\n    if (updates.rank !== batchDim + shape.length - sliceDim) {\n      throw new Error(shapeError + ` update.rank != ${batchDim + shape.length - sliceDim}`);\n    }\n    for (let d = 0; d < batchDim; ++d) {\n      if (updates.shape[d] !== indices.shape[d]) {\n        throw new Error(shapeError + ` updates.shape[${d}] (${updates.shape[d]}) != indices.shape[${d}] (${indices.shape[d]}).`);\n      }\n    }\n    for (let d = 0; d < updates.rank - batchDim; ++d) {\n      if (updates.shape[d + batchDim] !== shape[d + sliceDim]) {\n        throw new Error(shapeError + ` updates.shape[${d + batchDim}] (${updates.shape[d + batchDim]}) != shape[${d + batchDim}] (${shape[d + batchDim]})`);\n      }\n    }\n  }\n  /**\n   * Validate scatter nd inputs.\n   *\n   * @param update The tensor contains the update values.\n   * @param indices The tensor contains the indices for the update values.\n   * @param shape The shape of the output tensor.\n   */\n  function validateInput(updates, indices, shape) {\n    if (indices.rank < 1) {\n      throw new Error('tf.scatterND() expects the indices to be rank 1 or higher,' + ` but the rank was ${indices.rank}.`);\n    }\n    if (updates.rank < 1) {\n      throw new Error('tf.scatterND() expects the updates to be rank 1 or higher,' + ` but the rank was ${updates.rank}.`);\n    }\n    if (indices.dtype !== 'int32') {\n      throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${indices.dtype}`);\n    }\n    if (shape.length < 1) {\n      throw new Error(`Output rank must be greater or equal to 1, but got shape: ${shape}`);\n    }\n    if (shape.length === 0) {\n      if (indices.size === 0) {\n        throw new Error(`Indices specified for empty output. indices shape: ${indices.shape}`);\n      }\n      if (updates.size === 0) {\n        throw new Error(`Updates specified for empty output. updates shape: ${updates.shape}`);\n      }\n    }\n    validateUpdateShape(shape, indices, updates);\n  }\n  /**\n   * Calculate the shape information for the output.\n   *\n   * @param update The tensor contains the update values.\n   * @param indices The tensor contains the indices for the update values.\n   * @param shape The shape of the output tensor.\n   *\n   * @returns ScatterShapeInfo\n   */\n  function calculateShapes(updates, indices, shape) {\n    // Calculate the number of dimensions in indices\n    const indicesRank = indices.shape.length;\n    const sliceRank = indicesRank > 1 ? indices.shape[indicesRank - 1] : 1;\n    // Calculate the number of elements that make up each slice of our updated\n    // tensor. This allows us to work with flattened tensors and copy over whole\n    // slices at a time.\n    const totalNd = shape.length;\n    let sliceSize = 1;\n    for (let i = sliceRank; i < totalNd; ++i) {\n      sliceSize *= shape[i];\n    }\n    const safeSliceDim = sliceRank < 1 ? 1 : sliceRank;\n    const numUpdates = (0, _util.sizeFromShape)(indices.shape) / safeSliceDim;\n    const strides = [...(0, _util.computeStrides)(shape.slice(0, sliceRank)), 1];\n    const outputSize = (0, _util.sizeFromShape)(shape);\n    return {\n      sliceRank,\n      numUpdates,\n      sliceSize,\n      strides,\n      outputSize\n    };\n  }\n});","lineCount":104,"map":[[7,2,8,0,"exports"],[7,9,8,0],[7,10,8,0,"validateUpdateShape"],[7,29,8,0],[7,32,8,0,"validateUpdateShape"],[7,51,8,0],[8,2,45,0,"exports"],[8,9,45,0],[8,10,45,0,"validateInput"],[8,23,45,0],[8,26,45,0,"validateInput"],[8,39,45,0],[9,2,79,0,"exports"],[9,9,79,0],[9,10,79,0,"calculateShapes"],[9,25,79,0],[9,28,79,0,"calculateShapes"],[9,43,79,0],[10,2,1,0],[10,6,1,0,"_util"],[10,11,1,0],[10,14,1,0,"require"],[10,21,1,0],[10,22,1,0,"_dependencyMap"],[10,36,1,0],[11,2,2,0],[12,0,3,0],[13,0,4,0],[14,0,5,0],[15,0,6,0],[16,0,7,0],[17,2,8,7],[17,11,8,16,"validateUpdateShape"],[17,30,8,35,"validateUpdateShape"],[17,31,8,36,"shape"],[17,36,8,41],[17,38,8,43,"indices"],[17,45,8,50],[17,47,8,52,"updates"],[17,54,8,59],[17,56,8,61],[18,4,9,4],[18,10,9,10,"sliceDim"],[18,18,9,18],[18,21,9,22,"indices"],[18,28,9,29],[18,29,9,30,"rank"],[18,33,9,34],[18,36,9,37],[18,37,9,38],[18,40,9,42,"indices"],[18,47,9,49],[18,48,9,50,"shape"],[18,53,9,55],[18,54,9,56,"indices"],[18,61,9,63],[18,62,9,64,"rank"],[18,66,9,68],[18,69,9,71],[18,70,9,72],[18,71,9,73],[18,74,9,76],[18,75,9,77],[19,4,10,4],[19,10,10,10,"batchDim"],[19,18,10,18],[19,21,10,22,"indices"],[19,28,10,29],[19,29,10,30,"rank"],[19,33,10,34],[19,36,10,37],[19,37,10,38],[19,40,10,42,"indices"],[19,47,10,49],[19,48,10,50,"rank"],[19,52,10,54],[19,55,10,57],[19,56,10,58],[19,59,10,61],[19,60,10,62],[20,4,11,4],[20,10,11,10,"shapeError"],[20,20,11,20],[20,23,11,23],[20,78,11,78],[20,81,12,8],[20,121,12,48,"updates"],[20,128,12,55],[20,129,12,56,"shape"],[20,134,12,61],[20,136,12,63],[20,139,13,8],[20,159,13,28,"indices"],[20,166,13,35],[20,167,13,36,"shape"],[20,172,13,41],[20,184,13,53,"shape"],[20,189,13,58],[20,191,13,60],[20,194,14,8],[20,209,14,23,"sliceDim"],[20,217,14,31],[20,236,14,50,"batchDim"],[20,244,14,58],[20,247,14,61],[21,4,15,4],[21,8,15,8,"updates"],[21,15,15,15],[21,16,15,16,"rank"],[21,20,15,20],[21,23,15,23,"batchDim"],[21,31,15,31],[21,33,15,33],[22,6,16,8],[22,12,16,14],[22,16,16,18,"Error"],[22,21,16,23],[22,22,16,24,"shapeError"],[22,32,16,34],[22,35,16,37],[22,53,16,55,"batchDim"],[22,61,16,63],[22,65,16,67],[22,66,16,68],[23,4,17,4],[24,4,18,4],[24,8,18,8,"shape"],[24,13,18,13],[24,14,18,14,"length"],[24,20,18,20],[24,23,18,23,"sliceDim"],[24,31,18,31],[24,35,18,35,"updates"],[24,42,18,42],[24,43,18,43,"rank"],[24,47,18,47],[24,50,18,50,"batchDim"],[24,58,18,58],[24,59,18,59],[24,61,18,61],[25,6,19,8],[25,12,19,14],[25,16,19,18,"Error"],[25,21,19,23],[25,22,19,24,"shapeError"],[25,32,19,34],[25,35,20,12],[25,61,20,38,"sliceDim"],[25,69,20,46],[25,73,20,50,"updates"],[25,80,20,57],[25,81,20,58,"rank"],[25,85,20,62],[25,88,20,65,"batchDim"],[25,96,20,73],[25,97,20,74],[25,99,20,76],[25,100,20,77],[26,4,21,4],[27,4,22,4],[27,8,22,8,"updates"],[27,15,22,15],[27,16,22,16,"rank"],[27,20,22,20],[27,25,22,25,"batchDim"],[27,33,22,33],[27,36,22,36,"shape"],[27,41,22,41],[27,42,22,42,"length"],[27,48,22,48],[27,51,22,51,"sliceDim"],[27,59,22,59],[27,61,22,61],[28,6,23,8],[28,12,23,14],[28,16,23,18,"Error"],[28,21,23,23],[28,22,23,24,"shapeError"],[28,32,23,34],[28,35,23,37],[28,54,23,56,"batchDim"],[28,62,23,64],[28,65,23,67,"shape"],[28,70,23,72],[28,71,23,73,"length"],[28,77,23,79],[28,80,23,82,"sliceDim"],[28,88,23,90],[28,90,23,92],[28,91,23,93],[29,4,24,4],[30,4,25,4],[30,9,25,9],[30,13,25,13,"d"],[30,14,25,14],[30,17,25,17],[30,18,25,18],[30,20,25,20,"d"],[30,21,25,21],[30,24,25,24,"batchDim"],[30,32,25,32],[30,34,25,34],[30,36,25,36,"d"],[30,37,25,37],[30,39,25,39],[31,6,26,8],[31,10,26,12,"updates"],[31,17,26,19],[31,18,26,20,"shape"],[31,23,26,25],[31,24,26,26,"d"],[31,25,26,27],[31,26,26,28],[31,31,26,33,"indices"],[31,38,26,40],[31,39,26,41,"shape"],[31,44,26,46],[31,45,26,47,"d"],[31,46,26,48],[31,47,26,49],[31,49,26,51],[32,8,27,12],[32,14,27,18],[32,18,27,22,"Error"],[32,23,27,27],[32,24,27,28,"shapeError"],[32,34,27,38],[32,37,28,16],[32,55,28,34,"d"],[32,56,28,35],[32,62,28,41,"updates"],[32,69,28,48],[32,70,28,49,"shape"],[32,75,28,54],[32,76,28,55,"d"],[32,77,28,56],[32,78,28,57],[32,100,28,79,"d"],[32,101,28,80],[32,107,28,86,"indices"],[32,114,28,93],[32,115,28,94,"shape"],[32,120,28,99],[32,121,28,100,"d"],[32,122,28,101],[32,123,28,102],[32,127,28,106],[32,128,28,107],[33,6,29,8],[34,4,30,4],[35,4,31,4],[35,9,31,9],[35,13,31,13,"d"],[35,14,31,14],[35,17,31,17],[35,18,31,18],[35,20,31,20,"d"],[35,21,31,21],[35,24,31,24,"updates"],[35,31,31,31],[35,32,31,32,"rank"],[35,36,31,36],[35,39,31,39,"batchDim"],[35,47,31,47],[35,49,31,49],[35,51,31,51,"d"],[35,52,31,52],[35,54,31,54],[36,6,32,8],[36,10,32,12,"updates"],[36,17,32,19],[36,18,32,20,"shape"],[36,23,32,25],[36,24,32,26,"d"],[36,25,32,27],[36,28,32,30,"batchDim"],[36,36,32,38],[36,37,32,39],[36,42,32,44,"shape"],[36,47,32,49],[36,48,32,50,"d"],[36,49,32,51],[36,52,32,54,"sliceDim"],[36,60,32,62],[36,61,32,63],[36,63,32,65],[37,8,33,12],[37,14,33,18],[37,18,33,22,"Error"],[37,23,33,27],[37,24,33,28,"shapeError"],[37,34,33,38],[37,37,34,16],[37,55,34,34,"d"],[37,56,34,35],[37,59,34,38,"batchDim"],[37,67,34,46],[37,73,34,52,"updates"],[37,80,34,59],[37,81,34,60,"shape"],[37,86,34,65],[37,87,34,66,"d"],[37,88,34,67],[37,91,34,70,"batchDim"],[37,99,34,78],[37,100,34,79],[37,114,34,93,"d"],[37,115,34,94],[37,118,34,97,"batchDim"],[37,126,34,105],[37,132,34,111,"shape"],[37,137,34,116],[37,138,34,117,"d"],[37,139,34,118],[37,142,34,121,"batchDim"],[37,150,34,129],[37,151,34,130],[37,154,34,133],[37,155,34,134],[38,6,35,8],[39,4,36,4],[40,2,37,0],[41,2,38,0],[42,0,39,0],[43,0,40,0],[44,0,41,0],[45,0,42,0],[46,0,43,0],[47,0,44,0],[48,2,45,7],[48,11,45,16,"validateInput"],[48,24,45,29,"validateInput"],[48,25,45,30,"updates"],[48,32,45,37],[48,34,45,39,"indices"],[48,41,45,46],[48,43,45,48,"shape"],[48,48,45,53],[48,50,45,55],[49,4,46,4],[49,8,46,8,"indices"],[49,15,46,15],[49,16,46,16,"rank"],[49,20,46,20],[49,23,46,23],[49,24,46,24],[49,26,46,26],[50,6,47,8],[50,12,47,14],[50,16,47,18,"Error"],[50,21,47,23],[50,22,47,24],[50,82,47,84],[50,85,48,12],[50,106,48,33,"indices"],[50,113,48,40],[50,114,48,41,"rank"],[50,118,48,45],[50,121,48,48],[50,122,48,49],[51,4,49,4],[52,4,50,4],[52,8,50,8,"updates"],[52,15,50,15],[52,16,50,16,"rank"],[52,20,50,20],[52,23,50,23],[52,24,50,24],[52,26,50,26],[53,6,51,8],[53,12,51,14],[53,16,51,18,"Error"],[53,21,51,23],[53,22,51,24],[53,82,51,84],[53,85,52,12],[53,106,52,33,"updates"],[53,113,52,40],[53,114,52,41,"rank"],[53,118,52,45],[53,121,52,48],[53,122,52,49],[54,4,53,4],[55,4,54,4],[55,8,54,8,"indices"],[55,15,54,15],[55,16,54,16,"dtype"],[55,21,54,21],[55,26,54,26],[55,33,54,33],[55,35,54,35],[56,6,55,8],[56,12,55,14],[56,16,55,18,"Error"],[56,21,55,23],[56,22,55,24],[56,80,55,82,"indices"],[56,87,55,89],[56,88,55,90,"dtype"],[56,93,55,95],[56,95,55,97],[56,96,55,98],[57,4,56,4],[58,4,57,4],[58,8,57,8,"shape"],[58,13,57,13],[58,14,57,14,"length"],[58,20,57,20],[58,23,57,23],[58,24,57,24],[58,26,57,26],[59,6,58,8],[59,12,58,14],[59,16,58,18,"Error"],[59,21,58,23],[59,22,58,24],[59,83,58,85,"shape"],[59,88,58,90],[59,90,58,92],[59,91,58,93],[60,4,59,4],[61,4,60,4],[61,8,60,8,"shape"],[61,13,60,13],[61,14,60,14,"length"],[61,20,60,20],[61,25,60,25],[61,26,60,26],[61,28,60,28],[62,6,61,8],[62,10,61,12,"indices"],[62,17,61,19],[62,18,61,20,"size"],[62,22,61,24],[62,27,61,29],[62,28,61,30],[62,30,61,32],[63,8,62,12],[63,14,62,18],[63,18,62,22,"Error"],[63,23,62,27],[63,24,62,28],[63,78,62,82,"indices"],[63,85,62,89],[63,86,62,90,"shape"],[63,91,62,95],[63,93,62,97],[63,94,62,98],[64,6,63,8],[65,6,64,8],[65,10,64,12,"updates"],[65,17,64,19],[65,18,64,20,"size"],[65,22,64,24],[65,27,64,29],[65,28,64,30],[65,30,64,32],[66,8,65,12],[66,14,65,18],[66,18,65,22,"Error"],[66,23,65,27],[66,24,65,28],[66,78,65,82,"updates"],[66,85,65,89],[66,86,65,90,"shape"],[66,91,65,95],[66,93,65,97],[66,94,65,98],[67,6,66,8],[68,4,67,4],[69,4,68,4,"validateUpdateShape"],[69,23,68,23],[69,24,68,24,"shape"],[69,29,68,29],[69,31,68,31,"indices"],[69,38,68,38],[69,40,68,40,"updates"],[69,47,68,47],[69,48,68,48],[70,2,69,0],[71,2,70,0],[72,0,71,0],[73,0,72,0],[74,0,73,0],[75,0,74,0],[76,0,75,0],[77,0,76,0],[78,0,77,0],[79,0,78,0],[80,2,79,7],[80,11,79,16,"calculateShapes"],[80,26,79,31,"calculateShapes"],[80,27,79,32,"updates"],[80,34,79,39],[80,36,79,41,"indices"],[80,43,79,48],[80,45,79,50,"shape"],[80,50,79,55],[80,52,79,57],[81,4,80,4],[82,4,81,4],[82,10,81,10,"indicesRank"],[82,21,81,21],[82,24,81,24,"indices"],[82,31,81,31],[82,32,81,32,"shape"],[82,37,81,37],[82,38,81,38,"length"],[82,44,81,44],[83,4,82,4],[83,10,82,10,"sliceRank"],[83,19,82,19],[83,22,82,23,"indicesRank"],[83,33,82,34],[83,36,82,37],[83,37,82,38],[83,40,82,42,"indices"],[83,47,82,49],[83,48,82,50,"shape"],[83,53,82,55],[83,54,82,56,"indicesRank"],[83,65,82,67],[83,68,82,70],[83,69,82,71],[83,70,82,72],[83,73,82,75],[83,74,82,76],[84,4,83,4],[85,4,84,4],[86,4,85,4],[87,4,86,4],[87,10,86,10,"totalNd"],[87,17,86,17],[87,20,86,20,"shape"],[87,25,86,25],[87,26,86,26,"length"],[87,32,86,32],[88,4,87,4],[88,8,87,8,"sliceSize"],[88,17,87,17],[88,20,87,20],[88,21,87,21],[89,4,88,4],[89,9,88,9],[89,13,88,13,"i"],[89,14,88,14],[89,17,88,17,"sliceRank"],[89,26,88,26],[89,28,88,28,"i"],[89,29,88,29],[89,32,88,32,"totalNd"],[89,39,88,39],[89,41,88,41],[89,43,88,43,"i"],[89,44,88,44],[89,46,88,46],[90,6,89,8,"sliceSize"],[90,15,89,17],[90,19,89,21,"shape"],[90,24,89,26],[90,25,89,27,"i"],[90,26,89,28],[90,27,89,29],[91,4,90,4],[92,4,91,4],[92,10,91,10,"safeSliceDim"],[92,22,91,22],[92,25,91,26,"sliceRank"],[92,34,91,35],[92,37,91,38],[92,38,91,39],[92,41,91,43],[92,42,91,44],[92,45,91,47,"sliceRank"],[92,54,91,56],[93,4,92,4],[93,10,92,10,"numUpdates"],[93,20,92,20],[93,23,92,23],[93,27,92,23,"sizeFromShape"],[93,32,92,36],[93,33,92,36,"sizeFromShape"],[93,46,92,36],[93,48,92,37,"indices"],[93,55,92,44],[93,56,92,45,"shape"],[93,61,92,50],[93,62,92,51],[93,65,92,54,"safeSliceDim"],[93,77,92,66],[94,4,93,4],[94,10,93,10,"strides"],[94,17,93,17],[94,20,93,20],[94,21,93,21],[94,24,93,24],[94,28,93,24,"computeStrides"],[94,33,93,38],[94,34,93,38,"computeStrides"],[94,48,93,38],[94,50,93,39,"shape"],[94,55,93,44],[94,56,93,45,"slice"],[94,61,93,50],[94,62,93,51],[94,63,93,52],[94,65,93,54,"sliceRank"],[94,74,93,63],[94,75,93,64],[94,76,93,65],[94,78,93,67],[94,79,93,68],[94,80,93,69],[95,4,94,4],[95,10,94,10,"outputSize"],[95,20,94,20],[95,23,94,23],[95,27,94,23,"sizeFromShape"],[95,32,94,36],[95,33,94,36,"sizeFromShape"],[95,46,94,36],[95,48,94,37,"shape"],[95,53,94,42],[95,54,94,43],[96,4,95,4],[96,11,95,11],[97,6,95,13,"sliceRank"],[97,15,95,22],[98,6,95,24,"numUpdates"],[98,16,95,34],[99,6,95,36,"sliceSize"],[99,15,95,45],[100,6,95,47,"strides"],[100,13,95,54],[101,6,95,56,"outputSize"],[102,4,95,67],[102,5,95,68],[103,2,96,0],[104,0,96,1],[104,3]],"functionMap":{"names":["<global>","validateUpdateShape","validateInput","calculateShapes"],"mappings":"AAA;OCO;CD6B;OEQ;CFwB;OGU;CHiB"},"hasCjsExports":false},"type":"js/module"}]}