{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":69,"index":772}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":773},"end":{"line":18,"column":47,"index":820}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}},{"name":"./GatherV2_impl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":821},"end":{"line":19,"column":47,"index":868}}],"key":"oJviNxtcGywP54UTzcKOiulqN48=","exportNames":["*"],"imports":1}},{"name":"./Reshape","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":869},"end":{"line":20,"column":36,"index":905}}],"key":"EUWK+oKi/AwokPOQ1jng5DYfQSc=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.gatherV2 = gatherV2;\n  Object.defineProperty(exports, \"gatherV2Config\", {\n    enumerable: true,\n    get: function () {\n      return gatherV2Config;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  var _GatherV2_impl = require(_dependencyMap[2], \"./GatherV2_impl\");\n  var _Reshape = require(_dependencyMap[3], \"./Reshape\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function gatherV2(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x,\n      indices\n    } = inputs;\n    const {\n      axis,\n      batchDims\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)([x, indices], 'gatherV2');\n    // Throw error when any index is out of bound.\n    const parsedAxis = _tensorflowTfjsCore.util.parseAxisParam(axis, x.shape)[0];\n    const indicesVals = backend.data.get(indices.dataId).values;\n    const axisDim = x.shape[parsedAxis];\n    for (let i = 0; i < indicesVals.length; ++i) {\n      const index = indicesVals[i];\n      _tensorflowTfjsCore.util.assert(index <= axisDim - 1 && index >= 0, () => `GatherV2: the index value ${index} is not in [0, ${axisDim - 1}]`);\n    }\n    let $batchDims = batchDims;\n    if (batchDims == null) {\n      $batchDims = 0;\n    }\n    const indicesSize = _tensorflowTfjsCore.util.sizeFromShape(indices.shape);\n    const shapeInfo = _tensorflowTfjsCore.backend_util.segment_util.collectGatherOpShapeInfo(x, indices, parsedAxis, $batchDims);\n    const flattenX = (0, _Reshape.reshape)({\n      inputs: {\n        x\n      },\n      backend,\n      attrs: {\n        shape: [shapeInfo.batchSize, shapeInfo.outerSize, shapeInfo.dimSize, shapeInfo.sliceSize]\n      }\n    });\n    const flattenIndex = (0, _Reshape.reshape)({\n      inputs: {\n        x: indices\n      },\n      backend,\n      attrs: {\n        shape: [shapeInfo.batchSize, indicesSize / shapeInfo.batchSize]\n      }\n    });\n    const flattenOutputShape = [shapeInfo.batchSize, shapeInfo.outerSize, indicesSize / shapeInfo.batchSize, shapeInfo.sliceSize];\n    const indicesBuf = backend.bufferSync(flattenIndex);\n    const xBuf = backend.bufferSync(flattenX);\n    const outBuf = (0, _GatherV2_impl.gatherV2Impl)(xBuf, indicesBuf, flattenOutputShape);\n    backend.disposeIntermediateTensorInfo(flattenX);\n    backend.disposeIntermediateTensorInfo(flattenIndex);\n    return backend.makeTensorInfo(shapeInfo.outputShape, outBuf.dtype, outBuf.values);\n  }\n  const gatherV2Config = {\n    kernelName: _tensorflowTfjsCore.GatherV2,\n    backendName: 'cpu',\n    kernelFunc: gatherV2\n  };\n});","lineCount":95,"map":[[7,2,21,0,"exports"],[7,9,21,0],[7,10,21,0,"gatherV2"],[7,18,21,0],[7,21,21,0,"gatherV2"],[7,29,21,0],[8,2,66,0,"Object"],[8,8,66,0],[8,9,66,0,"defineProperty"],[8,23,66,0],[8,24,66,0,"exports"],[8,31,66,0],[9,4,66,0,"enumerable"],[9,14,66,0],[10,4,66,0,"get"],[10,7,66,0],[10,18,66,0,"get"],[10,19,66,0],[11,6,66,0],[11,13,66,0,"gatherV2Config"],[11,27,66,0],[12,4,66,0],[13,2,66,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,19,0],[16,6,19,0,"_GatherV2_impl"],[16,20,19,0],[16,23,19,0,"require"],[16,30,19,0],[16,31,19,0,"_dependencyMap"],[16,45,19,0],[17,2,20,0],[17,6,20,0,"_Reshape"],[17,14,20,0],[17,17,20,0,"require"],[17,24,20,0],[17,25,20,0,"_dependencyMap"],[17,39,20,0],[18,2,1,0],[19,0,2,0],[20,0,3,0],[21,0,4,0],[22,0,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[35,2,21,7],[35,11,21,16,"gatherV2"],[35,19,21,24,"gatherV2"],[35,20,21,25,"args"],[35,24,21,29],[35,26,21,31],[36,4,22,4],[36,10,22,10],[37,6,22,12,"inputs"],[37,12,22,18],[38,6,22,20,"backend"],[38,13,22,27],[39,6,22,29,"attrs"],[40,4,22,35],[40,5,22,36],[40,8,22,39,"args"],[40,12,22,43],[41,4,23,4],[41,10,23,10],[42,6,23,12,"x"],[42,7,23,13],[43,6,23,15,"indices"],[44,4,23,23],[44,5,23,24],[44,8,23,27,"inputs"],[44,14,23,33],[45,4,24,4],[45,10,24,10],[46,6,24,12,"axis"],[46,10,24,16],[47,6,24,18,"batchDims"],[48,4,24,28],[48,5,24,29],[48,8,24,32,"attrs"],[48,13,24,37],[49,4,25,4],[49,8,25,4,"assertNotComplex"],[49,17,25,20],[49,18,25,20,"assertNotComplex"],[49,34,25,20],[49,36,25,21],[49,37,25,22,"x"],[49,38,25,23],[49,40,25,25,"indices"],[49,47,25,32],[49,48,25,33],[49,50,25,35],[49,60,25,45],[49,61,25,46],[50,4,26,4],[51,4,27,4],[51,10,27,10,"parsedAxis"],[51,20,27,20],[51,23,27,23,"util"],[51,42,27,27],[51,43,27,27,"util"],[51,47,27,27],[51,48,27,28,"parseAxisParam"],[51,62,27,42],[51,63,27,43,"axis"],[51,67,27,47],[51,69,27,49,"x"],[51,70,27,50],[51,71,27,51,"shape"],[51,76,27,56],[51,77,27,57],[51,78,27,58],[51,79,27,59],[51,80,27,60],[52,4,28,4],[52,10,28,10,"indicesVals"],[52,21,28,21],[52,24,28,24,"backend"],[52,31,28,31],[52,32,28,32,"data"],[52,36,28,36],[52,37,28,37,"get"],[52,40,28,40],[52,41,28,41,"indices"],[52,48,28,48],[52,49,28,49,"dataId"],[52,55,28,55],[52,56,28,56],[52,57,28,57,"values"],[52,63,28,63],[53,4,29,4],[53,10,29,10,"axisDim"],[53,17,29,17],[53,20,29,20,"x"],[53,21,29,21],[53,22,29,22,"shape"],[53,27,29,27],[53,28,29,28,"parsedAxis"],[53,38,29,38],[53,39,29,39],[54,4,30,4],[54,9,30,9],[54,13,30,13,"i"],[54,14,30,14],[54,17,30,17],[54,18,30,18],[54,20,30,20,"i"],[54,21,30,21],[54,24,30,24,"indicesVals"],[54,35,30,35],[54,36,30,36,"length"],[54,42,30,42],[54,44,30,44],[54,46,30,46,"i"],[54,47,30,47],[54,49,30,49],[55,6,31,8],[55,12,31,14,"index"],[55,17,31,19],[55,20,31,22,"indicesVals"],[55,31,31,33],[55,32,31,34,"i"],[55,33,31,35],[55,34,31,36],[56,6,32,8,"util"],[56,25,32,12],[56,26,32,12,"util"],[56,30,32,12],[56,31,32,13,"assert"],[56,37,32,19],[56,38,32,20,"index"],[56,43,32,25],[56,47,32,29,"axisDim"],[56,54,32,36],[56,57,32,39],[56,58,32,40],[56,62,32,44,"index"],[56,67,32,49],[56,71,32,53],[56,72,32,54],[56,74,32,56],[56,80,32,62],[56,109,32,91,"index"],[56,114,32,96],[56,132,32,114,"axisDim"],[56,139,32,121],[56,142,32,124],[56,143,32,125],[56,146,32,128],[56,147,32,129],[57,4,33,4],[58,4,34,4],[58,8,34,8,"$batchDims"],[58,18,34,18],[58,21,34,21,"batchDims"],[58,30,34,30],[59,4,35,4],[59,8,35,8,"batchDims"],[59,17,35,17],[59,21,35,21],[59,25,35,25],[59,27,35,27],[60,6,36,8,"$batchDims"],[60,16,36,18],[60,19,36,21],[60,20,36,22],[61,4,37,4],[62,4,38,4],[62,10,38,10,"indicesSize"],[62,21,38,21],[62,24,38,24,"util"],[62,43,38,28],[62,44,38,28,"util"],[62,48,38,28],[62,49,38,29,"sizeFromShape"],[62,62,38,42],[62,63,38,43,"indices"],[62,70,38,50],[62,71,38,51,"shape"],[62,76,38,56],[62,77,38,57],[63,4,39,4],[63,10,39,10,"shapeInfo"],[63,19,39,19],[63,22,39,22,"backend_util"],[63,41,39,34],[63,42,39,34,"backend_util"],[63,54,39,34],[63,55,39,35,"segment_util"],[63,67,39,47],[63,68,39,48,"collectGatherOpShapeInfo"],[63,92,39,72],[63,93,39,73,"x"],[63,94,39,74],[63,96,39,76,"indices"],[63,103,39,83],[63,105,39,85,"parsedAxis"],[63,115,39,95],[63,117,39,97,"$batchDims"],[63,127,39,107],[63,128,39,108],[64,4,40,4],[64,10,40,10,"flattenX"],[64,18,40,18],[64,21,40,21],[64,25,40,21,"reshape"],[64,33,40,28],[64,34,40,28,"reshape"],[64,41,40,28],[64,43,40,29],[65,6,41,8,"inputs"],[65,12,41,14],[65,14,41,16],[66,8,41,18,"x"],[67,6,41,20],[67,7,41,21],[68,6,42,8,"backend"],[68,13,42,15],[69,6,43,8,"attrs"],[69,11,43,13],[69,13,43,15],[70,8,44,12,"shape"],[70,13,44,17],[70,15,44,19],[70,16,45,16,"shapeInfo"],[70,25,45,25],[70,26,45,26,"batchSize"],[70,35,45,35],[70,37,45,37,"shapeInfo"],[70,46,45,46],[70,47,45,47,"outerSize"],[70,56,45,56],[70,58,45,58,"shapeInfo"],[70,67,45,67],[70,68,45,68,"dimSize"],[70,75,45,75],[70,77,46,16,"shapeInfo"],[70,86,46,25],[70,87,46,26,"sliceSize"],[70,96,46,35],[71,6,48,8],[72,4,49,4],[72,5,49,5],[72,6,49,6],[73,4,50,4],[73,10,50,10,"flattenIndex"],[73,22,50,22],[73,25,50,25],[73,29,50,25,"reshape"],[73,37,50,32],[73,38,50,32,"reshape"],[73,45,50,32],[73,47,50,33],[74,6,51,8,"inputs"],[74,12,51,14],[74,14,51,16],[75,8,51,18,"x"],[75,9,51,19],[75,11,51,21,"indices"],[76,6,51,29],[76,7,51,30],[77,6,52,8,"backend"],[77,13,52,15],[78,6,53,8,"attrs"],[78,11,53,13],[78,13,53,15],[79,8,53,17,"shape"],[79,13,53,22],[79,15,53,24],[79,16,53,25,"shapeInfo"],[79,25,53,34],[79,26,53,35,"batchSize"],[79,35,53,44],[79,37,53,46,"indicesSize"],[79,48,53,57],[79,51,53,60,"shapeInfo"],[79,60,53,69],[79,61,53,70,"batchSize"],[79,70,53,79],[80,6,53,81],[81,4,54,4],[81,5,54,5],[81,6,54,6],[82,4,55,4],[82,10,55,10,"flattenOutputShape"],[82,28,55,28],[82,31,55,31],[82,32,56,8,"shapeInfo"],[82,41,56,17],[82,42,56,18,"batchSize"],[82,51,56,27],[82,53,56,29,"shapeInfo"],[82,62,56,38],[82,63,56,39,"outerSize"],[82,72,56,48],[82,74,56,50,"indicesSize"],[82,85,56,61],[82,88,56,64,"shapeInfo"],[82,97,56,73],[82,98,56,74,"batchSize"],[82,107,56,83],[82,109,57,8,"shapeInfo"],[82,118,57,17],[82,119,57,18,"sliceSize"],[82,128,57,27],[82,129,58,5],[83,4,59,4],[83,10,59,10,"indicesBuf"],[83,20,59,20],[83,23,59,23,"backend"],[83,30,59,30],[83,31,59,31,"bufferSync"],[83,41,59,41],[83,42,59,42,"flattenIndex"],[83,54,59,54],[83,55,59,55],[84,4,60,4],[84,10,60,10,"xBuf"],[84,14,60,14],[84,17,60,17,"backend"],[84,24,60,24],[84,25,60,25,"bufferSync"],[84,35,60,35],[84,36,60,36,"flattenX"],[84,44,60,44],[84,45,60,45],[85,4,61,4],[85,10,61,10,"outBuf"],[85,16,61,16],[85,19,61,19],[85,23,61,19,"gatherV2Impl"],[85,37,61,31],[85,38,61,31,"gatherV2Impl"],[85,50,61,31],[85,52,61,32,"xBuf"],[85,56,61,36],[85,58,61,38,"indicesBuf"],[85,68,61,48],[85,70,61,50,"flattenOutputShape"],[85,88,61,68],[85,89,61,69],[86,4,62,4,"backend"],[86,11,62,11],[86,12,62,12,"disposeIntermediateTensorInfo"],[86,41,62,41],[86,42,62,42,"flattenX"],[86,50,62,50],[86,51,62,51],[87,4,63,4,"backend"],[87,11,63,11],[87,12,63,12,"disposeIntermediateTensorInfo"],[87,41,63,41],[87,42,63,42,"flattenIndex"],[87,54,63,54],[87,55,63,55],[88,4,64,4],[88,11,64,11,"backend"],[88,18,64,18],[88,19,64,19,"makeTensorInfo"],[88,33,64,33],[88,34,64,34,"shapeInfo"],[88,43,64,43],[88,44,64,44,"outputShape"],[88,55,64,55],[88,57,64,57,"outBuf"],[88,63,64,63],[88,64,64,64,"dtype"],[88,69,64,69],[88,71,64,71,"outBuf"],[88,77,64,77],[88,78,64,78,"values"],[88,84,64,84],[88,85,64,85],[89,2,65,0],[90,2,66,7],[90,8,66,13,"gatherV2Config"],[90,22,66,27],[90,25,66,30],[91,4,67,4,"kernelName"],[91,14,67,14],[91,16,67,16,"GatherV2"],[91,35,67,24],[91,36,67,24,"GatherV2"],[91,44,67,24],[92,4,68,4,"backendName"],[92,15,68,15],[92,17,68,17],[92,22,68,22],[93,4,69,4,"kernelFunc"],[93,14,69,14],[93,16,69,16,"gatherV2"],[94,2,70,0],[94,3,70,1],[95,0,70,2],[95,3]],"functionMap":{"names":["<global>","gatherV2","util.assert$argument_1"],"mappings":"AAA;OCoB;wDCW,wED;CDiC"},"hasCjsExports":false},"type":"js/module"}]}