{"dependencies":[{"name":"../../engine/topology","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":10,"column":0,"index":286},"end":{"line":10,"column":46,"index":332}}],"key":"rjLWMJbesmUIFpjDSlVWtBpuZL0=","exportNames":["*"],"imports":1}},{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":11,"column":0,"index":333},"end":{"line":11,"column":60,"index":393}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../../utils/types_utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0,"index":467},"end":{"line":13,"column":82,"index":549}}],"key":"KNLCITfwnGLaGBjQ0rMvbYdxCWo=","exportNames":["*"],"imports":1}},{"name":"../../errors","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":14,"column":0,"index":550},"end":{"line":14,"column":42,"index":592}}],"key":"eT202ujluoOcHDbauyWnF/muvbc=","exportNames":["*"],"imports":1}},{"name":"../../backend/tfjs_backend","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":15,"column":0,"index":593},"end":{"line":15,"column":48,"index":641}}],"key":"xUnvOWBkNHpMyFMNlJ5A/sZLhS0=","exportNames":["*"],"imports":1}},{"name":"./preprocessing_utils","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":16,"column":0,"index":642},"end":{"line":16,"column":47,"index":689}}],"key":"7PBI3d2zxdzthoxpKjWcmcJQYfY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"CategoryEncoding\", {\n    enumerable: true,\n    get: function () {\n      return CategoryEncoding;\n    }\n  });\n  var _engineTopology = require(_dependencyMap[0], \"../../engine/topology\");\n  var _tensorflowTfjsCore = require(_dependencyMap[1], \"@tensorflow/tfjs-core\");\n  var _utilsTypes_utils = require(_dependencyMap[2], \"../../utils/types_utils\");\n  var _errors = require(_dependencyMap[3], \"../../errors\");\n  var _backendTfjs_backend = require(_dependencyMap[4], \"../../backend/tfjs_backend\");\n  var K = _interopNamespace(_backendTfjs_backend);\n  var _preprocessing_utils = require(_dependencyMap[5], \"./preprocessing_utils\");\n  var utils = _interopNamespace(_preprocessing_utils);\n  /**\n   * @license\n   * Copyright 2022 CodeSmith LLC\n   *\n   * Use of this source code is governed by an MIT-style\n   * license that can be found in the LICENSE file or at\n   * https://opensource.org/licenses/MIT.\n   * =============================================================================\n   */\n\n  class CategoryEncoding extends _engineTopology.Layer {\n    constructor(args) {\n      super(args);\n      this.numTokens = args.numTokens;\n      if (args.outputMode) {\n        this.outputMode = args.outputMode;\n      } else {\n        this.outputMode = 'multiHot';\n      }\n    }\n    getConfig() {\n      const config = {\n        'numTokens': this.numTokens,\n        'outputMode': this.outputMode\n      };\n      const baseConfig = super.getConfig();\n      Object.assign(config, baseConfig);\n      return config;\n    }\n    computeOutputShape(inputShape) {\n      inputShape = (0, _utilsTypes_utils.getExactlyOneShape)(inputShape);\n      if (inputShape == null) {\n        return [this.numTokens];\n      }\n      if (this.outputMode === 'oneHot' && inputShape[inputShape.length - 1] !== 1) {\n        inputShape.push(this.numTokens);\n        return inputShape;\n      }\n      inputShape[inputShape.length - 1] = this.numTokens;\n      return inputShape;\n    }\n    call(inputs, kwargs) {\n      return (0, _tensorflowTfjsCore.tidy)(() => {\n        inputs = (0, _utilsTypes_utils.getExactlyOneTensor)(inputs);\n        if (inputs.dtype !== 'int32') {\n          inputs = K.cast(inputs, 'int32');\n        }\n        let countWeights;\n        if (typeof kwargs['countWeights'] !== 'undefined') {\n          if (this.outputMode !== 'count') {\n            throw new _errors.ValueError(`countWeights is not used when outputMode !== count.\n              Received countWeights=${kwargs['countWeights']}`);\n          }\n          countWeights = (0, _utilsTypes_utils.getExactlyOneTensor)(kwargs['countWeights']);\n        }\n        const maxValue = (0, _tensorflowTfjsCore.max)(inputs);\n        const minValue = (0, _tensorflowTfjsCore.min)(inputs);\n        const greaterEqualMax = (0, _tensorflowTfjsCore.greater)(this.numTokens, maxValue).bufferSync().get(0);\n        const greaterMin = (0, _tensorflowTfjsCore.greaterEqual)(minValue, 0).bufferSync().get(0);\n        if (!(greaterEqualMax && greaterMin)) {\n          throw new _errors.ValueError('Input values must be between 0 < values <=' + ` numTokens with numTokens=${this.numTokens}`);\n        }\n        return utils.encodeCategoricalInputs(inputs, this.outputMode, this.numTokens, countWeights);\n      });\n    }\n  }\n  /** @nocollapse */\n  CategoryEncoding.className = 'CategoryEncoding';\n  _tensorflowTfjsCore.serialization.registerClass(CategoryEncoding);\n});","lineCount":105,"map":[[22,2,79,0,"Object"],[22,8,79,0],[22,9,79,0,"defineProperty"],[22,23,79,0],[22,24,79,0,"exports"],[22,31,79,0],[23,4,79,0,"enumerable"],[23,14,79,0],[24,4,79,0,"get"],[24,7,79,0],[24,18,79,0,"get"],[24,19,79,0],[25,6,79,0],[25,13,79,9,"CategoryEncoding"],[25,29,79,25],[26,4,79,25],[27,2,79,25],[28,2,10,0],[28,6,10,0,"_engineTopology"],[28,21,10,0],[28,24,10,0,"require"],[28,31,10,0],[28,32,10,0,"_dependencyMap"],[28,46,10,0],[29,2,11,0],[29,6,11,0,"_tensorflowTfjsCore"],[29,25,11,0],[29,28,11,0,"require"],[29,35,11,0],[29,36,11,0,"_dependencyMap"],[29,50,11,0],[30,2,13,0],[30,6,13,0,"_utilsTypes_utils"],[30,23,13,0],[30,26,13,0,"require"],[30,33,13,0],[30,34,13,0,"_dependencyMap"],[30,48,13,0],[31,2,14,0],[31,6,14,0,"_errors"],[31,13,14,0],[31,16,14,0,"require"],[31,23,14,0],[31,24,14,0,"_dependencyMap"],[31,38,14,0],[32,2,15,0],[32,6,15,0,"_backendTfjs_backend"],[32,26,15,0],[32,29,15,0,"require"],[32,36,15,0],[32,37,15,0,"_dependencyMap"],[32,51,15,0],[33,2,15,0],[33,6,15,0,"K"],[33,7,15,0],[33,10,15,0,"_interopNamespace"],[33,27,15,0],[33,28,15,0,"_backendTfjs_backend"],[33,48,15,0],[34,2,16,0],[34,6,16,0,"_preprocessing_utils"],[34,26,16,0],[34,29,16,0,"require"],[34,36,16,0],[34,37,16,0,"_dependencyMap"],[34,51,16,0],[35,2,16,0],[35,6,16,0,"utils"],[35,11,16,0],[35,14,16,0,"_interopNamespace"],[35,31,16,0],[35,32,16,0,"_preprocessing_utils"],[35,52,16,0],[36,2,1,0],[37,0,2,0],[38,0,3,0],[39,0,4,0],[40,0,5,0],[41,0,6,0],[42,0,7,0],[43,0,8,0],[44,0,9,0],[46,2,17,0],[46,8,17,6,"CategoryEncoding"],[46,24,17,22],[46,33,17,31,"Layer"],[46,48,17,36],[46,49,17,36,"Layer"],[46,54,17,36],[46,55,17,37],[47,4,18,4,"constructor"],[47,15,18,15,"constructor"],[47,16,18,16,"args"],[47,20,18,20],[47,22,18,22],[48,6,19,8],[48,11,19,13],[48,12,19,14,"args"],[48,16,19,18],[48,17,19,19],[49,6,20,8],[49,10,20,12],[49,11,20,13,"numTokens"],[49,20,20,22],[49,23,20,25,"args"],[49,27,20,29],[49,28,20,30,"numTokens"],[49,37,20,39],[50,6,21,8],[50,10,21,12,"args"],[50,14,21,16],[50,15,21,17,"outputMode"],[50,25,21,27],[50,27,21,29],[51,8,22,12],[51,12,22,16],[51,13,22,17,"outputMode"],[51,23,22,27],[51,26,22,30,"args"],[51,30,22,34],[51,31,22,35,"outputMode"],[51,41,22,45],[52,6,23,8],[52,7,23,9],[52,13,24,13],[53,8,25,12],[53,12,25,16],[53,13,25,17,"outputMode"],[53,23,25,27],[53,26,25,30],[53,36,25,40],[54,6,26,8],[55,4,27,4],[56,4,28,4,"getConfig"],[56,13,28,13,"getConfig"],[56,14,28,13],[56,16,28,16],[57,6,29,8],[57,12,29,14,"config"],[57,18,29,20],[57,21,29,23],[58,8,30,12],[58,19,30,23],[58,21,30,25],[58,25,30,29],[58,26,30,30,"numTokens"],[58,35,30,39],[59,8,31,12],[59,20,31,24],[59,22,31,26],[59,26,31,30],[59,27,31,31,"outputMode"],[60,6,32,8],[60,7,32,9],[61,6,33,8],[61,12,33,14,"baseConfig"],[61,22,33,24],[61,25,33,27],[61,30,33,32],[61,31,33,33,"getConfig"],[61,40,33,42],[61,41,33,43],[61,42,33,44],[62,6,34,8,"Object"],[62,12,34,14],[62,13,34,15,"assign"],[62,19,34,21],[62,20,34,22,"config"],[62,26,34,28],[62,28,34,30,"baseConfig"],[62,38,34,40],[62,39,34,41],[63,6,35,8],[63,13,35,15,"config"],[63,19,35,21],[64,4,36,4],[65,4,37,4,"computeOutputShape"],[65,22,37,22,"computeOutputShape"],[65,23,37,23,"inputShape"],[65,33,37,33],[65,35,37,35],[66,6,38,8,"inputShape"],[66,16,38,18],[66,19,38,21],[66,23,38,21,"getExactlyOneShape"],[66,40,38,39],[66,41,38,39,"getExactlyOneShape"],[66,59,38,39],[66,61,38,40,"inputShape"],[66,71,38,50],[66,72,38,51],[67,6,39,8],[67,10,39,12,"inputShape"],[67,20,39,22],[67,24,39,26],[67,28,39,30],[67,30,39,32],[68,8,40,12],[68,15,40,19],[68,16,40,20],[68,20,40,24],[68,21,40,25,"numTokens"],[68,30,40,34],[68,31,40,35],[69,6,41,8],[70,6,42,8],[70,10,42,12],[70,14,42,16],[70,15,42,17,"outputMode"],[70,25,42,27],[70,30,42,32],[70,38,42,40],[70,42,42,44,"inputShape"],[70,52,42,54],[70,53,42,55,"inputShape"],[70,63,42,65],[70,64,42,66,"length"],[70,70,42,72],[70,73,42,75],[70,74,42,76],[70,75,42,77],[70,80,42,82],[70,81,42,83],[70,83,42,85],[71,8,43,12,"inputShape"],[71,18,43,22],[71,19,43,23,"push"],[71,23,43,27],[71,24,43,28],[71,28,43,32],[71,29,43,33,"numTokens"],[71,38,43,42],[71,39,43,43],[72,8,44,12],[72,15,44,19,"inputShape"],[72,25,44,29],[73,6,45,8],[74,6,46,8,"inputShape"],[74,16,46,18],[74,17,46,19,"inputShape"],[74,27,46,29],[74,28,46,30,"length"],[74,34,46,36],[74,37,46,39],[74,38,46,40],[74,39,46,41],[74,42,46,44],[74,46,46,48],[74,47,46,49,"numTokens"],[74,56,46,58],[75,6,47,8],[75,13,47,15,"inputShape"],[75,23,47,25],[76,4,48,4],[77,4,49,4,"call"],[77,8,49,8,"call"],[77,9,49,9,"inputs"],[77,15,49,15],[77,17,49,17,"kwargs"],[77,23,49,23],[77,25,49,25],[78,6,50,8],[78,13,50,15],[78,17,50,15,"tidy"],[78,36,50,19],[78,37,50,19,"tidy"],[78,41,50,19],[78,43,50,20],[78,49,50,26],[79,8,51,12,"inputs"],[79,14,51,18],[79,17,51,21],[79,21,51,21,"getExactlyOneTensor"],[79,38,51,40],[79,39,51,40,"getExactlyOneTensor"],[79,58,51,40],[79,60,51,41,"inputs"],[79,66,51,47],[79,67,51,48],[80,8,52,12],[80,12,52,16,"inputs"],[80,18,52,22],[80,19,52,23,"dtype"],[80,24,52,28],[80,29,52,33],[80,36,52,40],[80,38,52,42],[81,10,53,16,"inputs"],[81,16,53,22],[81,19,53,25,"K"],[81,20,53,26],[81,21,53,27,"cast"],[81,25,53,31],[81,26,53,32,"inputs"],[81,32,53,38],[81,34,53,40],[81,41,53,47],[81,42,53,48],[82,8,54,12],[83,8,55,12],[83,12,55,16,"countWeights"],[83,24,55,28],[84,8,56,12],[84,12,56,17],[84,19,56,24,"kwargs"],[84,25,56,30],[84,26,56,31],[84,40,56,45],[84,41,56,46],[84,46,56,52],[84,57,56,63],[84,59,56,65],[85,10,57,16],[85,14,57,20],[85,18,57,24],[85,19,57,25,"outputMode"],[85,29,57,35],[85,34,57,40],[85,41,57,47],[85,43,57,49],[86,12,58,20],[86,18,58,26],[86,22,58,30,"ValueError"],[86,29,58,40],[86,30,58,40,"ValueError"],[86,40,58,40],[86,41,58,41],[87,0,59,0],[87,38,59,38,"kwargs"],[87,44,59,44],[87,45,59,45],[87,59,59,59],[87,60,59,60],[87,62,59,62],[87,63,59,63],[88,10,60,16],[89,10,61,16,"countWeights"],[89,22,61,28],[89,25,62,22],[89,29,62,22,"getExactlyOneTensor"],[89,46,62,41],[89,47,62,41,"getExactlyOneTensor"],[89,66,62,41],[89,68,62,42,"kwargs"],[89,74,62,48],[89,75,62,49],[89,89,62,63],[89,90,62,64],[89,91,62,65],[90,8,63,12],[91,8,64,12],[91,14,64,18,"maxValue"],[91,22,64,26],[91,25,64,29],[91,29,64,29,"max"],[91,48,64,32],[91,49,64,32,"max"],[91,52,64,32],[91,54,64,33,"inputs"],[91,60,64,39],[91,61,64,40],[92,8,65,12],[92,14,65,18,"minValue"],[92,22,65,26],[92,25,65,29],[92,29,65,29,"min"],[92,48,65,32],[92,49,65,32,"min"],[92,52,65,32],[92,54,65,33,"inputs"],[92,60,65,39],[92,61,65,40],[93,8,66,12],[93,14,66,18,"greaterEqualMax"],[93,29,66,33],[93,32,66,36],[93,36,66,36,"greater"],[93,55,66,43],[93,56,66,43,"greater"],[93,63,66,43],[93,65,66,44],[93,69,66,48],[93,70,66,49,"numTokens"],[93,79,66,58],[93,81,66,60,"maxValue"],[93,89,66,68],[93,90,66,69],[93,91,67,17,"bufferSync"],[93,101,67,27],[93,102,67,28],[93,103,67,29],[93,104,67,30,"get"],[93,107,67,33],[93,108,67,34],[93,109,67,35],[93,110,67,36],[94,8,68,12],[94,14,68,18,"greaterMin"],[94,24,68,28],[94,27,68,31],[94,31,68,31,"greaterEqual"],[94,50,68,43],[94,51,68,43,"greaterEqual"],[94,63,68,43],[94,65,68,44,"minValue"],[94,73,68,52],[94,75,68,54],[94,76,68,55],[94,77,68,56],[94,78,68,57,"bufferSync"],[94,88,68,67],[94,89,68,68],[94,90,68,69],[94,91,68,70,"get"],[94,94,68,73],[94,95,68,74],[94,96,68,75],[94,97,68,76],[95,8,69,12],[95,12,69,16],[95,14,69,18,"greaterEqualMax"],[95,29,69,33],[95,33,69,37,"greaterMin"],[95,43,69,47],[95,44,69,48],[95,46,69,50],[96,10,70,16],[96,16,70,22],[96,20,70,26,"ValueError"],[96,27,70,36],[96,28,70,36,"ValueError"],[96,38,70,36],[96,39,70,37],[96,83,70,81],[96,86,71,22],[96,115,71,51],[96,119,71,55],[96,120,71,56,"numTokens"],[96,129,71,65],[96,131,71,67],[96,132,71,68],[97,8,72,12],[98,8,73,12],[98,15,73,19,"utils"],[98,20,73,24],[98,21,73,25,"encodeCategoricalInputs"],[98,44,73,48],[98,45,73,49,"inputs"],[98,51,73,55],[98,53,73,57],[98,57,73,61],[98,58,73,62,"outputMode"],[98,68,73,72],[98,70,73,74],[98,74,73,78],[98,75,73,79,"numTokens"],[98,84,73,88],[98,86,73,90,"countWeights"],[98,98,73,102],[98,99,73,103],[99,6,74,8],[99,7,74,9],[99,8,74,10],[100,4,75,4],[101,2,76,0],[102,2,77,0],[103,2,78,0,"CategoryEncoding"],[103,18,78,16],[103,19,78,17,"className"],[103,28,78,26],[103,31,78,29],[103,49,78,47],[104,2,80,0,"serialization"],[104,21,80,13],[104,22,80,13,"serialization"],[104,35,80,13],[104,36,80,14,"registerClass"],[104,49,80,27],[104,50,80,28,"CategoryEncoding"],[104,66,80,44],[104,67,80,45],[105,0,80,46],[105,3]],"functionMap":{"names":["<global>","CategoryEncoding","CategoryEncoding#constructor","CategoryEncoding#getConfig","CategoryEncoding#computeOutputShape","CategoryEncoding#call","tidy$argument_0"],"mappings":"AAA;ACgB;ICC;KDS;IEC;KFQ;IGC;KHW;IIC;oBCC;SDwB;KJC;CDC"},"hasCjsExports":false},"type":"js/module"}]}