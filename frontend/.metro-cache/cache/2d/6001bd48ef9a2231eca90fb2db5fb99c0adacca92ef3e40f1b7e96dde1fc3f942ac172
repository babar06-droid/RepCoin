{"dependencies":[{"name":"./shader_compiler","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":54,"index":757}}],"key":"yVSKlvZSxQn3Ck2puzGVWEYPzq8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"GatherProgram\", {\n    enumerable: true,\n    get: function () {\n      return GatherProgram;\n    }\n  });\n  var _shader_compiler = require(_dependencyMap[0], \"./shader_compiler\");\n  /**\n   * @license\n   * Copyright 2017 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  class GatherProgram {\n    constructor(aShape, outputShape) {\n      this.variableNames = ['A', 'indices'];\n      this.outputShape = outputShape;\n      this.rank = outputShape.length;\n      const dtype = (0, _shader_compiler.getCoordsDataType)(this.rank);\n      const sourceCoords = getSourceCoords(aShape, 2);\n      this.userCode = `\n      void main() {\n        ${dtype} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${aShape[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${sourceCoords}));\n      }\n    `;\n    }\n  }\n  // The input and output are always flattened into rank 4 tensors.\n  function getSourceCoords(aShape, axis) {\n    const currentCoords = ['resRC.x', 'resRC.y', 'resRC.z', 'resRC.w'];\n    const sourceCoords = [];\n    for (let i = 0; i < aShape.length; i++) {\n      if (i === 2) {\n        sourceCoords.push('index');\n      } else {\n        sourceCoords.push(`${currentCoords[i]}`);\n      }\n    }\n    return sourceCoords.join();\n  }\n});","lineCount":61,"map":[[7,2,18,0,"Object"],[7,8,18,0],[7,9,18,0,"defineProperty"],[7,23,18,0],[7,24,18,0,"exports"],[7,31,18,0],[8,4,18,0,"enumerable"],[8,14,18,0],[9,4,18,0,"get"],[9,7,18,0],[9,18,18,0,"get"],[9,19,18,0],[10,6,18,0],[10,13,18,0,"GatherProgram"],[10,26,18,0],[11,4,18,0],[12,2,18,0],[13,2,17,0],[13,6,17,0,"_shader_compiler"],[13,22,17,0],[13,25,17,0,"require"],[13,32,17,0],[13,33,17,0,"_dependencyMap"],[13,47,17,0],[14,2,1,0],[15,0,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[20,0,7,0],[21,0,8,0],[22,0,9,0],[23,0,10,0],[24,0,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[31,2,18,7],[31,8,18,13,"GatherProgram"],[31,21,18,26],[31,22,18,27],[32,4,19,4,"constructor"],[32,15,19,15,"constructor"],[32,16,19,16,"aShape"],[32,22,19,22],[32,24,19,24,"outputShape"],[32,35,19,35],[32,37,19,37],[33,6,20,8],[33,10,20,12],[33,11,20,13,"variableNames"],[33,24,20,26],[33,27,20,29],[33,28,20,30],[33,31,20,33],[33,33,20,35],[33,42,20,44],[33,43,20,45],[34,6,21,8],[34,10,21,12],[34,11,21,13,"outputShape"],[34,22,21,24],[34,25,21,27,"outputShape"],[34,36,21,38],[35,6,22,8],[35,10,22,12],[35,11,22,13,"rank"],[35,15,22,17],[35,18,22,20,"outputShape"],[35,29,22,31],[35,30,22,32,"length"],[35,36,22,38],[36,6,23,8],[36,12,23,14,"dtype"],[36,17,23,19],[36,20,23,22],[36,24,23,22,"getCoordsDataType"],[36,40,23,39],[36,41,23,39,"getCoordsDataType"],[36,58,23,39],[36,60,23,40],[36,64,23,44],[36,65,23,45,"rank"],[36,69,23,49],[36,70,23,50],[37,6,24,8],[37,12,24,14,"sourceCoords"],[37,24,24,26],[37,27,24,29,"getSourceCoords"],[37,42,24,44],[37,43,24,45,"aShape"],[37,49,24,51],[37,51,24,53],[37,52,24,54],[37,53,24,55],[38,6,25,8],[38,10,25,12],[38,11,25,13,"userCode"],[38,19,25,21],[38,22,25,24],[39,0,26,0],[40,0,27,0],[40,10,27,10,"dtype"],[40,15,27,15],[41,0,28,0],[42,0,29,0],[42,52,29,52,"aShape"],[42,58,29,58],[42,59,29,59],[42,60,29,60],[42,61,29,61],[43,0,30,0],[43,36,30,36,"sourceCoords"],[43,48,30,48],[44,0,31,0],[45,0,32,0],[45,5,32,5],[46,4,33,4],[47,2,34,0],[48,2,35,0],[49,2,36,0],[49,11,36,9,"getSourceCoords"],[49,26,36,24,"getSourceCoords"],[49,27,36,25,"aShape"],[49,33,36,31],[49,35,36,33,"axis"],[49,39,36,37],[49,41,36,39],[50,4,37,4],[50,10,37,10,"currentCoords"],[50,23,37,23],[50,26,37,26],[50,27,37,27],[50,36,37,36],[50,38,37,38],[50,47,37,47],[50,49,37,49],[50,58,37,58],[50,60,37,60],[50,69,37,69],[50,70,37,70],[51,4,38,4],[51,10,38,10,"sourceCoords"],[51,22,38,22],[51,25,38,25],[51,27,38,27],[52,4,39,4],[52,9,39,9],[52,13,39,13,"i"],[52,14,39,14],[52,17,39,17],[52,18,39,18],[52,20,39,20,"i"],[52,21,39,21],[52,24,39,24,"aShape"],[52,30,39,30],[52,31,39,31,"length"],[52,37,39,37],[52,39,39,39,"i"],[52,40,39,40],[52,42,39,42],[52,44,39,44],[53,6,40,8],[53,10,40,12,"i"],[53,11,40,13],[53,16,40,18],[53,17,40,19],[53,19,40,21],[54,8,41,12,"sourceCoords"],[54,20,41,24],[54,21,41,25,"push"],[54,25,41,29],[54,26,41,30],[54,33,41,37],[54,34,41,38],[55,6,42,8],[55,7,42,9],[55,13,43,13],[56,8,44,12,"sourceCoords"],[56,20,44,24],[56,21,44,25,"push"],[56,25,44,29],[56,26,44,30],[56,29,44,33,"currentCoords"],[56,42,44,46],[56,43,44,47,"i"],[56,44,44,48],[56,45,44,49],[56,47,44,51],[56,48,44,52],[57,6,45,8],[58,4,46,4],[59,4,47,4],[59,11,47,11,"sourceCoords"],[59,23,47,23],[59,24,47,24,"join"],[59,28,47,28],[59,29,47,29],[59,30,47,30],[60,2,48,0],[61,0,48,1],[61,3]],"functionMap":{"names":["<global>","GatherProgram","GatherProgram#constructor","getSourceCoords"],"mappings":"AAA;OCiB;ICC;KDc;CDC;AGE;CHY"},"hasCjsExports":false},"type":"js/module"}]}