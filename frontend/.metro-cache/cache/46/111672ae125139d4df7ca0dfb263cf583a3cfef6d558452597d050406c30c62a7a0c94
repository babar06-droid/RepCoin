{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":80,"index":783}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":784},"end":{"line":18,"column":47,"index":831}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}},{"name":"./Transpose","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":832},"end":{"line":19,"column":40,"index":872}}],"key":"F6S1ekgW6WEHcH6rql/beO2khwY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.cumprod = cumprod;\n  Object.defineProperty(exports, \"cumprodConfig\", {\n    enumerable: true,\n    get: function () {\n      return cumprodConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  var _Transpose = require(_dependencyMap[2], \"./Transpose\");\n  /**\n   * @license\n   * Copyright 2022 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function cumprod(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x\n    } = inputs;\n    const {\n      axis,\n      exclusive,\n      reverse\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)(x, 'cumprod');\n    const permutation = _tensorflowTfjsCore.backend_util.getAxesPermutation([axis], x.shape.length);\n    let $x = x;\n    if (permutation != null) {\n      $x = (0, _Transpose.transpose)({\n        inputs: {\n          x\n        },\n        backend,\n        attrs: {\n          perm: permutation\n        }\n      });\n    }\n    const permutedAxis = _tensorflowTfjsCore.backend_util.getInnerMostAxes(1, x.shape.length)[0];\n    if (permutedAxis !== $x.shape.length - 1) {\n      throw new Error(`backend.cumprod in CPU expects an inner-most ` + `axis=${$x.shape.length - 1} but got axis=${permutedAxis}`);\n    }\n    const resultDtype = (0, _tensorflowTfjsCore.upcastType)($x.dtype, 'int32');\n    const vals = _tensorflowTfjsCore.util.makeOnesTypedArray(_tensorflowTfjsCore.util.sizeFromShape($x.shape), resultDtype);\n    const aVals = backend.data.get($x.dataId).values;\n    const finalDim = $x.shape[$x.shape.length - 1];\n    const indexAdjuster = reverse ? (i, j) => i + finalDim - j - 1 : (i, j) => i + j;\n    for (let i = 0; i < aVals.length; i += finalDim) {\n      for (let j = 0; j < finalDim; j++) {\n        const idx = indexAdjuster(i, j);\n        if (j === 0) {\n          vals[idx] = exclusive ? 1 : aVals[idx];\n        } else {\n          const prevIdx = indexAdjuster(i, j - 1);\n          vals[idx] = exclusive ? aVals[prevIdx] * vals[prevIdx] : aVals[idx] * vals[prevIdx];\n        }\n      }\n    }\n    const result = backend.makeTensorInfo($x.shape, resultDtype, vals);\n    if (permutation != null) {\n      const reversePermutation = _tensorflowTfjsCore.backend_util.getUndoAxesPermutation(permutation);\n      const reverseTransposedResult = (0, _Transpose.transpose)({\n        inputs: {\n          x: result\n        },\n        backend,\n        attrs: {\n          perm: reversePermutation\n        }\n      });\n      backend.disposeIntermediateTensorInfo(result);\n      backend.disposeIntermediateTensorInfo($x);\n      return reverseTransposedResult;\n    }\n    return result;\n  }\n  const cumprodConfig = {\n    kernelName: _tensorflowTfjsCore.Cumprod,\n    backendName: 'cpu',\n    kernelFunc: cumprod\n  };\n});","lineCount":105,"map":[[7,2,20,0,"exports"],[7,9,20,0],[7,10,20,0,"cumprod"],[7,17,20,0],[7,20,20,0,"cumprod"],[7,27,20,0],[8,2,65,0,"Object"],[8,8,65,0],[8,9,65,0,"defineProperty"],[8,23,65,0],[8,24,65,0,"exports"],[8,31,65,0],[9,4,65,0,"enumerable"],[9,14,65,0],[10,4,65,0,"get"],[10,7,65,0],[10,18,65,0,"get"],[10,19,65,0],[11,6,65,0],[11,13,65,0,"cumprodConfig"],[11,26,65,0],[12,4,65,0],[13,2,65,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,19,0],[16,6,19,0,"_Transpose"],[16,16,19,0],[16,19,19,0,"require"],[16,26,19,0],[16,27,19,0,"_dependencyMap"],[16,41,19,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[22,0,6,0],[23,0,7,0],[24,0,8,0],[25,0,9,0],[26,0,10,0],[27,0,11,0],[28,0,12,0],[29,0,13,0],[30,0,14,0],[31,0,15,0],[32,0,16,0],[34,2,20,7],[34,11,20,16,"cumprod"],[34,18,20,23,"cumprod"],[34,19,20,24,"args"],[34,23,20,28],[34,25,20,30],[35,4,21,4],[35,10,21,10],[36,6,21,12,"inputs"],[36,12,21,18],[37,6,21,20,"backend"],[37,13,21,27],[38,6,21,29,"attrs"],[39,4,21,35],[39,5,21,36],[39,8,21,39,"args"],[39,12,21,43],[40,4,22,4],[40,10,22,10],[41,6,22,12,"x"],[42,4,22,14],[42,5,22,15],[42,8,22,18,"inputs"],[42,14,22,24],[43,4,23,4],[43,10,23,10],[44,6,23,12,"axis"],[44,10,23,16],[45,6,23,18,"exclusive"],[45,15,23,27],[46,6,23,29,"reverse"],[47,4,23,37],[47,5,23,38],[47,8,23,41,"attrs"],[47,13,23,46],[48,4,24,4],[48,8,24,4,"assertNotComplex"],[48,17,24,20],[48,18,24,20,"assertNotComplex"],[48,34,24,20],[48,36,24,21,"x"],[48,37,24,22],[48,39,24,24],[48,48,24,33],[48,49,24,34],[49,4,25,4],[49,10,25,10,"permutation"],[49,21,25,21],[49,24,25,24,"backend_util"],[49,43,25,36],[49,44,25,36,"backend_util"],[49,56,25,36],[49,57,25,37,"getAxesPermutation"],[49,75,25,55],[49,76,25,56],[49,77,25,57,"axis"],[49,81,25,61],[49,82,25,62],[49,84,25,64,"x"],[49,85,25,65],[49,86,25,66,"shape"],[49,91,25,71],[49,92,25,72,"length"],[49,98,25,78],[49,99,25,79],[50,4,26,4],[50,8,26,8,"$x"],[50,10,26,10],[50,13,26,13,"x"],[50,14,26,14],[51,4,27,4],[51,8,27,8,"permutation"],[51,19,27,19],[51,23,27,23],[51,27,27,27],[51,29,27,29],[52,6,28,8,"$x"],[52,8,28,10],[52,11,28,13],[52,15,28,13,"transpose"],[52,25,28,22],[52,26,28,22,"transpose"],[52,35,28,22],[52,37,28,23],[53,8,28,25,"inputs"],[53,14,28,31],[53,16,28,33],[54,10,28,35,"x"],[55,8,28,37],[55,9,28,38],[56,8,28,40,"backend"],[56,15,28,47],[57,8,28,49,"attrs"],[57,13,28,54],[57,15,28,56],[58,10,28,58,"perm"],[58,14,28,62],[58,16,28,64,"permutation"],[59,8,28,76],[60,6,28,78],[60,7,28,79],[60,8,28,80],[61,4,29,4],[62,4,30,4],[62,10,30,10,"permutedAxis"],[62,22,30,22],[62,25,30,25,"backend_util"],[62,44,30,37],[62,45,30,37,"backend_util"],[62,57,30,37],[62,58,30,38,"getInnerMostAxes"],[62,74,30,54],[62,75,30,55],[62,76,30,56],[62,78,30,58,"x"],[62,79,30,59],[62,80,30,60,"shape"],[62,85,30,65],[62,86,30,66,"length"],[62,92,30,72],[62,93,30,73],[62,94,30,74],[62,95,30,75],[62,96,30,76],[63,4,31,4],[63,8,31,8,"permutedAxis"],[63,20,31,20],[63,25,31,25,"$x"],[63,27,31,27],[63,28,31,28,"shape"],[63,33,31,33],[63,34,31,34,"length"],[63,40,31,40],[63,43,31,43],[63,44,31,44],[63,46,31,46],[64,6,32,8],[64,12,32,14],[64,16,32,18,"Error"],[64,21,32,23],[64,22,32,24],[64,69,32,71],[64,72,33,12],[64,80,33,20,"$x"],[64,82,33,22],[64,83,33,23,"shape"],[64,88,33,28],[64,89,33,29,"length"],[64,95,33,35],[64,98,33,38],[64,99,33,39],[64,116,33,56,"permutedAxis"],[64,128,33,68],[64,130,33,70],[64,131,33,71],[65,4,34,4],[66,4,35,4],[66,10,35,10,"resultDtype"],[66,21,35,21],[66,24,35,24],[66,28,35,24,"upcastType"],[66,47,35,34],[66,48,35,34,"upcastType"],[66,58,35,34],[66,60,35,35,"$x"],[66,62,35,37],[66,63,35,38,"dtype"],[66,68,35,43],[66,70,35,45],[66,77,35,52],[66,78,35,53],[67,4,36,4],[67,10,36,10,"vals"],[67,14,36,14],[67,17,36,17,"util"],[67,36,36,21],[67,37,36,21,"util"],[67,41,36,21],[67,42,36,22,"makeOnesTypedArray"],[67,60,36,40],[67,61,36,41,"util"],[67,80,36,45],[67,81,36,45,"util"],[67,85,36,45],[67,86,36,46,"sizeFromShape"],[67,99,36,59],[67,100,36,60,"$x"],[67,102,36,62],[67,103,36,63,"shape"],[67,108,36,68],[67,109,36,69],[67,111,36,71,"resultDtype"],[67,122,36,82],[67,123,36,83],[68,4,37,4],[68,10,37,10,"aVals"],[68,15,37,15],[68,18,37,18,"backend"],[68,25,37,25],[68,26,37,26,"data"],[68,30,37,30],[68,31,37,31,"get"],[68,34,37,34],[68,35,37,35,"$x"],[68,37,37,37],[68,38,37,38,"dataId"],[68,44,37,44],[68,45,37,45],[68,46,37,46,"values"],[68,52,37,52],[69,4,38,4],[69,10,38,10,"finalDim"],[69,18,38,18],[69,21,38,21,"$x"],[69,23,38,23],[69,24,38,24,"shape"],[69,29,38,29],[69,30,38,30,"$x"],[69,32,38,32],[69,33,38,33,"shape"],[69,38,38,38],[69,39,38,39,"length"],[69,45,38,45],[69,48,38,48],[69,49,38,49],[69,50,38,50],[70,4,39,4],[70,10,39,10,"indexAdjuster"],[70,23,39,23],[70,26,39,26,"reverse"],[70,33,39,33],[70,36,40,8],[70,37,40,9,"i"],[70,38,40,10],[70,40,40,12,"j"],[70,41,40,13],[70,46,40,18,"i"],[70,47,40,19],[70,50,40,22,"finalDim"],[70,58,40,30],[70,61,40,33,"j"],[70,62,40,34],[70,65,40,37],[70,66,40,38],[70,69,41,8],[70,70,41,9,"i"],[70,71,41,10],[70,73,41,12,"j"],[70,74,41,13],[70,79,41,18,"i"],[70,80,41,19],[70,83,41,22,"j"],[70,84,41,23],[71,4,42,4],[71,9,42,9],[71,13,42,13,"i"],[71,14,42,14],[71,17,42,17],[71,18,42,18],[71,20,42,20,"i"],[71,21,42,21],[71,24,42,24,"aVals"],[71,29,42,29],[71,30,42,30,"length"],[71,36,42,36],[71,38,42,38,"i"],[71,39,42,39],[71,43,42,43,"finalDim"],[71,51,42,51],[71,53,42,53],[72,6,43,8],[72,11,43,13],[72,15,43,17,"j"],[72,16,43,18],[72,19,43,21],[72,20,43,22],[72,22,43,24,"j"],[72,23,43,25],[72,26,43,28,"finalDim"],[72,34,43,36],[72,36,43,38,"j"],[72,37,43,39],[72,39,43,41],[72,41,43,43],[73,8,44,12],[73,14,44,18,"idx"],[73,17,44,21],[73,20,44,24,"indexAdjuster"],[73,33,44,37],[73,34,44,38,"i"],[73,35,44,39],[73,37,44,41,"j"],[73,38,44,42],[73,39,44,43],[74,8,45,12],[74,12,45,16,"j"],[74,13,45,17],[74,18,45,22],[74,19,45,23],[74,21,45,25],[75,10,46,16,"vals"],[75,14,46,20],[75,15,46,21,"idx"],[75,18,46,24],[75,19,46,25],[75,22,46,28,"exclusive"],[75,31,46,37],[75,34,46,40],[75,35,46,41],[75,38,46,44,"aVals"],[75,43,46,49],[75,44,46,50,"idx"],[75,47,46,53],[75,48,46,54],[76,8,47,12],[76,9,47,13],[76,15,48,17],[77,10,49,16],[77,16,49,22,"prevIdx"],[77,23,49,29],[77,26,49,32,"indexAdjuster"],[77,39,49,45],[77,40,49,46,"i"],[77,41,49,47],[77,43,49,49,"j"],[77,44,49,50],[77,47,49,53],[77,48,49,54],[77,49,49,55],[78,10,50,16,"vals"],[78,14,50,20],[78,15,50,21,"idx"],[78,18,50,24],[78,19,50,25],[78,22,50,28,"exclusive"],[78,31,50,37],[78,34,50,40,"aVals"],[78,39,50,45],[78,40,50,46,"prevIdx"],[78,47,50,53],[78,48,50,54],[78,51,50,57,"vals"],[78,55,50,61],[78,56,50,62,"prevIdx"],[78,63,50,69],[78,64,50,70],[78,67,51,20,"aVals"],[78,72,51,25],[78,73,51,26,"idx"],[78,76,51,29],[78,77,51,30],[78,80,51,33,"vals"],[78,84,51,37],[78,85,51,38,"prevIdx"],[78,92,51,45],[78,93,51,46],[79,8,52,12],[80,6,53,8],[81,4,54,4],[82,4,55,4],[82,10,55,10,"result"],[82,16,55,16],[82,19,55,19,"backend"],[82,26,55,26],[82,27,55,27,"makeTensorInfo"],[82,41,55,41],[82,42,55,42,"$x"],[82,44,55,44],[82,45,55,45,"shape"],[82,50,55,50],[82,52,55,52,"resultDtype"],[82,63,55,63],[82,65,55,65,"vals"],[82,69,55,69],[82,70,55,70],[83,4,56,4],[83,8,56,8,"permutation"],[83,19,56,19],[83,23,56,23],[83,27,56,27],[83,29,56,29],[84,6,57,8],[84,12,57,14,"reversePermutation"],[84,30,57,32],[84,33,57,35,"backend_util"],[84,52,57,47],[84,53,57,47,"backend_util"],[84,65,57,47],[84,66,57,48,"getUndoAxesPermutation"],[84,88,57,70],[84,89,57,71,"permutation"],[84,100,57,82],[84,101,57,83],[85,6,58,8],[85,12,58,14,"reverseTransposedResult"],[85,35,58,37],[85,38,58,40],[85,42,58,40,"transpose"],[85,52,58,49],[85,53,58,49,"transpose"],[85,62,58,49],[85,64,58,50],[86,8,58,52,"inputs"],[86,14,58,58],[86,16,58,60],[87,10,58,62,"x"],[87,11,58,63],[87,13,58,65,"result"],[88,8,58,72],[88,9,58,73],[89,8,58,75,"backend"],[89,15,58,82],[90,8,58,84,"attrs"],[90,13,58,89],[90,15,58,91],[91,10,58,93,"perm"],[91,14,58,97],[91,16,58,99,"reversePermutation"],[92,8,58,118],[93,6,58,120],[93,7,58,121],[93,8,58,122],[94,6,59,8,"backend"],[94,13,59,15],[94,14,59,16,"disposeIntermediateTensorInfo"],[94,43,59,45],[94,44,59,46,"result"],[94,50,59,52],[94,51,59,53],[95,6,60,8,"backend"],[95,13,60,15],[95,14,60,16,"disposeIntermediateTensorInfo"],[95,43,60,45],[95,44,60,46,"$x"],[95,46,60,48],[95,47,60,49],[96,6,61,8],[96,13,61,15,"reverseTransposedResult"],[96,36,61,38],[97,4,62,4],[98,4,63,4],[98,11,63,11,"result"],[98,17,63,17],[99,2,64,0],[100,2,65,7],[100,8,65,13,"cumprodConfig"],[100,21,65,26],[100,24,65,29],[101,4,66,4,"kernelName"],[101,14,66,14],[101,16,66,16,"Cumprod"],[101,35,66,23],[101,36,66,23,"Cumprod"],[101,43,66,23],[102,4,67,4,"backendName"],[102,15,67,15],[102,17,67,17],[102,22,67,22],[103,4,68,4,"kernelFunc"],[103,14,68,14],[103,16,68,16,"cumprod"],[104,2,69,0],[104,3,69,1],[105,0,69,2],[105,3]],"functionMap":{"names":["<global>","cumprod","<anonymous>"],"mappings":"AAA;OCmB;QCoB,8BD;QCC,eD;CDuB"},"hasCjsExports":false},"type":"js/module"}]}