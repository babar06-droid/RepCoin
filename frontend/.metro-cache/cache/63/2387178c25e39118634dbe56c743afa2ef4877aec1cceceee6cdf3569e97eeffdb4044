{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":59,"index":762}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.createSimpleBinaryKernelImpl = createSimpleBinaryKernelImpl;\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * Template that creates implementation for binary ops. Supports broadcast.\n   */\n  function createSimpleBinaryKernelImpl(op) {\n    return (aShape, bShape, aVals, bVals, dtype) => {\n      const newShape = _tensorflowTfjsCore.backend_util.assertAndGetBroadcastShape(aShape, bShape);\n      const resultRank = newShape.length;\n      const resultStrides = _tensorflowTfjsCore.util.computeStrides(newShape);\n      const resultSize = _tensorflowTfjsCore.util.sizeFromShape(newShape);\n      const result = _tensorflowTfjsCore.util.getTypedArrayFromDType(dtype, resultSize);\n      const aRank = aShape.length;\n      const bRank = bShape.length;\n      const aStrides = _tensorflowTfjsCore.util.computeStrides(aShape);\n      const bStrides = _tensorflowTfjsCore.util.computeStrides(bShape);\n      const aBroadcastDims = _tensorflowTfjsCore.backend_util.getBroadcastDims(aShape, newShape);\n      const bBroadcastDims = _tensorflowTfjsCore.backend_util.getBroadcastDims(bShape, newShape);\n      if (aBroadcastDims.length + bBroadcastDims.length === 0) {\n        for (let i = 0; i < result.length; ++i) {\n          result[i] = op(aVals[i % aVals.length], bVals[i % bVals.length]);\n        }\n      } else {\n        for (let i = 0; i < result.length; ++i) {\n          const loc = _tensorflowTfjsCore.util.indexToLoc(i, resultRank, resultStrides);\n          const aLoc = loc.slice(-aRank);\n          aBroadcastDims.forEach(d => aLoc[d] = 0);\n          const aIndex = _tensorflowTfjsCore.util.locToIndex(aLoc, aRank, aStrides);\n          const bLoc = loc.slice(-bRank);\n          bBroadcastDims.forEach(d => bLoc[d] = 0);\n          const bIndex = _tensorflowTfjsCore.util.locToIndex(bLoc, bRank, bStrides);\n          result[i] = op(aVals[aIndex], bVals[bIndex]);\n        }\n      }\n      return [result, newShape];\n    };\n  }\n});","lineCount":61,"map":[[7,2,21,0,"exports"],[7,9,21,0],[7,10,21,0,"createSimpleBinaryKernelImpl"],[7,38,21,0],[7,41,21,0,"createSimpleBinaryKernelImpl"],[7,69,21,0],[8,2,17,0],[8,6,17,0,"_tensorflowTfjsCore"],[8,25,17,0],[8,28,17,0,"require"],[8,35,17,0],[8,36,17,0,"_dependencyMap"],[8,50,17,0],[9,2,1,0],[10,0,2,0],[11,0,3,0],[12,0,4,0],[13,0,5,0],[14,0,6,0],[15,0,7,0],[16,0,8,0],[17,0,9,0],[18,0,10,0],[19,0,11,0],[20,0,12,0],[21,0,13,0],[22,0,14,0],[23,0,15,0],[24,0,16,0],[26,2,18,0],[27,0,19,0],[28,0,20,0],[29,2,21,7],[29,11,21,16,"createSimpleBinaryKernelImpl"],[29,39,21,44,"createSimpleBinaryKernelImpl"],[29,40,21,45,"op"],[29,42,21,47],[29,44,21,49],[30,4,22,4],[30,11,22,11],[30,12,22,12,"aShape"],[30,18,22,18],[30,20,22,20,"bShape"],[30,26,22,26],[30,28,22,28,"aVals"],[30,33,22,33],[30,35,22,35,"bVals"],[30,40,22,40],[30,42,22,42,"dtype"],[30,47,22,47],[30,52,22,52],[31,6,23,8],[31,12,23,14,"newShape"],[31,20,23,22],[31,23,23,25,"backend_util"],[31,42,23,37],[31,43,23,37,"backend_util"],[31,55,23,37],[31,56,23,38,"assertAndGetBroadcastShape"],[31,82,23,64],[31,83,23,65,"aShape"],[31,89,23,71],[31,91,23,73,"bShape"],[31,97,23,79],[31,98,23,80],[32,6,24,8],[32,12,24,14,"resultRank"],[32,22,24,24],[32,25,24,27,"newShape"],[32,33,24,35],[32,34,24,36,"length"],[32,40,24,42],[33,6,25,8],[33,12,25,14,"resultStrides"],[33,25,25,27],[33,28,25,30,"util"],[33,47,25,34],[33,48,25,34,"util"],[33,52,25,34],[33,53,25,35,"computeStrides"],[33,67,25,49],[33,68,25,50,"newShape"],[33,76,25,58],[33,77,25,59],[34,6,26,8],[34,12,26,14,"resultSize"],[34,22,26,24],[34,25,26,27,"util"],[34,44,26,31],[34,45,26,31,"util"],[34,49,26,31],[34,50,26,32,"sizeFromShape"],[34,63,26,45],[34,64,26,46,"newShape"],[34,72,26,54],[34,73,26,55],[35,6,27,8],[35,12,27,14,"result"],[35,18,27,20],[35,21,27,23,"util"],[35,40,27,27],[35,41,27,27,"util"],[35,45,27,27],[35,46,27,28,"getTypedArrayFromDType"],[35,68,27,50],[35,69,27,51,"dtype"],[35,74,27,56],[35,76,27,58,"resultSize"],[35,86,27,68],[35,87,27,69],[36,6,28,8],[36,12,28,14,"aRank"],[36,17,28,19],[36,20,28,22,"aShape"],[36,26,28,28],[36,27,28,29,"length"],[36,33,28,35],[37,6,29,8],[37,12,29,14,"bRank"],[37,17,29,19],[37,20,29,22,"bShape"],[37,26,29,28],[37,27,29,29,"length"],[37,33,29,35],[38,6,30,8],[38,12,30,14,"aStrides"],[38,20,30,22],[38,23,30,25,"util"],[38,42,30,29],[38,43,30,29,"util"],[38,47,30,29],[38,48,30,30,"computeStrides"],[38,62,30,44],[38,63,30,45,"aShape"],[38,69,30,51],[38,70,30,52],[39,6,31,8],[39,12,31,14,"bStrides"],[39,20,31,22],[39,23,31,25,"util"],[39,42,31,29],[39,43,31,29,"util"],[39,47,31,29],[39,48,31,30,"computeStrides"],[39,62,31,44],[39,63,31,45,"bShape"],[39,69,31,51],[39,70,31,52],[40,6,32,8],[40,12,32,14,"aBroadcastDims"],[40,26,32,28],[40,29,32,31,"backend_util"],[40,48,32,43],[40,49,32,43,"backend_util"],[40,61,32,43],[40,62,32,44,"getBroadcastDims"],[40,78,32,60],[40,79,32,61,"aShape"],[40,85,32,67],[40,87,32,69,"newShape"],[40,95,32,77],[40,96,32,78],[41,6,33,8],[41,12,33,14,"bBroadcastDims"],[41,26,33,28],[41,29,33,31,"backend_util"],[41,48,33,43],[41,49,33,43,"backend_util"],[41,61,33,43],[41,62,33,44,"getBroadcastDims"],[41,78,33,60],[41,79,33,61,"bShape"],[41,85,33,67],[41,87,33,69,"newShape"],[41,95,33,77],[41,96,33,78],[42,6,34,8],[42,10,34,12,"aBroadcastDims"],[42,24,34,26],[42,25,34,27,"length"],[42,31,34,33],[42,34,34,36,"bBroadcastDims"],[42,48,34,50],[42,49,34,51,"length"],[42,55,34,57],[42,60,34,62],[42,61,34,63],[42,63,34,65],[43,8,35,12],[43,13,35,17],[43,17,35,21,"i"],[43,18,35,22],[43,21,35,25],[43,22,35,26],[43,24,35,28,"i"],[43,25,35,29],[43,28,35,32,"result"],[43,34,35,38],[43,35,35,39,"length"],[43,41,35,45],[43,43,35,47],[43,45,35,49,"i"],[43,46,35,50],[43,48,35,52],[44,10,36,16,"result"],[44,16,36,22],[44,17,36,23,"i"],[44,18,36,24],[44,19,36,25],[44,22,36,28,"op"],[44,24,36,30],[44,25,36,31,"aVals"],[44,30,36,36],[44,31,36,37,"i"],[44,32,36,38],[44,35,36,41,"aVals"],[44,40,36,46],[44,41,36,47,"length"],[44,47,36,53],[44,48,36,54],[44,50,36,56,"bVals"],[44,55,36,61],[44,56,36,62,"i"],[44,57,36,63],[44,60,36,66,"bVals"],[44,65,36,71],[44,66,36,72,"length"],[44,72,36,78],[44,73,36,79],[44,74,36,80],[45,8,37,12],[46,6,38,8],[46,7,38,9],[46,13,39,13],[47,8,40,12],[47,13,40,17],[47,17,40,21,"i"],[47,18,40,22],[47,21,40,25],[47,22,40,26],[47,24,40,28,"i"],[47,25,40,29],[47,28,40,32,"result"],[47,34,40,38],[47,35,40,39,"length"],[47,41,40,45],[47,43,40,47],[47,45,40,49,"i"],[47,46,40,50],[47,48,40,52],[48,10,41,16],[48,16,41,22,"loc"],[48,19,41,25],[48,22,41,28,"util"],[48,41,41,32],[48,42,41,32,"util"],[48,46,41,32],[48,47,41,33,"indexToLoc"],[48,57,41,43],[48,58,41,44,"i"],[48,59,41,45],[48,61,41,47,"resultRank"],[48,71,41,57],[48,73,41,59,"resultStrides"],[48,86,41,72],[48,87,41,73],[49,10,42,16],[49,16,42,22,"aLoc"],[49,20,42,26],[49,23,42,29,"loc"],[49,26,42,32],[49,27,42,33,"slice"],[49,32,42,38],[49,33,42,39],[49,34,42,40,"aRank"],[49,39,42,45],[49,40,42,46],[50,10,43,16,"aBroadcastDims"],[50,24,43,30],[50,25,43,31,"forEach"],[50,32,43,38],[50,33,43,39,"d"],[50,34,43,40],[50,38,43,44,"aLoc"],[50,42,43,48],[50,43,43,49,"d"],[50,44,43,50],[50,45,43,51],[50,48,43,54],[50,49,43,55],[50,50,43,56],[51,10,44,16],[51,16,44,22,"aIndex"],[51,22,44,28],[51,25,44,31,"util"],[51,44,44,35],[51,45,44,35,"util"],[51,49,44,35],[51,50,44,36,"locToIndex"],[51,60,44,46],[51,61,44,47,"aLoc"],[51,65,44,51],[51,67,44,53,"aRank"],[51,72,44,58],[51,74,44,60,"aStrides"],[51,82,44,68],[51,83,44,69],[52,10,45,16],[52,16,45,22,"bLoc"],[52,20,45,26],[52,23,45,29,"loc"],[52,26,45,32],[52,27,45,33,"slice"],[52,32,45,38],[52,33,45,39],[52,34,45,40,"bRank"],[52,39,45,45],[52,40,45,46],[53,10,46,16,"bBroadcastDims"],[53,24,46,30],[53,25,46,31,"forEach"],[53,32,46,38],[53,33,46,39,"d"],[53,34,46,40],[53,38,46,44,"bLoc"],[53,42,46,48],[53,43,46,49,"d"],[53,44,46,50],[53,45,46,51],[53,48,46,54],[53,49,46,55],[53,50,46,56],[54,10,47,16],[54,16,47,22,"bIndex"],[54,22,47,28],[54,25,47,31,"util"],[54,44,47,35],[54,45,47,35,"util"],[54,49,47,35],[54,50,47,36,"locToIndex"],[54,60,47,46],[54,61,47,47,"bLoc"],[54,65,47,51],[54,67,47,53,"bRank"],[54,72,47,58],[54,74,47,60,"bStrides"],[54,82,47,68],[54,83,47,69],[55,10,48,16,"result"],[55,16,48,22],[55,17,48,23,"i"],[55,18,48,24],[55,19,48,25],[55,22,48,28,"op"],[55,24,48,30],[55,25,48,31,"aVals"],[55,30,48,36],[55,31,48,37,"aIndex"],[55,37,48,43],[55,38,48,44],[55,40,48,46,"bVals"],[55,45,48,51],[55,46,48,52,"bIndex"],[55,52,48,58],[55,53,48,59],[55,54,48,60],[56,8,49,12],[57,6,50,8],[58,6,51,8],[58,13,51,15],[58,14,51,16,"result"],[58,20,51,22],[58,22,51,24,"newShape"],[58,30,51,32],[58,31,51,33],[59,4,52,4],[59,5,52,5],[60,2,53,0],[61,0,53,1],[61,3]],"functionMap":{"names":["<global>","createSimpleBinaryKernelImpl","<anonymous>","aBroadcastDims.forEach$argument_0","bBroadcastDims.forEach$argument_0"],"mappings":"AAA;OCoB;WCC;uCCqB,gBD;uCEG,gBF;KDM;CDC"},"hasCjsExports":false},"type":"js/module"}]}