{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":77,"index":780}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"rotateWithOffsetConfig\", {\n    enumerable: true,\n    get: function () {\n      return rotateWithOffsetConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  const rotateWithOffsetConfig = {\n    kernelName: _tensorflowTfjsCore.RotateWithOffset,\n    backendName: 'cpu',\n    kernelFunc: ({\n      inputs,\n      attrs,\n      backend\n    }) => {\n      const {\n        image\n      } = inputs;\n      const {\n        radians,\n        fillValue,\n        center\n      } = attrs;\n      const cpuBackend = backend;\n      const output = _tensorflowTfjsCore.util.getTypedArrayFromDType(image.dtype, _tensorflowTfjsCore.util.sizeFromShape(image.shape));\n      const [batch, imageHeight, imageWidth, numChannels] = image.shape;\n      const [centerX, centerY] = _tensorflowTfjsCore.backend_util.getImageCenter(center, imageHeight, imageWidth);\n      const fullOpacityValue = 255;\n      const sinFactor = Math.sin(radians);\n      const cosFactor = Math.cos(radians);\n      const imageVals = cpuBackend.data.get(image.dataId).values;\n      for (let batchIdx = 0; batchIdx < batch; batchIdx++) {\n        const batchOffset = batchIdx * imageWidth * imageHeight * numChannels;\n        for (let row = 0; row < imageHeight; row++) {\n          const rowOffset = row * (imageWidth * numChannels);\n          for (let col = 0; col < imageWidth; col++) {\n            const colOffset = col * numChannels;\n            for (let channel = 0; channel < numChannels; channel++) {\n              const coords = [batch, row, col, channel];\n              const x = coords[2];\n              const y = coords[1];\n              // coordX/coordY are the result of rotating and translating x/y.\n              let coordX = (x - centerX) * cosFactor - (y - centerY) * sinFactor;\n              let coordY = (x - centerX) * sinFactor + (y - centerY) * cosFactor;\n              coordX = Math.round(coordX + centerX);\n              coordY = Math.round(coordY + centerY);\n              let outputValue = fillValue;\n              if (typeof fillValue !== 'number') {\n                if (channel === 3) {\n                  outputValue = fullOpacityValue;\n                } else {\n                  outputValue = fillValue[channel];\n                }\n              }\n              // If the coordinate position falls within the image boundaries...\n              if (coordX >= 0 && coordX < imageWidth && coordY >= 0 && coordY < imageHeight) {\n                // set the output to the image value at the coordinate position.\n                const rotatedRowOffset = coordY * (imageWidth * numChannels);\n                const rotatedColOffset = coordX * numChannels;\n                const imageIdx = batchOffset + rotatedRowOffset + rotatedColOffset + channel;\n                outputValue = imageVals[imageIdx];\n              }\n              const outIdx = batchOffset + rowOffset + colOffset + channel;\n              output[outIdx] = outputValue;\n            }\n          }\n        }\n      }\n      const dataId = cpuBackend.write(output, image.shape, image.dtype);\n      return {\n        dataId,\n        shape: image.shape,\n        dtype: image.dtype\n      };\n    }\n  };\n});","lineCount":100,"map":[[7,2,18,0,"Object"],[7,8,18,0],[7,9,18,0,"defineProperty"],[7,23,18,0],[7,24,18,0,"exports"],[7,31,18,0],[8,4,18,0,"enumerable"],[8,14,18,0],[9,4,18,0,"get"],[9,7,18,0],[9,18,18,0,"get"],[9,19,18,0],[10,6,18,0],[10,13,18,0,"rotateWithOffsetConfig"],[10,35,18,0],[11,4,18,0],[12,2,18,0],[13,2,17,0],[13,6,17,0,"_tensorflowTfjsCore"],[13,25,17,0],[13,28,17,0,"require"],[13,35,17,0],[13,36,17,0,"_dependencyMap"],[13,50,17,0],[14,2,1,0],[15,0,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[20,0,7,0],[21,0,8,0],[22,0,9,0],[23,0,10,0],[24,0,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[31,2,18,7],[31,8,18,13,"rotateWithOffsetConfig"],[31,30,18,35],[31,33,18,38],[32,4,19,4,"kernelName"],[32,14,19,14],[32,16,19,16,"RotateWithOffset"],[32,35,19,32],[32,36,19,32,"RotateWithOffset"],[32,52,19,32],[33,4,20,4,"backendName"],[33,15,20,15],[33,17,20,17],[33,22,20,22],[34,4,21,4,"kernelFunc"],[34,14,21,14],[34,16,21,16,"kernelFunc"],[34,17,21,17],[35,6,21,19,"inputs"],[35,12,21,25],[36,6,21,27,"attrs"],[36,11,21,32],[37,6,21,34,"backend"],[38,4,21,42],[38,5,21,43],[38,10,21,48],[39,6,22,8],[39,12,22,14],[40,8,22,16,"image"],[41,6,22,22],[41,7,22,23],[41,10,22,26,"inputs"],[41,16,22,32],[42,6,23,8],[42,12,23,14],[43,8,23,16,"radians"],[43,15,23,23],[44,8,23,25,"fillValue"],[44,17,23,34],[45,8,23,36,"center"],[46,6,23,43],[46,7,23,44],[46,10,23,47,"attrs"],[46,15,23,52],[47,6,24,8],[47,12,24,14,"cpuBackend"],[47,22,24,24],[47,25,24,27,"backend"],[47,32,24,34],[48,6,25,8],[48,12,25,14,"output"],[48,18,25,20],[48,21,25,23,"util"],[48,40,25,27],[48,41,25,27,"util"],[48,45,25,27],[48,46,25,28,"getTypedArrayFromDType"],[48,68,25,50],[48,69,25,51,"image"],[48,74,25,56],[48,75,25,57,"dtype"],[48,80,25,62],[48,82,25,64,"util"],[48,101,25,68],[48,102,25,68,"util"],[48,106,25,68],[48,107,25,69,"sizeFromShape"],[48,120,25,82],[48,121,25,83,"image"],[48,126,25,88],[48,127,25,89,"shape"],[48,132,25,94],[48,133,25,95],[48,134,25,96],[49,6,26,8],[49,12,26,14],[49,13,26,15,"batch"],[49,18,26,20],[49,20,26,22,"imageHeight"],[49,31,26,33],[49,33,26,35,"imageWidth"],[49,43,26,45],[49,45,26,47,"numChannels"],[49,56,26,58],[49,57,26,59],[49,60,26,62,"image"],[49,65,26,67],[49,66,26,68,"shape"],[49,71,26,73],[50,6,27,8],[50,12,27,14],[50,13,27,15,"centerX"],[50,20,27,22],[50,22,27,24,"centerY"],[50,29,27,31],[50,30,27,32],[50,33,27,35,"backend_util"],[50,52,27,47],[50,53,27,47,"backend_util"],[50,65,27,47],[50,66,27,48,"getImageCenter"],[50,80,27,62],[50,81,27,63,"center"],[50,87,27,69],[50,89,27,71,"imageHeight"],[50,100,27,82],[50,102,27,84,"imageWidth"],[50,112,27,94],[50,113,27,95],[51,6,28,8],[51,12,28,14,"fullOpacityValue"],[51,28,28,30],[51,31,28,33],[51,34,28,36],[52,6,29,8],[52,12,29,14,"sinFactor"],[52,21,29,23],[52,24,29,26,"Math"],[52,28,29,30],[52,29,29,31,"sin"],[52,32,29,34],[52,33,29,35,"radians"],[52,40,29,42],[52,41,29,43],[53,6,30,8],[53,12,30,14,"cosFactor"],[53,21,30,23],[53,24,30,26,"Math"],[53,28,30,30],[53,29,30,31,"cos"],[53,32,30,34],[53,33,30,35,"radians"],[53,40,30,42],[53,41,30,43],[54,6,31,8],[54,12,31,14,"imageVals"],[54,21,31,23],[54,24,31,26,"cpuBackend"],[54,34,31,36],[54,35,31,37,"data"],[54,39,31,41],[54,40,31,42,"get"],[54,43,31,45],[54,44,31,46,"image"],[54,49,31,51],[54,50,31,52,"dataId"],[54,56,31,58],[54,57,31,59],[54,58,31,60,"values"],[54,64,31,66],[55,6,32,8],[55,11,32,13],[55,15,32,17,"batchIdx"],[55,23,32,25],[55,26,32,28],[55,27,32,29],[55,29,32,31,"batchIdx"],[55,37,32,39],[55,40,32,42,"batch"],[55,45,32,47],[55,47,32,49,"batchIdx"],[55,55,32,57],[55,57,32,59],[55,59,32,61],[56,8,33,12],[56,14,33,18,"batchOffset"],[56,25,33,29],[56,28,33,32,"batchIdx"],[56,36,33,40],[56,39,33,43,"imageWidth"],[56,49,33,53],[56,52,33,56,"imageHeight"],[56,63,33,67],[56,66,33,70,"numChannels"],[56,77,33,81],[57,8,34,12],[57,13,34,17],[57,17,34,21,"row"],[57,20,34,24],[57,23,34,27],[57,24,34,28],[57,26,34,30,"row"],[57,29,34,33],[57,32,34,36,"imageHeight"],[57,43,34,47],[57,45,34,49,"row"],[57,48,34,52],[57,50,34,54],[57,52,34,56],[58,10,35,16],[58,16,35,22,"rowOffset"],[58,25,35,31],[58,28,35,34,"row"],[58,31,35,37],[58,35,35,41,"imageWidth"],[58,45,35,51],[58,48,35,54,"numChannels"],[58,59,35,65],[58,60,35,66],[59,10,36,16],[59,15,36,21],[59,19,36,25,"col"],[59,22,36,28],[59,25,36,31],[59,26,36,32],[59,28,36,34,"col"],[59,31,36,37],[59,34,36,40,"imageWidth"],[59,44,36,50],[59,46,36,52,"col"],[59,49,36,55],[59,51,36,57],[59,53,36,59],[60,12,37,20],[60,18,37,26,"colOffset"],[60,27,37,35],[60,30,37,38,"col"],[60,33,37,41],[60,36,37,44,"numChannels"],[60,47,37,55],[61,12,38,20],[61,17,38,25],[61,21,38,29,"channel"],[61,28,38,36],[61,31,38,39],[61,32,38,40],[61,34,38,42,"channel"],[61,41,38,49],[61,44,38,52,"numChannels"],[61,55,38,63],[61,57,38,65,"channel"],[61,64,38,72],[61,66,38,74],[61,68,38,76],[62,14,39,24],[62,20,39,30,"coords"],[62,26,39,36],[62,29,39,39],[62,30,39,40,"batch"],[62,35,39,45],[62,37,39,47,"row"],[62,40,39,50],[62,42,39,52,"col"],[62,45,39,55],[62,47,39,57,"channel"],[62,54,39,64],[62,55,39,65],[63,14,40,24],[63,20,40,30,"x"],[63,21,40,31],[63,24,40,34,"coords"],[63,30,40,40],[63,31,40,41],[63,32,40,42],[63,33,40,43],[64,14,41,24],[64,20,41,30,"y"],[64,21,41,31],[64,24,41,34,"coords"],[64,30,41,40],[64,31,41,41],[64,32,41,42],[64,33,41,43],[65,14,42,24],[66,14,43,24],[66,18,43,28,"coordX"],[66,24,43,34],[66,27,43,37],[66,28,43,38,"x"],[66,29,43,39],[66,32,43,42,"centerX"],[66,39,43,49],[66,43,43,53,"cosFactor"],[66,52,43,62],[66,55,43,65],[66,56,43,66,"y"],[66,57,43,67],[66,60,43,70,"centerY"],[66,67,43,77],[66,71,43,81,"sinFactor"],[66,80,43,90],[67,14,44,24],[67,18,44,28,"coordY"],[67,24,44,34],[67,27,44,37],[67,28,44,38,"x"],[67,29,44,39],[67,32,44,42,"centerX"],[67,39,44,49],[67,43,44,53,"sinFactor"],[67,52,44,62],[67,55,44,65],[67,56,44,66,"y"],[67,57,44,67],[67,60,44,70,"centerY"],[67,67,44,77],[67,71,44,81,"cosFactor"],[67,80,44,90],[68,14,45,24,"coordX"],[68,20,45,30],[68,23,45,33,"Math"],[68,27,45,37],[68,28,45,38,"round"],[68,33,45,43],[68,34,45,44,"coordX"],[68,40,45,50],[68,43,45,53,"centerX"],[68,50,45,60],[68,51,45,61],[69,14,46,24,"coordY"],[69,20,46,30],[69,23,46,33,"Math"],[69,27,46,37],[69,28,46,38,"round"],[69,33,46,43],[69,34,46,44,"coordY"],[69,40,46,50],[69,43,46,53,"centerY"],[69,50,46,60],[69,51,46,61],[70,14,47,24],[70,18,47,28,"outputValue"],[70,29,47,39],[70,32,47,42,"fillValue"],[70,41,47,51],[71,14,48,24],[71,18,48,28],[71,25,48,35,"fillValue"],[71,34,48,44],[71,39,48,49],[71,47,48,57],[71,49,48,59],[72,16,49,28],[72,20,49,32,"channel"],[72,27,49,39],[72,32,49,44],[72,33,49,45],[72,35,49,47],[73,18,50,32,"outputValue"],[73,29,50,43],[73,32,50,46,"fullOpacityValue"],[73,48,50,62],[74,16,51,28],[74,17,51,29],[74,23,52,33],[75,18,53,32,"outputValue"],[75,29,53,43],[75,32,53,46,"fillValue"],[75,41,53,55],[75,42,53,56,"channel"],[75,49,53,63],[75,50,53,64],[76,16,54,28],[77,14,55,24],[78,14,56,24],[79,14,57,24],[79,18,57,28,"coordX"],[79,24,57,34],[79,28,57,38],[79,29,57,39],[79,33,57,43,"coordX"],[79,39,57,49],[79,42,57,52,"imageWidth"],[79,52,57,62],[79,56,57,66,"coordY"],[79,62,57,72],[79,66,57,76],[79,67,57,77],[79,71,58,28,"coordY"],[79,77,58,34],[79,80,58,37,"imageHeight"],[79,91,58,48],[79,93,58,50],[80,16,59,28],[81,16,60,28],[81,22,60,34,"rotatedRowOffset"],[81,38,60,50],[81,41,60,53,"coordY"],[81,47,60,59],[81,51,60,63,"imageWidth"],[81,61,60,73],[81,64,60,76,"numChannels"],[81,75,60,87],[81,76,60,88],[82,16,61,28],[82,22,61,34,"rotatedColOffset"],[82,38,61,50],[82,41,61,53,"coordX"],[82,47,61,59],[82,50,61,62,"numChannels"],[82,61,61,73],[83,16,62,28],[83,22,62,34,"imageIdx"],[83,30,62,42],[83,33,62,45,"batchOffset"],[83,44,62,56],[83,47,62,59,"rotatedRowOffset"],[83,63,62,75],[83,66,62,78,"rotatedColOffset"],[83,82,62,94],[83,85,62,97,"channel"],[83,92,62,104],[84,16,63,28,"outputValue"],[84,27,63,39],[84,30,63,42,"imageVals"],[84,39,63,51],[84,40,63,52,"imageIdx"],[84,48,63,60],[84,49,63,61],[85,14,64,24],[86,14,65,24],[86,20,65,30,"outIdx"],[86,26,65,36],[86,29,65,39,"batchOffset"],[86,40,65,50],[86,43,65,53,"rowOffset"],[86,52,65,62],[86,55,65,65,"colOffset"],[86,64,65,74],[86,67,65,77,"channel"],[86,74,65,84],[87,14,66,24,"output"],[87,20,66,30],[87,21,66,31,"outIdx"],[87,27,66,37],[87,28,66,38],[87,31,66,41,"outputValue"],[87,42,66,52],[88,12,67,20],[89,10,68,16],[90,8,69,12],[91,6,70,8],[92,6,71,8],[92,12,71,14,"dataId"],[92,18,71,20],[92,21,71,23,"cpuBackend"],[92,31,71,33],[92,32,71,34,"write"],[92,37,71,39],[92,38,71,40,"output"],[92,44,71,46],[92,46,71,48,"image"],[92,51,71,53],[92,52,71,54,"shape"],[92,57,71,59],[92,59,71,61,"image"],[92,64,71,66],[92,65,71,67,"dtype"],[92,70,71,72],[92,71,71,73],[93,6,72,8],[93,13,72,15],[94,8,72,17,"dataId"],[94,14,72,23],[95,8,72,25,"shape"],[95,13,72,30],[95,15,72,32,"image"],[95,20,72,37],[95,21,72,38,"shape"],[95,26,72,43],[96,8,72,45,"dtype"],[96,13,72,50],[96,15,72,52,"image"],[96,20,72,57],[96,21,72,58,"dtype"],[97,6,72,64],[97,7,72,65],[98,4,73,4],[99,2,74,0],[99,3,74,1],[100,0,74,2],[100,3]],"functionMap":{"names":["<global>","rotateWithOffsetConfig.kernelFunc"],"mappings":"AAA;gBCoB;KDoD"},"hasCjsExports":false},"type":"js/module"}]}