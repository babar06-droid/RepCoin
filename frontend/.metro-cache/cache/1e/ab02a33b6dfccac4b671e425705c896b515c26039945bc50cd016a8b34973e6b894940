{"dependencies":[{"name":"../tensor_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":50,"index":753}}],"key":"HQiCW53DuB7l+apA2eJH6n9FhMY=","exportNames":["*"],"imports":1}},{"name":"../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":754},"end":{"line":18,"column":53,"index":807}}],"key":"UCKDOr/oOGi3nbD26ZhyAVW61qk=","exportNames":["*"],"imports":1}},{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":808},"end":{"line":19,"column":32,"index":840}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}},{"name":"./add","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":841},"end":{"line":20,"column":28,"index":869}}],"key":"YzBaFStBt+uixjzrdu0NxJdBO+o=","exportNames":["*"],"imports":1}},{"name":"./div","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":870},"end":{"line":21,"column":28,"index":898}}],"key":"pYfaOV/+1lJSlfGs5XBJc2icIU0=","exportNames":["*"],"imports":1}},{"name":"./mul","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":899},"end":{"line":22,"column":28,"index":927}}],"key":"dGJcm1XT1xn6xqxUHy8IlN16LWU=","exportNames":["*"],"imports":1}},{"name":"./operation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":23,"column":0,"index":928},"end":{"line":23,"column":33,"index":961}}],"key":"lmmEAb6oR3TWnrsrETceKUovfkM=","exportNames":["*"],"imports":1}},{"name":"./pow","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":24,"column":0,"index":962},"end":{"line":24,"column":28,"index":990}}],"key":"tt8nC5f4JtGtnLtPBl7L+XWR2VM=","exportNames":["*"],"imports":1}},{"name":"./scalar","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":25,"column":0,"index":991},"end":{"line":25,"column":34,"index":1025}}],"key":"p7aNYU3QXbnnvilA+nw2NUaJ068=","exportNames":["*"],"imports":1}},{"name":"./sub","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":26,"column":0,"index":1026},"end":{"line":26,"column":28,"index":1054}}],"key":"17GB/TfX+vYDBMGz0tnC+fKFzbE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"movingAverage\", {\n    enumerable: true,\n    get: function () {\n      return movingAverage;\n    }\n  });\n  var _tensor_util = require(_dependencyMap[0], \"../tensor_util\");\n  var _tensor_util_env = require(_dependencyMap[1], \"../tensor_util_env\");\n  var _util = require(_dependencyMap[2], \"../util\");\n  var util = _interopNamespace(_util);\n  var _add = require(_dependencyMap[3], \"./add\");\n  var _div = require(_dependencyMap[4], \"./div\");\n  var _mul = require(_dependencyMap[5], \"./mul\");\n  var _operation = require(_dependencyMap[6], \"./operation\");\n  var _pow = require(_dependencyMap[7], \"./pow\");\n  var _scalar = require(_dependencyMap[8], \"./scalar\");\n  var _sub = require(_dependencyMap[9], \"./sub\");\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * Compute the moving average of a variable.\n   *\n   * Without zeroDebias, the moving average operation is defined by:\n   *   `v += delta`\n   * where\n   *   `delta = (1 - decay) * (x - v)`\n   *\n   * With zeroDebias (default), the `delta` term is scaled to debias the\n   * effect of the (assumed) zero-initialization of `v`.\n   *   `delta /= (1 - decay ^ step)`\n   *\n   * For more details on the zero-debiasing algorithm, see:\n   *   https://arxiv.org/abs/1412.6980\n   *\n   * Note that this function is completely stateless and does not keep track of\n   * step count. The step count needs to be maintained by the caller and passed\n   * in as `step`.\n   *\n   * @param v The current moving average value.\n   * @param x New input value, must have the same shape and dtype as `v`.\n   * @param decay The decay factor. Typical values are 0.95 and 0.99.\n   * @param step Step count.\n   * @param zeroDebias: Whether zeroDebias is to be performed (default: `true`).\n   * @returns The new moving average value.\n   *\n   * @doc {heading: 'Operations', subheading: 'Moving Average'}\n   */\n  function movingAverage_(v, x, decay, step, zeroDebias = true) {\n    const $v = (0, _tensor_util_env.convertToTensor)(v, 'v', 'movingAverage');\n    const $x = (0, _tensor_util_env.convertToTensor)(x, 'x', 'movingAverage');\n    const $decay = (0, _tensor_util_env.convertToTensor)(decay, 'decay', 'movingAverage');\n    (0, _tensor_util.assertTypesMatch)($v, $x);\n    util.assert(util.arraysEqual($v.shape, $x.shape), () => 'Shape mismatch in v and x');\n    const one = (0, _scalar.scalar)(1);\n    const oneMinusDecay = (0, _sub.sub)(one, $decay);\n    let update = (0, _mul.mul)((0, _sub.sub)($x, $v), oneMinusDecay);\n    if (zeroDebias) {\n      util.assert(step != null, () => 'When using zeroDebias: true, step is required.');\n      const $step = (0, _tensor_util_env.convertToTensor)(step, 'step', 'movingAverage');\n      update = (0, _div.div)(update, (0, _sub.sub)(one, (0, _pow.pow)($decay, $step)));\n    }\n    return (0, _add.add)($v, update);\n  }\n  const movingAverage = /* @__PURE__ */(0, _operation.op)({\n    movingAverage_\n  });\n});","lineCount":103,"map":[[22,2,71,0,"Object"],[22,8,71,0],[22,9,71,0,"defineProperty"],[22,23,71,0],[22,24,71,0,"exports"],[22,31,71,0],[23,4,71,0,"enumerable"],[23,14,71,0],[24,4,71,0,"get"],[24,7,71,0],[24,18,71,0,"get"],[24,19,71,0],[25,6,71,0],[25,13,71,0,"movingAverage"],[25,26,71,0],[26,4,71,0],[27,2,71,0],[28,2,17,0],[28,6,17,0,"_tensor_util"],[28,18,17,0],[28,21,17,0,"require"],[28,28,17,0],[28,29,17,0,"_dependencyMap"],[28,43,17,0],[29,2,18,0],[29,6,18,0,"_tensor_util_env"],[29,22,18,0],[29,25,18,0,"require"],[29,32,18,0],[29,33,18,0,"_dependencyMap"],[29,47,18,0],[30,2,19,0],[30,6,19,0,"_util"],[30,11,19,0],[30,14,19,0,"require"],[30,21,19,0],[30,22,19,0,"_dependencyMap"],[30,36,19,0],[31,2,19,0],[31,6,19,0,"util"],[31,10,19,0],[31,13,19,0,"_interopNamespace"],[31,30,19,0],[31,31,19,0,"_util"],[31,36,19,0],[32,2,20,0],[32,6,20,0,"_add"],[32,10,20,0],[32,13,20,0,"require"],[32,20,20,0],[32,21,20,0,"_dependencyMap"],[32,35,20,0],[33,2,21,0],[33,6,21,0,"_div"],[33,10,21,0],[33,13,21,0,"require"],[33,20,21,0],[33,21,21,0,"_dependencyMap"],[33,35,21,0],[34,2,22,0],[34,6,22,0,"_mul"],[34,10,22,0],[34,13,22,0,"require"],[34,20,22,0],[34,21,22,0,"_dependencyMap"],[34,35,22,0],[35,2,23,0],[35,6,23,0,"_operation"],[35,16,23,0],[35,19,23,0,"require"],[35,26,23,0],[35,27,23,0,"_dependencyMap"],[35,41,23,0],[36,2,24,0],[36,6,24,0,"_pow"],[36,10,24,0],[36,13,24,0,"require"],[36,20,24,0],[36,21,24,0,"_dependencyMap"],[36,35,24,0],[37,2,25,0],[37,6,25,0,"_scalar"],[37,13,25,0],[37,16,25,0,"require"],[37,23,25,0],[37,24,25,0,"_dependencyMap"],[37,38,25,0],[38,2,26,0],[38,6,26,0,"_sub"],[38,10,26,0],[38,13,26,0,"require"],[38,20,26,0],[38,21,26,0,"_dependencyMap"],[38,35,26,0],[39,2,1,0],[40,0,2,0],[41,0,3,0],[42,0,4,0],[43,0,5,0],[44,0,6,0],[45,0,7,0],[46,0,8,0],[47,0,9,0],[48,0,10,0],[49,0,11,0],[50,0,12,0],[51,0,13,0],[52,0,14,0],[53,0,15,0],[54,0,16,0],[56,2,27,0],[57,0,28,0],[58,0,29,0],[59,0,30,0],[60,0,31,0],[61,0,32,0],[62,0,33,0],[63,0,34,0],[64,0,35,0],[65,0,36,0],[66,0,37,0],[67,0,38,0],[68,0,39,0],[69,0,40,0],[70,0,41,0],[71,0,42,0],[72,0,43,0],[73,0,44,0],[74,0,45,0],[75,0,46,0],[76,0,47,0],[77,0,48,0],[78,0,49,0],[79,0,50,0],[80,0,51,0],[81,0,52,0],[82,0,53,0],[83,0,54,0],[84,2,55,0],[84,11,55,9,"movingAverage_"],[84,25,55,23,"movingAverage_"],[84,26,55,24,"v"],[84,27,55,25],[84,29,55,27,"x"],[84,30,55,28],[84,32,55,30,"decay"],[84,37,55,35],[84,39,55,37,"step"],[84,43,55,41],[84,45,55,43,"zeroDebias"],[84,55,55,53],[84,58,55,56],[84,62,55,60],[84,64,55,62],[85,4,56,4],[85,10,56,10,"$v"],[85,12,56,12],[85,15,56,15],[85,19,56,15,"convertToTensor"],[85,35,56,30],[85,36,56,30,"convertToTensor"],[85,51,56,30],[85,53,56,31,"v"],[85,54,56,32],[85,56,56,34],[85,59,56,37],[85,61,56,39],[85,76,56,54],[85,77,56,55],[86,4,57,4],[86,10,57,10,"$x"],[86,12,57,12],[86,15,57,15],[86,19,57,15,"convertToTensor"],[86,35,57,30],[86,36,57,30,"convertToTensor"],[86,51,57,30],[86,53,57,31,"x"],[86,54,57,32],[86,56,57,34],[86,59,57,37],[86,61,57,39],[86,76,57,54],[86,77,57,55],[87,4,58,4],[87,10,58,10,"$decay"],[87,16,58,16],[87,19,58,19],[87,23,58,19,"convertToTensor"],[87,39,58,34],[87,40,58,34,"convertToTensor"],[87,55,58,34],[87,57,58,35,"decay"],[87,62,58,40],[87,64,58,42],[87,71,58,49],[87,73,58,51],[87,88,58,66],[87,89,58,67],[88,4,59,4],[88,8,59,4,"assertTypesMatch"],[88,20,59,20],[88,21,59,20,"assertTypesMatch"],[88,37,59,20],[88,39,59,21,"$v"],[88,41,59,23],[88,43,59,25,"$x"],[88,45,59,27],[88,46,59,28],[89,4,60,4,"util"],[89,8,60,8],[89,9,60,9,"assert"],[89,15,60,15],[89,16,60,16,"util"],[89,20,60,20],[89,21,60,21,"arraysEqual"],[89,32,60,32],[89,33,60,33,"$v"],[89,35,60,35],[89,36,60,36,"shape"],[89,41,60,41],[89,43,60,43,"$x"],[89,45,60,45],[89,46,60,46,"shape"],[89,51,60,51],[89,52,60,52],[89,54,60,54],[89,60,60,60],[89,87,60,87],[89,88,60,88],[90,4,61,4],[90,10,61,10,"one"],[90,13,61,13],[90,16,61,16],[90,20,61,16,"scalar"],[90,27,61,22],[90,28,61,22,"scalar"],[90,34,61,22],[90,36,61,23],[90,37,61,24],[90,38,61,25],[91,4,62,4],[91,10,62,10,"oneMinusDecay"],[91,23,62,23],[91,26,62,26],[91,30,62,26,"sub"],[91,34,62,29],[91,35,62,29,"sub"],[91,38,62,29],[91,40,62,30,"one"],[91,43,62,33],[91,45,62,35,"$decay"],[91,51,62,41],[91,52,62,42],[92,4,63,4],[92,8,63,8,"update"],[92,14,63,14],[92,17,63,17],[92,21,63,17,"mul"],[92,25,63,20],[92,26,63,20,"mul"],[92,29,63,20],[92,31,63,21],[92,35,63,21,"sub"],[92,39,63,24],[92,40,63,24,"sub"],[92,43,63,24],[92,45,63,25,"$x"],[92,47,63,27],[92,49,63,29,"$v"],[92,51,63,31],[92,52,63,32],[92,54,63,34,"oneMinusDecay"],[92,67,63,47],[92,68,63,48],[93,4,64,4],[93,8,64,8,"zeroDebias"],[93,18,64,18],[93,20,64,20],[94,6,65,8,"util"],[94,10,65,12],[94,11,65,13,"assert"],[94,17,65,19],[94,18,65,20,"step"],[94,22,65,24],[94,26,65,28],[94,30,65,32],[94,32,65,34],[94,38,65,40],[94,86,65,88],[94,87,65,89],[95,6,66,8],[95,12,66,14,"$step"],[95,17,66,19],[95,20,66,22],[95,24,66,22,"convertToTensor"],[95,40,66,37],[95,41,66,37,"convertToTensor"],[95,56,66,37],[95,58,66,38,"step"],[95,62,66,42],[95,64,66,44],[95,70,66,50],[95,72,66,52],[95,87,66,67],[95,88,66,68],[96,6,67,8,"update"],[96,12,67,14],[96,15,67,17],[96,19,67,17,"div"],[96,23,67,20],[96,24,67,20,"div"],[96,27,67,20],[96,29,67,21,"update"],[96,35,67,27],[96,37,67,29],[96,41,67,29,"sub"],[96,45,67,32],[96,46,67,32,"sub"],[96,49,67,32],[96,51,67,33,"one"],[96,54,67,36],[96,56,67,38],[96,60,67,38,"pow"],[96,64,67,41],[96,65,67,41,"pow"],[96,68,67,41],[96,70,67,42,"$decay"],[96,76,67,48],[96,78,67,50,"$step"],[96,83,67,55],[96,84,67,56],[96,85,67,57],[96,86,67,58],[97,4,68,4],[98,4,69,4],[98,11,69,11],[98,15,69,11,"add"],[98,19,69,14],[98,20,69,14,"add"],[98,23,69,14],[98,25,69,15,"$v"],[98,27,69,17],[98,29,69,19,"update"],[98,35,69,25],[98,36,69,26],[99,2,70,0],[100,2,71,7],[100,8,71,13,"movingAverage"],[100,21,71,26],[100,24,71,29],[100,39,71,45],[100,43,71,45,"op"],[100,53,71,47],[100,54,71,47,"op"],[100,56,71,47],[100,58,71,48],[101,4,71,50,"movingAverage_"],[102,2,71,65],[102,3,71,66],[102,4,71,67],[103,0,71,68],[103,3]],"functionMap":{"names":["<global>","movingAverage_","util.assert$argument_1"],"mappings":"AAA;ACsD;sDCK,iCD;kCCK,sDD;CDK"},"hasCjsExports":false},"type":"js/module"}]}