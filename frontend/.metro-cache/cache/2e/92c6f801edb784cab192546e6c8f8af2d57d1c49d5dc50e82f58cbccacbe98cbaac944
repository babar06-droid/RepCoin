{"dependencies":[{"name":"../engine","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":35,"index":738}}],"key":"zbTTi8rtwr8rjl75PzEo829Yvss=","exportNames":["*"],"imports":1}},{"name":"../kernel_names","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":739},"end":{"line":18,"column":46,"index":785}}],"key":"gQVznmdGA0uoBQvR5Q4/qW+ITHg=","exportNames":["*"],"imports":1}},{"name":"../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":786},"end":{"line":19,"column":53,"index":839}}],"key":"UCKDOr/oOGi3nbD26ZhyAVW61qk=","exportNames":["*"],"imports":1}},{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":840},"end":{"line":20,"column":32,"index":872}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}},{"name":"./operation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":873},"end":{"line":21,"column":33,"index":906}}],"key":"lmmEAb6oR3TWnrsrETceKUovfkM=","exportNames":["*"],"imports":1}},{"name":"./reshape","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":907},"end":{"line":22,"column":36,"index":943}}],"key":"dz8GCsFShMGnHX1Wj7bBySjBnSE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"avgPoolGrad\", {\n    enumerable: true,\n    get: function () {\n      return avgPoolGrad;\n    }\n  });\n  var _engine = require(_dependencyMap[0], \"../engine\");\n  var _kernel_names = require(_dependencyMap[1], \"../kernel_names\");\n  var _tensor_util_env = require(_dependencyMap[2], \"../tensor_util_env\");\n  var _util = require(_dependencyMap[3], \"../util\");\n  var util = _interopNamespace(_util);\n  var _operation = require(_dependencyMap[4], \"./operation\");\n  var _reshape = require(_dependencyMap[5], \"./reshape\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * Computes the backprop of an 2D avg pool.\n   *\n   * @param dy The dy error, of rank 4 or rank 3 of shape\n   *     [batchSize, height, width, channels]. If rank 3, batch of 1 is\n   * assumed.\n   * @param input The input image, of rank 4 or rank 3 of shape\n   *     [batchSize, height, width, channels]. If rank 3, batch of 1 is\n   * assumed.\n   * @param filterSize The filter size: `[filterHeight, filterWidth]`. If\n   *     `filterSize` is a single number, then `filterHeight == filterWidth`.\n   * @param strides The strides of the pooling: `[strideHeight, strideWidth]`. If\n   *     `strides` is a single number, then `strideHeight == strideWidth`.\n   * @param pad The type of padding algorithm used in the forward prop of the op.\n   *     'same', 'valid', for more info, see this guide:\n   *     [https://www.tensorflow.org/api_docs/python/tf/nn/convolution](\n   *         https://www.tensorflow.org/api_docs/python/tf/nn/convolution)\n   */\n  function avgPoolGrad_(dy, input, filterSize, strides, pad) {\n    const $dy = (0, _tensor_util_env.convertToTensor)(dy, 'dy', 'avgPoolGrad');\n    const $input = (0, _tensor_util_env.convertToTensor)(input, 'input', 'avgPoolGrad');\n    util.assert($input.rank === $dy.rank, () => `Rank of input (${$input.rank}) does not match rank of dy (${$dy.rank})`);\n    let input4D = $input;\n    let dy4D = $dy;\n    let reshapedTo4D = false;\n    if ($input.rank === 3) {\n      reshapedTo4D = true;\n      input4D = (0, _reshape.reshape)($input, [1, $input.shape[0], $input.shape[1], $input.shape[2]]);\n      dy4D = (0, _reshape.reshape)($dy, [1, $dy.shape[0], $dy.shape[1], $dy.shape[2]]);\n    }\n    util.assert(dy4D.rank === 4, () => `Error in avgPoolGrad: dy must be rank 4 but got rank ` + `${dy4D.rank}.`);\n    util.assert(input4D.rank === 4, () => `Error in avgPoolGrad: input must be rank 4 but got rank ` + `${input4D.rank}.`);\n    const inputs = {\n      dy: dy4D,\n      input: input4D\n    };\n    const attrs = {\n      filterSize,\n      strides,\n      pad\n    };\n    // tslint:disable-next-line: no-unnecessary-type-assertion\n    const res = _engine.ENGINE.runKernel(_kernel_names.AvgPoolGrad, inputs, attrs);\n    if (reshapedTo4D) {\n      return (0, _reshape.reshape)(res, [res.shape[1], res.shape[2], res.shape[3]]);\n    }\n    return res;\n  }\n  const avgPoolGrad = /* @__PURE__ */(0, _operation.op)({\n    avgPoolGrad_\n  });\n});","lineCount":103,"map":[[22,2,67,0,"Object"],[22,8,67,0],[22,9,67,0,"defineProperty"],[22,23,67,0],[22,24,67,0,"exports"],[22,31,67,0],[23,4,67,0,"enumerable"],[23,14,67,0],[24,4,67,0,"get"],[24,7,67,0],[24,18,67,0,"get"],[24,19,67,0],[25,6,67,0],[25,13,67,0,"avgPoolGrad"],[25,24,67,0],[26,4,67,0],[27,2,67,0],[28,2,17,0],[28,6,17,0,"_engine"],[28,13,17,0],[28,16,17,0,"require"],[28,23,17,0],[28,24,17,0,"_dependencyMap"],[28,38,17,0],[29,2,18,0],[29,6,18,0,"_kernel_names"],[29,19,18,0],[29,22,18,0,"require"],[29,29,18,0],[29,30,18,0,"_dependencyMap"],[29,44,18,0],[30,2,19,0],[30,6,19,0,"_tensor_util_env"],[30,22,19,0],[30,25,19,0,"require"],[30,32,19,0],[30,33,19,0,"_dependencyMap"],[30,47,19,0],[31,2,20,0],[31,6,20,0,"_util"],[31,11,20,0],[31,14,20,0,"require"],[31,21,20,0],[31,22,20,0,"_dependencyMap"],[31,36,20,0],[32,2,20,0],[32,6,20,0,"util"],[32,10,20,0],[32,13,20,0,"_interopNamespace"],[32,30,20,0],[32,31,20,0,"_util"],[32,36,20,0],[33,2,21,0],[33,6,21,0,"_operation"],[33,16,21,0],[33,19,21,0,"require"],[33,26,21,0],[33,27,21,0,"_dependencyMap"],[33,41,21,0],[34,2,22,0],[34,6,22,0,"_reshape"],[34,14,22,0],[34,17,22,0,"require"],[34,24,22,0],[34,25,22,0,"_dependencyMap"],[34,39,22,0],[35,2,1,0],[36,0,2,0],[37,0,3,0],[38,0,4,0],[39,0,5,0],[40,0,6,0],[41,0,7,0],[42,0,8,0],[43,0,9,0],[44,0,10,0],[45,0,11,0],[46,0,12,0],[47,0,13,0],[48,0,14,0],[49,0,15,0],[50,0,16,0],[52,2,23,0],[53,0,24,0],[54,0,25,0],[55,0,26,0],[56,0,27,0],[57,0,28,0],[58,0,29,0],[59,0,30,0],[60,0,31,0],[61,0,32,0],[62,0,33,0],[63,0,34,0],[64,0,35,0],[65,0,36,0],[66,0,37,0],[67,0,38,0],[68,0,39,0],[69,0,40,0],[70,2,41,0],[70,11,41,9,"avgPoolGrad_"],[70,23,41,21,"avgPoolGrad_"],[70,24,41,22,"dy"],[70,26,41,24],[70,28,41,26,"input"],[70,33,41,31],[70,35,41,33,"filterSize"],[70,45,41,43],[70,47,41,45,"strides"],[70,54,41,52],[70,56,41,54,"pad"],[70,59,41,57],[70,61,41,59],[71,4,42,4],[71,10,42,10,"$dy"],[71,13,42,13],[71,16,42,16],[71,20,42,16,"convertToTensor"],[71,36,42,31],[71,37,42,31,"convertToTensor"],[71,52,42,31],[71,54,42,32,"dy"],[71,56,42,34],[71,58,42,36],[71,62,42,40],[71,64,42,42],[71,77,42,55],[71,78,42,56],[72,4,43,4],[72,10,43,10,"$input"],[72,16,43,16],[72,19,43,19],[72,23,43,19,"convertToTensor"],[72,39,43,34],[72,40,43,34,"convertToTensor"],[72,55,43,34],[72,57,43,35,"input"],[72,62,43,40],[72,64,43,42],[72,71,43,49],[72,73,43,51],[72,86,43,64],[72,87,43,65],[73,4,44,4,"util"],[73,8,44,8],[73,9,44,9,"assert"],[73,15,44,15],[73,16,44,16,"$input"],[73,22,44,22],[73,23,44,23,"rank"],[73,27,44,27],[73,32,44,32,"$dy"],[73,35,44,35],[73,36,44,36,"rank"],[73,40,44,40],[73,42,44,42],[73,48,44,48],[73,66,44,66,"$input"],[73,72,44,72],[73,73,44,73,"rank"],[73,77,44,77],[73,109,44,109,"$dy"],[73,112,44,112],[73,113,44,113,"rank"],[73,117,44,117],[73,120,44,120],[73,121,44,121],[74,4,45,4],[74,8,45,8,"input4D"],[74,15,45,15],[74,18,45,18,"$input"],[74,24,45,24],[75,4,46,4],[75,8,46,8,"dy4D"],[75,12,46,12],[75,15,46,15,"$dy"],[75,18,46,18],[76,4,47,4],[76,8,47,8,"reshapedTo4D"],[76,20,47,20],[76,23,47,23],[76,28,47,28],[77,4,48,4],[77,8,48,8,"$input"],[77,14,48,14],[77,15,48,15,"rank"],[77,19,48,19],[77,24,48,24],[77,25,48,25],[77,27,48,27],[78,6,49,8,"reshapedTo4D"],[78,18,49,20],[78,21,49,23],[78,25,49,27],[79,6,50,8,"input4D"],[79,13,50,15],[79,16,51,12],[79,20,51,12,"reshape"],[79,28,51,19],[79,29,51,19,"reshape"],[79,36,51,19],[79,38,51,20,"$input"],[79,44,51,26],[79,46,51,28],[79,47,51,29],[79,48,51,30],[79,50,51,32,"$input"],[79,56,51,38],[79,57,51,39,"shape"],[79,62,51,44],[79,63,51,45],[79,64,51,46],[79,65,51,47],[79,67,51,49,"$input"],[79,73,51,55],[79,74,51,56,"shape"],[79,79,51,61],[79,80,51,62],[79,81,51,63],[79,82,51,64],[79,84,51,66,"$input"],[79,90,51,72],[79,91,51,73,"shape"],[79,96,51,78],[79,97,51,79],[79,98,51,80],[79,99,51,81],[79,100,51,82],[79,101,51,83],[80,6,52,8,"dy4D"],[80,10,52,12],[80,13,52,15],[80,17,52,15,"reshape"],[80,25,52,22],[80,26,52,22,"reshape"],[80,33,52,22],[80,35,52,23,"$dy"],[80,38,52,26],[80,40,52,28],[80,41,52,29],[80,42,52,30],[80,44,52,32,"$dy"],[80,47,52,35],[80,48,52,36,"shape"],[80,53,52,41],[80,54,52,42],[80,55,52,43],[80,56,52,44],[80,58,52,46,"$dy"],[80,61,52,49],[80,62,52,50,"shape"],[80,67,52,55],[80,68,52,56],[80,69,52,57],[80,70,52,58],[80,72,52,60,"$dy"],[80,75,52,63],[80,76,52,64,"shape"],[80,81,52,69],[80,82,52,70],[80,83,52,71],[80,84,52,72],[80,85,52,73],[80,86,52,74],[81,4,53,4],[82,4,54,4,"util"],[82,8,54,8],[82,9,54,9,"assert"],[82,15,54,15],[82,16,54,16,"dy4D"],[82,20,54,20],[82,21,54,21,"rank"],[82,25,54,25],[82,30,54,30],[82,31,54,31],[82,33,54,33],[82,39,54,39],[82,94,54,94],[82,97,55,8],[82,100,55,11,"dy4D"],[82,104,55,15],[82,105,55,16,"rank"],[82,109,55,20],[82,112,55,23],[82,113,55,24],[83,4,56,4,"util"],[83,8,56,8],[83,9,56,9,"assert"],[83,15,56,15],[83,16,56,16,"input4D"],[83,23,56,23],[83,24,56,24,"rank"],[83,28,56,28],[83,33,56,33],[83,34,56,34],[83,36,56,36],[83,42,56,42],[83,100,56,100],[83,103,57,8],[83,106,57,11,"input4D"],[83,113,57,18],[83,114,57,19,"rank"],[83,118,57,23],[83,121,57,26],[83,122,57,27],[84,4,58,4],[84,10,58,10,"inputs"],[84,16,58,16],[84,19,58,19],[85,6,58,21,"dy"],[85,8,58,23],[85,10,58,25,"dy4D"],[85,14,58,29],[86,6,58,31,"input"],[86,11,58,36],[86,13,58,38,"input4D"],[87,4,58,46],[87,5,58,47],[88,4,59,4],[88,10,59,10,"attrs"],[88,15,59,15],[88,18,59,18],[89,6,59,20,"filterSize"],[89,16,59,30],[90,6,59,32,"strides"],[90,13,59,39],[91,6,59,41,"pad"],[92,4,59,45],[92,5,59,46],[93,4,60,4],[94,4,61,4],[94,10,61,10,"res"],[94,13,61,13],[94,16,61,16,"ENGINE"],[94,23,61,22],[94,24,61,22,"ENGINE"],[94,30,61,22],[94,31,61,23,"runKernel"],[94,40,61,32],[94,41,61,33,"AvgPoolGrad"],[94,54,61,44],[94,55,61,44,"AvgPoolGrad"],[94,66,61,44],[94,68,61,46,"inputs"],[94,74,61,52],[94,76,61,54,"attrs"],[94,81,61,59],[94,82,61,60],[95,4,62,4],[95,8,62,8,"reshapedTo4D"],[95,20,62,20],[95,22,62,22],[96,6,63,8],[96,13,63,15],[96,17,63,15,"reshape"],[96,25,63,22],[96,26,63,22,"reshape"],[96,33,63,22],[96,35,63,23,"res"],[96,38,63,26],[96,40,63,28],[96,41,63,29,"res"],[96,44,63,32],[96,45,63,33,"shape"],[96,50,63,38],[96,51,63,39],[96,52,63,40],[96,53,63,41],[96,55,63,43,"res"],[96,58,63,46],[96,59,63,47,"shape"],[96,64,63,52],[96,65,63,53],[96,66,63,54],[96,67,63,55],[96,69,63,57,"res"],[96,72,63,60],[96,73,63,61,"shape"],[96,78,63,66],[96,79,63,67],[96,80,63,68],[96,81,63,69],[96,82,63,70],[96,83,63,71],[97,4,64,4],[98,4,65,4],[98,11,65,11,"res"],[98,14,65,14],[99,2,66,0],[100,2,67,7],[100,8,67,13,"avgPoolGrad"],[100,19,67,24],[100,22,67,27],[100,37,67,43],[100,41,67,43,"op"],[100,51,67,45],[100,52,67,45,"op"],[100,54,67,45],[100,56,67,46],[101,4,67,48,"avgPoolGrad_"],[102,2,67,61],[102,3,67,62],[102,4,67,63],[103,0,67,64],[103,3]],"functionMap":{"names":["<global>","avgPoolGrad_","util.assert$argument_1"],"mappings":"AAA;ACwC;0CCG,8ED;iCCU;uBDC;oCCC;0BDC;CDS"},"hasCjsExports":false},"type":"js/module"}]}