{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":58,"index":761}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"seedrandom","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":762},"end":{"line":18,"column":41,"index":803}}],"key":"QSFFm6arjkkk5s1ZGE1gSL7+aSE=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":804},"end":{"line":19,"column":47,"index":851}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}},{"name":"./Softmax","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":852},"end":{"line":20,"column":36,"index":888}}],"key":"KJi1e1aVZC/6HHZjRf54gwG0A/4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  exports.multinomial = multinomial;\n  Object.defineProperty(exports, \"multinomialConfig\", {\n    enumerable: true,\n    get: function () {\n      return multinomialConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _seedrandom = require(_dependencyMap[1], \"seedrandom\");\n  var seedrandom = _interopNamespace(_seedrandom);\n  var _cpu_util = require(_dependencyMap[2], \"../cpu_util\");\n  var _Softmax = require(_dependencyMap[3], \"./Softmax\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function multinomial(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      logits\n    } = inputs;\n    const {\n      numSamples,\n      seed,\n      normalized\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)(logits, 'multinomial');\n    const probabilities = normalized ? logits : (0, _Softmax.softmax)({\n      inputs: {\n        logits\n      },\n      backend,\n      attrs: {\n        dim: -1\n      }\n    });\n    const batchSize = probabilities.shape[0];\n    const numEvents = probabilities.shape[1];\n    const probVals = backend.data.get(probabilities.dataId).values;\n    const resShape = [batchSize, numSamples];\n    const resVals = _tensorflowTfjsCore.util.makeZerosTypedArray(_tensorflowTfjsCore.util.sizeFromShape(resShape), 'int32');\n    for (let b = 0; b < batchSize; ++b) {\n      const offset = b * numEvents;\n      // The cdf won't include the last event. It will be implicit if no other\n      // event happened.\n      const cdf = new Float32Array(numEvents - 1);\n      cdf[0] = probVals[offset];\n      for (let event = 1; event < cdf.length; ++event) {\n        cdf[event] = cdf[event - 1] + probVals[offset + event];\n      }\n      const random = seedrandom.alea(seed.toString());\n      const outOffset = b * numSamples;\n      for (let sampleId = 0; sampleId < numSamples; ++sampleId) {\n        const r = random();\n        // Assume last event happened by default.\n        resVals[outOffset + sampleId] = cdf.length;\n        for (let event = 0; event < cdf.length; event++) {\n          if (r < cdf[event]) {\n            resVals[outOffset + sampleId] = event;\n            break;\n          }\n        }\n      }\n    }\n    if (!normalized) {\n      backend.disposeIntermediateTensorInfo(probabilities);\n    }\n    return backend.makeTensorInfo(resShape, 'int32', resVals);\n  }\n  const multinomialConfig = {\n    kernelName: _tensorflowTfjsCore.Multinomial,\n    backendName: 'cpu',\n    kernelFunc: multinomial\n  };\n});","lineCount":113,"map":[[22,2,21,0,"exports"],[22,9,21,0],[22,10,21,0,"multinomial"],[22,21,21,0],[22,24,21,0,"multinomial"],[22,35,21,0],[23,2,62,0,"Object"],[23,8,62,0],[23,9,62,0,"defineProperty"],[23,23,62,0],[23,24,62,0,"exports"],[23,31,62,0],[24,4,62,0,"enumerable"],[24,14,62,0],[25,4,62,0,"get"],[25,7,62,0],[25,18,62,0,"get"],[25,19,62,0],[26,6,62,0],[26,13,62,0,"multinomialConfig"],[26,30,62,0],[27,4,62,0],[28,2,62,0],[29,2,17,0],[29,6,17,0,"_tensorflowTfjsCore"],[29,25,17,0],[29,28,17,0,"require"],[29,35,17,0],[29,36,17,0,"_dependencyMap"],[29,50,17,0],[30,2,18,0],[30,6,18,0,"_seedrandom"],[30,17,18,0],[30,20,18,0,"require"],[30,27,18,0],[30,28,18,0,"_dependencyMap"],[30,42,18,0],[31,2,18,0],[31,6,18,0,"seedrandom"],[31,16,18,0],[31,19,18,0,"_interopNamespace"],[31,36,18,0],[31,37,18,0,"_seedrandom"],[31,48,18,0],[32,2,19,0],[32,6,19,0,"_cpu_util"],[32,15,19,0],[32,18,19,0,"require"],[32,25,19,0],[32,26,19,0,"_dependencyMap"],[32,40,19,0],[33,2,20,0],[33,6,20,0,"_Softmax"],[33,14,20,0],[33,17,20,0,"require"],[33,24,20,0],[33,25,20,0,"_dependencyMap"],[33,39,20,0],[34,2,1,0],[35,0,2,0],[36,0,3,0],[37,0,4,0],[38,0,5,0],[39,0,6,0],[40,0,7,0],[41,0,8,0],[42,0,9,0],[43,0,10,0],[44,0,11,0],[45,0,12,0],[46,0,13,0],[47,0,14,0],[48,0,15,0],[49,0,16,0],[51,2,21,7],[51,11,21,16,"multinomial"],[51,22,21,27,"multinomial"],[51,23,21,28,"args"],[51,27,21,32],[51,29,21,34],[52,4,22,4],[52,10,22,10],[53,6,22,12,"inputs"],[53,12,22,18],[54,6,22,20,"backend"],[54,13,22,27],[55,6,22,29,"attrs"],[56,4,22,35],[56,5,22,36],[56,8,22,39,"args"],[56,12,22,43],[57,4,23,4],[57,10,23,10],[58,6,23,12,"logits"],[59,4,23,19],[59,5,23,20],[59,8,23,23,"inputs"],[59,14,23,29],[60,4,24,4],[60,10,24,10],[61,6,24,12,"numSamples"],[61,16,24,22],[62,6,24,24,"seed"],[62,10,24,28],[63,6,24,30,"normalized"],[64,4,24,41],[64,5,24,42],[64,8,24,45,"attrs"],[64,13,24,50],[65,4,25,4],[65,8,25,4,"assertNotComplex"],[65,17,25,20],[65,18,25,20,"assertNotComplex"],[65,34,25,20],[65,36,25,21,"logits"],[65,42,25,27],[65,44,25,29],[65,57,25,42],[65,58,25,43],[66,4,26,4],[66,10,26,10,"probabilities"],[66,23,26,23],[66,26,26,26,"normalized"],[66,36,26,36],[66,39,27,8,"logits"],[66,45,27,14],[66,48,28,8],[66,52,28,8,"softmax"],[66,60,28,15],[66,61,28,15,"softmax"],[66,68,28,15],[66,70,28,16],[67,6,28,18,"inputs"],[67,12,28,24],[67,14,28,26],[68,8,28,28,"logits"],[69,6,28,35],[69,7,28,36],[70,6,28,38,"backend"],[70,13,28,45],[71,6,28,47,"attrs"],[71,11,28,52],[71,13,28,54],[72,8,28,56,"dim"],[72,11,28,59],[72,13,28,61],[72,14,28,62],[73,6,28,64],[74,4,28,66],[74,5,28,67],[74,6,28,68],[75,4,29,4],[75,10,29,10,"batchSize"],[75,19,29,19],[75,22,29,22,"probabilities"],[75,35,29,35],[75,36,29,36,"shape"],[75,41,29,41],[75,42,29,42],[75,43,29,43],[75,44,29,44],[76,4,30,4],[76,10,30,10,"numEvents"],[76,19,30,19],[76,22,30,22,"probabilities"],[76,35,30,35],[76,36,30,36,"shape"],[76,41,30,41],[76,42,30,42],[76,43,30,43],[76,44,30,44],[77,4,31,4],[77,10,31,10,"probVals"],[77,18,31,18],[77,21,31,21,"backend"],[77,28,31,28],[77,29,31,29,"data"],[77,33,31,33],[77,34,31,34,"get"],[77,37,31,37],[77,38,31,38,"probabilities"],[77,51,31,51],[77,52,31,52,"dataId"],[77,58,31,58],[77,59,31,59],[77,60,31,60,"values"],[77,66,31,66],[78,4,32,4],[78,10,32,10,"resShape"],[78,18,32,18],[78,21,32,21],[78,22,32,22,"batchSize"],[78,31,32,31],[78,33,32,33,"numSamples"],[78,43,32,43],[78,44,32,44],[79,4,33,4],[79,10,33,10,"resVals"],[79,17,33,17],[79,20,33,20,"util"],[79,39,33,24],[79,40,33,24,"util"],[79,44,33,24],[79,45,33,25,"makeZerosTypedArray"],[79,64,33,44],[79,65,33,45,"util"],[79,84,33,49],[79,85,33,49,"util"],[79,89,33,49],[79,90,33,50,"sizeFromShape"],[79,103,33,63],[79,104,33,64,"resShape"],[79,112,33,72],[79,113,33,73],[79,115,33,75],[79,122,33,82],[79,123,33,83],[80,4,34,4],[80,9,34,9],[80,13,34,13,"b"],[80,14,34,14],[80,17,34,17],[80,18,34,18],[80,20,34,20,"b"],[80,21,34,21],[80,24,34,24,"batchSize"],[80,33,34,33],[80,35,34,35],[80,37,34,37,"b"],[80,38,34,38],[80,40,34,40],[81,6,35,8],[81,12,35,14,"offset"],[81,18,35,20],[81,21,35,23,"b"],[81,22,35,24],[81,25,35,27,"numEvents"],[81,34,35,36],[82,6,36,8],[83,6,37,8],[84,6,38,8],[84,12,38,14,"cdf"],[84,15,38,17],[84,18,38,20],[84,22,38,24,"Float32Array"],[84,34,38,36],[84,35,38,37,"numEvents"],[84,44,38,46],[84,47,38,49],[84,48,38,50],[84,49,38,51],[85,6,39,8,"cdf"],[85,9,39,11],[85,10,39,12],[85,11,39,13],[85,12,39,14],[85,15,39,17,"probVals"],[85,23,39,25],[85,24,39,26,"offset"],[85,30,39,32],[85,31,39,33],[86,6,40,8],[86,11,40,13],[86,15,40,17,"event"],[86,20,40,22],[86,23,40,25],[86,24,40,26],[86,26,40,28,"event"],[86,31,40,33],[86,34,40,36,"cdf"],[86,37,40,39],[86,38,40,40,"length"],[86,44,40,46],[86,46,40,48],[86,48,40,50,"event"],[86,53,40,55],[86,55,40,57],[87,8,41,12,"cdf"],[87,11,41,15],[87,12,41,16,"event"],[87,17,41,21],[87,18,41,22],[87,21,41,25,"cdf"],[87,24,41,28],[87,25,41,29,"event"],[87,30,41,34],[87,33,41,37],[87,34,41,38],[87,35,41,39],[87,38,41,42,"probVals"],[87,46,41,50],[87,47,41,51,"offset"],[87,53,41,57],[87,56,41,60,"event"],[87,61,41,65],[87,62,41,66],[88,6,42,8],[89,6,43,8],[89,12,43,14,"random"],[89,18,43,20],[89,21,43,23,"seedrandom"],[89,31,43,33],[89,32,43,34,"alea"],[89,36,43,38],[89,37,43,39,"seed"],[89,41,43,43],[89,42,43,44,"toString"],[89,50,43,52],[89,51,43,53],[89,52,43,54],[89,53,43,55],[90,6,44,8],[90,12,44,14,"outOffset"],[90,21,44,23],[90,24,44,26,"b"],[90,25,44,27],[90,28,44,30,"numSamples"],[90,38,44,40],[91,6,45,8],[91,11,45,13],[91,15,45,17,"sampleId"],[91,23,45,25],[91,26,45,28],[91,27,45,29],[91,29,45,31,"sampleId"],[91,37,45,39],[91,40,45,42,"numSamples"],[91,50,45,52],[91,52,45,54],[91,54,45,56,"sampleId"],[91,62,45,64],[91,64,45,66],[92,8,46,12],[92,14,46,18,"r"],[92,15,46,19],[92,18,46,22,"random"],[92,24,46,28],[92,25,46,29],[92,26,46,30],[93,8,47,12],[94,8,48,12,"resVals"],[94,15,48,19],[94,16,48,20,"outOffset"],[94,25,48,29],[94,28,48,32,"sampleId"],[94,36,48,40],[94,37,48,41],[94,40,48,44,"cdf"],[94,43,48,47],[94,44,48,48,"length"],[94,50,48,54],[95,8,49,12],[95,13,49,17],[95,17,49,21,"event"],[95,22,49,26],[95,25,49,29],[95,26,49,30],[95,28,49,32,"event"],[95,33,49,37],[95,36,49,40,"cdf"],[95,39,49,43],[95,40,49,44,"length"],[95,46,49,50],[95,48,49,52,"event"],[95,53,49,57],[95,55,49,59],[95,57,49,61],[96,10,50,16],[96,14,50,20,"r"],[96,15,50,21],[96,18,50,24,"cdf"],[96,21,50,27],[96,22,50,28,"event"],[96,27,50,33],[96,28,50,34],[96,30,50,36],[97,12,51,20,"resVals"],[97,19,51,27],[97,20,51,28,"outOffset"],[97,29,51,37],[97,32,51,40,"sampleId"],[97,40,51,48],[97,41,51,49],[97,44,51,52,"event"],[97,49,51,57],[98,12,52,20],[99,10,53,16],[100,8,54,12],[101,6,55,8],[102,4,56,4],[103,4,57,4],[103,8,57,8],[103,9,57,9,"normalized"],[103,19,57,19],[103,21,57,21],[104,6,58,8,"backend"],[104,13,58,15],[104,14,58,16,"disposeIntermediateTensorInfo"],[104,43,58,45],[104,44,58,46,"probabilities"],[104,57,58,59],[104,58,58,60],[105,4,59,4],[106,4,60,4],[106,11,60,11,"backend"],[106,18,60,18],[106,19,60,19,"makeTensorInfo"],[106,33,60,33],[106,34,60,34,"resShape"],[106,42,60,42],[106,44,60,44],[106,51,60,51],[106,53,60,53,"resVals"],[106,60,60,60],[106,61,60,61],[107,2,61,0],[108,2,62,7],[108,8,62,13,"multinomialConfig"],[108,25,62,30],[108,28,62,33],[109,4,63,4,"kernelName"],[109,14,63,14],[109,16,63,16,"Multinomial"],[109,35,63,27],[109,36,63,27,"Multinomial"],[109,47,63,27],[110,4,64,4,"backendName"],[110,15,64,15],[110,17,64,17],[110,22,64,22],[111,4,65,4,"kernelFunc"],[111,14,65,14],[111,16,65,16,"multinomial"],[112,2,66,0],[112,3,66,1],[113,0,66,2],[113,3]],"functionMap":{"names":["<global>","multinomial"],"mappings":"AAA;OCoB;CDwC"},"hasCjsExports":false},"type":"js/module"}]}