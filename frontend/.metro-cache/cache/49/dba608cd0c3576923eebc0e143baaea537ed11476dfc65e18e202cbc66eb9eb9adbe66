{"dependencies":[{"name":"../globals","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":37,"index":740}}],"key":"rU7cy1Ex6BVXJU7MHjl4QiD+5lg=","exportNames":["*"],"imports":1}},{"name":"../gradients","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":741},"end":{"line":18,"column":45,"index":786}}],"key":"89Hx1subF8nAOiIk6BMSSbJL3r0=","exportNames":["*"],"imports":1}},{"name":"../ops/ops","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":787},"end":{"line":19,"column":36,"index":823}}],"key":"OVKpXXiqESp5VDdgBmWNN4tzq3U=","exportNames":["*"],"imports":1}},{"name":"../serialization","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":824},"end":{"line":20,"column":48,"index":872}}],"key":"b9863f0nQmS2Tr8wr1DKgZpSABw=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"Optimizer\", {\n    enumerable: true,\n    get: function () {\n      return Optimizer;\n    }\n  });\n  var _globals = require(_dependencyMap[0], \"../globals\");\n  var _gradients = require(_dependencyMap[1], \"../gradients\");\n  var _opsOps = require(_dependencyMap[2], \"../ops/ops\");\n  var _serialization = require(_dependencyMap[3], \"../serialization\");\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /** @doc {heading: 'Training', subheading: 'Classes', namespace: 'train'} */\n  class Optimizer extends _serialization.Serializable {\n    /**\n     * Executes `f()` and minimizes the scalar output of `f()` by computing\n     * gradients of y with respect to the list of trainable variables provided by\n     * `varList`. If no list is provided, it defaults to all trainable variables.\n     *\n     * @param f The function to execute and whose output to minimize.\n     * @param returnCost Whether to return the scalar cost value produced by\n     * executing `f()`.\n     * @param varList An optional list of variables to update. If specified, only\n     * the trainable variables in varList will be updated by minimize. Defaults to\n     * all trainable variables.\n     *\n     * @doc {heading: 'Training', subheading: 'Optimizers'}\n     */\n    minimize(f, returnCost = false, varList) {\n      const {\n        value,\n        grads\n      } = this.computeGradients(f, varList);\n      if (varList != null) {\n        const gradArray = varList.map(v => ({\n          name: v.name,\n          tensor: grads[v.name]\n        }));\n        this.applyGradients(gradArray);\n      } else {\n        this.applyGradients(grads);\n      }\n      // Dispose gradients.\n      (0, _globals.dispose)(grads);\n      if (returnCost) {\n        return value;\n      } else {\n        value.dispose();\n        return null;\n      }\n    }\n    /**\n     * The number of iterations that this optimizer instance has been invoked for.\n     */\n    get iterations() {\n      if (this.iterations_ == null) {\n        this.iterations_ = 0;\n      }\n      return this.iterations_;\n    }\n    incrementIterations() {\n      this.iterations_ = this.iterations + 1;\n    }\n    /**\n     * Executes f() and computes the gradient of the scalar output of f() with\n     * respect to the list of trainable variables provided by `varList`. If no\n     * list is provided, it defaults to all trainable variables.\n     *\n     * @param f The function to execute and whose output to use for computing\n     * gradients with respect to variables.\n     * @param varList An optional list of variables to compute gradients with\n     * respect to. If specified, only the trainable variables in varList will have\n     * gradients computed with respect to. Defaults to all trainable variables.\n     *\n     * @doc {heading: 'Training', subheading: 'Optimizers'}\n     */\n    computeGradients(f, varList) {\n      return (0, _gradients.variableGrads)(f, varList);\n    }\n    /**\n     * Dispose the variables (if any) owned by this optimizer instance.\n     */\n    dispose() {\n      if (this.iterations_ != null) {\n        (0, _globals.dispose)(this.iterations_);\n      }\n    }\n    async saveIterations() {\n      if (this.iterations_ == null) {\n        this.iterations_ = 0;\n      }\n      return {\n        name: 'iter',\n        // TODO(cais): Use 'int64' type when available.\n        tensor: (0, _opsOps.scalar)(this.iterations_, 'int32')\n      };\n    }\n    async getWeights() {\n      throw new Error('getWeights() is not implemented for this optimizer yet.');\n    }\n    async setWeights(weightValues) {\n      throw new Error(`setWeights() is not implemented for this optimizer class ` + `${this.getClassName()}`);\n    }\n    /**\n     * Extract the first element of the weight values and set it\n     * as the iterations counter variable of this instance of optimizer.\n     *\n     * @param weightValues\n     * @returns Weight values with the first element consumed and excluded.\n     */\n    async extractIterations(weightValues) {\n      this.iterations_ = (await weightValues[0].tensor.data())[0];\n      return weightValues.slice(1);\n    }\n  }\n  Object.defineProperty(Optimizer, Symbol.hasInstance, {\n    value: instance => {\n      return instance.minimize != null && instance.computeGradients != null && instance.applyGradients != null;\n    }\n  });\n});","lineCount":142,"map":[[7,2,22,0,"Object"],[7,8,22,0],[7,9,22,0,"defineProperty"],[7,23,22,0],[7,24,22,0,"exports"],[7,31,22,0],[8,4,22,0,"enumerable"],[8,14,22,0],[9,4,22,0,"get"],[9,7,22,0],[9,18,22,0,"get"],[9,19,22,0],[10,6,22,0],[10,13,22,0,"Optimizer"],[10,22,22,0],[11,4,22,0],[12,2,22,0],[13,2,17,0],[13,6,17,0,"_globals"],[13,14,17,0],[13,17,17,0,"require"],[13,24,17,0],[13,25,17,0,"_dependencyMap"],[13,39,17,0],[14,2,18,0],[14,6,18,0,"_gradients"],[14,16,18,0],[14,19,18,0,"require"],[14,26,18,0],[14,27,18,0,"_dependencyMap"],[14,41,18,0],[15,2,19,0],[15,6,19,0,"_opsOps"],[15,13,19,0],[15,16,19,0,"require"],[15,23,19,0],[15,24,19,0,"_dependencyMap"],[15,38,19,0],[16,2,20,0],[16,6,20,0,"_serialization"],[16,20,20,0],[16,23,20,0,"require"],[16,30,20,0],[16,31,20,0,"_dependencyMap"],[16,45,20,0],[17,2,1,0],[18,0,2,0],[19,0,3,0],[20,0,4,0],[21,0,5,0],[22,0,6,0],[23,0,7,0],[24,0,8,0],[25,0,9,0],[26,0,10,0],[27,0,11,0],[28,0,12,0],[29,0,13,0],[30,0,14,0],[31,0,15,0],[32,0,16,0],[34,2,21,0],[35,2,22,7],[35,8,22,13,"Optimizer"],[35,17,22,22],[35,26,22,31,"Serializable"],[35,40,22,43],[35,41,22,43,"Serializable"],[35,53,22,43],[35,54,22,44],[36,4,23,4],[37,0,24,0],[38,0,25,0],[39,0,26,0],[40,0,27,0],[41,0,28,0],[42,0,29,0],[43,0,30,0],[44,0,31,0],[45,0,32,0],[46,0,33,0],[47,0,34,0],[48,0,35,0],[49,0,36,0],[50,4,37,4,"minimize"],[50,12,37,12,"minimize"],[50,13,37,13,"f"],[50,14,37,14],[50,16,37,16,"returnCost"],[50,26,37,26],[50,29,37,29],[50,34,37,34],[50,36,37,36,"varList"],[50,43,37,43],[50,45,37,45],[51,6,38,8],[51,12,38,14],[52,8,38,16,"value"],[52,13,38,21],[53,8,38,23,"grads"],[54,6,38,29],[54,7,38,30],[54,10,38,33],[54,14,38,37],[54,15,38,38,"computeGradients"],[54,31,38,54],[54,32,38,55,"f"],[54,33,38,56],[54,35,38,58,"varList"],[54,42,38,65],[54,43,38,66],[55,6,39,8],[55,10,39,12,"varList"],[55,17,39,19],[55,21,39,23],[55,25,39,27],[55,27,39,29],[56,8,40,12],[56,14,40,18,"gradArray"],[56,23,40,27],[56,26,40,30,"varList"],[56,33,40,37],[56,34,40,38,"map"],[56,37,40,41],[56,38,40,42,"v"],[56,39,40,43],[56,44,40,48],[57,10,40,50,"name"],[57,14,40,54],[57,16,40,56,"v"],[57,17,40,57],[57,18,40,58,"name"],[57,22,40,62],[58,10,40,64,"tensor"],[58,16,40,70],[58,18,40,72,"grads"],[58,23,40,77],[58,24,40,78,"v"],[58,25,40,79],[58,26,40,80,"name"],[58,30,40,84],[59,8,40,86],[59,9,40,87],[59,10,40,88],[59,11,40,89],[60,8,41,12],[60,12,41,16],[60,13,41,17,"applyGradients"],[60,27,41,31],[60,28,41,32,"gradArray"],[60,37,41,41],[60,38,41,42],[61,6,42,8],[61,7,42,9],[61,13,43,13],[62,8,44,12],[62,12,44,16],[62,13,44,17,"applyGradients"],[62,27,44,31],[62,28,44,32,"grads"],[62,33,44,37],[62,34,44,38],[63,6,45,8],[64,6,46,8],[65,6,47,8],[65,10,47,8,"dispose"],[65,18,47,15],[65,19,47,15,"dispose"],[65,26,47,15],[65,28,47,16,"grads"],[65,33,47,21],[65,34,47,22],[66,6,48,8],[66,10,48,12,"returnCost"],[66,20,48,22],[66,22,48,24],[67,8,49,12],[67,15,49,19,"value"],[67,20,49,24],[68,6,50,8],[68,7,50,9],[68,13,51,13],[69,8,52,12,"value"],[69,13,52,17],[69,14,52,18,"dispose"],[69,21,52,25],[69,22,52,26],[69,23,52,27],[70,8,53,12],[70,15,53,19],[70,19,53,23],[71,6,54,8],[72,4,55,4],[73,4,56,4],[74,0,57,0],[75,0,58,0],[76,4,59,4],[76,8,59,8,"iterations"],[76,18,59,18,"iterations"],[76,19,59,18],[76,21,59,21],[77,6,60,8],[77,10,60,12],[77,14,60,16],[77,15,60,17,"iterations_"],[77,26,60,28],[77,30,60,32],[77,34,60,36],[77,36,60,38],[78,8,61,12],[78,12,61,16],[78,13,61,17,"iterations_"],[78,24,61,28],[78,27,61,31],[78,28,61,32],[79,6,62,8],[80,6,63,8],[80,13,63,15],[80,17,63,19],[80,18,63,20,"iterations_"],[80,29,63,31],[81,4,64,4],[82,4,65,4,"incrementIterations"],[82,23,65,23,"incrementIterations"],[82,24,65,23],[82,26,65,26],[83,6,66,8],[83,10,66,12],[83,11,66,13,"iterations_"],[83,22,66,24],[83,25,66,27],[83,29,66,31],[83,30,66,32,"iterations"],[83,40,66,42],[83,43,66,45],[83,44,66,46],[84,4,67,4],[85,4,68,4],[86,0,69,0],[87,0,70,0],[88,0,71,0],[89,0,72,0],[90,0,73,0],[91,0,74,0],[92,0,75,0],[93,0,76,0],[94,0,77,0],[95,0,78,0],[96,0,79,0],[97,0,80,0],[98,4,81,4,"computeGradients"],[98,20,81,20,"computeGradients"],[98,21,81,21,"f"],[98,22,81,22],[98,24,81,24,"varList"],[98,31,81,31],[98,33,81,33],[99,6,82,8],[99,13,82,15],[99,17,82,15,"variableGrads"],[99,27,82,28],[99,28,82,28,"variableGrads"],[99,41,82,28],[99,43,82,29,"f"],[99,44,82,30],[99,46,82,32,"varList"],[99,53,82,39],[99,54,82,40],[100,4,83,4],[101,4,84,4],[102,0,85,0],[103,0,86,0],[104,4,87,4,"dispose"],[104,11,87,11,"dispose"],[104,12,87,11],[104,14,87,14],[105,6,88,8],[105,10,88,12],[105,14,88,16],[105,15,88,17,"iterations_"],[105,26,88,28],[105,30,88,32],[105,34,88,36],[105,36,88,38],[106,8,89,12],[106,12,89,12,"dispose"],[106,20,89,19],[106,21,89,19,"dispose"],[106,28,89,19],[106,30,89,20],[106,34,89,24],[106,35,89,25,"iterations_"],[106,46,89,36],[106,47,89,37],[107,6,90,8],[108,4,91,4],[109,4,92,4],[109,10,92,10,"saveIterations"],[109,24,92,24,"saveIterations"],[109,25,92,24],[109,27,92,27],[110,6,93,8],[110,10,93,12],[110,14,93,16],[110,15,93,17,"iterations_"],[110,26,93,28],[110,30,93,32],[110,34,93,36],[110,36,93,38],[111,8,94,12],[111,12,94,16],[111,13,94,17,"iterations_"],[111,24,94,28],[111,27,94,31],[111,28,94,32],[112,6,95,8],[113,6,96,8],[113,13,96,15],[114,8,97,12,"name"],[114,12,97,16],[114,14,97,18],[114,20,97,24],[115,8,98,12],[116,8,99,12,"tensor"],[116,14,99,18],[116,16,99,20],[116,20,99,20,"scalar"],[116,27,99,26],[116,28,99,26,"scalar"],[116,34,99,26],[116,36,99,27],[116,40,99,31],[116,41,99,32,"iterations_"],[116,52,99,43],[116,54,99,45],[116,61,99,52],[117,6,100,8],[117,7,100,9],[118,4,101,4],[119,4,102,4],[119,10,102,10,"getWeights"],[119,20,102,20,"getWeights"],[119,21,102,20],[119,23,102,23],[120,6,103,8],[120,12,103,14],[120,16,103,18,"Error"],[120,21,103,23],[120,22,103,24],[120,79,103,81],[120,80,103,82],[121,4,104,4],[122,4,105,4],[122,10,105,10,"setWeights"],[122,20,105,20,"setWeights"],[122,21,105,21,"weightValues"],[122,33,105,33],[122,35,105,35],[123,6,106,8],[123,12,106,14],[123,16,106,18,"Error"],[123,21,106,23],[123,22,106,24],[123,81,106,83],[123,84,107,12],[123,87,107,15],[123,91,107,19],[123,92,107,20,"getClassName"],[123,104,107,32],[123,105,107,33],[123,106,107,34],[123,108,107,36],[123,109,107,37],[124,4,108,4],[125,4,109,4],[126,0,110,0],[127,0,111,0],[128,0,112,0],[129,0,113,0],[130,0,114,0],[131,0,115,0],[132,4,116,4],[132,10,116,10,"extractIterations"],[132,27,116,27,"extractIterations"],[132,28,116,28,"weightValues"],[132,40,116,40],[132,42,116,42],[133,6,117,8],[133,10,117,12],[133,11,117,13,"iterations_"],[133,22,117,24],[133,25,117,27],[133,26,117,28],[133,32,117,34,"weightValues"],[133,44,117,46],[133,45,117,47],[133,46,117,48],[133,47,117,49],[133,48,117,50,"tensor"],[133,54,117,56],[133,55,117,57,"data"],[133,59,117,61],[133,60,117,62],[133,61,117,63],[133,63,117,65],[133,64,117,66],[133,65,117,67],[134,6,118,8],[134,13,118,15,"weightValues"],[134,25,118,27],[134,26,118,28,"slice"],[134,31,118,33],[134,32,118,34],[134,33,118,35],[134,34,118,36],[135,4,119,4],[136,2,120,0],[137,2,121,0,"Object"],[137,8,121,6],[137,9,121,7,"defineProperty"],[137,23,121,21],[137,24,121,22,"Optimizer"],[137,33,121,31],[137,35,121,33,"Symbol"],[137,41,121,39],[137,42,121,40,"hasInstance"],[137,53,121,51],[137,55,121,53],[138,4,122,4,"value"],[138,9,122,9],[138,11,122,12,"instance"],[138,19,122,20],[138,23,122,25],[139,6,123,8],[139,13,123,15,"instance"],[139,21,123,23],[139,22,123,24,"minimize"],[139,30,123,32],[139,34,123,36],[139,38,123,40],[139,42,123,44,"instance"],[139,50,123,52],[139,51,123,53,"computeGradients"],[139,67,123,69],[139,71,123,73],[139,75,123,77],[139,79,124,12,"instance"],[139,87,124,20],[139,88,124,21,"applyGradients"],[139,102,124,35],[139,106,124,39],[139,110,124,43],[140,4,125,4],[141,2,126,0],[141,3,126,1],[141,4,126,2],[142,0,126,3],[142,3]],"functionMap":{"names":["<global>","Optimizer","Optimizer#minimize","varList.map$argument_0","Optimizer#get__iterations","Optimizer#incrementIterations","Optimizer#computeGradients","Optimizer#dispose","Optimizer#saveIterations","Optimizer#getWeights","Optimizer#setWeights","Optimizer#extractIterations","Object.defineProperty$argument_2.value"],"mappings":"AAA;OCqB;ICe;0CCG,8CD;KDe;IGI;KHK;IIC;KJE;IKc;KLE;IMI;KNI;IOC;KPS;IQC;KRE;ISC;KTG;IUQ;KVG;CDC;WYE;KZG"},"hasCjsExports":false},"type":"js/module"}]}