{"dependencies":[{"name":"./packing_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":45,"index":748}}],"key":"XZxV38atso3t5pLpH4+paVH17Hc=","exportNames":["*"],"imports":1}},{"name":"./shader_compiler","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":749},"end":{"line":18,"column":54,"index":803}}],"key":"yVSKlvZSxQn3Ck2puzGVWEYPzq8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"PadPackedProgram\", {\n    enumerable: true,\n    get: function () {\n      return PadPackedProgram;\n    }\n  });\n  var _packing_util = require(_dependencyMap[0], \"./packing_util\");\n  var _shader_compiler = require(_dependencyMap[1], \"./shader_compiler\");\n  /**\n   * @license\n   * Copyright 2019 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  class PadPackedProgram {\n    constructor(xShape, paddings, constantValue) {\n      this.variableNames = ['x'];\n      this.packedInputs = true;\n      this.packedOutput = true;\n      this.customUniforms = [{\n        name: 'value',\n        type: 'float'\n      }];\n      this.outputShape = paddings.map((p, i) => p[0] /* beforePad */ + xShape[i] + p[1] /* afterPad */);\n      const rank = xShape.length;\n      const dtype = (0, _shader_compiler.getCoordsDataType)(rank);\n      const start = paddings.map(p => p[0]).join(',');\n      const end = paddings.map((p, i) => p[0] + xShape[i]).join(',');\n      const coords = (0, _packing_util.getChannels)('rc', rank);\n      const source = (0, _packing_util.getChannels)('source', rank);\n      const cLimit = `${coords[rank - 1]} < ${this.outputShape[rank - 1]}`;\n      const innerDims = rank === 1 ? 'source' : `vec2(${source.slice(-2).join()})`;\n      const componentSetup = [`${dtype} rc = outputLoc;`, `${coords[rank - 1]} += 1;\n       if(${cLimit}) {\n      `, rank === 1 ? '' : `}\n       rc = outputLoc;\n       ${coords[rank - 2]} += 1;\n       if(${coords[rank - 2]} < ${this.outputShape[rank - 2]}) {`, rank === 1 ? '' : `  ${coords[rank - 1]} += 1;\n         if(${cLimit}) {`];\n      const paddingArea = rank === 1 ? 'rc < start || rc >= end' : 'any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))';\n      let mainLoop = '';\n      for (let i = 0, j = rank === 1 ? 2 : 4; i < j; i++) {\n        mainLoop += `\n        ${componentSetup[i]}\n        if (${paddingArea}) {\n          result[${i}] = float(value);\n        } else {\n          ${dtype} source = rc - start;\n          result[${i}] = getChannel(getX(${source.join()}), ${innerDims});\n        }\n      `;\n      }\n      mainLoop += rank === 1 ? `} ` : `}}`;\n      this.userCode = `\n      const ${dtype} start = ${dtype}(${start});\n      const ${dtype} end = ${dtype}(${end});\n\n      void main() {\n        ${dtype} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${mainLoop}\n        setOutput(result);\n      }\n    `;\n    }\n  }\n});","lineCount":84,"map":[[7,2,19,0,"Object"],[7,8,19,0],[7,9,19,0,"defineProperty"],[7,23,19,0],[7,24,19,0,"exports"],[7,31,19,0],[8,4,19,0,"enumerable"],[8,14,19,0],[9,4,19,0,"get"],[9,7,19,0],[9,18,19,0,"get"],[9,19,19,0],[10,6,19,0],[10,13,19,0,"PadPackedProgram"],[10,29,19,0],[11,4,19,0],[12,2,19,0],[13,2,17,0],[13,6,17,0,"_packing_util"],[13,19,17,0],[13,22,17,0,"require"],[13,29,17,0],[13,30,17,0,"_dependencyMap"],[13,44,17,0],[14,2,18,0],[14,6,18,0,"_shader_compiler"],[14,22,18,0],[14,25,18,0,"require"],[14,32,18,0],[14,33,18,0,"_dependencyMap"],[14,47,18,0],[15,2,1,0],[16,0,2,0],[17,0,3,0],[18,0,4,0],[19,0,5,0],[20,0,6,0],[21,0,7,0],[22,0,8,0],[23,0,9,0],[24,0,10,0],[25,0,11,0],[26,0,12,0],[27,0,13,0],[28,0,14,0],[29,0,15,0],[30,0,16,0],[32,2,19,7],[32,8,19,13,"PadPackedProgram"],[32,24,19,29],[32,25,19,30],[33,4,20,4,"constructor"],[33,15,20,15,"constructor"],[33,16,20,16,"xShape"],[33,22,20,22],[33,24,20,24,"paddings"],[33,32,20,32],[33,34,20,34,"constantValue"],[33,47,20,47],[33,49,20,49],[34,6,21,8],[34,10,21,12],[34,11,21,13,"variableNames"],[34,24,21,26],[34,27,21,29],[34,28,21,30],[34,31,21,33],[34,32,21,34],[35,6,22,8],[35,10,22,12],[35,11,22,13,"packedInputs"],[35,23,22,25],[35,26,22,28],[35,30,22,32],[36,6,23,8],[36,10,23,12],[36,11,23,13,"packedOutput"],[36,23,23,25],[36,26,23,28],[36,30,23,32],[37,6,24,8],[37,10,24,12],[37,11,24,13,"customUniforms"],[37,25,24,27],[37,28,24,30],[37,29,24,31],[38,8,24,33,"name"],[38,12,24,37],[38,14,24,39],[38,21,24,46],[39,8,24,48,"type"],[39,12,24,52],[39,14,24,54],[40,6,24,62],[40,7,24,63],[40,8,24,64],[41,6,25,8],[41,10,25,12],[41,11,25,13,"outputShape"],[41,22,25,24],[41,25,25,27,"paddings"],[41,33,25,35],[41,34,25,36,"map"],[41,37,25,39],[41,38,25,40],[41,39,25,41,"p"],[41,40,25,42],[41,42,25,44,"i"],[41,43,25,45],[41,48,25,50,"p"],[41,49,25,51],[41,50,25,52],[41,51,25,53],[41,52,25,54],[41,53,25,55],[41,71,25,73,"xShape"],[41,77,25,79],[41,78,25,80,"i"],[41,79,25,81],[41,80,25,82],[41,83,25,85,"p"],[41,84,25,86],[41,85,25,87],[41,86,25,88],[41,87,25,89],[41,88,25,90],[41,102,25,104],[41,103,25,105],[42,6,26,8],[42,12,26,14,"rank"],[42,16,26,18],[42,19,26,21,"xShape"],[42,25,26,27],[42,26,26,28,"length"],[42,32,26,34],[43,6,27,8],[43,12,27,14,"dtype"],[43,17,27,19],[43,20,27,22],[43,24,27,22,"getCoordsDataType"],[43,40,27,39],[43,41,27,39,"getCoordsDataType"],[43,58,27,39],[43,60,27,40,"rank"],[43,64,27,44],[43,65,27,45],[44,6,28,8],[44,12,28,14,"start"],[44,17,28,19],[44,20,28,22,"paddings"],[44,28,28,30],[44,29,28,31,"map"],[44,32,28,34],[44,33,28,35,"p"],[44,34,28,36],[44,38,28,40,"p"],[44,39,28,41],[44,40,28,42],[44,41,28,43],[44,42,28,44],[44,43,28,45],[44,44,28,46,"join"],[44,48,28,50],[44,49,28,51],[44,52,28,54],[44,53,28,55],[45,6,29,8],[45,12,29,14,"end"],[45,15,29,17],[45,18,29,20,"paddings"],[45,26,29,28],[45,27,29,29,"map"],[45,30,29,32],[45,31,29,33],[45,32,29,34,"p"],[45,33,29,35],[45,35,29,37,"i"],[45,36,29,38],[45,41,29,43,"p"],[45,42,29,44],[45,43,29,45],[45,44,29,46],[45,45,29,47],[45,48,29,50,"xShape"],[45,54,29,56],[45,55,29,57,"i"],[45,56,29,58],[45,57,29,59],[45,58,29,60],[45,59,29,61,"join"],[45,63,29,65],[45,64,29,66],[45,67,29,69],[45,68,29,70],[46,6,30,8],[46,12,30,14,"coords"],[46,18,30,20],[46,21,30,23],[46,25,30,23,"getChannels"],[46,38,30,34],[46,39,30,34,"getChannels"],[46,50,30,34],[46,52,30,35],[46,56,30,39],[46,58,30,41,"rank"],[46,62,30,45],[46,63,30,46],[47,6,31,8],[47,12,31,14,"source"],[47,18,31,20],[47,21,31,23],[47,25,31,23,"getChannels"],[47,38,31,34],[47,39,31,34,"getChannels"],[47,50,31,34],[47,52,31,35],[47,60,31,43],[47,62,31,45,"rank"],[47,66,31,49],[47,67,31,50],[48,6,32,8],[48,12,32,14,"cLimit"],[48,18,32,20],[48,21,32,23],[48,24,32,26,"coords"],[48,30,32,32],[48,31,32,33,"rank"],[48,35,32,37],[48,38,32,40],[48,39,32,41],[48,40,32,42],[48,46,32,48],[48,50,32,52],[48,51,32,53,"outputShape"],[48,62,32,64],[48,63,32,65,"rank"],[48,67,32,69],[48,70,32,72],[48,71,32,73],[48,72,32,74],[48,74,32,76],[49,6,33,8],[49,12,33,14,"innerDims"],[49,21,33,23],[49,24,33,26,"rank"],[49,28,33,30],[49,33,33,35],[49,34,33,36],[49,37,33,39],[49,45,33,47],[49,48,33,50],[49,56,33,58,"source"],[49,62,33,64],[49,63,33,65,"slice"],[49,68,33,70],[49,69,33,71],[49,70,33,72],[49,71,33,73],[49,72,33,74],[49,73,33,75,"join"],[49,77,33,79],[49,78,33,80],[49,79,33,81],[49,82,33,84],[50,6,34,8],[50,12,34,14,"componentSetup"],[50,26,34,28],[50,29,34,31],[50,30,35,12],[50,33,35,15,"dtype"],[50,38,35,20],[50,56,35,38],[50,58,35,40],[50,61,35,43,"coords"],[50,67,35,49],[50,68,35,50,"rank"],[50,72,35,54],[50,75,35,57],[50,76,35,58],[50,77,35,59],[51,0,36,0],[51,12,36,12,"cLimit"],[51,18,36,18],[52,0,37,0],[52,7,37,7],[52,9,38,12,"rank"],[52,13,38,16],[52,18,38,21],[52,19,38,22],[52,22,38,25],[52,24,38,27],[52,27,38,30],[53,0,39,0],[54,0,40,0],[54,9,40,9,"coords"],[54,15,40,15],[54,16,40,16,"rank"],[54,20,40,20],[54,23,40,23],[54,24,40,24],[54,25,40,25],[55,0,41,0],[55,12,41,12,"coords"],[55,18,41,18],[55,19,41,19,"rank"],[55,23,41,23],[55,26,41,26],[55,27,41,27],[55,28,41,28],[55,34,41,34],[55,38,41,38],[55,39,41,39,"outputShape"],[55,50,41,50],[55,51,41,51,"rank"],[55,55,41,55],[55,58,41,58],[55,59,41,59],[55,60,41,60],[55,65,41,65],[55,67,42,12,"rank"],[55,71,42,16],[55,76,42,21],[55,77,42,22],[55,80,42,25],[55,82,42,27],[55,85,42,30],[55,90,42,35,"coords"],[55,96,42,41],[55,97,42,42,"rank"],[55,101,42,46],[55,104,42,49],[55,105,42,50],[55,106,42,51],[56,0,43,0],[56,14,43,14,"cLimit"],[56,20,43,20],[56,25,43,25],[56,26,44,9],[57,6,45,8],[57,12,45,14,"paddingArea"],[57,23,45,25],[57,26,45,28,"rank"],[57,30,45,32],[57,35,45,37],[57,36,45,38],[57,39,46,12],[57,64,46,37],[57,67,47,12],[57,127,47,72],[58,6,48,8],[58,10,48,12,"mainLoop"],[58,18,48,20],[58,21,48,23],[58,23,48,25],[59,6,49,8],[59,11,49,13],[59,15,49,17,"i"],[59,16,49,18],[59,19,49,21],[59,20,49,22],[59,22,49,24,"j"],[59,23,49,25],[59,26,49,28,"rank"],[59,30,49,32],[59,35,49,37],[59,36,49,38],[59,39,49,41],[59,40,49,42],[59,43,49,45],[59,44,49,46],[59,46,49,48,"i"],[59,47,49,49],[59,50,49,52,"j"],[59,51,49,53],[59,53,49,55,"i"],[59,54,49,56],[59,56,49,58],[59,58,49,60],[60,8,50,12,"mainLoop"],[60,16,50,20],[60,20,50,24],[61,0,51,0],[61,10,51,10,"componentSetup"],[61,24,51,24],[61,25,51,25,"i"],[61,26,51,26],[61,27,51,27],[62,0,52,0],[62,14,52,14,"paddingArea"],[62,25,52,25],[63,0,53,0],[63,19,53,19,"i"],[63,20,53,20],[64,0,54,0],[65,0,55,0],[65,12,55,12,"dtype"],[65,17,55,17],[66,0,56,0],[66,19,56,19,"i"],[66,20,56,20],[66,43,56,43,"source"],[66,49,56,49],[66,50,56,50,"join"],[66,54,56,54],[66,55,56,55],[66,56,56,56],[66,62,56,62,"innerDims"],[66,71,56,71],[67,0,57,0],[68,0,58,0],[68,7,58,7],[69,6,59,8],[70,6,60,8,"mainLoop"],[70,14,60,16],[70,18,60,21,"rank"],[70,22,60,25],[70,27,60,30],[70,28,60,31],[70,31,60,34],[70,35,60,38],[70,38,60,41],[70,42,60,46],[71,6,61,8],[71,10,61,12],[71,11,61,13,"userCode"],[71,19,61,21],[71,22,61,24],[72,0,62,0],[72,14,62,14,"dtype"],[72,19,62,19],[72,31,62,31,"dtype"],[72,36,62,36],[72,40,62,40,"start"],[72,45,62,45],[73,0,63,0],[73,14,63,14,"dtype"],[73,19,63,19],[73,29,63,29,"dtype"],[73,34,63,34],[73,38,63,38,"end"],[73,41,63,41],[74,0,64,0],[75,0,65,0],[76,0,66,0],[76,10,66,10,"dtype"],[76,15,66,15],[77,0,67,0],[78,0,68,0],[78,10,68,10,"mainLoop"],[78,18,68,18],[79,0,69,0],[80,0,70,0],[81,0,71,0],[81,5,71,5],[82,4,72,4],[83,2,73,0],[84,0,73,1],[84,3]],"functionMap":{"names":["<global>","PadPackedProgram","PadPackedProgram#constructor","paddings.map$argument_0"],"mappings":"AAA;OCkB;ICC;wCCK,iDD;mCCG,SD;iCCC,0BD;KD2C;CDC"},"hasCjsExports":false},"type":"js/module"}]}