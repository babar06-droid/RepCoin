{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":77,"index":780}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":781},"end":{"line":18,"column":47,"index":828}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}},{"name":"./Transpose","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":829},"end":{"line":19,"column":40,"index":869}}],"key":"F6S1ekgW6WEHcH6rql/beO2khwY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.prodImpl = prodImpl;\n  exports.prod = prod;\n  Object.defineProperty(exports, \"prodConfig\", {\n    enumerable: true,\n    get: function () {\n      return prodConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  var _Transpose = require(_dependencyMap[2], \"./Transpose\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function prodImpl(xShape, xDtype, xVals, reductionAxes) {\n    const [outShape, reduceShape] = _tensorflowTfjsCore.backend_util.computeOutAndReduceShapes(xShape, reductionAxes);\n    const outDtype = (0, _tensorflowTfjsCore.upcastType)(xDtype, 'int32');\n    const outVals = _tensorflowTfjsCore.util.makeZerosTypedArray(_tensorflowTfjsCore.util.sizeFromShape(outShape), outDtype);\n    const reduceSize = _tensorflowTfjsCore.util.sizeFromShape(reduceShape);\n    for (let i = 0; i < outVals.length; ++i) {\n      const offset = i * reduceSize;\n      let prod = 1;\n      for (let j = 0; j < reduceSize; ++j) {\n        prod *= xVals[offset + j];\n      }\n      outVals[i] = prod;\n    }\n    return {\n      outVals,\n      outShape,\n      outDtype\n    };\n  }\n  function prod(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x\n    } = inputs;\n    const {\n      axis,\n      keepDims\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)(x, 'prod');\n    const xRank = x.shape.length;\n    const axes = _tensorflowTfjsCore.util.parseAxisParam(axis, x.shape);\n    const permutation = _tensorflowTfjsCore.backend_util.getAxesPermutation(axes, xRank);\n    let reductionAxes = axes;\n    let permutedX = x;\n    const intermediateTensorInfos = [];\n    if (permutation != null) {\n      permutedX = (0, _Transpose.transpose)({\n        inputs: {\n          x\n        },\n        backend,\n        attrs: {\n          perm: permutation\n        }\n      });\n      intermediateTensorInfos.push(permutedX);\n      reductionAxes = _tensorflowTfjsCore.backend_util.getInnerMostAxes(reductionAxes.length, xRank);\n    }\n    const xVals = backend.data.get(permutedX.dataId).values;\n    const {\n      outVals,\n      outShape,\n      outDtype\n    } = prodImpl(permutedX.shape, permutedX.dtype, xVals, reductionAxes);\n    let resultShape = outShape;\n    if (keepDims) {\n      resultShape = _tensorflowTfjsCore.backend_util.expandShapeToKeepDim(outShape, axes);\n    }\n    intermediateTensorInfos.forEach(t => backend.disposeIntermediateTensorInfo(t));\n    return backend.makeTensorInfo(resultShape, outDtype, outVals);\n  }\n  const prodConfig = {\n    kernelName: _tensorflowTfjsCore.Prod,\n    backendName: 'cpu',\n    kernelFunc: prod\n  };\n});","lineCount":105,"map":[[7,2,20,0,"exports"],[7,9,20,0],[7,10,20,0,"prodImpl"],[7,18,20,0],[7,21,20,0,"prodImpl"],[7,29,20,0],[8,2,35,0,"exports"],[8,9,35,0],[8,10,35,0,"prod"],[8,14,35,0],[8,17,35,0,"prod"],[8,21,35,0],[9,2,60,0,"Object"],[9,8,60,0],[9,9,60,0,"defineProperty"],[9,23,60,0],[9,24,60,0,"exports"],[9,31,60,0],[10,4,60,0,"enumerable"],[10,14,60,0],[11,4,60,0,"get"],[11,7,60,0],[11,18,60,0,"get"],[11,19,60,0],[12,6,60,0],[12,13,60,0,"prodConfig"],[12,23,60,0],[13,4,60,0],[14,2,60,0],[15,2,17,0],[15,6,17,0,"_tensorflowTfjsCore"],[15,25,17,0],[15,28,17,0,"require"],[15,35,17,0],[15,36,17,0,"_dependencyMap"],[15,50,17,0],[16,2,18,0],[16,6,18,0,"_cpu_util"],[16,15,18,0],[16,18,18,0,"require"],[16,25,18,0],[16,26,18,0,"_dependencyMap"],[16,40,18,0],[17,2,19,0],[17,6,19,0,"_Transpose"],[17,16,19,0],[17,19,19,0,"require"],[17,26,19,0],[17,27,19,0,"_dependencyMap"],[17,41,19,0],[18,2,1,0],[19,0,2,0],[20,0,3,0],[21,0,4,0],[22,0,5,0],[23,0,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[35,2,20,7],[35,11,20,16,"prodImpl"],[35,19,20,24,"prodImpl"],[35,20,20,25,"xShape"],[35,26,20,31],[35,28,20,33,"xDtype"],[35,34,20,39],[35,36,20,41,"xVals"],[35,41,20,46],[35,43,20,48,"reductionAxes"],[35,56,20,61],[35,58,20,63],[36,4,21,4],[36,10,21,10],[36,11,21,11,"outShape"],[36,19,21,19],[36,21,21,21,"reduceShape"],[36,32,21,32],[36,33,21,33],[36,36,21,36,"backend_util"],[36,55,21,48],[36,56,21,48,"backend_util"],[36,68,21,48],[36,69,21,49,"computeOutAndReduceShapes"],[36,94,21,74],[36,95,21,75,"xShape"],[36,101,21,81],[36,103,21,83,"reductionAxes"],[36,116,21,96],[36,117,21,97],[37,4,22,4],[37,10,22,10,"outDtype"],[37,18,22,18],[37,21,22,21],[37,25,22,21,"upcastType"],[37,44,22,31],[37,45,22,31,"upcastType"],[37,55,22,31],[37,57,22,32,"xDtype"],[37,63,22,38],[37,65,22,40],[37,72,22,47],[37,73,22,48],[38,4,23,4],[38,10,23,10,"outVals"],[38,17,23,17],[38,20,23,20,"util"],[38,39,23,24],[38,40,23,24,"util"],[38,44,23,24],[38,45,23,25,"makeZerosTypedArray"],[38,64,23,44],[38,65,23,45,"util"],[38,84,23,49],[38,85,23,49,"util"],[38,89,23,49],[38,90,23,50,"sizeFromShape"],[38,103,23,63],[38,104,23,64,"outShape"],[38,112,23,72],[38,113,23,73],[38,115,23,75,"outDtype"],[38,123,23,83],[38,124,23,84],[39,4,24,4],[39,10,24,10,"reduceSize"],[39,20,24,20],[39,23,24,23,"util"],[39,42,24,27],[39,43,24,27,"util"],[39,47,24,27],[39,48,24,28,"sizeFromShape"],[39,61,24,41],[39,62,24,42,"reduceShape"],[39,73,24,53],[39,74,24,54],[40,4,25,4],[40,9,25,9],[40,13,25,13,"i"],[40,14,25,14],[40,17,25,17],[40,18,25,18],[40,20,25,20,"i"],[40,21,25,21],[40,24,25,24,"outVals"],[40,31,25,31],[40,32,25,32,"length"],[40,38,25,38],[40,40,25,40],[40,42,25,42,"i"],[40,43,25,43],[40,45,25,45],[41,6,26,8],[41,12,26,14,"offset"],[41,18,26,20],[41,21,26,23,"i"],[41,22,26,24],[41,25,26,27,"reduceSize"],[41,35,26,37],[42,6,27,8],[42,10,27,12,"prod"],[42,14,27,16],[42,17,27,19],[42,18,27,20],[43,6,28,8],[43,11,28,13],[43,15,28,17,"j"],[43,16,28,18],[43,19,28,21],[43,20,28,22],[43,22,28,24,"j"],[43,23,28,25],[43,26,28,28,"reduceSize"],[43,36,28,38],[43,38,28,40],[43,40,28,42,"j"],[43,41,28,43],[43,43,28,45],[44,8,29,12,"prod"],[44,12,29,16],[44,16,29,20,"xVals"],[44,21,29,25],[44,22,29,26,"offset"],[44,28,29,32],[44,31,29,35,"j"],[44,32,29,36],[44,33,29,37],[45,6,30,8],[46,6,31,8,"outVals"],[46,13,31,15],[46,14,31,16,"i"],[46,15,31,17],[46,16,31,18],[46,19,31,21,"prod"],[46,23,31,25],[47,4,32,4],[48,4,33,4],[48,11,33,11],[49,6,33,13,"outVals"],[49,13,33,20],[50,6,33,22,"outShape"],[50,14,33,30],[51,6,33,32,"outDtype"],[52,4,33,41],[52,5,33,42],[53,2,34,0],[54,2,35,7],[54,11,35,16,"prod"],[54,15,35,20,"prod"],[54,16,35,21,"args"],[54,20,35,25],[54,22,35,27],[55,4,36,4],[55,10,36,10],[56,6,36,12,"inputs"],[56,12,36,18],[57,6,36,20,"backend"],[57,13,36,27],[58,6,36,29,"attrs"],[59,4,36,35],[59,5,36,36],[59,8,36,39,"args"],[59,12,36,43],[60,4,37,4],[60,10,37,10],[61,6,37,12,"x"],[62,4,37,14],[62,5,37,15],[62,8,37,18,"inputs"],[62,14,37,24],[63,4,38,4],[63,10,38,10],[64,6,38,12,"axis"],[64,10,38,16],[65,6,38,18,"keepDims"],[66,4,38,27],[66,5,38,28],[66,8,38,31,"attrs"],[66,13,38,36],[67,4,39,4],[67,8,39,4,"assertNotComplex"],[67,17,39,20],[67,18,39,20,"assertNotComplex"],[67,34,39,20],[67,36,39,21,"x"],[67,37,39,22],[67,39,39,24],[67,45,39,30],[67,46,39,31],[68,4,40,4],[68,10,40,10,"xRank"],[68,15,40,15],[68,18,40,18,"x"],[68,19,40,19],[68,20,40,20,"shape"],[68,25,40,25],[68,26,40,26,"length"],[68,32,40,32],[69,4,41,4],[69,10,41,10,"axes"],[69,14,41,14],[69,17,41,17,"util"],[69,36,41,21],[69,37,41,21,"util"],[69,41,41,21],[69,42,41,22,"parseAxisParam"],[69,56,41,36],[69,57,41,37,"axis"],[69,61,41,41],[69,63,41,43,"x"],[69,64,41,44],[69,65,41,45,"shape"],[69,70,41,50],[69,71,41,51],[70,4,42,4],[70,10,42,10,"permutation"],[70,21,42,21],[70,24,42,24,"backend_util"],[70,43,42,36],[70,44,42,36,"backend_util"],[70,56,42,36],[70,57,42,37,"getAxesPermutation"],[70,75,42,55],[70,76,42,56,"axes"],[70,80,42,60],[70,82,42,62,"xRank"],[70,87,42,67],[70,88,42,68],[71,4,43,4],[71,8,43,8,"reductionAxes"],[71,21,43,21],[71,24,43,24,"axes"],[71,28,43,28],[72,4,44,4],[72,8,44,8,"permutedX"],[72,17,44,17],[72,20,44,20,"x"],[72,21,44,21],[73,4,45,4],[73,10,45,10,"intermediateTensorInfos"],[73,33,45,33],[73,36,45,36],[73,38,45,38],[74,4,46,4],[74,8,46,8,"permutation"],[74,19,46,19],[74,23,46,23],[74,27,46,27],[74,29,46,29],[75,6,47,8,"permutedX"],[75,15,47,17],[75,18,47,20],[75,22,47,20,"transpose"],[75,32,47,29],[75,33,47,29,"transpose"],[75,42,47,29],[75,44,47,30],[76,8,47,32,"inputs"],[76,14,47,38],[76,16,47,40],[77,10,47,42,"x"],[78,8,47,44],[78,9,47,45],[79,8,47,47,"backend"],[79,15,47,54],[80,8,47,56,"attrs"],[80,13,47,61],[80,15,47,63],[81,10,47,65,"perm"],[81,14,47,69],[81,16,47,71,"permutation"],[82,8,47,83],[83,6,47,85],[83,7,47,86],[83,8,47,87],[84,6,48,8,"intermediateTensorInfos"],[84,29,48,31],[84,30,48,32,"push"],[84,34,48,36],[84,35,48,37,"permutedX"],[84,44,48,46],[84,45,48,47],[85,6,49,8,"reductionAxes"],[85,19,49,21],[85,22,49,24,"backend_util"],[85,41,49,36],[85,42,49,36,"backend_util"],[85,54,49,36],[85,55,49,37,"getInnerMostAxes"],[85,71,49,53],[85,72,49,54,"reductionAxes"],[85,85,49,67],[85,86,49,68,"length"],[85,92,49,74],[85,94,49,76,"xRank"],[85,99,49,81],[85,100,49,82],[86,4,50,4],[87,4,51,4],[87,10,51,10,"xVals"],[87,15,51,15],[87,18,51,18,"backend"],[87,25,51,25],[87,26,51,26,"data"],[87,30,51,30],[87,31,51,31,"get"],[87,34,51,34],[87,35,51,35,"permutedX"],[87,44,51,44],[87,45,51,45,"dataId"],[87,51,51,51],[87,52,51,52],[87,53,51,53,"values"],[87,59,51,59],[88,4,52,4],[88,10,52,10],[89,6,52,12,"outVals"],[89,13,52,19],[90,6,52,21,"outShape"],[90,14,52,29],[91,6,52,31,"outDtype"],[92,4,52,40],[92,5,52,41],[92,8,52,44,"prodImpl"],[92,16,52,52],[92,17,52,53,"permutedX"],[92,26,52,62],[92,27,52,63,"shape"],[92,32,52,68],[92,34,52,70,"permutedX"],[92,43,52,79],[92,44,52,80,"dtype"],[92,49,52,85],[92,51,52,87,"xVals"],[92,56,52,92],[92,58,52,94,"reductionAxes"],[92,71,52,107],[92,72,52,108],[93,4,53,4],[93,8,53,8,"resultShape"],[93,19,53,19],[93,22,53,22,"outShape"],[93,30,53,30],[94,4,54,4],[94,8,54,8,"keepDims"],[94,16,54,16],[94,18,54,18],[95,6,55,8,"resultShape"],[95,17,55,19],[95,20,55,22,"backend_util"],[95,39,55,34],[95,40,55,34,"backend_util"],[95,52,55,34],[95,53,55,35,"expandShapeToKeepDim"],[95,73,55,55],[95,74,55,56,"outShape"],[95,82,55,64],[95,84,55,66,"axes"],[95,88,55,70],[95,89,55,71],[96,4,56,4],[97,4,57,4,"intermediateTensorInfos"],[97,27,57,27],[97,28,57,28,"forEach"],[97,35,57,35],[97,36,57,36,"t"],[97,37,57,37],[97,41,57,41,"backend"],[97,48,57,48],[97,49,57,49,"disposeIntermediateTensorInfo"],[97,78,57,78],[97,79,57,79,"t"],[97,80,57,80],[97,81,57,81],[97,82,57,82],[98,4,58,4],[98,11,58,11,"backend"],[98,18,58,18],[98,19,58,19,"makeTensorInfo"],[98,33,58,33],[98,34,58,34,"resultShape"],[98,45,58,45],[98,47,58,47,"outDtype"],[98,55,58,55],[98,57,58,57,"outVals"],[98,64,58,64],[98,65,58,65],[99,2,59,0],[100,2,60,7],[100,8,60,13,"prodConfig"],[100,18,60,23],[100,21,60,26],[101,4,61,4,"kernelName"],[101,14,61,14],[101,16,61,16,"Prod"],[101,35,61,20],[101,36,61,20,"Prod"],[101,40,61,20],[102,4,62,4,"backendName"],[102,15,62,15],[102,17,62,17],[102,22,62,22],[103,4,63,4,"kernelFunc"],[103,14,63,14],[103,16,63,16,"prod"],[104,2,64,0],[104,3,64,1],[105,0,64,2],[105,3]],"functionMap":{"names":["<global>","prodImpl","prod","intermediateTensorInfos.forEach$argument_0"],"mappings":"AAA;OCmB;CDc;OEC;oCCsB,6CD;CFE"},"hasCjsExports":false},"type":"js/module"}]}