{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"LRNGradProgram\", {\n    enumerable: true,\n    get: function () {\n      return LRNGradProgram;\n    }\n  });\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n  class LRNGradProgram {\n    constructor(inputShape, depthRadius, bias, alpha, beta) {\n      this.variableNames = ['inputImage', 'outputImage', 'dy'];\n      this.outputShape = [];\n      this.outputShape = inputShape;\n      this.depth = inputShape[3];\n      this.depthRadius = depthRadius;\n      this.bias = bias;\n      this.alpha = alpha;\n      this.beta = beta;\n      this.userCode = `\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${depthRadius})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${depthRadius} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${alpha}) * norm + float(${bias});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${alpha})\n                * float(${beta})\n                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${beta});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `;\n    }\n  }\n});","lineCount":97,"map":[[7,2,17,0,"Object"],[7,8,17,0],[7,9,17,0,"defineProperty"],[7,23,17,0],[7,24,17,0,"exports"],[7,31,17,0],[8,4,17,0,"enumerable"],[8,14,17,0],[9,4,17,0,"get"],[9,7,17,0],[9,18,17,0,"get"],[9,19,17,0],[10,6,17,0],[10,13,17,0,"LRNGradProgram"],[10,27,17,0],[11,4,17,0],[12,2,17,0],[13,2,1,0],[14,0,2,0],[15,0,3,0],[16,0,4,0],[17,0,5,0],[18,0,6,0],[19,0,7,0],[20,0,8,0],[21,0,9,0],[22,0,10,0],[23,0,11,0],[24,0,12,0],[25,0,13,0],[26,0,14,0],[27,0,15,0],[28,0,16,0],[29,2,17,7],[29,8,17,13,"LRNGradProgram"],[29,22,17,27],[29,23,17,28],[30,4,18,4,"constructor"],[30,15,18,15,"constructor"],[30,16,18,16,"inputShape"],[30,26,18,26],[30,28,18,28,"depthRadius"],[30,39,18,39],[30,41,18,41,"bias"],[30,45,18,45],[30,47,18,47,"alpha"],[30,52,18,52],[30,54,18,54,"beta"],[30,58,18,58],[30,60,18,60],[31,6,19,8],[31,10,19,12],[31,11,19,13,"variableNames"],[31,24,19,26],[31,27,19,29],[31,28,19,30],[31,40,19,42],[31,42,19,44],[31,55,19,57],[31,57,19,59],[31,61,19,63],[31,62,19,64],[32,6,20,8],[32,10,20,12],[32,11,20,13,"outputShape"],[32,22,20,24],[32,25,20,27],[32,27,20,29],[33,6,21,8],[33,10,21,12],[33,11,21,13,"outputShape"],[33,22,21,24],[33,25,21,27,"inputShape"],[33,35,21,37],[34,6,22,8],[34,10,22,12],[34,11,22,13,"depth"],[34,16,22,18],[34,19,22,21,"inputShape"],[34,29,22,31],[34,30,22,32],[34,31,22,33],[34,32,22,34],[35,6,23,8],[35,10,23,12],[35,11,23,13,"depthRadius"],[35,22,23,24],[35,25,23,27,"depthRadius"],[35,36,23,38],[36,6,24,8],[36,10,24,12],[36,11,24,13,"bias"],[36,15,24,17],[36,18,24,20,"bias"],[36,22,24,24],[37,6,25,8],[37,10,25,12],[37,11,25,13,"alpha"],[37,16,25,18],[37,19,25,21,"alpha"],[37,24,25,26],[38,6,26,8],[38,10,26,12],[38,11,26,13,"beta"],[38,15,26,17],[38,18,26,20,"beta"],[38,22,26,24],[39,6,27,8],[39,10,27,12],[39,11,27,13,"userCode"],[39,19,27,21],[39,22,27,24],[40,0,28,0],[41,0,29,0],[42,0,30,0],[43,0,31,0],[44,0,32,0],[45,0,33,0],[46,0,34,0],[47,0,35,0],[47,30,35,30],[47,34,35,34],[47,35,35,35,"depth"],[47,40,35,40],[48,0,36,0],[48,52,36,52,"depthRadius"],[48,63,36,63],[49,0,37,0],[49,41,37,41],[49,45,37,45],[49,46,37,46,"depth"],[49,51,37,51],[50,0,38,0],[50,26,38,26,"depthRadius"],[50,37,38,37],[51,0,39,0],[52,0,40,0],[53,0,41,0],[53,38,41,38],[53,42,41,42],[53,43,41,43,"depth"],[53,48,41,48],[54,0,42,0],[55,0,43,0],[56,0,44,0],[57,0,45,0],[58,0,46,0],[59,0,47,0],[60,0,48,0],[61,0,49,0],[62,0,50,0],[63,0,51,0],[64,0,52,0],[65,0,53,0],[66,0,54,0],[67,0,55,0],[68,0,56,0],[68,25,56,25,"alpha"],[68,30,56,30],[68,50,56,50,"bias"],[68,54,56,54],[69,0,57,0],[70,0,58,0],[71,0,59,0],[72,0,60,0],[73,0,61,0],[74,0,62,0],[75,0,63,0],[75,41,63,41,"alpha"],[75,46,63,46],[76,0,64,0],[76,26,64,26,"beta"],[76,30,64,30],[77,0,65,0],[78,0,66,0],[79,0,67,0],[80,0,68,0],[80,42,68,42,"beta"],[80,46,68,46],[81,0,69,0],[82,0,70,0],[83,0,71,0],[84,0,72,0],[85,0,73,0],[86,0,74,0],[87,0,75,0],[88,0,76,0],[89,0,77,0],[90,0,78,0],[91,0,79,0],[92,0,80,0],[93,0,81,0],[94,0,82,0],[94,5,82,5],[95,4,83,4],[96,2,84,0],[97,0,84,1],[97,3]],"functionMap":{"names":["<global>","LRNGradProgram","LRNGradProgram#constructor"],"mappings":"AAA;OCgB;ICC;KDiE;CDC"},"hasCjsExports":false},"type":"js/module"}]}