{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":109,"index":812}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":813},"end":{"line":18,"column":47,"index":860}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.depthwiseConv2dNativeBackpropInput = depthwiseConv2dNativeBackpropInput;\n  Object.defineProperty(exports, \"depthwiseConv2dNativeBackpropInputConfig\", {\n    enumerable: true,\n    get: function () {\n      return depthwiseConv2dNativeBackpropInputConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function depthwiseConv2dNativeBackpropInput(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      dy,\n      filter\n    } = inputs;\n    const {\n      strides,\n      dilations,\n      pad,\n      dimRoundingMode,\n      inputShape\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)([dy, filter], 'depthwiseConv2DNativeBackpropInput');\n    const dyStrides = _tensorflowTfjsCore.util.computeStrides(dy.shape);\n    const filterStrides = _tensorflowTfjsCore.util.computeStrides(filter.shape);\n    const convInfo = _tensorflowTfjsCore.backend_util.computeConv2DInfo(inputShape, filter.shape, strides, dilations, pad, dimRoundingMode, true /* depthwise */);\n    const dx = new _tensorflowTfjsCore.TensorBuffer(convInfo.inShape, 'float32');\n    const dxValues = dx.values;\n    const [dxS0, dxS1, dxS2] = dx.strides;\n    const dyValues = backend.data.get(dy.dataId).values;\n    const [dyS0, dyS1, dyS2] = dyStrides;\n    const fltValues = backend.data.get(filter.dataId).values;\n    const [fltS0, fltS1, fltS2] = filterStrides;\n    const {\n      batchSize,\n      filterHeight,\n      filterWidth,\n      inChannels,\n      inHeight,\n      inWidth,\n      outChannels,\n      outHeight,\n      outWidth,\n      strideHeight,\n      strideWidth\n    } = convInfo;\n    const topPad = filterHeight - 1 - convInfo.padInfo.top;\n    const leftPad = filterWidth - 1 - convInfo.padInfo.left;\n    const chMul = outChannels / inChannels;\n    for (let b = 0; b < batchSize; ++b) {\n      for (let d1 = 0; d1 < inChannels; ++d1) {\n        for (let xR = 0; xR < inHeight; ++xR) {\n          const xRCorner = xR - topPad;\n          const xRMin = Math.max(0, Math.ceil(xRCorner / strideHeight));\n          const yRMax = Math.min(outHeight, (filterHeight + xRCorner) / strideHeight);\n          for (let xC = 0; xC < inWidth; ++xC) {\n            const xCCorner = xC - leftPad;\n            const xCMin = Math.max(0, Math.ceil(xCCorner / strideWidth));\n            const yCMax = Math.min(outWidth, (filterWidth + xCCorner) / strideWidth);\n            let dotProd = 0;\n            for (let yR = xRMin; yR < yRMax; ++yR) {\n              const wR = yR * strideHeight - xRCorner;\n              for (let yC = xCMin; yC < yCMax; ++yC) {\n                const wC = yC * strideWidth - xCCorner;\n                const dyOffset = dyS0 * b + dyS1 * yR + dyS2 * yC;\n                const fltOffset = fltS0 * (filterHeight - 1 - wR) + fltS1 * (filterWidth - 1 - wC) + fltS2 * d1;\n                for (let dm = 0; dm < chMul; ++dm) {\n                  const d2 = d1 * chMul + dm;\n                  const pixel = dyValues[dyOffset + d2];\n                  const weight = fltValues[fltOffset + dm];\n                  dotProd += pixel * weight;\n                }\n              }\n            }\n            dxValues[dxS0 * b + dxS1 * xR + dxS2 * xC + d1] = dotProd;\n          }\n        }\n      }\n    }\n    return backend.makeTensorInfo(dx.shape, dx.dtype, dx.values);\n  }\n  const depthwiseConv2dNativeBackpropInputConfig = {\n    kernelName: _tensorflowTfjsCore.DepthwiseConv2dNativeBackpropInput,\n    backendName: 'cpu',\n    kernelFunc: depthwiseConv2dNativeBackpropInput\n  };\n});","lineCount":114,"map":[[7,2,19,0,"exports"],[7,9,19,0],[7,10,19,0,"depthwiseConv2dNativeBackpropInput"],[7,44,19,0],[7,47,19,0,"depthwiseConv2dNativeBackpropInput"],[7,81,19,0],[8,2,71,0,"Object"],[8,8,71,0],[8,9,71,0,"defineProperty"],[8,23,71,0],[8,24,71,0,"exports"],[8,31,71,0],[9,4,71,0,"enumerable"],[9,14,71,0],[10,4,71,0,"get"],[10,7,71,0],[10,18,71,0,"get"],[10,19,71,0],[11,6,71,0],[11,13,71,0,"depthwiseConv2dNativeBackpropInputConfig"],[11,53,71,0],[12,4,71,0],[13,2,71,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[25,0,10,0],[26,0,11,0],[27,0,12,0],[28,0,13,0],[29,0,14,0],[30,0,15,0],[31,0,16,0],[33,2,19,7],[33,11,19,16,"depthwiseConv2dNativeBackpropInput"],[33,45,19,50,"depthwiseConv2dNativeBackpropInput"],[33,46,19,51,"args"],[33,50,19,55],[33,52,19,57],[34,4,20,4],[34,10,20,10],[35,6,20,12,"inputs"],[35,12,20,18],[36,6,20,20,"backend"],[36,13,20,27],[37,6,20,29,"attrs"],[38,4,20,35],[38,5,20,36],[38,8,20,39,"args"],[38,12,20,43],[39,4,21,4],[39,10,21,10],[40,6,21,12,"dy"],[40,8,21,14],[41,6,21,16,"filter"],[42,4,21,23],[42,5,21,24],[42,8,21,27,"inputs"],[42,14,21,33],[43,4,22,4],[43,10,22,10],[44,6,22,12,"strides"],[44,13,22,19],[45,6,22,21,"dilations"],[45,15,22,30],[46,6,22,32,"pad"],[46,9,22,35],[47,6,22,37,"dimRoundingMode"],[47,21,22,52],[48,6,22,54,"inputShape"],[49,4,22,65],[49,5,22,66],[49,8,22,69,"attrs"],[49,13,22,74],[50,4,23,4],[50,8,23,4,"assertNotComplex"],[50,17,23,20],[50,18,23,20,"assertNotComplex"],[50,34,23,20],[50,36,23,21],[50,37,23,22,"dy"],[50,39,23,24],[50,41,23,26,"filter"],[50,47,23,32],[50,48,23,33],[50,50,23,35],[50,86,23,71],[50,87,23,72],[51,4,24,4],[51,10,24,10,"dyStrides"],[51,19,24,19],[51,22,24,22,"util"],[51,41,24,26],[51,42,24,26,"util"],[51,46,24,26],[51,47,24,27,"computeStrides"],[51,61,24,41],[51,62,24,42,"dy"],[51,64,24,44],[51,65,24,45,"shape"],[51,70,24,50],[51,71,24,51],[52,4,25,4],[52,10,25,10,"filterStrides"],[52,23,25,23],[52,26,25,26,"util"],[52,45,25,30],[52,46,25,30,"util"],[52,50,25,30],[52,51,25,31,"computeStrides"],[52,65,25,45],[52,66,25,46,"filter"],[52,72,25,52],[52,73,25,53,"shape"],[52,78,25,58],[52,79,25,59],[53,4,26,4],[53,10,26,10,"convInfo"],[53,18,26,18],[53,21,26,21,"backend_util"],[53,40,26,33],[53,41,26,33,"backend_util"],[53,53,26,33],[53,54,26,34,"computeConv2DInfo"],[53,71,26,51],[53,72,26,52,"inputShape"],[53,82,26,62],[53,84,26,64,"filter"],[53,90,26,70],[53,91,26,71,"shape"],[53,96,26,76],[53,98,26,78,"strides"],[53,105,26,85],[53,107,26,87,"dilations"],[53,116,26,96],[53,118,26,98,"pad"],[53,121,26,101],[53,123,26,103,"dimRoundingMode"],[53,138,26,118],[53,140,26,120],[53,144,26,124],[53,145,26,125],[53,160,26,140],[53,161,26,141],[54,4,27,4],[54,10,27,10,"dx"],[54,12,27,12],[54,15,27,15],[54,19,27,19,"TensorBuffer"],[54,38,27,31],[54,39,27,31,"TensorBuffer"],[54,51,27,31],[54,52,27,32,"convInfo"],[54,60,27,40],[54,61,27,41,"inShape"],[54,68,27,48],[54,70,27,50],[54,79,27,59],[54,80,27,60],[55,4,28,4],[55,10,28,10,"dxValues"],[55,18,28,18],[55,21,28,21,"dx"],[55,23,28,23],[55,24,28,24,"values"],[55,30,28,30],[56,4,29,4],[56,10,29,10],[56,11,29,11,"dxS0"],[56,15,29,15],[56,17,29,17,"dxS1"],[56,21,29,21],[56,23,29,23,"dxS2"],[56,27,29,27],[56,28,29,28],[56,31,29,31,"dx"],[56,33,29,33],[56,34,29,34,"strides"],[56,41,29,41],[57,4,30,4],[57,10,30,10,"dyValues"],[57,18,30,18],[57,21,30,21,"backend"],[57,28,30,28],[57,29,30,29,"data"],[57,33,30,33],[57,34,30,34,"get"],[57,37,30,37],[57,38,30,38,"dy"],[57,40,30,40],[57,41,30,41,"dataId"],[57,47,30,47],[57,48,30,48],[57,49,30,49,"values"],[57,55,30,55],[58,4,31,4],[58,10,31,10],[58,11,31,11,"dyS0"],[58,15,31,15],[58,17,31,17,"dyS1"],[58,21,31,21],[58,23,31,23,"dyS2"],[58,27,31,27],[58,28,31,28],[58,31,31,31,"dyStrides"],[58,40,31,40],[59,4,32,4],[59,10,32,10,"fltValues"],[59,19,32,19],[59,22,32,22,"backend"],[59,29,32,29],[59,30,32,30,"data"],[59,34,32,34],[59,35,32,35,"get"],[59,38,32,38],[59,39,32,39,"filter"],[59,45,32,45],[59,46,32,46,"dataId"],[59,52,32,52],[59,53,32,53],[59,54,32,54,"values"],[59,60,32,60],[60,4,33,4],[60,10,33,10],[60,11,33,11,"fltS0"],[60,16,33,16],[60,18,33,18,"fltS1"],[60,23,33,23],[60,25,33,25,"fltS2"],[60,30,33,30],[60,31,33,31],[60,34,33,34,"filterStrides"],[60,47,33,47],[61,4,34,4],[61,10,34,10],[62,6,34,12,"batchSize"],[62,15,34,21],[63,6,34,23,"filterHeight"],[63,18,34,35],[64,6,34,37,"filterWidth"],[64,17,34,48],[65,6,34,50,"inChannels"],[65,16,34,60],[66,6,34,62,"inHeight"],[66,14,34,70],[67,6,34,72,"inWidth"],[67,13,34,79],[68,6,34,81,"outChannels"],[68,17,34,92],[69,6,34,94,"outHeight"],[69,15,34,103],[70,6,34,105,"outWidth"],[70,14,34,113],[71,6,34,115,"strideHeight"],[71,18,34,127],[72,6,34,129,"strideWidth"],[73,4,34,141],[73,5,34,142],[73,8,34,145,"convInfo"],[73,16,34,153],[74,4,35,4],[74,10,35,10,"topPad"],[74,16,35,16],[74,19,35,19,"filterHeight"],[74,31,35,31],[74,34,35,34],[74,35,35,35],[74,38,35,38,"convInfo"],[74,46,35,46],[74,47,35,47,"padInfo"],[74,54,35,54],[74,55,35,55,"top"],[74,58,35,58],[75,4,36,4],[75,10,36,10,"leftPad"],[75,17,36,17],[75,20,36,20,"filterWidth"],[75,31,36,31],[75,34,36,34],[75,35,36,35],[75,38,36,38,"convInfo"],[75,46,36,46],[75,47,36,47,"padInfo"],[75,54,36,54],[75,55,36,55,"left"],[75,59,36,59],[76,4,37,4],[76,10,37,10,"chMul"],[76,15,37,15],[76,18,37,18,"outChannels"],[76,29,37,29],[76,32,37,32,"inChannels"],[76,42,37,42],[77,4,38,4],[77,9,38,9],[77,13,38,13,"b"],[77,14,38,14],[77,17,38,17],[77,18,38,18],[77,20,38,20,"b"],[77,21,38,21],[77,24,38,24,"batchSize"],[77,33,38,33],[77,35,38,35],[77,37,38,37,"b"],[77,38,38,38],[77,40,38,40],[78,6,39,8],[78,11,39,13],[78,15,39,17,"d1"],[78,17,39,19],[78,20,39,22],[78,21,39,23],[78,23,39,25,"d1"],[78,25,39,27],[78,28,39,30,"inChannels"],[78,38,39,40],[78,40,39,42],[78,42,39,44,"d1"],[78,44,39,46],[78,46,39,48],[79,8,40,12],[79,13,40,17],[79,17,40,21,"xR"],[79,19,40,23],[79,22,40,26],[79,23,40,27],[79,25,40,29,"xR"],[79,27,40,31],[79,30,40,34,"inHeight"],[79,38,40,42],[79,40,40,44],[79,42,40,46,"xR"],[79,44,40,48],[79,46,40,50],[80,10,41,16],[80,16,41,22,"xRCorner"],[80,24,41,30],[80,27,41,33,"xR"],[80,29,41,35],[80,32,41,38,"topPad"],[80,38,41,44],[81,10,42,16],[81,16,42,22,"xRMin"],[81,21,42,27],[81,24,42,30,"Math"],[81,28,42,34],[81,29,42,35,"max"],[81,32,42,38],[81,33,42,39],[81,34,42,40],[81,36,42,42,"Math"],[81,40,42,46],[81,41,42,47,"ceil"],[81,45,42,51],[81,46,42,52,"xRCorner"],[81,54,42,60],[81,57,42,63,"strideHeight"],[81,69,42,75],[81,70,42,76],[81,71,42,77],[82,10,43,16],[82,16,43,22,"yRMax"],[82,21,43,27],[82,24,43,30,"Math"],[82,28,43,34],[82,29,43,35,"min"],[82,32,43,38],[82,33,43,39,"outHeight"],[82,42,43,48],[82,44,43,50],[82,45,43,51,"filterHeight"],[82,57,43,63],[82,60,43,66,"xRCorner"],[82,68,43,74],[82,72,43,78,"strideHeight"],[82,84,43,90],[82,85,43,91],[83,10,44,16],[83,15,44,21],[83,19,44,25,"xC"],[83,21,44,27],[83,24,44,30],[83,25,44,31],[83,27,44,33,"xC"],[83,29,44,35],[83,32,44,38,"inWidth"],[83,39,44,45],[83,41,44,47],[83,43,44,49,"xC"],[83,45,44,51],[83,47,44,53],[84,12,45,20],[84,18,45,26,"xCCorner"],[84,26,45,34],[84,29,45,37,"xC"],[84,31,45,39],[84,34,45,42,"leftPad"],[84,41,45,49],[85,12,46,20],[85,18,46,26,"xCMin"],[85,23,46,31],[85,26,46,34,"Math"],[85,30,46,38],[85,31,46,39,"max"],[85,34,46,42],[85,35,46,43],[85,36,46,44],[85,38,46,46,"Math"],[85,42,46,50],[85,43,46,51,"ceil"],[85,47,46,55],[85,48,46,56,"xCCorner"],[85,56,46,64],[85,59,46,67,"strideWidth"],[85,70,46,78],[85,71,46,79],[85,72,46,80],[86,12,47,20],[86,18,47,26,"yCMax"],[86,23,47,31],[86,26,47,34,"Math"],[86,30,47,38],[86,31,47,39,"min"],[86,34,47,42],[86,35,47,43,"outWidth"],[86,43,47,51],[86,45,47,53],[86,46,47,54,"filterWidth"],[86,57,47,65],[86,60,47,68,"xCCorner"],[86,68,47,76],[86,72,47,80,"strideWidth"],[86,83,47,91],[86,84,47,92],[87,12,48,20],[87,16,48,24,"dotProd"],[87,23,48,31],[87,26,48,34],[87,27,48,35],[88,12,49,20],[88,17,49,25],[88,21,49,29,"yR"],[88,23,49,31],[88,26,49,34,"xRMin"],[88,31,49,39],[88,33,49,41,"yR"],[88,35,49,43],[88,38,49,46,"yRMax"],[88,43,49,51],[88,45,49,53],[88,47,49,55,"yR"],[88,49,49,57],[88,51,49,59],[89,14,50,24],[89,20,50,30,"wR"],[89,22,50,32],[89,25,50,35,"yR"],[89,27,50,37],[89,30,50,40,"strideHeight"],[89,42,50,52],[89,45,50,55,"xRCorner"],[89,53,50,63],[90,14,51,24],[90,19,51,29],[90,23,51,33,"yC"],[90,25,51,35],[90,28,51,38,"xCMin"],[90,33,51,43],[90,35,51,45,"yC"],[90,37,51,47],[90,40,51,50,"yCMax"],[90,45,51,55],[90,47,51,57],[90,49,51,59,"yC"],[90,51,51,61],[90,53,51,63],[91,16,52,28],[91,22,52,34,"wC"],[91,24,52,36],[91,27,52,39,"yC"],[91,29,52,41],[91,32,52,44,"strideWidth"],[91,43,52,55],[91,46,52,58,"xCCorner"],[91,54,52,66],[92,16,53,28],[92,22,53,34,"dyOffset"],[92,30,53,42],[92,33,53,45,"dyS0"],[92,37,53,49],[92,40,53,52,"b"],[92,41,53,53],[92,44,53,56,"dyS1"],[92,48,53,60],[92,51,53,63,"yR"],[92,53,53,65],[92,56,53,68,"dyS2"],[92,60,53,72],[92,63,53,75,"yC"],[92,65,53,77],[93,16,54,28],[93,22,54,34,"fltOffset"],[93,31,54,43],[93,34,54,46,"fltS0"],[93,39,54,51],[93,43,54,55,"filterHeight"],[93,55,54,67],[93,58,54,70],[93,59,54,71],[93,62,54,74,"wR"],[93,64,54,76],[93,65,54,77],[93,68,55,32,"fltS1"],[93,73,55,37],[93,77,55,41,"filterWidth"],[93,88,55,52],[93,91,55,55],[93,92,55,56],[93,95,55,59,"wC"],[93,97,55,61],[93,98,55,62],[93,101,55,65,"fltS2"],[93,106,55,70],[93,109,55,73,"d1"],[93,111,55,75],[94,16,56,28],[94,21,56,33],[94,25,56,37,"dm"],[94,27,56,39],[94,30,56,42],[94,31,56,43],[94,33,56,45,"dm"],[94,35,56,47],[94,38,56,50,"chMul"],[94,43,56,55],[94,45,56,57],[94,47,56,59,"dm"],[94,49,56,61],[94,51,56,63],[95,18,57,32],[95,24,57,38,"d2"],[95,26,57,40],[95,29,57,43,"d1"],[95,31,57,45],[95,34,57,48,"chMul"],[95,39,57,53],[95,42,57,56,"dm"],[95,44,57,58],[96,18,58,32],[96,24,58,38,"pixel"],[96,29,58,43],[96,32,58,46,"dyValues"],[96,40,58,54],[96,41,58,55,"dyOffset"],[96,49,58,63],[96,52,58,66,"d2"],[96,54,58,68],[96,55,58,69],[97,18,59,32],[97,24,59,38,"weight"],[97,30,59,44],[97,33,59,47,"fltValues"],[97,42,59,56],[97,43,59,57,"fltOffset"],[97,52,59,66],[97,55,59,69,"dm"],[97,57,59,71],[97,58,59,72],[98,18,60,32,"dotProd"],[98,25,60,39],[98,29,60,43,"pixel"],[98,34,60,48],[98,37,60,51,"weight"],[98,43,60,57],[99,16,61,28],[100,14,62,24],[101,12,63,20],[102,12,64,20,"dxValues"],[102,20,64,28],[102,21,64,29,"dxS0"],[102,25,64,33],[102,28,64,36,"b"],[102,29,64,37],[102,32,64,40,"dxS1"],[102,36,64,44],[102,39,64,47,"xR"],[102,41,64,49],[102,44,64,52,"dxS2"],[102,48,64,56],[102,51,64,59,"xC"],[102,53,64,61],[102,56,64,64,"d1"],[102,58,64,66],[102,59,64,67],[102,62,64,70,"dotProd"],[102,69,64,77],[103,10,65,16],[104,8,66,12],[105,6,67,8],[106,4,68,4],[107,4,69,4],[107,11,69,11,"backend"],[107,18,69,18],[107,19,69,19,"makeTensorInfo"],[107,33,69,33],[107,34,69,34,"dx"],[107,36,69,36],[107,37,69,37,"shape"],[107,42,69,42],[107,44,69,44,"dx"],[107,46,69,46],[107,47,69,47,"dtype"],[107,52,69,52],[107,54,69,54,"dx"],[107,56,69,56],[107,57,69,57,"values"],[107,63,69,63],[107,64,69,64],[108,2,70,0],[109,2,71,7],[109,8,71,13,"depthwiseConv2dNativeBackpropInputConfig"],[109,48,71,53],[109,51,71,56],[110,4,72,4,"kernelName"],[110,14,72,14],[110,16,72,16,"DepthwiseConv2dNativeBackpropInput"],[110,35,72,50],[110,36,72,50,"DepthwiseConv2dNativeBackpropInput"],[110,70,72,50],[111,4,73,4,"backendName"],[111,15,73,15],[111,17,73,17],[111,22,73,22],[112,4,74,4,"kernelFunc"],[112,14,74,14],[112,16,74,16,"depthwiseConv2dNativeBackpropInput"],[113,2,75,0],[113,3,75,1],[114,0,75,2],[114,3]],"functionMap":{"names":["<global>","depthwiseConv2dNativeBackpropInput"],"mappings":"AAA;OCkB;CDmD"},"hasCjsExports":false},"type":"js/module"}]}