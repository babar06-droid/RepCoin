{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":59,"index":762}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"./gpgpu_math","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":763},"end":{"line":18,"column":48,"index":811}}],"key":"r7nFADTf/sGcqNrAYkmj7Z35J80=","exportNames":["*"],"imports":1}},{"name":"./packing_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":812},"end":{"line":19,"column":45,"index":857}}],"key":"XZxV38atso3t5pLpH4+paVH17Hc=","exportNames":["*"],"imports":1}},{"name":"./shader_compiler","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":858},"end":{"line":20,"column":54,"index":912}}],"key":"yVSKlvZSxQn3Ck2puzGVWEYPzq8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"CHECK_NAN_SNIPPET_PACKED\", {\n    enumerable: true,\n    get: function () {\n      return CHECK_NAN_SNIPPET_PACKED;\n    }\n  });\n  Object.defineProperty(exports, \"ELU_DER\", {\n    enumerable: true,\n    get: function () {\n      return ELU_DER;\n    }\n  });\n  Object.defineProperty(exports, \"NOT_EQUAL\", {\n    enumerable: true,\n    get: function () {\n      return NOT_EQUAL;\n    }\n  });\n  Object.defineProperty(exports, \"BinaryOpPackedProgram\", {\n    enumerable: true,\n    get: function () {\n      return BinaryOpPackedProgram;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _gpgpu_math = require(_dependencyMap[1], \"./gpgpu_math\");\n  var _packing_util = require(_dependencyMap[2], \"./packing_util\");\n  var _shader_compiler = require(_dependencyMap[3], \"./shader_compiler\");\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  const CHECK_NAN_SNIPPET_PACKED = `\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n`;\n  const ELU_DER = `\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n`;\n  const NOT_EQUAL = `\n  return vec4(notEqual(a, b));\n`;\n  class BinaryOpPackedProgram {\n    constructor(op, aShape, bShape, checkOutOfBounds = false) {\n      this.variableNames = ['A', 'B'];\n      this.supportsBroadcasting = true;\n      this.packedInputs = true;\n      this.packedOutput = true;\n      this.outputShape = _tensorflowTfjsCore.backend_util.assertAndGetBroadcastShape(aShape, bShape);\n      const rank = this.outputShape.length;\n      this.enableShapeUniforms = (0, _gpgpu_math.useShapeUniforms)(rank);\n      let checkOutOfBoundsString = '';\n      if (checkOutOfBounds) {\n        if (rank === 0 || _tensorflowTfjsCore.util.sizeFromShape(this.outputShape) === 1) {\n          checkOutOfBoundsString = `\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        `;\n        } else {\n          const dtype = (0, _shader_compiler.getCoordsDataType)(rank);\n          checkOutOfBoundsString = `\n          ${dtype} coords = getOutputCoords();\n        `;\n          if (rank === 1) {\n            if (this.enableShapeUniforms) {\n              checkOutOfBoundsString += `\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;\n            } else {\n              checkOutOfBoundsString += `\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;\n            }\n          } else {\n            const channels = (0, _packing_util.getChannels)('coords', rank);\n            if (this.enableShapeUniforms) {\n              checkOutOfBoundsString += `\n            bool nextRowOutOfBounds =\n              (${channels[rank - 2]} + 1) >= outShape[${rank} - 2];\n            bool nextColOutOfBounds =\n              (${channels[rank - 1]} + 1) >= outShape[${rank} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `;\n            } else {\n              checkOutOfBoundsString += `\n            bool nextRowOutOfBounds =\n              (${channels[rank - 2]} + 1) >= ${this.outputShape[rank - 2]};\n            bool nextColOutOfBounds =\n              (${channels[rank - 1]} + 1) >= ${this.outputShape[rank - 1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `;\n            }\n          }\n        }\n      }\n      this.userCode = `\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${op}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${checkOutOfBoundsString}\n\n        setOutput(result);\n      }\n    `;\n    }\n  }\n});","lineCount":144,"map":[[7,2,21,0,"Object"],[7,8,21,0],[7,9,21,0,"defineProperty"],[7,23,21,0],[7,24,21,0,"exports"],[7,31,21,0],[8,4,21,0,"enumerable"],[8,14,21,0],[9,4,21,0,"get"],[9,7,21,0],[9,18,21,0,"get"],[9,19,21,0],[10,6,21,0],[10,13,21,0,"CHECK_NAN_SNIPPET_PACKED"],[10,37,21,0],[11,4,21,0],[12,2,21,0],[13,2,27,0,"Object"],[13,8,27,0],[13,9,27,0,"defineProperty"],[13,23,27,0],[13,24,27,0,"exports"],[13,31,27,0],[14,4,27,0,"enumerable"],[14,14,27,0],[15,4,27,0,"get"],[15,7,27,0],[15,18,27,0,"get"],[15,19,27,0],[16,6,27,0],[16,13,27,0,"ELU_DER"],[16,20,27,0],[17,4,27,0],[18,2,27,0],[19,2,31,0,"Object"],[19,8,31,0],[19,9,31,0,"defineProperty"],[19,23,31,0],[19,24,31,0,"exports"],[19,31,31,0],[20,4,31,0,"enumerable"],[20,14,31,0],[21,4,31,0,"get"],[21,7,31,0],[21,18,31,0,"get"],[21,19,31,0],[22,6,31,0],[22,13,31,0,"NOT_EQUAL"],[22,22,31,0],[23,4,31,0],[24,2,31,0],[25,2,34,0,"Object"],[25,8,34,0],[25,9,34,0,"defineProperty"],[25,23,34,0],[25,24,34,0,"exports"],[25,31,34,0],[26,4,34,0,"enumerable"],[26,14,34,0],[27,4,34,0,"get"],[27,7,34,0],[27,18,34,0,"get"],[27,19,34,0],[28,6,34,0],[28,13,34,0,"BinaryOpPackedProgram"],[28,34,34,0],[29,4,34,0],[30,2,34,0],[31,2,17,0],[31,6,17,0,"_tensorflowTfjsCore"],[31,25,17,0],[31,28,17,0,"require"],[31,35,17,0],[31,36,17,0,"_dependencyMap"],[31,50,17,0],[32,2,18,0],[32,6,18,0,"_gpgpu_math"],[32,17,18,0],[32,20,18,0,"require"],[32,27,18,0],[32,28,18,0,"_dependencyMap"],[32,42,18,0],[33,2,19,0],[33,6,19,0,"_packing_util"],[33,19,19,0],[33,22,19,0,"require"],[33,29,19,0],[33,30,19,0,"_dependencyMap"],[33,44,19,0],[34,2,20,0],[34,6,20,0,"_shader_compiler"],[34,22,20,0],[34,25,20,0,"require"],[34,32,20,0],[34,33,20,0,"_dependencyMap"],[34,47,20,0],[35,2,1,0],[36,0,2,0],[37,0,3,0],[38,0,4,0],[39,0,5,0],[40,0,6,0],[41,0,7,0],[42,0,8,0],[43,0,9,0],[44,0,10,0],[45,0,11,0],[46,0,12,0],[47,0,13,0],[48,0,14,0],[49,0,15,0],[50,0,16,0],[52,2,21,7],[52,8,21,13,"CHECK_NAN_SNIPPET_PACKED"],[52,32,21,37],[52,35,21,40],[53,0,22,0],[54,0,23,0],[55,0,24,0],[56,0,25,0],[57,0,26,0],[57,1,26,1],[58,2,27,7],[58,8,27,13,"ELU_DER"],[58,15,27,20],[58,18,27,23],[59,0,28,0],[60,0,29,0],[61,0,30,0],[61,1,30,1],[62,2,31,7],[62,8,31,13,"NOT_EQUAL"],[62,17,31,22],[62,20,31,25],[63,0,32,0],[64,0,33,0],[64,1,33,1],[65,2,34,7],[65,8,34,13,"BinaryOpPackedProgram"],[65,29,34,34],[65,30,34,35],[66,4,35,4,"constructor"],[66,15,35,15,"constructor"],[66,16,35,16,"op"],[66,18,35,18],[66,20,35,20,"aShape"],[66,26,35,26],[66,28,35,28,"bShape"],[66,34,35,34],[66,36,35,36,"checkOutOfBounds"],[66,52,35,52],[66,55,35,55],[66,60,35,60],[66,62,35,62],[67,6,36,8],[67,10,36,12],[67,11,36,13,"variableNames"],[67,24,36,26],[67,27,36,29],[67,28,36,30],[67,31,36,33],[67,33,36,35],[67,36,36,38],[67,37,36,39],[68,6,37,8],[68,10,37,12],[68,11,37,13,"supportsBroadcasting"],[68,31,37,33],[68,34,37,36],[68,38,37,40],[69,6,38,8],[69,10,38,12],[69,11,38,13,"packedInputs"],[69,23,38,25],[69,26,38,28],[69,30,38,32],[70,6,39,8],[70,10,39,12],[70,11,39,13,"packedOutput"],[70,23,39,25],[70,26,39,28],[70,30,39,32],[71,6,40,8],[71,10,40,12],[71,11,40,13,"outputShape"],[71,22,40,24],[71,25,40,27,"backend_util"],[71,44,40,39],[71,45,40,39,"backend_util"],[71,57,40,39],[71,58,40,40,"assertAndGetBroadcastShape"],[71,84,40,66],[71,85,40,67,"aShape"],[71,91,40,73],[71,93,40,75,"bShape"],[71,99,40,81],[71,100,40,82],[72,6,41,8],[72,12,41,14,"rank"],[72,16,41,18],[72,19,41,21],[72,23,41,25],[72,24,41,26,"outputShape"],[72,35,41,37],[72,36,41,38,"length"],[72,42,41,44],[73,6,42,8],[73,10,42,12],[73,11,42,13,"enableShapeUniforms"],[73,30,42,32],[73,33,42,35],[73,37,42,35,"useShapeUniforms"],[73,48,42,51],[73,49,42,51,"useShapeUniforms"],[73,65,42,51],[73,67,42,52,"rank"],[73,71,42,56],[73,72,42,57],[74,6,43,8],[74,10,43,12,"checkOutOfBoundsString"],[74,32,43,34],[74,35,43,37],[74,37,43,39],[75,6,44,8],[75,10,44,12,"checkOutOfBounds"],[75,26,44,28],[75,28,44,30],[76,8,45,12],[76,12,45,16,"rank"],[76,16,45,20],[76,21,45,25],[76,22,45,26],[76,26,45,30,"util"],[76,45,45,34],[76,46,45,34,"util"],[76,50,45,34],[76,51,45,35,"sizeFromShape"],[76,64,45,48],[76,65,45,49],[76,69,45,53],[76,70,45,54,"outputShape"],[76,81,45,65],[76,82,45,66],[76,87,45,71],[76,88,45,72],[76,90,45,74],[77,10,46,16,"checkOutOfBoundsString"],[77,32,46,38],[77,35,46,41],[78,0,47,0],[79,0,48,0],[80,0,49,0],[81,0,50,0],[81,9,50,9],[82,8,51,12],[82,9,51,13],[82,15,52,17],[83,10,53,16],[83,16,53,22,"dtype"],[83,21,53,27],[83,24,53,30],[83,28,53,30,"getCoordsDataType"],[83,44,53,47],[83,45,53,47,"getCoordsDataType"],[83,62,53,47],[83,64,53,48,"rank"],[83,68,53,52],[83,69,53,53],[84,10,54,16,"checkOutOfBoundsString"],[84,32,54,38],[84,35,54,41],[85,0,55,0],[85,12,55,12,"dtype"],[85,17,55,17],[86,0,56,0],[86,9,56,9],[87,10,57,16],[87,14,57,20,"rank"],[87,18,57,24],[87,23,57,29],[87,24,57,30],[87,26,57,32],[88,12,58,20],[88,16,58,24],[88,20,58,28],[88,21,58,29,"enableShapeUniforms"],[88,40,58,48],[88,42,58,50],[89,14,59,24,"checkOutOfBoundsString"],[89,36,59,46],[89,40,59,50],[90,0,60,0],[91,0,61,0],[92,0,62,0],[93,0,63,0],[93,11,63,11],[94,12,64,20],[94,13,64,21],[94,19,65,25],[95,14,66,24,"checkOutOfBoundsString"],[95,36,66,46],[95,40,66,50],[96,0,67,0],[96,41,67,41],[96,45,67,45],[96,46,67,46,"outputShape"],[96,57,67,57],[96,58,67,58],[96,59,67,59],[96,60,67,60],[97,0,68,0],[98,0,69,0],[99,0,70,0],[99,11,70,11],[100,12,71,20],[101,10,72,16],[101,11,72,17],[101,17,73,21],[102,12,74,20],[102,18,74,26,"channels"],[102,26,74,34],[102,29,74,37],[102,33,74,37,"getChannels"],[102,46,74,48],[102,47,74,48,"getChannels"],[102,58,74,48],[102,60,74,49],[102,68,74,57],[102,70,74,59,"rank"],[102,74,74,63],[102,75,74,64],[103,12,75,20],[103,16,75,24],[103,20,75,28],[103,21,75,29,"enableShapeUniforms"],[103,40,75,48],[103,42,75,50],[104,14,76,24,"checkOutOfBoundsString"],[104,36,76,46],[104,40,76,50],[105,0,77,0],[106,0,78,0],[106,17,78,17,"channels"],[106,25,78,25],[106,26,78,26,"rank"],[106,30,78,30],[106,33,78,33],[106,34,78,34],[106,35,78,35],[106,56,78,56,"rank"],[106,60,78,60],[107,0,79,0],[108,0,80,0],[108,17,80,17,"channels"],[108,25,80,25],[108,26,80,26,"rank"],[108,30,80,30],[108,33,80,33],[108,34,80,34],[108,35,80,35],[108,56,80,56,"rank"],[108,60,80,60],[109,0,81,0],[110,0,82,0],[111,0,83,0],[112,0,84,0],[112,11,84,11],[113,12,85,20],[113,13,85,21],[113,19,86,25],[114,14,87,24,"checkOutOfBoundsString"],[114,36,87,46],[114,40,87,50],[115,0,88,0],[116,0,89,0],[116,17,89,17,"channels"],[116,25,89,25],[116,26,89,26,"rank"],[116,30,89,30],[116,33,89,33],[116,34,89,34],[116,35,89,35],[116,47,89,47],[116,51,89,51],[116,52,89,52,"outputShape"],[116,63,89,63],[116,64,89,64,"rank"],[116,68,89,68],[116,71,89,71],[116,72,89,72],[116,73,89,73],[117,0,90,0],[118,0,91,0],[118,17,91,17,"channels"],[118,25,91,25],[118,26,91,26,"rank"],[118,30,91,30],[118,33,91,33],[118,34,91,34],[118,35,91,35],[118,47,91,47],[118,51,91,51],[118,52,91,52,"outputShape"],[118,63,91,63],[118,64,91,64,"rank"],[118,68,91,68],[118,71,91,71],[118,72,91,72],[118,73,91,73],[119,0,92,0],[120,0,93,0],[121,0,94,0],[122,0,95,0],[122,11,95,11],[123,12,96,20],[124,10,97,16],[125,8,98,12],[126,6,99,8],[127,6,100,8],[127,10,100,12],[127,11,100,13,"userCode"],[127,19,100,21],[127,22,100,24],[128,0,101,0],[129,0,102,0],[129,10,102,10,"op"],[129,12,102,12],[130,0,103,0],[131,0,104,0],[132,0,105,0],[133,0,106,0],[134,0,107,0],[135,0,108,0],[136,0,109,0],[137,0,110,0],[137,10,110,10,"checkOutOfBoundsString"],[137,32,110,32],[138,0,111,0],[139,0,112,0],[140,0,113,0],[141,0,114,0],[141,5,114,5],[142,4,115,4],[143,2,116,0],[144,0,116,1],[144,3]],"functionMap":{"names":["<global>","BinaryOpPackedProgram","BinaryOpPackedProgram#constructor"],"mappings":"AAA;OCiC;ICC;KDgF;CDC"},"hasCjsExports":false},"type":"js/module"}]}