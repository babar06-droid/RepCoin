{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":65,"index":768}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":769},"end":{"line":18,"column":47,"index":816}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}},{"name":"./Cast","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":817},"end":{"line":19,"column":30,"index":847}}],"key":"SOBmKbAlkQuiZ1po/s3HTPueiR4=","exportNames":["*"],"imports":1}},{"name":"./Equal","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":848},"end":{"line":20,"column":32,"index":880}}],"key":"U4KCyb8wnQ3LrhiQdnmOz78VuIs=","exportNames":["*"],"imports":1}},{"name":"./ExpandDims","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":881},"end":{"line":21,"column":42,"index":923}}],"key":"V7w09VgKx+KOWszj3bXLeTMn0bo=","exportNames":["*"],"imports":1}},{"name":"./Multiply","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":924},"end":{"line":22,"column":38,"index":962}}],"key":"1n3upWdb1/4tv8y+cZP1u3RwscI=","exportNames":["*"],"imports":1}},{"name":"./Pack","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":23,"column":0,"index":963},"end":{"line":23,"column":30,"index":993}}],"key":"QJHl3PMc3p3em+N+sSCr5JjLyKI=","exportNames":["*"],"imports":1}},{"name":"./Sum","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":24,"column":0,"index":994},"end":{"line":24,"column":28,"index":1022}}],"key":"d7Y5U7PWKSyphQklNUED/rT1MrQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.unsortedSegmentSum = unsortedSegmentSum;\n  Object.defineProperty(exports, \"unsortedSegmentSumConfig\", {\n    enumerable: true,\n    get: function () {\n      return unsortedSegmentSumConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  var _Cast = require(_dependencyMap[2], \"./Cast\");\n  var _Equal = require(_dependencyMap[3], \"./Equal\");\n  var _ExpandDims = require(_dependencyMap[4], \"./ExpandDims\");\n  var _Multiply = require(_dependencyMap[5], \"./Multiply\");\n  var _Pack = require(_dependencyMap[6], \"./Pack\");\n  var _Sum = require(_dependencyMap[7], \"./Sum\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function unsortedSegmentSum(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x,\n      segmentIds\n    } = inputs;\n    const {\n      numSegments\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)(x, 'unsortedSegmentSum');\n    const xRank = x.shape.length;\n    const segmentIdsRank = segmentIds.shape.length;\n    const res = [];\n    const intermediates = [];\n    // Reshape the segment id's so that they can be broadcast with\n    // x. The new shape should be [segmentIds.shape, 1, ..., 1]\n    const numIters = xRank - segmentIdsRank;\n    let $segmentIds = segmentIds;\n    for (let i = 0; i < numIters; ++i) {\n      const expanded = (0, _ExpandDims.expandDims)({\n        inputs: {\n          input: $segmentIds\n        },\n        backend,\n        attrs: {\n          dim: i + 1\n        }\n      });\n      $segmentIds = expanded;\n      intermediates.push(expanded);\n    }\n    for (let i = 0; i < numSegments; ++i) {\n      const scalarValue = _tensorflowTfjsCore.util.createScalarValue(i, 'int32');\n      const segmentId = backend.makeTensorInfo([], 'int32', scalarValue);\n      const mask = (0, _Equal.equal)({\n        inputs: {\n          a: segmentId,\n          b: $segmentIds\n        },\n        backend\n      });\n      const maskCasted = (0, _Cast.cast)({\n        inputs: {\n          x: mask\n        },\n        backend,\n        attrs: {\n          dtype: 'float32'\n        }\n      });\n      const mul = (0, _Multiply.multiply)({\n        inputs: {\n          a: maskCasted,\n          b: x\n        },\n        backend\n      });\n      const sumTensorInfo = (0, _Sum.sum)({\n        inputs: {\n          x: mul\n        },\n        backend,\n        attrs: {\n          axis: 0,\n          keepDims: false\n        }\n      });\n      res.push(sumTensorInfo);\n      intermediates.push(segmentId);\n      intermediates.push(mask);\n      intermediates.push(maskCasted);\n      intermediates.push(mul);\n      intermediates.push(sumTensorInfo);\n    }\n    const result = (0, _Pack.pack)({\n      inputs: res,\n      backend,\n      attrs: {\n        axis: 0\n      }\n    });\n    intermediates.forEach(t => backend.disposeIntermediateTensorInfo(t));\n    return result;\n  }\n  const unsortedSegmentSumConfig = {\n    kernelName: _tensorflowTfjsCore.UnsortedSegmentSum,\n    backendName: 'cpu',\n    kernelFunc: unsortedSegmentSum\n  };\n});","lineCount":132,"map":[[7,2,25,0,"exports"],[7,9,25,0],[7,10,25,0,"unsortedSegmentSum"],[7,28,25,0],[7,31,25,0,"unsortedSegmentSum"],[7,49,25,0],[8,2,61,0,"Object"],[8,8,61,0],[8,9,61,0,"defineProperty"],[8,23,61,0],[8,24,61,0,"exports"],[8,31,61,0],[9,4,61,0,"enumerable"],[9,14,61,0],[10,4,61,0,"get"],[10,7,61,0],[10,18,61,0,"get"],[10,19,61,0],[11,6,61,0],[11,13,61,0,"unsortedSegmentSumConfig"],[11,37,61,0],[12,4,61,0],[13,2,61,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,19,0],[16,6,19,0,"_Cast"],[16,11,19,0],[16,14,19,0,"require"],[16,21,19,0],[16,22,19,0,"_dependencyMap"],[16,36,19,0],[17,2,20,0],[17,6,20,0,"_Equal"],[17,12,20,0],[17,15,20,0,"require"],[17,22,20,0],[17,23,20,0,"_dependencyMap"],[17,37,20,0],[18,2,21,0],[18,6,21,0,"_ExpandDims"],[18,17,21,0],[18,20,21,0,"require"],[18,27,21,0],[18,28,21,0,"_dependencyMap"],[18,42,21,0],[19,2,22,0],[19,6,22,0,"_Multiply"],[19,15,22,0],[19,18,22,0,"require"],[19,25,22,0],[19,26,22,0,"_dependencyMap"],[19,40,22,0],[20,2,23,0],[20,6,23,0,"_Pack"],[20,11,23,0],[20,14,23,0,"require"],[20,21,23,0],[20,22,23,0,"_dependencyMap"],[20,36,23,0],[21,2,24,0],[21,6,24,0,"_Sum"],[21,10,24,0],[21,13,24,0,"require"],[21,20,24,0],[21,21,24,0,"_dependencyMap"],[21,35,24,0],[22,2,1,0],[23,0,2,0],[24,0,3,0],[25,0,4,0],[26,0,5,0],[27,0,6,0],[28,0,7,0],[29,0,8,0],[30,0,9,0],[31,0,10,0],[32,0,11,0],[33,0,12,0],[34,0,13,0],[35,0,14,0],[36,0,15,0],[37,0,16,0],[39,2,25,7],[39,11,25,16,"unsortedSegmentSum"],[39,29,25,34,"unsortedSegmentSum"],[39,30,25,35,"args"],[39,34,25,39],[39,36,25,41],[40,4,26,4],[40,10,26,10],[41,6,26,12,"inputs"],[41,12,26,18],[42,6,26,20,"backend"],[42,13,26,27],[43,6,26,29,"attrs"],[44,4,26,35],[44,5,26,36],[44,8,26,39,"args"],[44,12,26,43],[45,4,27,4],[45,10,27,10],[46,6,27,12,"x"],[46,7,27,13],[47,6,27,15,"segmentIds"],[48,4,27,26],[48,5,27,27],[48,8,27,30,"inputs"],[48,14,27,36],[49,4,28,4],[49,10,28,10],[50,6,28,12,"numSegments"],[51,4,28,24],[51,5,28,25],[51,8,28,28,"attrs"],[51,13,28,33],[52,4,29,4],[52,8,29,4,"assertNotComplex"],[52,17,29,20],[52,18,29,20,"assertNotComplex"],[52,34,29,20],[52,36,29,21,"x"],[52,37,29,22],[52,39,29,24],[52,59,29,44],[52,60,29,45],[53,4,30,4],[53,10,30,10,"xRank"],[53,15,30,15],[53,18,30,18,"x"],[53,19,30,19],[53,20,30,20,"shape"],[53,25,30,25],[53,26,30,26,"length"],[53,32,30,32],[54,4,31,4],[54,10,31,10,"segmentIdsRank"],[54,24,31,24],[54,27,31,27,"segmentIds"],[54,37,31,37],[54,38,31,38,"shape"],[54,43,31,43],[54,44,31,44,"length"],[54,50,31,50],[55,4,32,4],[55,10,32,10,"res"],[55,13,32,13],[55,16,32,16],[55,18,32,18],[56,4,33,4],[56,10,33,10,"intermediates"],[56,23,33,23],[56,26,33,26],[56,28,33,28],[57,4,34,4],[58,4,35,4],[59,4,36,4],[59,10,36,10,"numIters"],[59,18,36,18],[59,21,36,21,"xRank"],[59,26,36,26],[59,29,36,29,"segmentIdsRank"],[59,43,36,43],[60,4,37,4],[60,8,37,8,"$segmentIds"],[60,19,37,19],[60,22,37,22,"segmentIds"],[60,32,37,32],[61,4,38,4],[61,9,38,9],[61,13,38,13,"i"],[61,14,38,14],[61,17,38,17],[61,18,38,18],[61,20,38,20,"i"],[61,21,38,21],[61,24,38,24,"numIters"],[61,32,38,32],[61,34,38,34],[61,36,38,36,"i"],[61,37,38,37],[61,39,38,39],[62,6,39,8],[62,12,39,14,"expanded"],[62,20,39,22],[62,23,39,25],[62,27,39,25,"expandDims"],[62,38,39,35],[62,39,39,35,"expandDims"],[62,49,39,35],[62,51,39,36],[63,8,39,38,"inputs"],[63,14,39,44],[63,16,39,46],[64,10,39,48,"input"],[64,15,39,53],[64,17,39,55,"$segmentIds"],[65,8,39,67],[65,9,39,68],[66,8,39,70,"backend"],[66,15,39,77],[67,8,39,79,"attrs"],[67,13,39,84],[67,15,39,86],[68,10,39,88,"dim"],[68,13,39,91],[68,15,39,93,"i"],[68,16,39,94],[68,19,39,97],[69,8,39,99],[70,6,39,101],[70,7,39,102],[70,8,39,103],[71,6,40,8,"$segmentIds"],[71,17,40,19],[71,20,40,22,"expanded"],[71,28,40,30],[72,6,41,8,"intermediates"],[72,19,41,21],[72,20,41,22,"push"],[72,24,41,26],[72,25,41,27,"expanded"],[72,33,41,35],[72,34,41,36],[73,4,42,4],[74,4,43,4],[74,9,43,9],[74,13,43,13,"i"],[74,14,43,14],[74,17,43,17],[74,18,43,18],[74,20,43,20,"i"],[74,21,43,21],[74,24,43,24,"numSegments"],[74,35,43,35],[74,37,43,37],[74,39,43,39,"i"],[74,40,43,40],[74,42,43,42],[75,6,44,8],[75,12,44,14,"scalarValue"],[75,23,44,25],[75,26,44,28,"util"],[75,45,44,32],[75,46,44,32,"util"],[75,50,44,32],[75,51,44,33,"createScalarValue"],[75,68,44,50],[75,69,44,51,"i"],[75,70,44,52],[75,72,44,54],[75,79,44,61],[75,80,44,62],[76,6,45,8],[76,12,45,14,"segmentId"],[76,21,45,23],[76,24,45,26,"backend"],[76,31,45,33],[76,32,45,34,"makeTensorInfo"],[76,46,45,48],[76,47,45,49],[76,49,45,51],[76,51,45,53],[76,58,45,60],[76,60,45,62,"scalarValue"],[76,71,45,73],[76,72,45,74],[77,6,46,8],[77,12,46,14,"mask"],[77,16,46,18],[77,19,46,21],[77,23,46,21,"equal"],[77,29,46,26],[77,30,46,26,"equal"],[77,35,46,26],[77,37,46,27],[78,8,46,29,"inputs"],[78,14,46,35],[78,16,46,37],[79,10,46,39,"a"],[79,11,46,40],[79,13,46,42,"segmentId"],[79,22,46,51],[80,10,46,53,"b"],[80,11,46,54],[80,13,46,56,"$segmentIds"],[81,8,46,68],[81,9,46,69],[82,8,46,71,"backend"],[83,6,46,79],[83,7,46,80],[83,8,46,81],[84,6,47,8],[84,12,47,14,"maskCasted"],[84,22,47,24],[84,25,47,27],[84,29,47,27,"cast"],[84,34,47,31],[84,35,47,31,"cast"],[84,39,47,31],[84,41,47,32],[85,8,47,34,"inputs"],[85,14,47,40],[85,16,47,42],[86,10,47,44,"x"],[86,11,47,45],[86,13,47,47,"mask"],[87,8,47,52],[87,9,47,53],[88,8,47,55,"backend"],[88,15,47,62],[89,8,47,64,"attrs"],[89,13,47,69],[89,15,47,71],[90,10,47,73,"dtype"],[90,15,47,78],[90,17,47,80],[91,8,47,90],[92,6,47,92],[92,7,47,93],[92,8,47,94],[93,6,48,8],[93,12,48,14,"mul"],[93,15,48,17],[93,18,48,20],[93,22,48,20,"multiply"],[93,31,48,28],[93,32,48,28,"multiply"],[93,40,48,28],[93,42,48,29],[94,8,48,31,"inputs"],[94,14,48,37],[94,16,48,39],[95,10,48,41,"a"],[95,11,48,42],[95,13,48,44,"maskCasted"],[95,23,48,54],[96,10,48,56,"b"],[96,11,48,57],[96,13,48,59,"x"],[97,8,48,61],[97,9,48,62],[98,8,48,64,"backend"],[99,6,48,72],[99,7,48,73],[99,8,48,74],[100,6,49,8],[100,12,49,14,"sumTensorInfo"],[100,25,49,27],[100,28,49,30],[100,32,49,30,"sum"],[100,36,49,33],[100,37,49,33,"sum"],[100,40,49,33],[100,42,49,34],[101,8,49,36,"inputs"],[101,14,49,42],[101,16,49,44],[102,10,49,46,"x"],[102,11,49,47],[102,13,49,49,"mul"],[103,8,49,53],[103,9,49,54],[104,8,49,56,"backend"],[104,15,49,63],[105,8,49,65,"attrs"],[105,13,49,70],[105,15,49,72],[106,10,49,74,"axis"],[106,14,49,78],[106,16,49,80],[106,17,49,81],[107,10,49,83,"keepDims"],[107,18,49,91],[107,20,49,93],[108,8,49,99],[109,6,49,101],[109,7,49,102],[109,8,49,103],[110,6,50,8,"res"],[110,9,50,11],[110,10,50,12,"push"],[110,14,50,16],[110,15,50,17,"sumTensorInfo"],[110,28,50,30],[110,29,50,31],[111,6,51,8,"intermediates"],[111,19,51,21],[111,20,51,22,"push"],[111,24,51,26],[111,25,51,27,"segmentId"],[111,34,51,36],[111,35,51,37],[112,6,52,8,"intermediates"],[112,19,52,21],[112,20,52,22,"push"],[112,24,52,26],[112,25,52,27,"mask"],[112,29,52,31],[112,30,52,32],[113,6,53,8,"intermediates"],[113,19,53,21],[113,20,53,22,"push"],[113,24,53,26],[113,25,53,27,"maskCasted"],[113,35,53,37],[113,36,53,38],[114,6,54,8,"intermediates"],[114,19,54,21],[114,20,54,22,"push"],[114,24,54,26],[114,25,54,27,"mul"],[114,28,54,30],[114,29,54,31],[115,6,55,8,"intermediates"],[115,19,55,21],[115,20,55,22,"push"],[115,24,55,26],[115,25,55,27,"sumTensorInfo"],[115,38,55,40],[115,39,55,41],[116,4,56,4],[117,4,57,4],[117,10,57,10,"result"],[117,16,57,16],[117,19,57,19],[117,23,57,19,"pack"],[117,28,57,23],[117,29,57,23,"pack"],[117,33,57,23],[117,35,57,24],[118,6,57,26,"inputs"],[118,12,57,32],[118,14,57,34,"res"],[118,17,57,37],[119,6,57,39,"backend"],[119,13,57,46],[120,6,57,48,"attrs"],[120,11,57,53],[120,13,57,55],[121,8,57,57,"axis"],[121,12,57,61],[121,14,57,63],[122,6,57,65],[123,4,57,67],[123,5,57,68],[123,6,57,69],[124,4,58,4,"intermediates"],[124,17,58,17],[124,18,58,18,"forEach"],[124,25,58,25],[124,26,58,26,"t"],[124,27,58,27],[124,31,58,31,"backend"],[124,38,58,38],[124,39,58,39,"disposeIntermediateTensorInfo"],[124,68,58,68],[124,69,58,69,"t"],[124,70,58,70],[124,71,58,71],[124,72,58,72],[125,4,59,4],[125,11,59,11,"result"],[125,17,59,17],[126,2,60,0],[127,2,61,7],[127,8,61,13,"unsortedSegmentSumConfig"],[127,32,61,37],[127,35,61,40],[128,4,62,4,"kernelName"],[128,14,62,14],[128,16,62,16,"UnsortedSegmentSum"],[128,35,62,34],[128,36,62,34,"UnsortedSegmentSum"],[128,54,62,34],[129,4,63,4,"backendName"],[129,15,63,15],[129,17,63,17],[129,22,63,22],[130,4,64,4,"kernelFunc"],[130,14,64,14],[130,16,64,16,"unsortedSegmentSum"],[131,2,65,0],[131,3,65,1],[132,0,65,2],[132,3]],"functionMap":{"names":["<global>","unsortedSegmentSum","intermediates.forEach$argument_0"],"mappings":"AAA;OCwB;0BCiC,6CD;CDE"},"hasCjsExports":false},"type":"js/module"}]}