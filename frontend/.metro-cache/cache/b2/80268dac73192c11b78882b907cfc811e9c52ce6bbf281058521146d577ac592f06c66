{"dependencies":[{"name":"./shader_compiler","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":54,"index":757}}],"key":"yVSKlvZSxQn3Ck2puzGVWEYPzq8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"TileProgram\", {\n    enumerable: true,\n    get: function () {\n      return TileProgram;\n    }\n  });\n  var _shader_compiler = require(_dependencyMap[0], \"./shader_compiler\");\n  /**\n   * @license\n   * Copyright 2017 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  class TileProgram {\n    constructor(aShape, reps) {\n      this.variableNames = ['A'];\n      const outputShape = new Array(aShape.length);\n      for (let i = 0; i < outputShape.length; i++) {\n        outputShape[i] = aShape[i] * reps[i];\n      }\n      this.outputShape = outputShape;\n      this.rank = outputShape.length;\n      const dtype = (0, _shader_compiler.getCoordsDataType)(this.rank);\n      const sourceCoords = getSourceCoords(aShape);\n      this.userCode = `\n      void main() {\n        ${dtype} resRC = getOutputCoords();\n        setOutput(getA(${sourceCoords}));\n      }\n    `;\n    }\n  }\n  function getSourceCoords(aShape) {\n    const rank = aShape.length;\n    if (rank > 5) {\n      throw Error(`Tile for rank ${rank} is not yet supported`);\n    }\n    if (rank === 1) {\n      return `imod(resRC, ${aShape[0]})`;\n    }\n    const currentCoords = ['resRC.x', 'resRC.y', 'resRC.z', 'resRC.w', 'resRC.u'];\n    const sourceCoords = [];\n    for (let i = 0; i < aShape.length; i++) {\n      sourceCoords.push(`imod(${currentCoords[i]}, ${aShape[i]})`);\n    }\n    return sourceCoords.join();\n  }\n});","lineCount":65,"map":[[7,2,18,0,"Object"],[7,8,18,0],[7,9,18,0,"defineProperty"],[7,23,18,0],[7,24,18,0,"exports"],[7,31,18,0],[8,4,18,0,"enumerable"],[8,14,18,0],[9,4,18,0,"get"],[9,7,18,0],[9,18,18,0,"get"],[9,19,18,0],[10,6,18,0],[10,13,18,0,"TileProgram"],[10,24,18,0],[11,4,18,0],[12,2,18,0],[13,2,17,0],[13,6,17,0,"_shader_compiler"],[13,22,17,0],[13,25,17,0,"require"],[13,32,17,0],[13,33,17,0,"_dependencyMap"],[13,47,17,0],[14,2,1,0],[15,0,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[20,0,7,0],[21,0,8,0],[22,0,9,0],[23,0,10,0],[24,0,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[31,2,18,7],[31,8,18,13,"TileProgram"],[31,19,18,24],[31,20,18,25],[32,4,19,4,"constructor"],[32,15,19,15,"constructor"],[32,16,19,16,"aShape"],[32,22,19,22],[32,24,19,24,"reps"],[32,28,19,28],[32,30,19,30],[33,6,20,8],[33,10,20,12],[33,11,20,13,"variableNames"],[33,24,20,26],[33,27,20,29],[33,28,20,30],[33,31,20,33],[33,32,20,34],[34,6,21,8],[34,12,21,14,"outputShape"],[34,23,21,25],[34,26,21,28],[34,30,21,32,"Array"],[34,35,21,37],[34,36,21,38,"aShape"],[34,42,21,44],[34,43,21,45,"length"],[34,49,21,51],[34,50,21,52],[35,6,22,8],[35,11,22,13],[35,15,22,17,"i"],[35,16,22,18],[35,19,22,21],[35,20,22,22],[35,22,22,24,"i"],[35,23,22,25],[35,26,22,28,"outputShape"],[35,37,22,39],[35,38,22,40,"length"],[35,44,22,46],[35,46,22,48,"i"],[35,47,22,49],[35,49,22,51],[35,51,22,53],[36,8,23,12,"outputShape"],[36,19,23,23],[36,20,23,24,"i"],[36,21,23,25],[36,22,23,26],[36,25,23,29,"aShape"],[36,31,23,35],[36,32,23,36,"i"],[36,33,23,37],[36,34,23,38],[36,37,23,41,"reps"],[36,41,23,45],[36,42,23,46,"i"],[36,43,23,47],[36,44,23,48],[37,6,24,8],[38,6,25,8],[38,10,25,12],[38,11,25,13,"outputShape"],[38,22,25,24],[38,25,25,27,"outputShape"],[38,36,25,38],[39,6,26,8],[39,10,26,12],[39,11,26,13,"rank"],[39,15,26,17],[39,18,26,20,"outputShape"],[39,29,26,31],[39,30,26,32,"length"],[39,36,26,38],[40,6,27,8],[40,12,27,14,"dtype"],[40,17,27,19],[40,20,27,22],[40,24,27,22,"getCoordsDataType"],[40,40,27,39],[40,41,27,39,"getCoordsDataType"],[40,58,27,39],[40,60,27,40],[40,64,27,44],[40,65,27,45,"rank"],[40,69,27,49],[40,70,27,50],[41,6,28,8],[41,12,28,14,"sourceCoords"],[41,24,28,26],[41,27,28,29,"getSourceCoords"],[41,42,28,44],[41,43,28,45,"aShape"],[41,49,28,51],[41,50,28,52],[42,6,29,8],[42,10,29,12],[42,11,29,13,"userCode"],[42,19,29,21],[42,22,29,24],[43,0,30,0],[44,0,31,0],[44,10,31,10,"dtype"],[44,15,31,15],[45,0,32,0],[45,25,32,25,"sourceCoords"],[45,37,32,37],[46,0,33,0],[47,0,34,0],[47,5,34,5],[48,4,35,4],[49,2,36,0],[50,2,37,0],[50,11,37,9,"getSourceCoords"],[50,26,37,24,"getSourceCoords"],[50,27,37,25,"aShape"],[50,33,37,31],[50,35,37,33],[51,4,38,4],[51,10,38,10,"rank"],[51,14,38,14],[51,17,38,17,"aShape"],[51,23,38,23],[51,24,38,24,"length"],[51,30,38,30],[52,4,39,4],[52,8,39,8,"rank"],[52,12,39,12],[52,15,39,15],[52,16,39,16],[52,18,39,18],[53,6,40,8],[53,12,40,14,"Error"],[53,17,40,19],[53,18,40,20],[53,35,40,37,"rank"],[53,39,40,41],[53,62,40,64],[53,63,40,65],[54,4,41,4],[55,4,42,4],[55,8,42,8,"rank"],[55,12,42,12],[55,17,42,17],[55,18,42,18],[55,20,42,20],[56,6,43,8],[56,13,43,15],[56,28,43,30,"aShape"],[56,34,43,36],[56,35,43,37],[56,36,43,38],[56,37,43,39],[56,40,43,42],[57,4,44,4],[58,4,45,4],[58,10,45,10,"currentCoords"],[58,23,45,23],[58,26,45,26],[58,27,45,27],[58,36,45,36],[58,38,45,38],[58,47,45,47],[58,49,45,49],[58,58,45,58],[58,60,45,60],[58,69,45,69],[58,71,45,71],[58,80,45,80],[58,81,45,81],[59,4,46,4],[59,10,46,10,"sourceCoords"],[59,22,46,22],[59,25,46,25],[59,27,46,27],[60,4,47,4],[60,9,47,9],[60,13,47,13,"i"],[60,14,47,14],[60,17,47,17],[60,18,47,18],[60,20,47,20,"i"],[60,21,47,21],[60,24,47,24,"aShape"],[60,30,47,30],[60,31,47,31,"length"],[60,37,47,37],[60,39,47,39,"i"],[60,40,47,40],[60,42,47,42],[60,44,47,44],[61,6,48,8,"sourceCoords"],[61,18,48,20],[61,19,48,21,"push"],[61,23,48,25],[61,24,48,26],[61,32,48,34,"currentCoords"],[61,45,48,47],[61,46,48,48,"i"],[61,47,48,49],[61,48,48,50],[61,53,48,55,"aShape"],[61,59,48,61],[61,60,48,62,"i"],[61,61,48,63],[61,62,48,64],[61,65,48,67],[61,66,48,68],[62,4,49,4],[63,4,50,4],[63,11,50,11,"sourceCoords"],[63,23,50,23],[63,24,50,24,"join"],[63,28,50,28],[63,29,50,29],[63,30,50,30],[64,2,51,0],[65,0,51,1],[65,3]],"functionMap":{"names":["<global>","TileProgram","TileProgram#constructor","getSourceCoords"],"mappings":"AAA;OCiB;ICC;KDgB;CDC;AGC;CHc"},"hasCjsExports":false},"type":"js/module"}]}