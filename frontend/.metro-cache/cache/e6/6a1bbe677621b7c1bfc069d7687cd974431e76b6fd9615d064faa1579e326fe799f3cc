{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":65,"index":768}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":769},"end":{"line":18,"column":47,"index":816}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.resizeBilinearGrad = resizeBilinearGrad;\n  Object.defineProperty(exports, \"resizeBilinearGradConfig\", {\n    enumerable: true,\n    get: function () {\n      return resizeBilinearGradConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function resizeBilinearGrad(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      images,\n      dy\n    } = inputs;\n    const {\n      alignCorners\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)([dy, images], 'resizeBilinearGrad');\n    const imagesStrides = _tensorflowTfjsCore.util.computeStrides(images.shape);\n    const [batch, xHeight, xWidth, depth] = images.shape;\n    const [, yHeight, yWidth] = dy.shape;\n    const output = new Float32Array(batch * xHeight * xWidth * depth);\n    // In the backwards pass, we want to find the pixels that were generated\n    // for each pixel in the input image the forward pass and add the\n    // corresponding coefficient from dy to the gradient (with some\n    // interpolation).\n    const effectiveXSize = [alignCorners && yHeight > 1 ? xHeight - 1 : xHeight, alignCorners && yWidth > 1 ? xWidth - 1 : xWidth];\n    const effectiveYSize = [alignCorners && yHeight > 1 ? yHeight - 1 : yHeight, alignCorners && yWidth > 1 ? yWidth - 1 : yWidth];\n    const heightScale = effectiveXSize[0] / effectiveYSize[0];\n    const widthScale = effectiveXSize[1] / effectiveYSize[1];\n    // Reference implementation\n    // tslint:disable-next-line:max-line-length\n    // https://github.com/tensorflow/tensorflow/blob/3039375c86a5bbc9610c7725dcaa95d635f87ba2/tensorflow/core/kernels/resize_bilinear_op.cc#L275\n    const dyValues = backend.data.get(dy.dataId).values;\n    let offset = 0;\n    for (let b = 0; b < batch; b++) {\n      const bOffset = b * imagesStrides[0];\n      for (let r = 0; r < yHeight; r++) {\n        const dxR = r * heightScale;\n        const topDxRIndex = Math.floor(dxR);\n        const bottomDxRIndex = Math.min(Math.ceil(dxR), xHeight - 1);\n        const topDxROffset = bOffset + topDxRIndex * imagesStrides[1];\n        const bottomDxROffset = bOffset + bottomDxRIndex * imagesStrides[1];\n        const dxRLerp = dxR - topDxRIndex;\n        const inverseDxRLerp = 1.0 - dxRLerp;\n        for (let c = 0; c < yWidth; c++) {\n          const dxC = c * widthScale;\n          const leftDxCIndex = Math.floor(dxC);\n          const rightDxCIndex = Math.min(Math.ceil(dxC), xWidth - 1);\n          const dxCLerp = dxC - leftDxCIndex;\n          const inverseDxCLerp = 1.0 - dxCLerp;\n          const topLeftRCOffset = topDxROffset + leftDxCIndex * imagesStrides[2];\n          const topRightRCOffset = topDxROffset + rightDxCIndex * imagesStrides[2];\n          const bottomLeftRCOffset = bottomDxROffset + leftDxCIndex * imagesStrides[2];\n          const bottomRightRCOffset = bottomDxROffset + rightDxCIndex * imagesStrides[2];\n          const inverseDxRLerpTimesInverseDxCLerp = inverseDxRLerp * inverseDxCLerp;\n          const inverseDxRLerpTimesDxCLerp = inverseDxRLerp * dxCLerp;\n          const dxRLerpTimesInverseDxCLerp = dxRLerp * inverseDxCLerp;\n          const dxRLerpTimesDxCLerp = dxRLerp * dxCLerp;\n          for (let d = 0; d < depth; d++) {\n            const dyVal = dyValues[offset++];\n            output[topLeftRCOffset + d] += dyVal * inverseDxRLerpTimesInverseDxCLerp;\n            output[topRightRCOffset + d] += dyVal * inverseDxRLerpTimesDxCLerp;\n            output[bottomLeftRCOffset + d] += dyVal * dxRLerpTimesInverseDxCLerp;\n            output[bottomRightRCOffset + d] += dyVal * dxRLerpTimesDxCLerp;\n          }\n        }\n      }\n    }\n    return backend.makeTensorInfo([batch, xWidth, xHeight, depth], 'float32', output);\n  }\n  const resizeBilinearGradConfig = {\n    kernelName: _tensorflowTfjsCore.ResizeBilinearGrad,\n    backendName: 'cpu',\n    kernelFunc: resizeBilinearGrad\n  };\n});","lineCount":105,"map":[[7,2,19,0,"exports"],[7,9,19,0],[7,10,19,0,"resizeBilinearGrad"],[7,28,19,0],[7,31,19,0,"resizeBilinearGrad"],[7,49,19,0],[8,2,84,0,"Object"],[8,8,84,0],[8,9,84,0,"defineProperty"],[8,23,84,0],[8,24,84,0,"exports"],[8,31,84,0],[9,4,84,0,"enumerable"],[9,14,84,0],[10,4,84,0,"get"],[10,7,84,0],[10,18,84,0,"get"],[10,19,84,0],[11,6,84,0],[11,13,84,0,"resizeBilinearGradConfig"],[11,37,84,0],[12,4,84,0],[13,2,84,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[25,0,10,0],[26,0,11,0],[27,0,12,0],[28,0,13,0],[29,0,14,0],[30,0,15,0],[31,0,16,0],[33,2,19,7],[33,11,19,16,"resizeBilinearGrad"],[33,29,19,34,"resizeBilinearGrad"],[33,30,19,35,"args"],[33,34,19,39],[33,36,19,41],[34,4,20,4],[34,10,20,10],[35,6,20,12,"inputs"],[35,12,20,18],[36,6,20,20,"backend"],[36,13,20,27],[37,6,20,29,"attrs"],[38,4,20,35],[38,5,20,36],[38,8,20,39,"args"],[38,12,20,43],[39,4,21,4],[39,10,21,10],[40,6,21,12,"images"],[40,12,21,18],[41,6,21,20,"dy"],[42,4,21,23],[42,5,21,24],[42,8,21,27,"inputs"],[42,14,21,33],[43,4,22,4],[43,10,22,10],[44,6,22,12,"alignCorners"],[45,4,22,25],[45,5,22,26],[45,8,22,29,"attrs"],[45,13,22,34],[46,4,23,4],[46,8,23,4,"assertNotComplex"],[46,17,23,20],[46,18,23,20,"assertNotComplex"],[46,34,23,20],[46,36,23,21],[46,37,23,22,"dy"],[46,39,23,24],[46,41,23,26,"images"],[46,47,23,32],[46,48,23,33],[46,50,23,35],[46,70,23,55],[46,71,23,56],[47,4,24,4],[47,10,24,10,"imagesStrides"],[47,23,24,23],[47,26,24,26,"util"],[47,45,24,30],[47,46,24,30,"util"],[47,50,24,30],[47,51,24,31,"computeStrides"],[47,65,24,45],[47,66,24,46,"images"],[47,72,24,52],[47,73,24,53,"shape"],[47,78,24,58],[47,79,24,59],[48,4,25,4],[48,10,25,10],[48,11,25,11,"batch"],[48,16,25,16],[48,18,25,18,"xHeight"],[48,25,25,25],[48,27,25,27,"xWidth"],[48,33,25,33],[48,35,25,35,"depth"],[48,40,25,40],[48,41,25,41],[48,44,25,44,"images"],[48,50,25,50],[48,51,25,51,"shape"],[48,56,25,56],[49,4,26,4],[49,10,26,10],[49,13,26,13,"yHeight"],[49,20,26,20],[49,22,26,22,"yWidth"],[49,28,26,28],[49,29,26,29],[49,32,26,32,"dy"],[49,34,26,34],[49,35,26,35,"shape"],[49,40,26,40],[50,4,27,4],[50,10,27,10,"output"],[50,16,27,16],[50,19,27,19],[50,23,27,23,"Float32Array"],[50,35,27,35],[50,36,27,36,"batch"],[50,41,27,41],[50,44,27,44,"xHeight"],[50,51,27,51],[50,54,27,54,"xWidth"],[50,60,27,60],[50,63,27,63,"depth"],[50,68,27,68],[50,69,27,69],[51,4,28,4],[52,4,29,4],[53,4,30,4],[54,4,31,4],[55,4,32,4],[55,10,32,10,"effectiveXSize"],[55,24,32,24],[55,27,32,27],[55,28,33,9,"alignCorners"],[55,40,33,21],[55,44,33,25,"yHeight"],[55,51,33,32],[55,54,33,35],[55,55,33,36],[55,58,33,40,"xHeight"],[55,65,33,47],[55,68,33,50],[55,69,33,51],[55,72,33,54,"xHeight"],[55,79,33,61],[55,81,34,9,"alignCorners"],[55,93,34,21],[55,97,34,25,"yWidth"],[55,103,34,31],[55,106,34,34],[55,107,34,35],[55,110,34,39,"xWidth"],[55,116,34,45],[55,119,34,48],[55,120,34,49],[55,123,34,52,"xWidth"],[55,129,34,58],[55,130,35,5],[56,4,36,4],[56,10,36,10,"effectiveYSize"],[56,24,36,24],[56,27,36,27],[56,28,37,9,"alignCorners"],[56,40,37,21],[56,44,37,25,"yHeight"],[56,51,37,32],[56,54,37,35],[56,55,37,36],[56,58,37,40,"yHeight"],[56,65,37,47],[56,68,37,50],[56,69,37,51],[56,72,37,54,"yHeight"],[56,79,37,61],[56,81,38,9,"alignCorners"],[56,93,38,21],[56,97,38,25,"yWidth"],[56,103,38,31],[56,106,38,34],[56,107,38,35],[56,110,38,39,"yWidth"],[56,116,38,45],[56,119,38,48],[56,120,38,49],[56,123,38,52,"yWidth"],[56,129,38,58],[56,130,39,5],[57,4,40,4],[57,10,40,10,"heightScale"],[57,21,40,21],[57,24,40,24,"effectiveXSize"],[57,38,40,38],[57,39,40,39],[57,40,40,40],[57,41,40,41],[57,44,40,44,"effectiveYSize"],[57,58,40,58],[57,59,40,59],[57,60,40,60],[57,61,40,61],[58,4,41,4],[58,10,41,10,"widthScale"],[58,20,41,20],[58,23,41,23,"effectiveXSize"],[58,37,41,37],[58,38,41,38],[58,39,41,39],[58,40,41,40],[58,43,41,43,"effectiveYSize"],[58,57,41,57],[58,58,41,58],[58,59,41,59],[58,60,41,60],[59,4,42,4],[60,4,43,4],[61,4,44,4],[62,4,45,4],[62,10,45,10,"dyValues"],[62,18,45,18],[62,21,45,21,"backend"],[62,28,45,28],[62,29,45,29,"data"],[62,33,45,33],[62,34,45,34,"get"],[62,37,45,37],[62,38,45,38,"dy"],[62,40,45,40],[62,41,45,41,"dataId"],[62,47,45,47],[62,48,45,48],[62,49,45,49,"values"],[62,55,45,55],[63,4,46,4],[63,8,46,8,"offset"],[63,14,46,14],[63,17,46,17],[63,18,46,18],[64,4,47,4],[64,9,47,9],[64,13,47,13,"b"],[64,14,47,14],[64,17,47,17],[64,18,47,18],[64,20,47,20,"b"],[64,21,47,21],[64,24,47,24,"batch"],[64,29,47,29],[64,31,47,31,"b"],[64,32,47,32],[64,34,47,34],[64,36,47,36],[65,6,48,8],[65,12,48,14,"bOffset"],[65,19,48,21],[65,22,48,24,"b"],[65,23,48,25],[65,26,48,28,"imagesStrides"],[65,39,48,41],[65,40,48,42],[65,41,48,43],[65,42,48,44],[66,6,49,8],[66,11,49,13],[66,15,49,17,"r"],[66,16,49,18],[66,19,49,21],[66,20,49,22],[66,22,49,24,"r"],[66,23,49,25],[66,26,49,28,"yHeight"],[66,33,49,35],[66,35,49,37,"r"],[66,36,49,38],[66,38,49,40],[66,40,49,42],[67,8,50,12],[67,14,50,18,"dxR"],[67,17,50,21],[67,20,50,24,"r"],[67,21,50,25],[67,24,50,28,"heightScale"],[67,35,50,39],[68,8,51,12],[68,14,51,18,"topDxRIndex"],[68,25,51,29],[68,28,51,32,"Math"],[68,32,51,36],[68,33,51,37,"floor"],[68,38,51,42],[68,39,51,43,"dxR"],[68,42,51,46],[68,43,51,47],[69,8,52,12],[69,14,52,18,"bottomDxRIndex"],[69,28,52,32],[69,31,52,35,"Math"],[69,35,52,39],[69,36,52,40,"min"],[69,39,52,43],[69,40,52,44,"Math"],[69,44,52,48],[69,45,52,49,"ceil"],[69,49,52,53],[69,50,52,54,"dxR"],[69,53,52,57],[69,54,52,58],[69,56,52,60,"xHeight"],[69,63,52,67],[69,66,52,70],[69,67,52,71],[69,68,52,72],[70,8,53,12],[70,14,53,18,"topDxROffset"],[70,26,53,30],[70,29,53,33,"bOffset"],[70,36,53,40],[70,39,53,43,"topDxRIndex"],[70,50,53,54],[70,53,53,57,"imagesStrides"],[70,66,53,70],[70,67,53,71],[70,68,53,72],[70,69,53,73],[71,8,54,12],[71,14,54,18,"bottomDxROffset"],[71,29,54,33],[71,32,54,36,"bOffset"],[71,39,54,43],[71,42,54,46,"bottomDxRIndex"],[71,56,54,60],[71,59,54,63,"imagesStrides"],[71,72,54,76],[71,73,54,77],[71,74,54,78],[71,75,54,79],[72,8,55,12],[72,14,55,18,"dxRLerp"],[72,21,55,25],[72,24,55,28,"dxR"],[72,27,55,31],[72,30,55,34,"topDxRIndex"],[72,41,55,45],[73,8,56,12],[73,14,56,18,"inverseDxRLerp"],[73,28,56,32],[73,31,56,35],[73,34,56,38],[73,37,56,41,"dxRLerp"],[73,44,56,48],[74,8,57,12],[74,13,57,17],[74,17,57,21,"c"],[74,18,57,22],[74,21,57,25],[74,22,57,26],[74,24,57,28,"c"],[74,25,57,29],[74,28,57,32,"yWidth"],[74,34,57,38],[74,36,57,40,"c"],[74,37,57,41],[74,39,57,43],[74,41,57,45],[75,10,58,16],[75,16,58,22,"dxC"],[75,19,58,25],[75,22,58,28,"c"],[75,23,58,29],[75,26,58,32,"widthScale"],[75,36,58,42],[76,10,59,16],[76,16,59,22,"leftDxCIndex"],[76,28,59,34],[76,31,59,37,"Math"],[76,35,59,41],[76,36,59,42,"floor"],[76,41,59,47],[76,42,59,48,"dxC"],[76,45,59,51],[76,46,59,52],[77,10,60,16],[77,16,60,22,"rightDxCIndex"],[77,29,60,35],[77,32,60,38,"Math"],[77,36,60,42],[77,37,60,43,"min"],[77,40,60,46],[77,41,60,47,"Math"],[77,45,60,51],[77,46,60,52,"ceil"],[77,50,60,56],[77,51,60,57,"dxC"],[77,54,60,60],[77,55,60,61],[77,57,60,63,"xWidth"],[77,63,60,69],[77,66,60,72],[77,67,60,73],[77,68,60,74],[78,10,61,16],[78,16,61,22,"dxCLerp"],[78,23,61,29],[78,26,61,32,"dxC"],[78,29,61,35],[78,32,61,38,"leftDxCIndex"],[78,44,61,50],[79,10,62,16],[79,16,62,22,"inverseDxCLerp"],[79,30,62,36],[79,33,62,39],[79,36,62,42],[79,39,62,45,"dxCLerp"],[79,46,62,52],[80,10,63,16],[80,16,63,22,"topLeftRCOffset"],[80,31,63,37],[80,34,63,40,"topDxROffset"],[80,46,63,52],[80,49,63,55,"leftDxCIndex"],[80,61,63,67],[80,64,63,70,"imagesStrides"],[80,77,63,83],[80,78,63,84],[80,79,63,85],[80,80,63,86],[81,10,64,16],[81,16,64,22,"topRightRCOffset"],[81,32,64,38],[81,35,64,41,"topDxROffset"],[81,47,64,53],[81,50,64,56,"rightDxCIndex"],[81,63,64,69],[81,66,64,72,"imagesStrides"],[81,79,64,85],[81,80,64,86],[81,81,64,87],[81,82,64,88],[82,10,65,16],[82,16,65,22,"bottomLeftRCOffset"],[82,34,65,40],[82,37,65,43,"bottomDxROffset"],[82,52,65,58],[82,55,65,61,"leftDxCIndex"],[82,67,65,73],[82,70,65,76,"imagesStrides"],[82,83,65,89],[82,84,65,90],[82,85,65,91],[82,86,65,92],[83,10,66,16],[83,16,66,22,"bottomRightRCOffset"],[83,35,66,41],[83,38,66,44,"bottomDxROffset"],[83,53,66,59],[83,56,66,62,"rightDxCIndex"],[83,69,66,75],[83,72,66,78,"imagesStrides"],[83,85,66,91],[83,86,66,92],[83,87,66,93],[83,88,66,94],[84,10,67,16],[84,16,67,22,"inverseDxRLerpTimesInverseDxCLerp"],[84,49,67,55],[84,52,67,58,"inverseDxRLerp"],[84,66,67,72],[84,69,67,75,"inverseDxCLerp"],[84,83,67,89],[85,10,68,16],[85,16,68,22,"inverseDxRLerpTimesDxCLerp"],[85,42,68,48],[85,45,68,51,"inverseDxRLerp"],[85,59,68,65],[85,62,68,68,"dxCLerp"],[85,69,68,75],[86,10,69,16],[86,16,69,22,"dxRLerpTimesInverseDxCLerp"],[86,42,69,48],[86,45,69,51,"dxRLerp"],[86,52,69,58],[86,55,69,61,"inverseDxCLerp"],[86,69,69,75],[87,10,70,16],[87,16,70,22,"dxRLerpTimesDxCLerp"],[87,35,70,41],[87,38,70,44,"dxRLerp"],[87,45,70,51],[87,48,70,54,"dxCLerp"],[87,55,70,61],[88,10,71,16],[88,15,71,21],[88,19,71,25,"d"],[88,20,71,26],[88,23,71,29],[88,24,71,30],[88,26,71,32,"d"],[88,27,71,33],[88,30,71,36,"depth"],[88,35,71,41],[88,37,71,43,"d"],[88,38,71,44],[88,40,71,46],[88,42,71,48],[89,12,72,20],[89,18,72,26,"dyVal"],[89,23,72,31],[89,26,72,34,"dyValues"],[89,34,72,42],[89,35,72,43,"offset"],[89,41,72,49],[89,43,72,51],[89,44,72,52],[90,12,73,20,"output"],[90,18,73,26],[90,19,73,27,"topLeftRCOffset"],[90,34,73,42],[90,37,73,45,"d"],[90,38,73,46],[90,39,73,47],[90,43,74,24,"dyVal"],[90,48,74,29],[90,51,74,32,"inverseDxRLerpTimesInverseDxCLerp"],[90,84,74,65],[91,12,75,20,"output"],[91,18,75,26],[91,19,75,27,"topRightRCOffset"],[91,35,75,43],[91,38,75,46,"d"],[91,39,75,47],[91,40,75,48],[91,44,75,52,"dyVal"],[91,49,75,57],[91,52,75,60,"inverseDxRLerpTimesDxCLerp"],[91,78,75,86],[92,12,76,20,"output"],[92,18,76,26],[92,19,76,27,"bottomLeftRCOffset"],[92,37,76,45],[92,40,76,48,"d"],[92,41,76,49],[92,42,76,50],[92,46,76,54,"dyVal"],[92,51,76,59],[92,54,76,62,"dxRLerpTimesInverseDxCLerp"],[92,80,76,88],[93,12,77,20,"output"],[93,18,77,26],[93,19,77,27,"bottomRightRCOffset"],[93,38,77,46],[93,41,77,49,"d"],[93,42,77,50],[93,43,77,51],[93,47,77,55,"dyVal"],[93,52,77,60],[93,55,77,63,"dxRLerpTimesDxCLerp"],[93,74,77,82],[94,10,78,16],[95,8,79,12],[96,6,80,8],[97,4,81,4],[98,4,82,4],[98,11,82,11,"backend"],[98,18,82,18],[98,19,82,19,"makeTensorInfo"],[98,33,82,33],[98,34,82,34],[98,35,82,35,"batch"],[98,40,82,40],[98,42,82,42,"xWidth"],[98,48,82,48],[98,50,82,50,"xHeight"],[98,57,82,57],[98,59,82,59,"depth"],[98,64,82,64],[98,65,82,65],[98,67,82,67],[98,76,82,76],[98,78,82,78,"output"],[98,84,82,84],[98,85,82,85],[99,2,83,0],[100,2,84,7],[100,8,84,13,"resizeBilinearGradConfig"],[100,32,84,37],[100,35,84,40],[101,4,85,4,"kernelName"],[101,14,85,14],[101,16,85,16,"ResizeBilinearGrad"],[101,35,85,34],[101,36,85,34,"ResizeBilinearGrad"],[101,54,85,34],[102,4,86,4,"backendName"],[102,15,86,15],[102,17,86,17],[102,22,86,22],[103,4,87,4,"kernelFunc"],[103,14,87,14],[103,16,87,16,"resizeBilinearGrad"],[104,2,88,0],[104,3,88,1],[105,0,88,2],[105,3]],"functionMap":{"names":["<global>","resizeBilinearGrad"],"mappings":"AAA;OCkB;CDgE"},"hasCjsExports":false},"type":"js/module"}]}