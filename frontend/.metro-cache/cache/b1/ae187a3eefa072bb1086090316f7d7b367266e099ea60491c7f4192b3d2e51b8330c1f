{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":59,"index":762}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.sparseReshapeImpl = sparseReshapeImpl;\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  /**\n   * @license\n   * Copyright 2021 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function sparseReshapeImpl(inputIndices, inputIndicesShape, inputDType, inputShape, targetShape) {\n    const denseSize = _tensorflowTfjsCore.util.sizeFromShape(inputShape);\n    const nnz = inputIndicesShape[0];\n    const outputRank = targetShape.length;\n    // Compute the output shape. Determine product of specified dimensions, and\n    // find the index of the unspecified one.\n    const outputShape = [];\n    let product = 1;\n    let unknownIndex = -1;\n    for (let d = 0; d < outputRank; ++d) {\n      const size = targetShape[d];\n      if (size === -1) {\n        if (unknownIndex !== -1) {\n          throw new Error(_tensorflowTfjsCore.backend_util.getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(unknownIndex, d));\n        }\n        unknownIndex = d;\n        outputShape.push(1);\n      } else {\n        if (size < 0) {\n          throw new Error(_tensorflowTfjsCore.backend_util.getSparseReshapeNegativeOutputDimErrorMessage(d, size));\n        }\n        product *= size;\n        outputShape.push(size);\n      }\n    }\n    if (unknownIndex !== -1) {\n      if (product <= 0) {\n        throw new Error(_tensorflowTfjsCore.backend_util.getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());\n      }\n      const missing = Math.trunc(denseSize / product);\n      if (product * missing !== denseSize) {\n        throw new Error(_tensorflowTfjsCore.backend_util.getSparseReshapeInputOutputMultipleErrorMessage(inputShape, outputShape));\n      }\n      outputShape[unknownIndex] = missing;\n    }\n    const outputSize = _tensorflowTfjsCore.util.sizeFromShape(outputShape);\n    if (outputSize !== denseSize) {\n      throw new Error(_tensorflowTfjsCore.backend_util.getSparseReshapeInputOutputMismatchErrorMessage(inputShape, outputShape));\n    }\n    const inputRank = inputShape.length;\n    const inputStrides = [];\n    if (inputRank > 0) {\n      inputStrides[inputRank - 1] = 1;\n      for (let d = inputRank - 2; d >= 0; --d) {\n        inputStrides[d] = inputStrides[d + 1] * inputShape[d + 1];\n      }\n    }\n    const outputStrides = [];\n    if (outputRank > 0) {\n      outputStrides[outputRank - 1] = 1;\n      for (let d = outputRank - 2; d >= 0; --d) {\n        outputStrides[d] = outputStrides[d + 1] * outputShape[d + 1];\n      }\n    }\n    const newIndices = _tensorflowTfjsCore.util.getArrayFromDType(inputDType, nnz * outputRank);\n    for (let i = 0; i < nnz; ++i) {\n      let id = 0;\n      for (let j = 0; j < inputRank; ++j) {\n        // inputIndices is a 2d tensor with shape of [nnz, inputRank]\n        id += inputIndices[i * inputRank + j] * inputStrides[j];\n      }\n      for (let j = 0; j < outputRank; ++j) {\n        // newIndices is a 2d tensor with shape of [nnz, outputRank]\n        newIndices[i * outputRank + j] = Math.trunc(id / outputStrides[j]);\n        id %= outputStrides[j];\n      }\n    }\n    return [newIndices, [nnz, outputRank], outputShape];\n  }\n});","lineCount":95,"map":[[7,2,18,0,"exports"],[7,9,18,0],[7,10,18,0,"sparseReshapeImpl"],[7,27,18,0],[7,30,18,0,"sparseReshapeImpl"],[7,47,18,0],[8,2,17,0],[8,6,17,0,"_tensorflowTfjsCore"],[8,25,17,0],[8,28,17,0,"require"],[8,35,17,0],[8,36,17,0,"_dependencyMap"],[8,50,17,0],[9,2,1,0],[10,0,2,0],[11,0,3,0],[12,0,4,0],[13,0,5,0],[14,0,6,0],[15,0,7,0],[16,0,8,0],[17,0,9,0],[18,0,10,0],[19,0,11,0],[20,0,12,0],[21,0,13,0],[22,0,14,0],[23,0,15,0],[24,0,16,0],[26,2,18,7],[26,11,18,16,"sparseReshapeImpl"],[26,28,18,33,"sparseReshapeImpl"],[26,29,18,34,"inputIndices"],[26,41,18,46],[26,43,18,48,"inputIndicesShape"],[26,60,18,65],[26,62,18,67,"inputDType"],[26,72,18,77],[26,74,18,79,"inputShape"],[26,84,18,89],[26,86,18,91,"targetShape"],[26,97,18,102],[26,99,18,104],[27,4,19,4],[27,10,19,10,"denseSize"],[27,19,19,19],[27,22,19,22,"util"],[27,41,19,26],[27,42,19,26,"util"],[27,46,19,26],[27,47,19,27,"sizeFromShape"],[27,60,19,40],[27,61,19,41,"inputShape"],[27,71,19,51],[27,72,19,52],[28,4,20,4],[28,10,20,10,"nnz"],[28,13,20,13],[28,16,20,16,"inputIndicesShape"],[28,33,20,33],[28,34,20,34],[28,35,20,35],[28,36,20,36],[29,4,21,4],[29,10,21,10,"outputRank"],[29,20,21,20],[29,23,21,23,"targetShape"],[29,34,21,34],[29,35,21,35,"length"],[29,41,21,41],[30,4,22,4],[31,4,23,4],[32,4,24,4],[32,10,24,10,"outputShape"],[32,21,24,21],[32,24,24,24],[32,26,24,26],[33,4,25,4],[33,8,25,8,"product"],[33,15,25,15],[33,18,25,18],[33,19,25,19],[34,4,26,4],[34,8,26,8,"unknownIndex"],[34,20,26,20],[34,23,26,23],[34,24,26,24],[34,25,26,25],[35,4,27,4],[35,9,27,9],[35,13,27,13,"d"],[35,14,27,14],[35,17,27,17],[35,18,27,18],[35,20,27,20,"d"],[35,21,27,21],[35,24,27,24,"outputRank"],[35,34,27,34],[35,36,27,36],[35,38,27,38,"d"],[35,39,27,39],[35,41,27,41],[36,6,28,8],[36,12,28,14,"size"],[36,16,28,18],[36,19,28,21,"targetShape"],[36,30,28,32],[36,31,28,33,"d"],[36,32,28,34],[36,33,28,35],[37,6,29,8],[37,10,29,12,"size"],[37,14,29,16],[37,19,29,21],[37,20,29,22],[37,21,29,23],[37,23,29,25],[38,8,30,12],[38,12,30,16,"unknownIndex"],[38,24,30,28],[38,29,30,33],[38,30,30,34],[38,31,30,35],[38,33,30,37],[39,10,31,16],[39,16,31,22],[39,20,31,26,"Error"],[39,25,31,31],[39,26,31,32,"backend_util"],[39,45,31,44],[39,46,31,44,"backend_util"],[39,58,31,44],[39,59,32,21,"getSparseReshapeMultipleNegativeOneOutputDimErrorMessage"],[39,115,32,77],[39,116,32,78,"unknownIndex"],[39,128,32,90],[39,130,32,92,"d"],[39,131,32,93],[39,132,32,94],[39,133,32,95],[40,8,33,12],[41,8,34,12,"unknownIndex"],[41,20,34,24],[41,23,34,27,"d"],[41,24,34,28],[42,8,35,12,"outputShape"],[42,19,35,23],[42,20,35,24,"push"],[42,24,35,28],[42,25,35,29],[42,26,35,30],[42,27,35,31],[43,6,36,8],[43,7,36,9],[43,13,37,13],[44,8,38,12],[44,12,38,16,"size"],[44,16,38,20],[44,19,38,23],[44,20,38,24],[44,22,38,26],[45,10,39,16],[45,16,39,22],[45,20,39,26,"Error"],[45,25,39,31],[45,26,39,32,"backend_util"],[45,45,39,44],[45,46,39,44,"backend_util"],[45,58,39,44],[45,59,39,45,"getSparseReshapeNegativeOutputDimErrorMessage"],[45,104,39,90],[45,105,39,91,"d"],[45,106,39,92],[45,108,39,94,"size"],[45,112,39,98],[45,113,39,99],[45,114,39,100],[46,8,40,12],[47,8,41,12,"product"],[47,15,41,19],[47,19,41,23,"size"],[47,23,41,27],[48,8,42,12,"outputShape"],[48,19,42,23],[48,20,42,24,"push"],[48,24,42,28],[48,25,42,29,"size"],[48,29,42,33],[48,30,42,34],[49,6,43,8],[50,4,44,4],[51,4,45,4],[51,8,45,8,"unknownIndex"],[51,20,45,20],[51,25,45,25],[51,26,45,26],[51,27,45,27],[51,29,45,29],[52,6,46,8],[52,10,46,12,"product"],[52,17,46,19],[52,21,46,23],[52,22,46,24],[52,24,46,26],[53,8,47,12],[53,14,47,18],[53,18,47,22,"Error"],[53,23,47,27],[53,24,47,28,"backend_util"],[53,43,47,40],[53,44,47,40,"backend_util"],[53,56,47,40],[53,57,47,41,"getSparseReshapeEmptyTensorZeroOutputDimErrorMessage"],[53,109,47,93],[53,110,47,94],[53,111,47,95],[53,112,47,96],[54,6,48,8],[55,6,49,8],[55,12,49,14,"missing"],[55,19,49,21],[55,22,49,24,"Math"],[55,26,49,28],[55,27,49,29,"trunc"],[55,32,49,34],[55,33,49,35,"denseSize"],[55,42,49,44],[55,45,49,47,"product"],[55,52,49,54],[55,53,49,55],[56,6,50,8],[56,10,50,12,"product"],[56,17,50,19],[56,20,50,22,"missing"],[56,27,50,29],[56,32,50,34,"denseSize"],[56,41,50,43],[56,43,50,45],[57,8,51,12],[57,14,51,18],[57,18,51,22,"Error"],[57,23,51,27],[57,24,51,28,"backend_util"],[57,43,51,40],[57,44,51,40,"backend_util"],[57,56,51,40],[57,57,51,41,"getSparseReshapeInputOutputMultipleErrorMessage"],[57,104,51,88],[57,105,51,89,"inputShape"],[57,115,51,99],[57,117,51,101,"outputShape"],[57,128,51,112],[57,129,51,113],[57,130,51,114],[58,6,52,8],[59,6,53,8,"outputShape"],[59,17,53,19],[59,18,53,20,"unknownIndex"],[59,30,53,32],[59,31,53,33],[59,34,53,36,"missing"],[59,41,53,43],[60,4,54,4],[61,4,55,4],[61,10,55,10,"outputSize"],[61,20,55,20],[61,23,55,23,"util"],[61,42,55,27],[61,43,55,27,"util"],[61,47,55,27],[61,48,55,28,"sizeFromShape"],[61,61,55,41],[61,62,55,42,"outputShape"],[61,73,55,53],[61,74,55,54],[62,4,56,4],[62,8,56,8,"outputSize"],[62,18,56,18],[62,23,56,23,"denseSize"],[62,32,56,32],[62,34,56,34],[63,6,57,8],[63,12,57,14],[63,16,57,18,"Error"],[63,21,57,23],[63,22,57,24,"backend_util"],[63,41,57,36],[63,42,57,36,"backend_util"],[63,54,57,36],[63,55,57,37,"getSparseReshapeInputOutputMismatchErrorMessage"],[63,102,57,84],[63,103,57,85,"inputShape"],[63,113,57,95],[63,115,57,97,"outputShape"],[63,126,57,108],[63,127,57,109],[63,128,57,110],[64,4,58,4],[65,4,59,4],[65,10,59,10,"inputRank"],[65,19,59,19],[65,22,59,22,"inputShape"],[65,32,59,32],[65,33,59,33,"length"],[65,39,59,39],[66,4,60,4],[66,10,60,10,"inputStrides"],[66,22,60,22],[66,25,60,25],[66,27,60,27],[67,4,61,4],[67,8,61,8,"inputRank"],[67,17,61,17],[67,20,61,20],[67,21,61,21],[67,23,61,23],[68,6,62,8,"inputStrides"],[68,18,62,20],[68,19,62,21,"inputRank"],[68,28,62,30],[68,31,62,33],[68,32,62,34],[68,33,62,35],[68,36,62,38],[68,37,62,39],[69,6,63,8],[69,11,63,13],[69,15,63,17,"d"],[69,16,63,18],[69,19,63,21,"inputRank"],[69,28,63,30],[69,31,63,33],[69,32,63,34],[69,34,63,36,"d"],[69,35,63,37],[69,39,63,41],[69,40,63,42],[69,42,63,44],[69,44,63,46,"d"],[69,45,63,47],[69,47,63,49],[70,8,64,12,"inputStrides"],[70,20,64,24],[70,21,64,25,"d"],[70,22,64,26],[70,23,64,27],[70,26,64,30,"inputStrides"],[70,38,64,42],[70,39,64,43,"d"],[70,40,64,44],[70,43,64,47],[70,44,64,48],[70,45,64,49],[70,48,64,52,"inputShape"],[70,58,64,62],[70,59,64,63,"d"],[70,60,64,64],[70,63,64,67],[70,64,64,68],[70,65,64,69],[71,6,65,8],[72,4,66,4],[73,4,67,4],[73,10,67,10,"outputStrides"],[73,23,67,23],[73,26,67,26],[73,28,67,28],[74,4,68,4],[74,8,68,8,"outputRank"],[74,18,68,18],[74,21,68,21],[74,22,68,22],[74,24,68,24],[75,6,69,8,"outputStrides"],[75,19,69,21],[75,20,69,22,"outputRank"],[75,30,69,32],[75,33,69,35],[75,34,69,36],[75,35,69,37],[75,38,69,40],[75,39,69,41],[76,6,70,8],[76,11,70,13],[76,15,70,17,"d"],[76,16,70,18],[76,19,70,21,"outputRank"],[76,29,70,31],[76,32,70,34],[76,33,70,35],[76,35,70,37,"d"],[76,36,70,38],[76,40,70,42],[76,41,70,43],[76,43,70,45],[76,45,70,47,"d"],[76,46,70,48],[76,48,70,50],[77,8,71,12,"outputStrides"],[77,21,71,25],[77,22,71,26,"d"],[77,23,71,27],[77,24,71,28],[77,27,71,31,"outputStrides"],[77,40,71,44],[77,41,71,45,"d"],[77,42,71,46],[77,45,71,49],[77,46,71,50],[77,47,71,51],[77,50,71,54,"outputShape"],[77,61,71,65],[77,62,71,66,"d"],[77,63,71,67],[77,66,71,70],[77,67,71,71],[77,68,71,72],[78,6,72,8],[79,4,73,4],[80,4,74,4],[80,10,74,10,"newIndices"],[80,20,74,20],[80,23,74,23,"util"],[80,42,74,27],[80,43,74,27,"util"],[80,47,74,27],[80,48,74,28,"getArrayFromDType"],[80,65,74,45],[80,66,74,46,"inputDType"],[80,76,74,56],[80,78,74,58,"nnz"],[80,81,74,61],[80,84,74,64,"outputRank"],[80,94,74,74],[80,95,74,75],[81,4,75,4],[81,9,75,9],[81,13,75,13,"i"],[81,14,75,14],[81,17,75,17],[81,18,75,18],[81,20,75,20,"i"],[81,21,75,21],[81,24,75,24,"nnz"],[81,27,75,27],[81,29,75,29],[81,31,75,31,"i"],[81,32,75,32],[81,34,75,34],[82,6,76,8],[82,10,76,12,"id"],[82,12,76,14],[82,15,76,17],[82,16,76,18],[83,6,77,8],[83,11,77,13],[83,15,77,17,"j"],[83,16,77,18],[83,19,77,21],[83,20,77,22],[83,22,77,24,"j"],[83,23,77,25],[83,26,77,28,"inputRank"],[83,35,77,37],[83,37,77,39],[83,39,77,41,"j"],[83,40,77,42],[83,42,77,44],[84,8,78,12],[85,8,79,12,"id"],[85,10,79,14],[85,14,79,18,"inputIndices"],[85,26,79,30],[85,27,79,31,"i"],[85,28,79,32],[85,31,79,35,"inputRank"],[85,40,79,44],[85,43,79,47,"j"],[85,44,79,48],[85,45,79,49],[85,48,79,52,"inputStrides"],[85,60,79,64],[85,61,79,65,"j"],[85,62,79,66],[85,63,79,67],[86,6,80,8],[87,6,81,8],[87,11,81,13],[87,15,81,17,"j"],[87,16,81,18],[87,19,81,21],[87,20,81,22],[87,22,81,24,"j"],[87,23,81,25],[87,26,81,28,"outputRank"],[87,36,81,38],[87,38,81,40],[87,40,81,42,"j"],[87,41,81,43],[87,43,81,45],[88,8,82,12],[89,8,83,12,"newIndices"],[89,18,83,22],[89,19,83,23,"i"],[89,20,83,24],[89,23,83,27,"outputRank"],[89,33,83,37],[89,36,83,40,"j"],[89,37,83,41],[89,38,83,42],[89,41,83,45,"Math"],[89,45,83,49],[89,46,83,50,"trunc"],[89,51,83,55],[89,52,83,56,"id"],[89,54,83,58],[89,57,83,61,"outputStrides"],[89,70,83,74],[89,71,83,75,"j"],[89,72,83,76],[89,73,83,77],[89,74,83,78],[90,8,84,12,"id"],[90,10,84,14],[90,14,84,18,"outputStrides"],[90,27,84,31],[90,28,84,32,"j"],[90,29,84,33],[90,30,84,34],[91,6,85,8],[92,4,86,4],[93,4,87,4],[93,11,87,11],[93,12,87,12,"newIndices"],[93,22,87,22],[93,24,87,24],[93,25,87,25,"nnz"],[93,28,87,28],[93,30,87,30,"outputRank"],[93,40,87,40],[93,41,87,41],[93,43,87,43,"outputShape"],[93,54,87,54],[93,55,87,55],[94,2,88,0],[95,0,88,1],[95,3]],"functionMap":{"names":["<global>","sparseReshapeImpl"],"mappings":"AAA;OCiB;CDsE"},"hasCjsExports":false},"type":"js/module"}]}