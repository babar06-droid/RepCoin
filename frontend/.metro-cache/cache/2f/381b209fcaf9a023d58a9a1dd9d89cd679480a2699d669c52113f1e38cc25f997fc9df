{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"DepthwiseConv2DDerFilterProgram\", {\n    enumerable: true,\n    get: function () {\n      return DepthwiseConv2DDerFilterProgram;\n    }\n  });\n  Object.defineProperty(exports, \"DepthwiseConv2DDerInputProgram\", {\n    enumerable: true,\n    get: function () {\n      return DepthwiseConv2DDerInputProgram;\n    }\n  });\n  /**\n   * @license\n   * Copyright 2018 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n  class DepthwiseConv2DDerFilterProgram {\n    constructor(convInfo) {\n      this.variableNames = ['x', 'dy'];\n      this.outputShape = convInfo.filterShape;\n      const strideHeight = convInfo.strideHeight;\n      const strideWidth = convInfo.strideWidth;\n      const padTop = convInfo.padInfo.top;\n      const padLeft = convInfo.padInfo.left;\n      const channelMul = convInfo.outChannels / convInfo.inChannels;\n      this.userCode = `\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${channelMul} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${convInfo.batchSize}; b++) {\n          for (int yR = 0; yR < ${convInfo.outHeight}; yR++) {\n            int xR = wR + yR * ${strideHeight} - ${padTop};\n\n            if (xR < 0 || xR >= ${convInfo.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${convInfo.outWidth}; yC++) {\n              int xC = wC + yC * ${strideWidth} - ${padLeft};\n\n              if (xC < 0 || xC >= ${convInfo.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `;\n    }\n  }\n  class DepthwiseConv2DDerInputProgram {\n    constructor(convInfo) {\n      this.variableNames = ['dy', 'W'];\n      this.outputShape = convInfo.inShape;\n      const filterHeight = convInfo.filterHeight;\n      const filterWidth = convInfo.filterWidth;\n      const strideHeight = convInfo.strideHeight;\n      const strideWidth = convInfo.strideWidth;\n      const padTop = filterHeight - 1 - convInfo.padInfo.top;\n      const padLeft = filterWidth - 1 - convInfo.padInfo.left;\n      const channelMul = convInfo.outChannels / convInfo.inChannels;\n      this.userCode = `\n      const ivec2 pads = ivec2(${padTop}, ${padLeft});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${filterHeight}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${strideHeight}.0;\n\n          if (dyR < 0.0 || dyR >= ${convInfo.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${filterHeight} - 1 - wR;\n\n          for (int wC = 0; wC < ${filterWidth}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${strideWidth}.0;\n\n            if (dyC < 0.0 || dyC >= ${convInfo.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${filterWidth} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${channelMul}; dm++) {\n              int d2 = d1 * ${channelMul} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `;\n    }\n  }\n});","lineCount":141,"map":[[7,2,17,0,"Object"],[7,8,17,0],[7,9,17,0,"defineProperty"],[7,23,17,0],[7,24,17,0,"exports"],[7,31,17,0],[8,4,17,0,"enumerable"],[8,14,17,0],[9,4,17,0,"get"],[9,7,17,0],[9,18,17,0,"get"],[9,19,17,0],[10,6,17,0],[10,13,17,0,"DepthwiseConv2DDerFilterProgram"],[10,44,17,0],[11,4,17,0],[12,2,17,0],[13,2,64,0,"Object"],[13,8,64,0],[13,9,64,0,"defineProperty"],[13,23,64,0],[13,24,64,0,"exports"],[13,31,64,0],[14,4,64,0,"enumerable"],[14,14,64,0],[15,4,64,0,"get"],[15,7,64,0],[15,18,64,0,"get"],[15,19,64,0],[16,6,64,0],[16,13,64,0,"DepthwiseConv2DDerInputProgram"],[16,43,64,0],[17,4,64,0],[18,2,64,0],[19,2,1,0],[20,0,2,0],[21,0,3,0],[22,0,4,0],[23,0,5,0],[24,0,6,0],[25,0,7,0],[26,0,8,0],[27,0,9,0],[28,0,10,0],[29,0,11,0],[30,0,12,0],[31,0,13,0],[32,0,14,0],[33,0,15,0],[34,0,16,0],[35,2,17,7],[35,8,17,13,"DepthwiseConv2DDerFilterProgram"],[35,39,17,44],[35,40,17,45],[36,4,18,4,"constructor"],[36,15,18,15,"constructor"],[36,16,18,16,"convInfo"],[36,24,18,24],[36,26,18,26],[37,6,19,8],[37,10,19,12],[37,11,19,13,"variableNames"],[37,24,19,26],[37,27,19,29],[37,28,19,30],[37,31,19,33],[37,33,19,35],[37,37,19,39],[37,38,19,40],[38,6,20,8],[38,10,20,12],[38,11,20,13,"outputShape"],[38,22,20,24],[38,25,20,27,"convInfo"],[38,33,20,35],[38,34,20,36,"filterShape"],[38,45,20,47],[39,6,21,8],[39,12,21,14,"strideHeight"],[39,24,21,26],[39,27,21,29,"convInfo"],[39,35,21,37],[39,36,21,38,"strideHeight"],[39,48,21,50],[40,6,22,8],[40,12,22,14,"strideWidth"],[40,23,22,25],[40,26,22,28,"convInfo"],[40,34,22,36],[40,35,22,37,"strideWidth"],[40,46,22,48],[41,6,23,8],[41,12,23,14,"padTop"],[41,18,23,20],[41,21,23,23,"convInfo"],[41,29,23,31],[41,30,23,32,"padInfo"],[41,37,23,39],[41,38,23,40,"top"],[41,41,23,43],[42,6,24,8],[42,12,24,14,"padLeft"],[42,19,24,21],[42,22,24,24,"convInfo"],[42,30,24,32],[42,31,24,33,"padInfo"],[42,38,24,40],[42,39,24,41,"left"],[42,43,24,45],[43,6,25,8],[43,12,25,14,"channelMul"],[43,22,25,24],[43,25,25,27,"convInfo"],[43,33,25,35],[43,34,25,36,"outChannels"],[43,45,25,47],[43,48,25,50,"convInfo"],[43,56,25,58],[43,57,25,59,"inChannels"],[43,67,25,69],[44,6,26,8],[44,10,26,12],[44,11,26,13,"userCode"],[44,19,26,21],[44,22,26,24],[45,0,27,0],[46,0,28,0],[47,0,29,0],[48,0,30,0],[49,0,31,0],[50,0,32,0],[51,0,33,0],[51,24,33,24,"channelMul"],[51,34,33,34],[52,0,34,0],[53,0,35,0],[54,0,36,0],[55,0,37,0],[56,0,38,0],[56,30,38,30,"convInfo"],[56,38,38,38],[56,39,38,39,"batchSize"],[56,48,38,48],[57,0,39,0],[57,34,39,34,"convInfo"],[57,42,39,42],[57,43,39,43,"outHeight"],[57,52,39,52],[58,0,40,0],[58,33,40,33,"strideHeight"],[58,45,40,45],[58,51,40,51,"padTop"],[58,57,40,57],[59,0,41,0],[60,0,42,0],[60,34,42,34,"convInfo"],[60,42,42,42],[60,43,42,43,"inHeight"],[60,51,42,51],[61,0,43,0],[62,0,44,0],[63,0,45,0],[64,0,46,0],[64,36,46,36,"convInfo"],[64,44,46,44],[64,45,46,45,"outWidth"],[64,53,46,53],[65,0,47,0],[65,35,47,35,"strideWidth"],[65,46,47,46],[65,52,47,52,"padLeft"],[65,59,47,59],[66,0,48,0],[67,0,49,0],[67,36,49,36,"convInfo"],[67,44,49,44],[67,45,49,45,"inWidth"],[67,52,49,52],[68,0,50,0],[69,0,51,0],[70,0,52,0],[71,0,53,0],[72,0,54,0],[73,0,55,0],[74,0,56,0],[75,0,57,0],[76,0,58,0],[77,0,59,0],[78,0,60,0],[79,0,61,0],[79,5,61,5],[80,4,62,4],[81,2,63,0],[82,2,64,7],[82,8,64,13,"DepthwiseConv2DDerInputProgram"],[82,38,64,43],[82,39,64,44],[83,4,65,4,"constructor"],[83,15,65,15,"constructor"],[83,16,65,16,"convInfo"],[83,24,65,24],[83,26,65,26],[84,6,66,8],[84,10,66,12],[84,11,66,13,"variableNames"],[84,24,66,26],[84,27,66,29],[84,28,66,30],[84,32,66,34],[84,34,66,36],[84,37,66,39],[84,38,66,40],[85,6,67,8],[85,10,67,12],[85,11,67,13,"outputShape"],[85,22,67,24],[85,25,67,27,"convInfo"],[85,33,67,35],[85,34,67,36,"inShape"],[85,41,67,43],[86,6,68,8],[86,12,68,14,"filterHeight"],[86,24,68,26],[86,27,68,29,"convInfo"],[86,35,68,37],[86,36,68,38,"filterHeight"],[86,48,68,50],[87,6,69,8],[87,12,69,14,"filterWidth"],[87,23,69,25],[87,26,69,28,"convInfo"],[87,34,69,36],[87,35,69,37,"filterWidth"],[87,46,69,48],[88,6,70,8],[88,12,70,14,"strideHeight"],[88,24,70,26],[88,27,70,29,"convInfo"],[88,35,70,37],[88,36,70,38,"strideHeight"],[88,48,70,50],[89,6,71,8],[89,12,71,14,"strideWidth"],[89,23,71,25],[89,26,71,28,"convInfo"],[89,34,71,36],[89,35,71,37,"strideWidth"],[89,46,71,48],[90,6,72,8],[90,12,72,14,"padTop"],[90,18,72,20],[90,21,72,23,"filterHeight"],[90,33,72,35],[90,36,72,38],[90,37,72,39],[90,40,72,42,"convInfo"],[90,48,72,50],[90,49,72,51,"padInfo"],[90,56,72,58],[90,57,72,59,"top"],[90,60,72,62],[91,6,73,8],[91,12,73,14,"padLeft"],[91,19,73,21],[91,22,73,24,"filterWidth"],[91,33,73,35],[91,36,73,38],[91,37,73,39],[91,40,73,42,"convInfo"],[91,48,73,50],[91,49,73,51,"padInfo"],[91,56,73,58],[91,57,73,59,"left"],[91,61,73,63],[92,6,74,8],[92,12,74,14,"channelMul"],[92,22,74,24],[92,25,74,27,"convInfo"],[92,33,74,35],[92,34,74,36,"outChannels"],[92,45,74,47],[92,48,74,50,"convInfo"],[92,56,74,58],[92,57,74,59,"inChannels"],[92,67,74,69],[93,6,75,8],[93,10,75,12],[93,11,75,13,"userCode"],[93,19,75,21],[93,22,75,24],[94,0,76,0],[94,33,76,33,"padTop"],[94,39,76,39],[94,44,76,44,"padLeft"],[94,51,76,51],[95,0,77,0],[96,0,78,0],[97,0,79,0],[98,0,80,0],[99,0,81,0],[100,0,82,0],[101,0,83,0],[102,0,84,0],[103,0,85,0],[104,0,86,0],[105,0,87,0],[106,0,88,0],[106,32,88,32,"filterHeight"],[106,44,88,44],[107,0,89,0],[107,48,89,48,"strideHeight"],[107,60,89,60],[108,0,90,0],[109,0,91,0],[109,36,91,36,"convInfo"],[109,44,91,44],[109,45,91,45,"outHeight"],[109,54,91,54],[110,0,92,0],[111,0,93,0],[112,0,94,0],[113,0,95,0],[114,0,96,0],[114,25,96,25,"filterHeight"],[114,37,96,37],[115,0,97,0],[116,0,98,0],[116,34,98,34,"filterWidth"],[116,45,98,45],[117,0,99,0],[117,50,99,50,"strideWidth"],[117,61,99,61],[118,0,100,0],[119,0,101,0],[119,38,101,38,"convInfo"],[119,46,101,46],[119,47,101,47,"outWidth"],[119,55,101,55],[120,0,102,0],[121,0,103,0],[122,0,104,0],[123,0,105,0],[124,0,106,0],[125,0,107,0],[125,27,107,27,"filterWidth"],[125,38,107,38],[126,0,108,0],[127,0,109,0],[128,0,110,0],[128,36,110,36,"channelMul"],[128,46,110,46],[129,0,111,0],[129,30,111,30,"channelMul"],[129,40,111,40],[130,0,112,0],[131,0,113,0],[132,0,114,0],[133,0,115,0],[134,0,116,0],[135,0,117,0],[136,0,118,0],[137,0,119,0],[138,0,120,0],[138,5,120,5],[139,4,121,4],[140,2,122,0],[141,0,122,1],[141,3]],"functionMap":{"names":["<global>","DepthwiseConv2DDerFilterProgram","DepthwiseConv2DDerFilterProgram#constructor","DepthwiseConv2DDerInputProgram","DepthwiseConv2DDerInputProgram#constructor"],"mappings":"AAA;OCgB;ICC;KD4C;CDC;OGC;ICC;KDwD;CHC"},"hasCjsExports":false},"type":"js/module"}]}