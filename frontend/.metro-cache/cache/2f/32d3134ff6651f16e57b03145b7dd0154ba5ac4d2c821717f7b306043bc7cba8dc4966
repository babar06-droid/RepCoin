{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":64,"index":767}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":768},"end":{"line":18,"column":47,"index":815}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}},{"name":"../utils/zeros_impl","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":816},"end":{"line":19,"column":44,"index":860}}],"key":"EpYipdIxs2xnJ6MzrElw739bTpA=","exportNames":["*"],"imports":1}},{"name":"./Cast","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":861},"end":{"line":20,"column":30,"index":891}}],"key":"SOBmKbAlkQuiZ1po/s3HTPueiR4=","exportNames":["*"],"imports":1}},{"name":"./Identity","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":892},"end":{"line":21,"column":38,"index":930}}],"key":"fmoGkMbvl3R/HMlCKK1PD8/q2lc=","exportNames":["*"],"imports":1}},{"name":"./Reshape","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":22,"column":0,"index":931},"end":{"line":22,"column":36,"index":967}}],"key":"EUWK+oKi/AwokPOQ1jng5DYfQSc=","exportNames":["*"],"imports":1}},{"name":"./Transpose","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":23,"column":0,"index":968},"end":{"line":23,"column":40,"index":1008}}],"key":"F6S1ekgW6WEHcH6rql/beO2khwY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.sum = sum;\n  Object.defineProperty(exports, \"sumConfig\", {\n    enumerable: true,\n    get: function () {\n      return sumConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  var _utilsZeros_impl = require(_dependencyMap[2], \"../utils/zeros_impl\");\n  var _Cast = require(_dependencyMap[3], \"./Cast\");\n  var _Identity = require(_dependencyMap[4], \"./Identity\");\n  var _Reshape = require(_dependencyMap[5], \"./Reshape\");\n  var _Transpose = require(_dependencyMap[6], \"./Transpose\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function sum(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x\n    } = inputs;\n    const {\n      axis,\n      keepDims\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)(x, 'sum');\n    let $x;\n    if (x.dtype === 'bool') {\n      $x = (0, _Cast.cast)({\n        inputs: {\n          x\n        },\n        backend,\n        attrs: {\n          dtype: 'int32'\n        }\n      });\n    } else {\n      $x = (0, _Identity.identity)({\n        inputs: {\n          x\n        },\n        backend\n      });\n    }\n    const xRank = $x.shape.length;\n    const axes = _tensorflowTfjsCore.util.parseAxisParam(axis, $x.shape);\n    const permutation = _tensorflowTfjsCore.backend_util.getAxesPermutation(axes, xRank);\n    let reductionAxes = axes;\n    let permutedX = $x;\n    if (permutation != null) {\n      permutedX = (0, _Transpose.transpose)({\n        inputs: {\n          x: $x\n        },\n        backend,\n        attrs: {\n          perm: permutation\n        }\n      });\n      reductionAxes = _tensorflowTfjsCore.backend_util.getInnerMostAxes(reductionAxes.length, xRank);\n    }\n    _tensorflowTfjsCore.backend_util.assertAxesAreInnerMostDims('sum', reductionAxes, permutedX.shape.length);\n    const [outShape, reduceShape] = _tensorflowTfjsCore.backend_util.computeOutAndReduceShapes(permutedX.shape, reductionAxes);\n    const resultDtype = _tensorflowTfjsCore.backend_util.upcastType(permutedX.dtype, 'int32');\n    let result = (0, _utilsZeros_impl.zeros)(backend, outShape, resultDtype);\n    const reduceSize = _tensorflowTfjsCore.util.sizeFromShape(reduceShape);\n    const vals = backend.data.get(result.dataId).values;\n    const aVals = backend.data.get(permutedX.dataId).values;\n    for (let i = 0; i < vals.length; ++i) {\n      const offset = i * reduceSize;\n      let sum = 0;\n      for (let j = 0; j < reduceSize; ++j) {\n        sum += aVals[offset + j];\n      }\n      vals[i] = sum;\n    }\n    if (keepDims) {\n      const newShape = _tensorflowTfjsCore.backend_util.expandShapeToKeepDim(result.shape, axes);\n      const oldResult = result;\n      result = (0, _Reshape.reshape)({\n        inputs: {\n          x: result\n        },\n        backend,\n        attrs: {\n          shape: newShape\n        }\n      });\n      backend.disposeIntermediateTensorInfo(oldResult);\n    }\n    backend.disposeIntermediateTensorInfo($x);\n    if (permutation != null) {\n      backend.disposeIntermediateTensorInfo(permutedX);\n    }\n    return result;\n  }\n  const sumConfig = {\n    kernelName: _tensorflowTfjsCore.Sum,\n    backendName: 'cpu',\n    kernelFunc: sum\n  };\n});","lineCount":128,"map":[[7,2,24,0,"exports"],[7,9,24,0],[7,10,24,0,"sum"],[7,13,24,0],[7,16,24,0,"sum"],[7,19,24,0],[8,2,73,0,"Object"],[8,8,73,0],[8,9,73,0,"defineProperty"],[8,23,73,0],[8,24,73,0,"exports"],[8,31,73,0],[9,4,73,0,"enumerable"],[9,14,73,0],[10,4,73,0,"get"],[10,7,73,0],[10,18,73,0,"get"],[10,19,73,0],[11,6,73,0],[11,13,73,0,"sumConfig"],[11,22,73,0],[12,4,73,0],[13,2,73,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,19,0],[16,6,19,0,"_utilsZeros_impl"],[16,22,19,0],[16,25,19,0,"require"],[16,32,19,0],[16,33,19,0,"_dependencyMap"],[16,47,19,0],[17,2,20,0],[17,6,20,0,"_Cast"],[17,11,20,0],[17,14,20,0,"require"],[17,21,20,0],[17,22,20,0,"_dependencyMap"],[17,36,20,0],[18,2,21,0],[18,6,21,0,"_Identity"],[18,15,21,0],[18,18,21,0,"require"],[18,25,21,0],[18,26,21,0,"_dependencyMap"],[18,40,21,0],[19,2,22,0],[19,6,22,0,"_Reshape"],[19,14,22,0],[19,17,22,0,"require"],[19,24,22,0],[19,25,22,0,"_dependencyMap"],[19,39,22,0],[20,2,23,0],[20,6,23,0,"_Transpose"],[20,16,23,0],[20,19,23,0,"require"],[20,26,23,0],[20,27,23,0,"_dependencyMap"],[20,41,23,0],[21,2,1,0],[22,0,2,0],[23,0,3,0],[24,0,4,0],[25,0,5,0],[26,0,6,0],[27,0,7,0],[28,0,8,0],[29,0,9,0],[30,0,10,0],[31,0,11,0],[32,0,12,0],[33,0,13,0],[34,0,14,0],[35,0,15,0],[36,0,16,0],[38,2,24,7],[38,11,24,16,"sum"],[38,14,24,19,"sum"],[38,15,24,20,"args"],[38,19,24,24],[38,21,24,26],[39,4,25,4],[39,10,25,10],[40,6,25,12,"inputs"],[40,12,25,18],[41,6,25,20,"backend"],[41,13,25,27],[42,6,25,29,"attrs"],[43,4,25,35],[43,5,25,36],[43,8,25,39,"args"],[43,12,25,43],[44,4,26,4],[44,10,26,10],[45,6,26,12,"x"],[46,4,26,14],[46,5,26,15],[46,8,26,18,"inputs"],[46,14,26,24],[47,4,27,4],[47,10,27,10],[48,6,27,12,"axis"],[48,10,27,16],[49,6,27,18,"keepDims"],[50,4,27,27],[50,5,27,28],[50,8,27,31,"attrs"],[50,13,27,36],[51,4,28,4],[51,8,28,4,"assertNotComplex"],[51,17,28,20],[51,18,28,20,"assertNotComplex"],[51,34,28,20],[51,36,28,21,"x"],[51,37,28,22],[51,39,28,24],[51,44,28,29],[51,45,28,30],[52,4,29,4],[52,8,29,8,"$x"],[52,10,29,10],[53,4,30,4],[53,8,30,8,"x"],[53,9,30,9],[53,10,30,10,"dtype"],[53,15,30,15],[53,20,30,20],[53,26,30,26],[53,28,30,28],[54,6,31,8,"$x"],[54,8,31,10],[54,11,31,13],[54,15,31,13,"cast"],[54,20,31,17],[54,21,31,17,"cast"],[54,25,31,17],[54,27,31,18],[55,8,31,20,"inputs"],[55,14,31,26],[55,16,31,28],[56,10,31,30,"x"],[57,8,31,32],[57,9,31,33],[58,8,31,35,"backend"],[58,15,31,42],[59,8,31,44,"attrs"],[59,13,31,49],[59,15,31,51],[60,10,31,53,"dtype"],[60,15,31,58],[60,17,31,60],[61,8,31,68],[62,6,31,70],[62,7,31,71],[62,8,31,72],[63,4,32,4],[63,5,32,5],[63,11,33,9],[64,6,34,8,"$x"],[64,8,34,10],[64,11,34,13],[64,15,34,13,"identity"],[64,24,34,21],[64,25,34,21,"identity"],[64,33,34,21],[64,35,34,22],[65,8,34,24,"inputs"],[65,14,34,30],[65,16,34,32],[66,10,34,34,"x"],[67,8,34,36],[67,9,34,37],[68,8,34,39,"backend"],[69,6,34,47],[69,7,34,48],[69,8,34,49],[70,4,35,4],[71,4,36,4],[71,10,36,10,"xRank"],[71,15,36,15],[71,18,36,18,"$x"],[71,20,36,20],[71,21,36,21,"shape"],[71,26,36,26],[71,27,36,27,"length"],[71,33,36,33],[72,4,37,4],[72,10,37,10,"axes"],[72,14,37,14],[72,17,37,17,"util"],[72,36,37,21],[72,37,37,21,"util"],[72,41,37,21],[72,42,37,22,"parseAxisParam"],[72,56,37,36],[72,57,37,37,"axis"],[72,61,37,41],[72,63,37,43,"$x"],[72,65,37,45],[72,66,37,46,"shape"],[72,71,37,51],[72,72,37,52],[73,4,38,4],[73,10,38,10,"permutation"],[73,21,38,21],[73,24,38,24,"backend_util"],[73,43,38,36],[73,44,38,36,"backend_util"],[73,56,38,36],[73,57,38,37,"getAxesPermutation"],[73,75,38,55],[73,76,38,56,"axes"],[73,80,38,60],[73,82,38,62,"xRank"],[73,87,38,67],[73,88,38,68],[74,4,39,4],[74,8,39,8,"reductionAxes"],[74,21,39,21],[74,24,39,24,"axes"],[74,28,39,28],[75,4,40,4],[75,8,40,8,"permutedX"],[75,17,40,17],[75,20,40,20,"$x"],[75,22,40,22],[76,4,41,4],[76,8,41,8,"permutation"],[76,19,41,19],[76,23,41,23],[76,27,41,27],[76,29,41,29],[77,6,42,8,"permutedX"],[77,15,42,17],[77,18,43,12],[77,22,43,12,"transpose"],[77,32,43,21],[77,33,43,21,"transpose"],[77,42,43,21],[77,44,43,22],[78,8,43,24,"inputs"],[78,14,43,30],[78,16,43,32],[79,10,43,34,"x"],[79,11,43,35],[79,13,43,37,"$x"],[80,8,43,40],[80,9,43,41],[81,8,43,43,"backend"],[81,15,43,50],[82,8,43,52,"attrs"],[82,13,43,57],[82,15,43,59],[83,10,43,61,"perm"],[83,14,43,65],[83,16,43,67,"permutation"],[84,8,43,79],[85,6,43,81],[85,7,43,82],[85,8,43,83],[86,6,44,8,"reductionAxes"],[86,19,44,21],[86,22,44,24,"backend_util"],[86,41,44,36],[86,42,44,36,"backend_util"],[86,54,44,36],[86,55,44,37,"getInnerMostAxes"],[86,71,44,53],[86,72,44,54,"reductionAxes"],[86,85,44,67],[86,86,44,68,"length"],[86,92,44,74],[86,94,44,76,"xRank"],[86,99,44,81],[86,100,44,82],[87,4,45,4],[88,4,46,4,"backend_util"],[88,23,46,16],[88,24,46,16,"backend_util"],[88,36,46,16],[88,37,46,17,"assertAxesAreInnerMostDims"],[88,63,46,43],[88,64,46,44],[88,69,46,49],[88,71,46,51,"reductionAxes"],[88,84,46,64],[88,86,46,66,"permutedX"],[88,95,46,75],[88,96,46,76,"shape"],[88,101,46,81],[88,102,46,82,"length"],[88,108,46,88],[88,109,46,89],[89,4,47,4],[89,10,47,10],[89,11,47,11,"outShape"],[89,19,47,19],[89,21,47,21,"reduceShape"],[89,32,47,32],[89,33,47,33],[89,36,47,36,"backend_util"],[89,55,47,48],[89,56,47,48,"backend_util"],[89,68,47,48],[89,69,47,49,"computeOutAndReduceShapes"],[89,94,47,74],[89,95,47,75,"permutedX"],[89,104,47,84],[89,105,47,85,"shape"],[89,110,47,90],[89,112,47,92,"reductionAxes"],[89,125,47,105],[89,126,47,106],[90,4,48,4],[90,10,48,10,"resultDtype"],[90,21,48,21],[90,24,48,24,"backend_util"],[90,43,48,36],[90,44,48,36,"backend_util"],[90,56,48,36],[90,57,48,37,"upcastType"],[90,67,48,47],[90,68,48,48,"permutedX"],[90,77,48,57],[90,78,48,58,"dtype"],[90,83,48,63],[90,85,48,65],[90,92,48,72],[90,93,48,73],[91,4,49,4],[91,8,49,8,"result"],[91,14,49,14],[91,17,49,17],[91,21,49,17,"zeros"],[91,37,49,22],[91,38,49,22,"zeros"],[91,43,49,22],[91,45,49,23,"backend"],[91,52,49,30],[91,54,49,32,"outShape"],[91,62,49,40],[91,64,49,42,"resultDtype"],[91,75,49,53],[91,76,49,54],[92,4,50,4],[92,10,50,10,"reduceSize"],[92,20,50,20],[92,23,50,23,"util"],[92,42,50,27],[92,43,50,27,"util"],[92,47,50,27],[92,48,50,28,"sizeFromShape"],[92,61,50,41],[92,62,50,42,"reduceShape"],[92,73,50,53],[92,74,50,54],[93,4,51,4],[93,10,51,10,"vals"],[93,14,51,14],[93,17,51,17,"backend"],[93,24,51,24],[93,25,51,25,"data"],[93,29,51,29],[93,30,51,30,"get"],[93,33,51,33],[93,34,51,34,"result"],[93,40,51,40],[93,41,51,41,"dataId"],[93,47,51,47],[93,48,51,48],[93,49,51,49,"values"],[93,55,51,55],[94,4,52,4],[94,10,52,10,"aVals"],[94,15,52,15],[94,18,52,18,"backend"],[94,25,52,25],[94,26,52,26,"data"],[94,30,52,30],[94,31,52,31,"get"],[94,34,52,34],[94,35,52,35,"permutedX"],[94,44,52,44],[94,45,52,45,"dataId"],[94,51,52,51],[94,52,52,52],[94,53,52,53,"values"],[94,59,52,59],[95,4,53,4],[95,9,53,9],[95,13,53,13,"i"],[95,14,53,14],[95,17,53,17],[95,18,53,18],[95,20,53,20,"i"],[95,21,53,21],[95,24,53,24,"vals"],[95,28,53,28],[95,29,53,29,"length"],[95,35,53,35],[95,37,53,37],[95,39,53,39,"i"],[95,40,53,40],[95,42,53,42],[96,6,54,8],[96,12,54,14,"offset"],[96,18,54,20],[96,21,54,23,"i"],[96,22,54,24],[96,25,54,27,"reduceSize"],[96,35,54,37],[97,6,55,8],[97,10,55,12,"sum"],[97,13,55,15],[97,16,55,18],[97,17,55,19],[98,6,56,8],[98,11,56,13],[98,15,56,17,"j"],[98,16,56,18],[98,19,56,21],[98,20,56,22],[98,22,56,24,"j"],[98,23,56,25],[98,26,56,28,"reduceSize"],[98,36,56,38],[98,38,56,40],[98,40,56,42,"j"],[98,41,56,43],[98,43,56,45],[99,8,57,12,"sum"],[99,11,57,15],[99,15,57,19,"aVals"],[99,20,57,24],[99,21,57,25,"offset"],[99,27,57,31],[99,30,57,34,"j"],[99,31,57,35],[99,32,57,36],[100,6,58,8],[101,6,59,8,"vals"],[101,10,59,12],[101,11,59,13,"i"],[101,12,59,14],[101,13,59,15],[101,16,59,18,"sum"],[101,19,59,21],[102,4,60,4],[103,4,61,4],[103,8,61,8,"keepDims"],[103,16,61,16],[103,18,61,18],[104,6,62,8],[104,12,62,14,"newShape"],[104,20,62,22],[104,23,62,25,"backend_util"],[104,42,62,37],[104,43,62,37,"backend_util"],[104,55,62,37],[104,56,62,38,"expandShapeToKeepDim"],[104,76,62,58],[104,77,62,59,"result"],[104,83,62,65],[104,84,62,66,"shape"],[104,89,62,71],[104,91,62,73,"axes"],[104,95,62,77],[104,96,62,78],[105,6,63,8],[105,12,63,14,"oldResult"],[105,21,63,23],[105,24,63,26,"result"],[105,30,63,32],[106,6,64,8,"result"],[106,12,64,14],[106,15,64,17],[106,19,64,17,"reshape"],[106,27,64,24],[106,28,64,24,"reshape"],[106,35,64,24],[106,37,64,25],[107,8,64,27,"inputs"],[107,14,64,33],[107,16,64,35],[108,10,64,37,"x"],[108,11,64,38],[108,13,64,40,"result"],[109,8,64,47],[109,9,64,48],[110,8,64,50,"backend"],[110,15,64,57],[111,8,64,59,"attrs"],[111,13,64,64],[111,15,64,66],[112,10,64,68,"shape"],[112,15,64,73],[112,17,64,75,"newShape"],[113,8,64,84],[114,6,64,86],[114,7,64,87],[114,8,64,88],[115,6,65,8,"backend"],[115,13,65,15],[115,14,65,16,"disposeIntermediateTensorInfo"],[115,43,65,45],[115,44,65,46,"oldResult"],[115,53,65,55],[115,54,65,56],[116,4,66,4],[117,4,67,4,"backend"],[117,11,67,11],[117,12,67,12,"disposeIntermediateTensorInfo"],[117,41,67,41],[117,42,67,42,"$x"],[117,44,67,44],[117,45,67,45],[118,4,68,4],[118,8,68,8,"permutation"],[118,19,68,19],[118,23,68,23],[118,27,68,27],[118,29,68,29],[119,6,69,8,"backend"],[119,13,69,15],[119,14,69,16,"disposeIntermediateTensorInfo"],[119,43,69,45],[119,44,69,46,"permutedX"],[119,53,69,55],[119,54,69,56],[120,4,70,4],[121,4,71,4],[121,11,71,11,"result"],[121,17,71,17],[122,2,72,0],[123,2,73,7],[123,8,73,13,"sumConfig"],[123,17,73,22],[123,20,73,25],[124,4,74,4,"kernelName"],[124,14,74,14],[124,16,74,16,"Sum"],[124,35,74,19],[124,36,74,19,"Sum"],[124,39,74,19],[125,4,75,4,"backendName"],[125,15,75,15],[125,17,75,17],[125,22,75,22],[126,4,76,4,"kernelFunc"],[126,14,76,14],[126,16,76,16,"sum"],[127,2,77,0],[127,3,77,1],[128,0,77,2],[128,3]],"functionMap":{"names":["<global>","sum"],"mappings":"AAA;OCuB;CDgD"},"hasCjsExports":false},"type":"js/module"}]}