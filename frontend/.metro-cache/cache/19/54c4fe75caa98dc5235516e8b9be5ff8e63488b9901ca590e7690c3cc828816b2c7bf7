{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":76,"index":779}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":780},"end":{"line":18,"column":47,"index":827}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.avgPool3DGrad = avgPool3DGrad;\n  Object.defineProperty(exports, \"avgPool3DGradConfig\", {\n    enumerable: true,\n    get: function () {\n      return avgPool3DGradConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function avgPool3DGrad(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      dy,\n      input\n    } = inputs;\n    const {\n      filterSize,\n      strides,\n      pad,\n      dimRoundingMode\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)([dy, input], 'avgPool3DGrad');\n    const convInfo = _tensorflowTfjsCore.backend_util.computePool3DInfo(input.shape, filterSize, strides, 1 /* dilations */, pad, dimRoundingMode);\n    const strideDepth = convInfo.strideDepth;\n    const strideHeight = convInfo.strideHeight;\n    const strideWidth = convInfo.strideWidth;\n    const filterDepth = convInfo.filterDepth;\n    const filterHeight = convInfo.filterHeight;\n    const filterWidth = convInfo.filterWidth;\n    const dilationDepth = convInfo.dilationDepth;\n    const dilationHeight = convInfo.dilationHeight;\n    const dilationWidth = convInfo.dilationWidth;\n    const effectiveFilterDepth = convInfo.effectiveFilterDepth;\n    const effectiveFilterHeight = convInfo.effectiveFilterHeight;\n    const effectiveFilterWidth = convInfo.effectiveFilterWidth;\n    const padFront = effectiveFilterDepth - 1 - convInfo.padInfo.front;\n    const padLeft = effectiveFilterWidth - 1 - convInfo.padInfo.left;\n    const padTop = effectiveFilterHeight - 1 - convInfo.padInfo.top;\n    const dx = (0, _tensorflowTfjsCore.buffer)(input.shape, 'float32');\n    const avgMultiplier = 1 / (filterDepth * filterHeight * filterWidth);\n    const dyBuf = backend.bufferSync(dy);\n    for (let batch = 0; batch < convInfo.batchSize; ++batch) {\n      for (let channel = 0; channel < convInfo.inChannels; ++channel) {\n        for (let dxDepth = 0; dxDepth < convInfo.inDepth; ++dxDepth) {\n          for (let dxRow = 0; dxRow < convInfo.inHeight; ++dxRow) {\n            for (let dxCol = 0; dxCol < convInfo.inWidth; ++dxCol) {\n              // Shader code begins.\n              const dyDepthCorner = dxDepth - padFront;\n              const dyRowCorner = dxRow - padTop;\n              const dyColCorner = dxCol - padLeft;\n              let dotProd = 0;\n              for (let wDepth = 0; wDepth < effectiveFilterDepth; wDepth += dilationDepth) {\n                const dyDepth = (dyDepthCorner + wDepth) / strideDepth;\n                if (dyDepth < 0 || dyDepth >= convInfo.outDepth || Math.floor(dyDepth) !== dyDepth) {\n                  continue;\n                }\n                for (let wRow = 0; wRow < effectiveFilterHeight; wRow += dilationHeight) {\n                  const dyRow = (dyRowCorner + wRow) / strideHeight;\n                  if (dyRow < 0 || dyRow >= convInfo.outHeight || Math.floor(dyRow) !== dyRow) {\n                    continue;\n                  }\n                  for (let wCol = 0; wCol < effectiveFilterWidth; wCol += dilationWidth) {\n                    const dyCol = (dyColCorner + wCol) / strideWidth;\n                    if (dyCol < 0 || dyCol >= convInfo.outWidth || Math.floor(dyCol) !== dyCol) {\n                      continue;\n                    }\n                    const pixel = dyBuf.get(batch, dyDepth, dyRow, dyCol, channel);\n                    dotProd += pixel;\n                  }\n                }\n              }\n              dx.set(dotProd * avgMultiplier, batch, dxDepth, dxRow, dxCol, channel);\n            }\n          }\n        }\n      }\n    }\n    return backend.makeTensorInfo(dx.shape, dx.dtype, dx.values);\n  }\n  const avgPool3DGradConfig = {\n    kernelName: _tensorflowTfjsCore.AvgPool3DGrad,\n    backendName: 'cpu',\n    kernelFunc: avgPool3DGrad\n  };\n});","lineCount":112,"map":[[7,2,19,0,"exports"],[7,9,19,0],[7,10,19,0,"avgPool3DGrad"],[7,23,19,0],[7,26,19,0,"avgPool3DGrad"],[7,39,19,0],[8,2,84,0,"Object"],[8,8,84,0],[8,9,84,0,"defineProperty"],[8,23,84,0],[8,24,84,0,"exports"],[8,31,84,0],[9,4,84,0,"enumerable"],[9,14,84,0],[10,4,84,0,"get"],[10,7,84,0],[10,18,84,0,"get"],[10,19,84,0],[11,6,84,0],[11,13,84,0,"avgPool3DGradConfig"],[11,32,84,0],[12,4,84,0],[13,2,84,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[25,0,10,0],[26,0,11,0],[27,0,12,0],[28,0,13,0],[29,0,14,0],[30,0,15,0],[31,0,16,0],[33,2,19,7],[33,11,19,16,"avgPool3DGrad"],[33,24,19,29,"avgPool3DGrad"],[33,25,19,30,"args"],[33,29,19,34],[33,31,19,36],[34,4,20,4],[34,10,20,10],[35,6,20,12,"inputs"],[35,12,20,18],[36,6,20,20,"backend"],[36,13,20,27],[37,6,20,29,"attrs"],[38,4,20,35],[38,5,20,36],[38,8,20,39,"args"],[38,12,20,43],[39,4,21,4],[39,10,21,10],[40,6,21,12,"dy"],[40,8,21,14],[41,6,21,16,"input"],[42,4,21,22],[42,5,21,23],[42,8,21,26,"inputs"],[42,14,21,32],[43,4,22,4],[43,10,22,10],[44,6,22,12,"filterSize"],[44,16,22,22],[45,6,22,24,"strides"],[45,13,22,31],[46,6,22,33,"pad"],[46,9,22,36],[47,6,22,38,"dimRoundingMode"],[48,4,22,54],[48,5,22,55],[48,8,22,58,"attrs"],[48,13,22,63],[49,4,23,4],[49,8,23,4,"assertNotComplex"],[49,17,23,20],[49,18,23,20,"assertNotComplex"],[49,34,23,20],[49,36,23,21],[49,37,23,22,"dy"],[49,39,23,24],[49,41,23,26,"input"],[49,46,23,31],[49,47,23,32],[49,49,23,34],[49,64,23,49],[49,65,23,50],[50,4,24,4],[50,10,24,10,"convInfo"],[50,18,24,18],[50,21,24,21,"backend_util"],[50,40,24,33],[50,41,24,33,"backend_util"],[50,53,24,33],[50,54,24,34,"computePool3DInfo"],[50,71,24,51],[50,72,24,52,"input"],[50,77,24,57],[50,78,24,58,"shape"],[50,83,24,63],[50,85,24,65,"filterSize"],[50,95,24,75],[50,97,24,77,"strides"],[50,104,24,84],[50,106,24,86],[50,107,24,87],[50,108,24,88],[50,125,24,105,"pad"],[50,128,24,108],[50,130,24,110,"dimRoundingMode"],[50,145,24,125],[50,146,24,126],[51,4,25,4],[51,10,25,10,"strideDepth"],[51,21,25,21],[51,24,25,24,"convInfo"],[51,32,25,32],[51,33,25,33,"strideDepth"],[51,44,25,44],[52,4,26,4],[52,10,26,10,"strideHeight"],[52,22,26,22],[52,25,26,25,"convInfo"],[52,33,26,33],[52,34,26,34,"strideHeight"],[52,46,26,46],[53,4,27,4],[53,10,27,10,"strideWidth"],[53,21,27,21],[53,24,27,24,"convInfo"],[53,32,27,32],[53,33,27,33,"strideWidth"],[53,44,27,44],[54,4,28,4],[54,10,28,10,"filterDepth"],[54,21,28,21],[54,24,28,24,"convInfo"],[54,32,28,32],[54,33,28,33,"filterDepth"],[54,44,28,44],[55,4,29,4],[55,10,29,10,"filterHeight"],[55,22,29,22],[55,25,29,25,"convInfo"],[55,33,29,33],[55,34,29,34,"filterHeight"],[55,46,29,46],[56,4,30,4],[56,10,30,10,"filterWidth"],[56,21,30,21],[56,24,30,24,"convInfo"],[56,32,30,32],[56,33,30,33,"filterWidth"],[56,44,30,44],[57,4,31,4],[57,10,31,10,"dilationDepth"],[57,23,31,23],[57,26,31,26,"convInfo"],[57,34,31,34],[57,35,31,35,"dilationDepth"],[57,48,31,48],[58,4,32,4],[58,10,32,10,"dilationHeight"],[58,24,32,24],[58,27,32,27,"convInfo"],[58,35,32,35],[58,36,32,36,"dilationHeight"],[58,50,32,50],[59,4,33,4],[59,10,33,10,"dilationWidth"],[59,23,33,23],[59,26,33,26,"convInfo"],[59,34,33,34],[59,35,33,35,"dilationWidth"],[59,48,33,48],[60,4,34,4],[60,10,34,10,"effectiveFilterDepth"],[60,30,34,30],[60,33,34,33,"convInfo"],[60,41,34,41],[60,42,34,42,"effectiveFilterDepth"],[60,62,34,62],[61,4,35,4],[61,10,35,10,"effectiveFilterHeight"],[61,31,35,31],[61,34,35,34,"convInfo"],[61,42,35,42],[61,43,35,43,"effectiveFilterHeight"],[61,64,35,64],[62,4,36,4],[62,10,36,10,"effectiveFilterWidth"],[62,30,36,30],[62,33,36,33,"convInfo"],[62,41,36,41],[62,42,36,42,"effectiveFilterWidth"],[62,62,36,62],[63,4,37,4],[63,10,37,10,"padFront"],[63,18,37,18],[63,21,37,21,"effectiveFilterDepth"],[63,41,37,41],[63,44,37,44],[63,45,37,45],[63,48,37,48,"convInfo"],[63,56,37,56],[63,57,37,57,"padInfo"],[63,64,37,64],[63,65,37,65,"front"],[63,70,37,70],[64,4,38,4],[64,10,38,10,"padLeft"],[64,17,38,17],[64,20,38,20,"effectiveFilterWidth"],[64,40,38,40],[64,43,38,43],[64,44,38,44],[64,47,38,47,"convInfo"],[64,55,38,55],[64,56,38,56,"padInfo"],[64,63,38,63],[64,64,38,64,"left"],[64,68,38,68],[65,4,39,4],[65,10,39,10,"padTop"],[65,16,39,16],[65,19,39,19,"effectiveFilterHeight"],[65,40,39,40],[65,43,39,43],[65,44,39,44],[65,47,39,47,"convInfo"],[65,55,39,55],[65,56,39,56,"padInfo"],[65,63,39,63],[65,64,39,64,"top"],[65,67,39,67],[66,4,40,4],[66,10,40,10,"dx"],[66,12,40,12],[66,15,40,15],[66,19,40,15,"buffer"],[66,38,40,21],[66,39,40,21,"buffer"],[66,45,40,21],[66,47,40,22,"input"],[66,52,40,27],[66,53,40,28,"shape"],[66,58,40,33],[66,60,40,35],[66,69,40,44],[66,70,40,45],[67,4,41,4],[67,10,41,10,"avgMultiplier"],[67,23,41,23],[67,26,41,26],[67,27,41,27],[67,31,41,31,"filterDepth"],[67,42,41,42],[67,45,41,45,"filterHeight"],[67,57,41,57],[67,60,41,60,"filterWidth"],[67,71,41,71],[67,72,41,72],[68,4,42,4],[68,10,42,10,"dyBuf"],[68,15,42,15],[68,18,42,18,"backend"],[68,25,42,25],[68,26,42,26,"bufferSync"],[68,36,42,36],[68,37,42,37,"dy"],[68,39,42,39],[68,40,42,40],[69,4,43,4],[69,9,43,9],[69,13,43,13,"batch"],[69,18,43,18],[69,21,43,21],[69,22,43,22],[69,24,43,24,"batch"],[69,29,43,29],[69,32,43,32,"convInfo"],[69,40,43,40],[69,41,43,41,"batchSize"],[69,50,43,50],[69,52,43,52],[69,54,43,54,"batch"],[69,59,43,59],[69,61,43,61],[70,6,44,8],[70,11,44,13],[70,15,44,17,"channel"],[70,22,44,24],[70,25,44,27],[70,26,44,28],[70,28,44,30,"channel"],[70,35,44,37],[70,38,44,40,"convInfo"],[70,46,44,48],[70,47,44,49,"inChannels"],[70,57,44,59],[70,59,44,61],[70,61,44,63,"channel"],[70,68,44,70],[70,70,44,72],[71,8,45,12],[71,13,45,17],[71,17,45,21,"dxDepth"],[71,24,45,28],[71,27,45,31],[71,28,45,32],[71,30,45,34,"dxDepth"],[71,37,45,41],[71,40,45,44,"convInfo"],[71,48,45,52],[71,49,45,53,"inDepth"],[71,56,45,60],[71,58,45,62],[71,60,45,64,"dxDepth"],[71,67,45,71],[71,69,45,73],[72,10,46,16],[72,15,46,21],[72,19,46,25,"dxRow"],[72,24,46,30],[72,27,46,33],[72,28,46,34],[72,30,46,36,"dxRow"],[72,35,46,41],[72,38,46,44,"convInfo"],[72,46,46,52],[72,47,46,53,"inHeight"],[72,55,46,61],[72,57,46,63],[72,59,46,65,"dxRow"],[72,64,46,70],[72,66,46,72],[73,12,47,20],[73,17,47,25],[73,21,47,29,"dxCol"],[73,26,47,34],[73,29,47,37],[73,30,47,38],[73,32,47,40,"dxCol"],[73,37,47,45],[73,40,47,48,"convInfo"],[73,48,47,56],[73,49,47,57,"inWidth"],[73,56,47,64],[73,58,47,66],[73,60,47,68,"dxCol"],[73,65,47,73],[73,67,47,75],[74,14,48,24],[75,14,49,24],[75,20,49,30,"dyDepthCorner"],[75,33,49,43],[75,36,49,46,"dxDepth"],[75,43,49,53],[75,46,49,56,"padFront"],[75,54,49,64],[76,14,50,24],[76,20,50,30,"dyRowCorner"],[76,31,50,41],[76,34,50,44,"dxRow"],[76,39,50,49],[76,42,50,52,"padTop"],[76,48,50,58],[77,14,51,24],[77,20,51,30,"dyColCorner"],[77,31,51,41],[77,34,51,44,"dxCol"],[77,39,51,49],[77,42,51,52,"padLeft"],[77,49,51,59],[78,14,52,24],[78,18,52,28,"dotProd"],[78,25,52,35],[78,28,52,38],[78,29,52,39],[79,14,53,24],[79,19,53,29],[79,23,53,33,"wDepth"],[79,29,53,39],[79,32,53,42],[79,33,53,43],[79,35,53,45,"wDepth"],[79,41,53,51],[79,44,53,54,"effectiveFilterDepth"],[79,64,53,74],[79,66,53,76,"wDepth"],[79,72,53,82],[79,76,53,86,"dilationDepth"],[79,89,53,99],[79,91,53,101],[80,16,54,28],[80,22,54,34,"dyDepth"],[80,29,54,41],[80,32,54,44],[80,33,54,45,"dyDepthCorner"],[80,46,54,58],[80,49,54,61,"wDepth"],[80,55,54,67],[80,59,54,71,"strideDepth"],[80,70,54,82],[81,16,55,28],[81,20,55,32,"dyDepth"],[81,27,55,39],[81,30,55,42],[81,31,55,43],[81,35,55,47,"dyDepth"],[81,42,55,54],[81,46,55,58,"convInfo"],[81,54,55,66],[81,55,55,67,"outDepth"],[81,63,55,75],[81,67,56,32,"Math"],[81,71,56,36],[81,72,56,37,"floor"],[81,77,56,42],[81,78,56,43,"dyDepth"],[81,85,56,50],[81,86,56,51],[81,91,56,56,"dyDepth"],[81,98,56,63],[81,100,56,65],[82,18,57,32],[83,16,58,28],[84,16,59,28],[84,21,59,33],[84,25,59,37,"wRow"],[84,29,59,41],[84,32,59,44],[84,33,59,45],[84,35,59,47,"wRow"],[84,39,59,51],[84,42,59,54,"effectiveFilterHeight"],[84,63,59,75],[84,65,59,77,"wRow"],[84,69,59,81],[84,73,59,85,"dilationHeight"],[84,87,59,99],[84,89,59,101],[85,18,60,32],[85,24,60,38,"dyRow"],[85,29,60,43],[85,32,60,46],[85,33,60,47,"dyRowCorner"],[85,44,60,58],[85,47,60,61,"wRow"],[85,51,60,65],[85,55,60,69,"strideHeight"],[85,67,60,81],[86,18,61,32],[86,22,61,36,"dyRow"],[86,27,61,41],[86,30,61,44],[86,31,61,45],[86,35,61,49,"dyRow"],[86,40,61,54],[86,44,61,58,"convInfo"],[86,52,61,66],[86,53,61,67,"outHeight"],[86,62,61,76],[86,66,62,36,"Math"],[86,70,62,40],[86,71,62,41,"floor"],[86,76,62,46],[86,77,62,47,"dyRow"],[86,82,62,52],[86,83,62,53],[86,88,62,58,"dyRow"],[86,93,62,63],[86,95,62,65],[87,20,63,36],[88,18,64,32],[89,18,65,32],[89,23,65,37],[89,27,65,41,"wCol"],[89,31,65,45],[89,34,65,48],[89,35,65,49],[89,37,65,51,"wCol"],[89,41,65,55],[89,44,65,58,"effectiveFilterWidth"],[89,64,65,78],[89,66,65,80,"wCol"],[89,70,65,84],[89,74,65,88,"dilationWidth"],[89,87,65,101],[89,89,65,103],[90,20,66,36],[90,26,66,42,"dyCol"],[90,31,66,47],[90,34,66,50],[90,35,66,51,"dyColCorner"],[90,46,66,62],[90,49,66,65,"wCol"],[90,53,66,69],[90,57,66,73,"strideWidth"],[90,68,66,84],[91,20,67,36],[91,24,67,40,"dyCol"],[91,29,67,45],[91,32,67,48],[91,33,67,49],[91,37,67,53,"dyCol"],[91,42,67,58],[91,46,67,62,"convInfo"],[91,54,67,70],[91,55,67,71,"outWidth"],[91,63,67,79],[91,67,68,40,"Math"],[91,71,68,44],[91,72,68,45,"floor"],[91,77,68,50],[91,78,68,51,"dyCol"],[91,83,68,56],[91,84,68,57],[91,89,68,62,"dyCol"],[91,94,68,67],[91,96,68,69],[92,22,69,40],[93,20,70,36],[94,20,71,36],[94,26,71,42,"pixel"],[94,31,71,47],[94,34,71,50,"dyBuf"],[94,39,71,55],[94,40,71,56,"get"],[94,43,71,59],[94,44,71,60,"batch"],[94,49,71,65],[94,51,71,67,"dyDepth"],[94,58,71,74],[94,60,71,76,"dyRow"],[94,65,71,81],[94,67,71,83,"dyCol"],[94,72,71,88],[94,74,71,90,"channel"],[94,81,71,97],[94,82,71,98],[95,20,72,36,"dotProd"],[95,27,72,43],[95,31,72,47,"pixel"],[95,36,72,52],[96,18,73,32],[97,16,74,28],[98,14,75,24],[99,14,76,24,"dx"],[99,16,76,26],[99,17,76,27,"set"],[99,20,76,30],[99,21,76,31,"dotProd"],[99,28,76,38],[99,31,76,41,"avgMultiplier"],[99,44,76,54],[99,46,76,56,"batch"],[99,51,76,61],[99,53,76,63,"dxDepth"],[99,60,76,70],[99,62,76,72,"dxRow"],[99,67,76,77],[99,69,76,79,"dxCol"],[99,74,76,84],[99,76,76,86,"channel"],[99,83,76,93],[99,84,76,94],[100,12,77,20],[101,10,78,16],[102,8,79,12],[103,6,80,8],[104,4,81,4],[105,4,82,4],[105,11,82,11,"backend"],[105,18,82,18],[105,19,82,19,"makeTensorInfo"],[105,33,82,33],[105,34,82,34,"dx"],[105,36,82,36],[105,37,82,37,"shape"],[105,42,82,42],[105,44,82,44,"dx"],[105,46,82,46],[105,47,82,47,"dtype"],[105,52,82,52],[105,54,82,54,"dx"],[105,56,82,56],[105,57,82,57,"values"],[105,63,82,63],[105,64,82,64],[106,2,83,0],[107,2,84,7],[107,8,84,13,"avgPool3DGradConfig"],[107,27,84,32],[107,30,84,35],[108,4,85,4,"kernelName"],[108,14,85,14],[108,16,85,16,"AvgPool3DGrad"],[108,35,85,29],[108,36,85,29,"AvgPool3DGrad"],[108,49,85,29],[109,4,86,4,"backendName"],[109,15,86,15],[109,17,86,17],[109,22,86,22],[110,4,87,4,"kernelFunc"],[110,14,87,14],[110,16,87,16,"avgPool3DGrad"],[111,2,88,0],[111,3,88,1],[112,0,88,2],[112,3]],"functionMap":{"names":["<global>","avgPool3DGrad"],"mappings":"AAA;OCkB;CDgE"},"hasCjsExports":false},"type":"js/module"}]}