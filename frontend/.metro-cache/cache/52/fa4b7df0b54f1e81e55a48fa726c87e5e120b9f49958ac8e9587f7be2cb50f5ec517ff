{"dependencies":[{"name":"@tensorflow/tfjs-core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":54,"index":757}}],"key":"qIleUpSDMUXFynEGc51k60/pDSs=","exportNames":["*"],"imports":1}},{"name":"../cpu_util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":758},"end":{"line":18,"column":47,"index":805}}],"key":"5L5S4GXlh/uJh1MrXQbkPSVOWm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.lRNGrad = lRNGrad;\n  Object.defineProperty(exports, \"LRNGradConfig\", {\n    enumerable: true,\n    get: function () {\n      return LRNGradConfig;\n    }\n  });\n  var _tensorflowTfjsCore = require(_dependencyMap[0], \"@tensorflow/tfjs-core\");\n  var _cpu_util = require(_dependencyMap[1], \"../cpu_util\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  function lRNGrad(args) {\n    const {\n      inputs,\n      backend,\n      attrs\n    } = args;\n    const {\n      x,\n      y,\n      dy\n    } = inputs;\n    const {\n      depthRadius,\n      bias,\n      alpha,\n      beta\n    } = attrs;\n    (0, _cpu_util.assertNotComplex)(dy, 'LRNGrad');\n    const dySize = _tensorflowTfjsCore.util.sizeFromShape(dy.shape);\n    const channels = dy.shape[3];\n    const dyValues = backend.data.get(dy.dataId).values;\n    const xValues = backend.data.get(x.dataId).values;\n    const yValues = backend.data.get(y.dataId).values;\n    const result = new Float32Array(dySize);\n    const size = dySize;\n    for (let offset = 0; offset < size; offset++) {\n      const currentChannel = offset % channels;\n      const depthBegin = offset - currentChannel + Math.max(0, currentChannel - depthRadius);\n      const depthEnd = offset - currentChannel + Math.min(channels, currentChannel + depthRadius + 1);\n      let norm = 0;\n      for (let k = depthBegin; k < depthEnd; k++) {\n        norm += Math.pow(xValues[k], 2);\n      }\n      norm = alpha * norm + bias;\n      for (let k = depthBegin; k < depthEnd; k++) {\n        let dyi = -2 * alpha * beta * xValues[k] * yValues[offset] / norm;\n        if (offset === k) {\n          dyi += Math.pow(norm, -beta);\n        }\n        dyi *= dyValues[offset];\n        result[k] += dyi;\n      }\n    }\n    return backend.makeTensorInfo(dy.shape, x.dtype, result);\n  }\n  // tslint:disable-next-line: variable-name\n  const LRNGradConfig = {\n    kernelName: _tensorflowTfjsCore.LRNGrad,\n    backendName: 'cpu',\n    kernelFunc: lRNGrad\n  };\n});","lineCount":84,"map":[[7,2,19,0,"exports"],[7,9,19,0],[7,10,19,0,"lRNGrad"],[7,17,19,0],[7,20,19,0,"lRNGrad"],[7,27,19,0],[8,2,53,0,"Object"],[8,8,53,0],[8,9,53,0,"defineProperty"],[8,23,53,0],[8,24,53,0,"exports"],[8,31,53,0],[9,4,53,0,"enumerable"],[9,14,53,0],[10,4,53,0,"get"],[10,7,53,0],[10,18,53,0,"get"],[10,19,53,0],[11,6,53,0],[11,13,53,0,"LRNGradConfig"],[11,26,53,0],[12,4,53,0],[13,2,53,0],[14,2,17,0],[14,6,17,0,"_tensorflowTfjsCore"],[14,25,17,0],[14,28,17,0,"require"],[14,35,17,0],[14,36,17,0,"_dependencyMap"],[14,50,17,0],[15,2,18,0],[15,6,18,0,"_cpu_util"],[15,15,18,0],[15,18,18,0,"require"],[15,25,18,0],[15,26,18,0,"_dependencyMap"],[15,40,18,0],[16,2,1,0],[17,0,2,0],[18,0,3,0],[19,0,4,0],[20,0,5,0],[21,0,6,0],[22,0,7,0],[23,0,8,0],[24,0,9,0],[25,0,10,0],[26,0,11,0],[27,0,12,0],[28,0,13,0],[29,0,14,0],[30,0,15,0],[31,0,16,0],[33,2,19,7],[33,11,19,16,"lRNGrad"],[33,18,19,23,"lRNGrad"],[33,19,19,24,"args"],[33,23,19,28],[33,25,19,30],[34,4,20,4],[34,10,20,10],[35,6,20,12,"inputs"],[35,12,20,18],[36,6,20,20,"backend"],[36,13,20,27],[37,6,20,29,"attrs"],[38,4,20,35],[38,5,20,36],[38,8,20,39,"args"],[38,12,20,43],[39,4,21,4],[39,10,21,10],[40,6,21,12,"x"],[40,7,21,13],[41,6,21,15,"y"],[41,7,21,16],[42,6,21,18,"dy"],[43,4,21,21],[43,5,21,22],[43,8,21,25,"inputs"],[43,14,21,31],[44,4,22,4],[44,10,22,10],[45,6,22,12,"depthRadius"],[45,17,22,23],[46,6,22,25,"bias"],[46,10,22,29],[47,6,22,31,"alpha"],[47,11,22,36],[48,6,22,38,"beta"],[49,4,22,43],[49,5,22,44],[49,8,22,47,"attrs"],[49,13,22,52],[50,4,23,4],[50,8,23,4,"assertNotComplex"],[50,17,23,20],[50,18,23,20,"assertNotComplex"],[50,34,23,20],[50,36,23,21,"dy"],[50,38,23,23],[50,40,23,25],[50,49,23,34],[50,50,23,35],[51,4,24,4],[51,10,24,10,"dySize"],[51,16,24,16],[51,19,24,19,"util"],[51,38,24,23],[51,39,24,23,"util"],[51,43,24,23],[51,44,24,24,"sizeFromShape"],[51,57,24,37],[51,58,24,38,"dy"],[51,60,24,40],[51,61,24,41,"shape"],[51,66,24,46],[51,67,24,47],[52,4,25,4],[52,10,25,10,"channels"],[52,18,25,18],[52,21,25,21,"dy"],[52,23,25,23],[52,24,25,24,"shape"],[52,29,25,29],[52,30,25,30],[52,31,25,31],[52,32,25,32],[53,4,26,4],[53,10,26,10,"dyValues"],[53,18,26,18],[53,21,26,21,"backend"],[53,28,26,28],[53,29,26,29,"data"],[53,33,26,33],[53,34,26,34,"get"],[53,37,26,37],[53,38,26,38,"dy"],[53,40,26,40],[53,41,26,41,"dataId"],[53,47,26,47],[53,48,26,48],[53,49,26,49,"values"],[53,55,26,55],[54,4,27,4],[54,10,27,10,"xValues"],[54,17,27,17],[54,20,27,20,"backend"],[54,27,27,27],[54,28,27,28,"data"],[54,32,27,32],[54,33,27,33,"get"],[54,36,27,36],[54,37,27,37,"x"],[54,38,27,38],[54,39,27,39,"dataId"],[54,45,27,45],[54,46,27,46],[54,47,27,47,"values"],[54,53,27,53],[55,4,28,4],[55,10,28,10,"yValues"],[55,17,28,17],[55,20,28,20,"backend"],[55,27,28,27],[55,28,28,28,"data"],[55,32,28,32],[55,33,28,33,"get"],[55,36,28,36],[55,37,28,37,"y"],[55,38,28,38],[55,39,28,39,"dataId"],[55,45,28,45],[55,46,28,46],[55,47,28,47,"values"],[55,53,28,53],[56,4,29,4],[56,10,29,10,"result"],[56,16,29,16],[56,19,29,19],[56,23,29,23,"Float32Array"],[56,35,29,35],[56,36,29,36,"dySize"],[56,42,29,42],[56,43,29,43],[57,4,30,4],[57,10,30,10,"size"],[57,14,30,14],[57,17,30,17,"dySize"],[57,23,30,23],[58,4,31,4],[58,9,31,9],[58,13,31,13,"offset"],[58,19,31,19],[58,22,31,22],[58,23,31,23],[58,25,31,25,"offset"],[58,31,31,31],[58,34,31,34,"size"],[58,38,31,38],[58,40,31,40,"offset"],[58,46,31,46],[58,48,31,48],[58,50,31,50],[59,6,32,8],[59,12,32,14,"currentChannel"],[59,26,32,28],[59,29,32,31,"offset"],[59,35,32,37],[59,38,32,40,"channels"],[59,46,32,48],[60,6,33,8],[60,12,33,14,"depthBegin"],[60,22,33,24],[60,25,33,28,"offset"],[60,31,33,34],[60,34,33,37,"currentChannel"],[60,48,33,51],[60,51,33,55,"Math"],[60,55,33,59],[60,56,33,60,"max"],[60,59,33,63],[60,60,33,64],[60,61,33,65],[60,63,33,67,"currentChannel"],[60,77,33,81],[60,80,33,84,"depthRadius"],[60,91,33,95],[60,92,33,96],[61,6,34,8],[61,12,34,14,"depthEnd"],[61,20,34,22],[61,23,34,26,"offset"],[61,29,34,32],[61,32,34,35,"currentChannel"],[61,46,34,49],[61,49,35,12,"Math"],[61,53,35,16],[61,54,35,17,"min"],[61,57,35,20],[61,58,35,21,"channels"],[61,66,35,29],[61,68,35,31,"currentChannel"],[61,82,35,45],[61,85,35,48,"depthRadius"],[61,96,35,59],[61,99,35,62],[61,100,35,63],[61,101,35,64],[62,6,36,8],[62,10,36,12,"norm"],[62,14,36,16],[62,17,36,19],[62,18,36,20],[63,6,37,8],[63,11,37,13],[63,15,37,17,"k"],[63,16,37,18],[63,19,37,21,"depthBegin"],[63,29,37,31],[63,31,37,33,"k"],[63,32,37,34],[63,35,37,37,"depthEnd"],[63,43,37,45],[63,45,37,47,"k"],[63,46,37,48],[63,48,37,50],[63,50,37,52],[64,8,38,12,"norm"],[64,12,38,16],[64,16,38,20,"Math"],[64,20,38,24],[64,21,38,25,"pow"],[64,24,38,28],[64,25,38,29,"xValues"],[64,32,38,36],[64,33,38,37,"k"],[64,34,38,38],[64,35,38,39],[64,37,38,41],[64,38,38,42],[64,39,38,43],[65,6,39,8],[66,6,40,8,"norm"],[66,10,40,12],[66,13,40,15,"alpha"],[66,18,40,20],[66,21,40,23,"norm"],[66,25,40,27],[66,28,40,30,"bias"],[66,32,40,34],[67,6,41,8],[67,11,41,13],[67,15,41,17,"k"],[67,16,41,18],[67,19,41,21,"depthBegin"],[67,29,41,31],[67,31,41,33,"k"],[67,32,41,34],[67,35,41,37,"depthEnd"],[67,43,41,45],[67,45,41,47,"k"],[67,46,41,48],[67,48,41,50],[67,50,41,52],[68,8,42,12],[68,12,42,16,"dyi"],[68,15,42,19],[68,18,42,22],[68,19,42,23],[68,20,42,24],[68,23,42,27,"alpha"],[68,28,42,32],[68,31,42,35,"beta"],[68,35,42,39],[68,38,42,42,"xValues"],[68,45,42,49],[68,46,42,50,"k"],[68,47,42,51],[68,48,42,52],[68,51,42,55,"yValues"],[68,58,42,62],[68,59,42,63,"offset"],[68,65,42,69],[68,66,42,70],[68,69,42,73,"norm"],[68,73,42,77],[69,8,43,12],[69,12,43,16,"offset"],[69,18,43,22],[69,23,43,27,"k"],[69,24,43,28],[69,26,43,30],[70,10,44,16,"dyi"],[70,13,44,19],[70,17,44,23,"Math"],[70,21,44,27],[70,22,44,28,"pow"],[70,25,44,31],[70,26,44,32,"norm"],[70,30,44,36],[70,32,44,38],[70,33,44,39,"beta"],[70,37,44,43],[70,38,44,44],[71,8,45,12],[72,8,46,12,"dyi"],[72,11,46,15],[72,15,46,19,"dyValues"],[72,23,46,27],[72,24,46,28,"offset"],[72,30,46,34],[72,31,46,35],[73,8,47,12,"result"],[73,14,47,18],[73,15,47,19,"k"],[73,16,47,20],[73,17,47,21],[73,21,47,25,"dyi"],[73,24,47,28],[74,6,48,8],[75,4,49,4],[76,4,50,4],[76,11,50,11,"backend"],[76,18,50,18],[76,19,50,19,"makeTensorInfo"],[76,33,50,33],[76,34,50,34,"dy"],[76,36,50,36],[76,37,50,37,"shape"],[76,42,50,42],[76,44,50,44,"x"],[76,45,50,45],[76,46,50,46,"dtype"],[76,51,50,51],[76,53,50,53,"result"],[76,59,50,59],[76,60,50,60],[77,2,51,0],[78,2,52,0],[79,2,53,7],[79,8,53,13,"LRNGradConfig"],[79,21,53,26],[79,24,53,29],[80,4,54,4,"kernelName"],[80,14,54,14],[80,16,54,16,"LRNGrad"],[80,35,54,23],[80,36,54,23,"LRNGrad"],[80,43,54,23],[81,4,55,4,"backendName"],[81,15,55,15],[81,17,55,17],[81,22,55,22],[82,4,56,4,"kernelFunc"],[82,14,56,14],[82,16,56,16,"lRNGrad"],[83,2,57,0],[83,3,57,1],[84,0,57,2],[84,3]],"functionMap":{"names":["<global>","lRNGrad"],"mappings":"AAA;OCkB;CDgC"},"hasCjsExports":false},"type":"js/module"}]}