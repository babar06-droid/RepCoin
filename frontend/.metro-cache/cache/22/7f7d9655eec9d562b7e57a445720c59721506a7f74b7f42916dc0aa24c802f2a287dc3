{"dependencies":[{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":33,"index":736}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.monitorPromisesProgress = monitorPromisesProgress;\n  var _util = require(_dependencyMap[0], \"../util\");\n  /**\n   * @license\n   * Copyright 2019 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * Monitor Promise.all progress, fire onProgress callback function.\n   *\n   * @param promises Promise list going to be monitored\n   * @param onProgress Callback function. Fired when a promise resolved.\n   * @param startFraction Optional fraction start. Default to 0.\n   * @param endFraction Optional fraction end. Default to 1.\n   */\n  function monitorPromisesProgress(promises, onProgress, startFraction, endFraction) {\n    checkPromises(promises);\n    startFraction = startFraction == null ? 0 : startFraction;\n    endFraction = endFraction == null ? 1 : endFraction;\n    checkFraction(startFraction, endFraction);\n    let resolvedPromise = 0;\n    const registerMonitor = promise => {\n      promise.then(value => {\n        const fraction = startFraction + ++resolvedPromise / promises.length * (endFraction - startFraction);\n        // pass fraction as parameter to callback function.\n        onProgress(fraction);\n        return value;\n      });\n      return promise;\n    };\n    function checkPromises(promises) {\n      (0, _util.assert)(promises != null && Array.isArray(promises) && promises.length > 0, () => 'promises must be a none empty array');\n    }\n    function checkFraction(startFraction, endFraction) {\n      (0, _util.assert)(startFraction >= 0 && startFraction <= 1, () => `Progress fraction must be in range [0, 1], but ` + `got startFraction ${startFraction}`);\n      (0, _util.assert)(endFraction >= 0 && endFraction <= 1, () => `Progress fraction must be in range [0, 1], but ` + `got endFraction ${endFraction}`);\n      (0, _util.assert)(endFraction >= startFraction, () => `startFraction must be no more than endFraction, but ` + `got startFraction ${startFraction} and endFraction ` + `${endFraction}`);\n    }\n    return Promise.all(promises.map(registerMonitor));\n  }\n});","lineCount":59,"map":[[7,2,26,0,"exports"],[7,9,26,0],[7,10,26,0,"monitorPromisesProgress"],[7,33,26,0],[7,36,26,0,"monitorPromisesProgress"],[7,59,26,0],[8,2,17,0],[8,6,17,0,"_util"],[8,11,17,0],[8,14,17,0,"require"],[8,21,17,0],[8,22,17,0,"_dependencyMap"],[8,36,17,0],[9,2,1,0],[10,0,2,0],[11,0,3,0],[12,0,4,0],[13,0,5,0],[14,0,6,0],[15,0,7,0],[16,0,8,0],[17,0,9,0],[18,0,10,0],[19,0,11,0],[20,0,12,0],[21,0,13,0],[22,0,14,0],[23,0,15,0],[24,0,16,0],[26,2,18,0],[27,0,19,0],[28,0,20,0],[29,0,21,0],[30,0,22,0],[31,0,23,0],[32,0,24,0],[33,0,25,0],[34,2,26,7],[34,11,26,16,"monitorPromisesProgress"],[34,34,26,39,"monitorPromisesProgress"],[34,35,26,40,"promises"],[34,43,26,48],[34,45,26,50,"onProgress"],[34,55,26,60],[34,57,26,62,"startFraction"],[34,70,26,75],[34,72,26,77,"endFraction"],[34,83,26,88],[34,85,26,90],[35,4,27,4,"checkPromises"],[35,17,27,17],[35,18,27,18,"promises"],[35,26,27,26],[35,27,27,27],[36,4,28,4,"startFraction"],[36,17,28,17],[36,20,28,20,"startFraction"],[36,33,28,33],[36,37,28,37],[36,41,28,41],[36,44,28,44],[36,45,28,45],[36,48,28,48,"startFraction"],[36,61,28,61],[37,4,29,4,"endFraction"],[37,15,29,15],[37,18,29,18,"endFraction"],[37,29,29,29],[37,33,29,33],[37,37,29,37],[37,40,29,40],[37,41,29,41],[37,44,29,44,"endFraction"],[37,55,29,55],[38,4,30,4,"checkFraction"],[38,17,30,17],[38,18,30,18,"startFraction"],[38,31,30,31],[38,33,30,33,"endFraction"],[38,44,30,44],[38,45,30,45],[39,4,31,4],[39,8,31,8,"resolvedPromise"],[39,23,31,23],[39,26,31,26],[39,27,31,27],[40,4,32,4],[40,10,32,10,"registerMonitor"],[40,25,32,25],[40,28,32,29,"promise"],[40,35,32,36],[40,39,32,41],[41,6,33,8,"promise"],[41,13,33,15],[41,14,33,16,"then"],[41,18,33,20],[41,19,33,21,"value"],[41,24,33,26],[41,28,33,30],[42,8,34,12],[42,14,34,18,"fraction"],[42,22,34,26],[42,25,34,29,"startFraction"],[42,38,34,42],[42,41,35,16],[42,43,35,18,"resolvedPromise"],[42,58,35,33],[42,61,35,36,"promises"],[42,69,35,44],[42,70,35,45,"length"],[42,76,35,51],[42,80,35,55,"endFraction"],[42,91,35,66],[42,94,35,69,"startFraction"],[42,107,35,82],[42,108,35,83],[43,8,36,12],[44,8,37,12,"onProgress"],[44,18,37,22],[44,19,37,23,"fraction"],[44,27,37,31],[44,28,37,32],[45,8,38,12],[45,15,38,19,"value"],[45,20,38,24],[46,6,39,8],[46,7,39,9],[46,8,39,10],[47,6,40,8],[47,13,40,15,"promise"],[47,20,40,22],[48,4,41,4],[48,5,41,5],[49,4,42,4],[49,13,42,13,"checkPromises"],[49,26,42,26,"checkPromises"],[49,27,42,27,"promises"],[49,35,42,35],[49,37,42,37],[50,6,43,8],[50,10,43,8,"assert"],[50,15,43,14],[50,16,43,14,"assert"],[50,22,43,14],[50,24,43,15,"promises"],[50,32,43,23],[50,36,43,27],[50,40,43,31],[50,44,43,35,"Array"],[50,49,43,40],[50,50,43,41,"isArray"],[50,57,43,48],[50,58,43,49,"promises"],[50,66,43,57],[50,67,43,58],[50,71,43,62,"promises"],[50,79,43,70],[50,80,43,71,"length"],[50,86,43,77],[50,89,43,80],[50,90,43,81],[50,92,43,83],[50,98,43,89],[50,135,43,126],[50,136,43,127],[51,4,44,4],[52,4,45,4],[52,13,45,13,"checkFraction"],[52,26,45,26,"checkFraction"],[52,27,45,27,"startFraction"],[52,40,45,40],[52,42,45,42,"endFraction"],[52,53,45,53],[52,55,45,55],[53,6,46,8],[53,10,46,8,"assert"],[53,15,46,14],[53,16,46,14,"assert"],[53,22,46,14],[53,24,46,15,"startFraction"],[53,37,46,28],[53,41,46,32],[53,42,46,33],[53,46,46,37,"startFraction"],[53,59,46,50],[53,63,46,54],[53,64,46,55],[53,66,46,57],[53,72,46,63],[53,121,46,112],[53,124,47,12],[53,145,47,33,"startFraction"],[53,158,47,46],[53,160,47,48],[53,161,47,49],[54,6,48,8],[54,10,48,8,"assert"],[54,15,48,14],[54,16,48,14,"assert"],[54,22,48,14],[54,24,48,15,"endFraction"],[54,35,48,26],[54,39,48,30],[54,40,48,31],[54,44,48,35,"endFraction"],[54,55,48,46],[54,59,48,50],[54,60,48,51],[54,62,48,53],[54,68,48,59],[54,117,48,108],[54,120,49,12],[54,139,49,31,"endFraction"],[54,150,49,42],[54,152,49,44],[54,153,49,45],[55,6,50,8],[55,10,50,8,"assert"],[55,15,50,14],[55,16,50,14,"assert"],[55,22,50,14],[55,24,50,15,"endFraction"],[55,35,50,26],[55,39,50,30,"startFraction"],[55,52,50,43],[55,54,50,45],[55,60,50,51],[55,114,50,105],[55,117,51,12],[55,138,51,33,"startFraction"],[55,151,51,46],[55,170,51,65],[55,173,52,12],[55,176,52,15,"endFraction"],[55,187,52,26],[55,189,52,28],[55,190,52,29],[56,4,53,4],[57,4,54,4],[57,11,54,11,"Promise"],[57,18,54,18],[57,19,54,19,"all"],[57,22,54,22],[57,23,54,23,"promises"],[57,31,54,31],[57,32,54,32,"map"],[57,35,54,35],[57,36,54,36,"registerMonitor"],[57,51,54,51],[57,52,54,52],[57,53,54,53],[58,2,55,0],[59,0,55,1],[59,3]],"functionMap":{"names":["<global>","monitorPromisesProgress","registerMonitor","promise.then$argument_0","checkPromises","assert$argument_1","checkFraction"],"mappings":"AAA;OCyB;4BCM;qBCC;SDM;KDE;IGC;mFCC,2CD;KHC;IKC;yDDC;gDCC;qDDC;4CCC;6CDC;4BCE;KLC;CDE"},"hasCjsExports":false},"type":"js/module"}]}