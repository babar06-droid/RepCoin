{"dependencies":[{"name":"./shader_compiler","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":54,"index":757}}],"key":"yVSKlvZSxQn3Ck2puzGVWEYPzq8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"MirrorPadProgram\", {\n    enumerable: true,\n    get: function () {\n      return MirrorPadProgram;\n    }\n  });\n  var _shader_compiler = require(_dependencyMap[0], \"./shader_compiler\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  class MirrorPadProgram {\n    constructor(xShape, paddings, mode) {\n      this.variableNames = ['x'];\n      this.outputShape = paddings.map((p, i) => p[0] /* beforePad */ + xShape[i] + p[1] /* afterPad */);\n      const rank = xShape.length;\n      const dtype = (0, _shader_compiler.getCoordsDataType)(rank);\n      const start = paddings.map(p => p[0]).join(',');\n      const end = paddings.map((p, i) => p[0] + xShape[i]).join(',');\n      const unpackedCoords = ['coords[0]', 'coords[1]', 'coords[2]', 'coords[3]'].slice(0, rank);\n      const offset = mode === 'reflect' ? 0 : 1;\n      if (rank === 1) {\n        this.userCode = `\n        int start = ${start};\n        int end = ${end};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${offset};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${offset};\n          }\n          setOutput(getX(outC - start));\n        }\n      `;\n        return;\n      }\n      this.userCode = `\n      ${dtype} start = ${dtype}(${start});\n      ${dtype} end = ${dtype}(${end});\n\n      void main() {\n        ${dtype} outC = getOutputCoords();\n        for (int i = 0; i < ${rank}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${offset};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${offset};\n          }\n        }\n        ${dtype} coords = outC - start;\n        setOutput(getX(${unpackedCoords}));\n      }\n    `;\n    }\n  }\n});","lineCount":77,"map":[[7,2,18,0,"Object"],[7,8,18,0],[7,9,18,0,"defineProperty"],[7,23,18,0],[7,24,18,0,"exports"],[7,31,18,0],[8,4,18,0,"enumerable"],[8,14,18,0],[9,4,18,0,"get"],[9,7,18,0],[9,18,18,0,"get"],[9,19,18,0],[10,6,18,0],[10,13,18,0,"MirrorPadProgram"],[10,29,18,0],[11,4,18,0],[12,2,18,0],[13,2,17,0],[13,6,17,0,"_shader_compiler"],[13,22,17,0],[13,25,17,0,"require"],[13,32,17,0],[13,33,17,0,"_dependencyMap"],[13,47,17,0],[14,2,1,0],[15,0,2,0],[16,0,3,0],[17,0,4,0],[18,0,5,0],[19,0,6,0],[20,0,7,0],[21,0,8,0],[22,0,9,0],[23,0,10,0],[24,0,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[31,2,18,7],[31,8,18,13,"MirrorPadProgram"],[31,24,18,29],[31,25,18,30],[32,4,19,4,"constructor"],[32,15,19,15,"constructor"],[32,16,19,16,"xShape"],[32,22,19,22],[32,24,19,24,"paddings"],[32,32,19,32],[32,34,19,34,"mode"],[32,38,19,38],[32,40,19,40],[33,6,20,8],[33,10,20,12],[33,11,20,13,"variableNames"],[33,24,20,26],[33,27,20,29],[33,28,20,30],[33,31,20,33],[33,32,20,34],[34,6,21,8],[34,10,21,12],[34,11,21,13,"outputShape"],[34,22,21,24],[34,25,21,27,"paddings"],[34,33,21,35],[34,34,21,36,"map"],[34,37,21,39],[34,38,21,40],[34,39,21,41,"p"],[34,40,21,42],[34,42,21,44,"i"],[34,43,21,45],[34,48,21,50,"p"],[34,49,21,51],[34,50,21,52],[34,51,21,53],[34,52,21,54],[34,53,21,55],[34,71,21,73,"xShape"],[34,77,21,79],[34,78,21,80,"i"],[34,79,21,81],[34,80,21,82],[34,83,21,85,"p"],[34,84,21,86],[34,85,21,87],[34,86,21,88],[34,87,21,89],[34,88,21,90],[34,102,21,104],[34,103,21,105],[35,6,22,8],[35,12,22,14,"rank"],[35,16,22,18],[35,19,22,21,"xShape"],[35,25,22,27],[35,26,22,28,"length"],[35,32,22,34],[36,6,23,8],[36,12,23,14,"dtype"],[36,17,23,19],[36,20,23,22],[36,24,23,22,"getCoordsDataType"],[36,40,23,39],[36,41,23,39,"getCoordsDataType"],[36,58,23,39],[36,60,23,40,"rank"],[36,64,23,44],[36,65,23,45],[37,6,24,8],[37,12,24,14,"start"],[37,17,24,19],[37,20,24,22,"paddings"],[37,28,24,30],[37,29,24,31,"map"],[37,32,24,34],[37,33,24,35,"p"],[37,34,24,36],[37,38,24,40,"p"],[37,39,24,41],[37,40,24,42],[37,41,24,43],[37,42,24,44],[37,43,24,45],[37,44,24,46,"join"],[37,48,24,50],[37,49,24,51],[37,52,24,54],[37,53,24,55],[38,6,25,8],[38,12,25,14,"end"],[38,15,25,17],[38,18,25,20,"paddings"],[38,26,25,28],[38,27,25,29,"map"],[38,30,25,32],[38,31,25,33],[38,32,25,34,"p"],[38,33,25,35],[38,35,25,37,"i"],[38,36,25,38],[38,41,25,43,"p"],[38,42,25,44],[38,43,25,45],[38,44,25,46],[38,45,25,47],[38,48,25,50,"xShape"],[38,54,25,56],[38,55,25,57,"i"],[38,56,25,58],[38,57,25,59],[38,58,25,60],[38,59,25,61,"join"],[38,63,25,65],[38,64,25,66],[38,67,25,69],[38,68,25,70],[39,6,26,8],[39,12,26,14,"unpackedCoords"],[39,26,26,28],[39,29,26,31],[39,30,26,32],[39,41,26,43],[39,43,26,45],[39,54,26,56],[39,56,26,58],[39,67,26,69],[39,69,26,71],[39,80,26,82],[39,81,26,83],[39,82,26,84,"slice"],[39,87,26,89],[39,88,26,90],[39,89,26,91],[39,91,26,93,"rank"],[39,95,26,97],[39,96,26,98],[40,6,27,8],[40,12,27,14,"offset"],[40,18,27,20],[40,21,27,23,"mode"],[40,25,27,27],[40,30,27,32],[40,39,27,41],[40,42,27,44],[40,43,27,45],[40,46,27,48],[40,47,27,49],[41,6,28,8],[41,10,28,12,"rank"],[41,14,28,16],[41,19,28,21],[41,20,28,22],[41,22,28,24],[42,8,29,12],[42,12,29,16],[42,13,29,17,"userCode"],[42,21,29,25],[42,24,29,28],[43,0,30,0],[43,22,30,22,"start"],[43,27,30,27],[44,0,31,0],[44,20,31,20,"end"],[44,23,31,23],[45,0,32,0],[46,0,33,0],[47,0,34,0],[48,0,35,0],[49,0,36,0],[49,40,36,40,"offset"],[49,46,36,46],[50,0,37,0],[51,0,38,0],[51,44,38,44,"offset"],[51,50,38,50],[52,0,39,0],[53,0,40,0],[54,0,41,0],[55,0,42,0],[55,7,42,7],[56,8,43,12],[57,6,44,8],[58,6,45,8],[58,10,45,12],[58,11,45,13,"userCode"],[58,19,45,21],[58,22,45,24],[59,0,46,0],[59,8,46,8,"dtype"],[59,13,46,13],[59,25,46,25,"dtype"],[59,30,46,30],[59,34,46,34,"start"],[59,39,46,39],[60,0,47,0],[60,8,47,8,"dtype"],[60,13,47,13],[60,23,47,23,"dtype"],[60,28,47,28],[60,32,47,32,"end"],[60,35,47,35],[61,0,48,0],[62,0,49,0],[63,0,50,0],[63,10,50,10,"dtype"],[63,15,50,15],[64,0,51,0],[64,30,51,30,"rank"],[64,34,51,34],[65,0,52,0],[66,0,53,0],[66,49,53,49,"offset"],[66,55,53,55],[67,0,54,0],[68,0,55,0],[68,53,55,53,"offset"],[68,59,55,59],[69,0,56,0],[70,0,57,0],[71,0,58,0],[71,10,58,10,"dtype"],[71,15,58,15],[72,0,59,0],[72,25,59,25,"unpackedCoords"],[72,39,59,39],[73,0,60,0],[74,0,61,0],[74,5,61,5],[75,4,62,4],[76,2,63,0],[77,0,63,1],[77,3]],"functionMap":{"names":["<global>","MirrorPadProgram","MirrorPadProgram#constructor","paddings.map$argument_0"],"mappings":"AAA;OCiB;ICC;wCCE,iDD;mCCG,SD;iCCC,0BD;KDqC;CDC"},"hasCjsExports":false},"type":"js/module"}]}