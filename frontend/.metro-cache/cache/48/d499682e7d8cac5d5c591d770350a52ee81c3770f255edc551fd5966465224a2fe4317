{"dependencies":[{"name":"../engine","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":17,"column":0,"index":703},"end":{"line":17,"column":35,"index":738}}],"key":"zbTTi8rtwr8rjl75PzEo829Yvss=","exportNames":["*"],"imports":1}},{"name":"../kernel_names","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":18,"column":0,"index":739},"end":{"line":18,"column":49,"index":788}}],"key":"gQVznmdGA0uoBQvR5Q4/qW+ITHg=","exportNames":["*"],"imports":1}},{"name":"../tensor_util_env","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":19,"column":0,"index":789},"end":{"line":19,"column":53,"index":842}}],"key":"UCKDOr/oOGi3nbD26ZhyAVW61qk=","exportNames":["*"],"imports":1}},{"name":"../util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":20,"column":0,"index":843},"end":{"line":20,"column":32,"index":875}}],"key":"DTmef1GE5grNQfsvpIzpBlINy9c=","exportNames":["*"],"imports":1}},{"name":"./operation","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":21,"column":0,"index":876},"end":{"line":21,"column":33,"index":909}}],"key":"lmmEAb6oR3TWnrsrETceKUovfkM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"spaceToBatchND\", {\n    enumerable: true,\n    get: function () {\n      return spaceToBatchND;\n    }\n  });\n  var _engine = require(_dependencyMap[0], \"../engine\");\n  var _kernel_names = require(_dependencyMap[1], \"../kernel_names\");\n  var _tensor_util_env = require(_dependencyMap[2], \"../tensor_util_env\");\n  var _util = require(_dependencyMap[3], \"../util\");\n  var util = _interopNamespace(_util);\n  var _operation = require(_dependencyMap[4], \"./operation\");\n  /**\n   * @license\n   * Copyright 2020 Google LLC. All Rights Reserved.\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   * http://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   * =============================================================================\n   */\n\n  /**\n   * This operation divides \"spatial\" dimensions `[1, ..., M]` of the input into\n   * a grid of blocks of shape `blockShape`, and interleaves these blocks with\n   * the \"batch\" dimension (0) such that in the output, the spatial\n   * dimensions `[1, ..., M]` correspond to the position within the grid,\n   * and the batch dimension combines both the position within a spatial block\n   * and the original batch position. Prior to division into blocks,\n   * the spatial dimensions of the input are optionally zero padded\n   * according to `paddings`. See below for a precise description.\n   *\n   * ```js\n   * const x = tf.tensor4d([1, 2, 3, 4], [1, 2, 2, 1]);\n   * const blockShape = [2, 2];\n   * const paddings = [[0, 0], [0, 0]];\n   *\n   * x.spaceToBatchND(blockShape, paddings).print();\n   * ```\n   *\n   * @param x A `tf.Tensor`. N-D with `x.shape` = `[batch] + spatialShape +\n   * remainingShape`, where spatialShape has `M` dimensions.\n   * @param blockShape A 1-D array. Must have shape `[M]`, all values must\n   * be >= 1.\n   * @param paddings A 2-D array. Must have shape `[M, 2]`, all values must be >=\n   *     0. `paddings[i] = [padStart, padEnd]` specifies the amount to zero-pad\n   * from input dimension `i + 1`, which corresponds to spatial dimension `i`. It\n   * is required that\n   * `(inputShape[i + 1] + padStart + padEnd) % blockShape[i] === 0`\n   *\n   * This operation is equivalent to the following steps:\n   *\n   * 1. Zero-pad the start and end of dimensions `[1, ..., M]` of the input\n   * according to `paddings` to produce `padded` of shape paddedShape.\n   *\n   * 2. Reshape `padded` to `reshapedPadded` of shape:\n   * `[batch] + [paddedShape[1] / blockShape[0], blockShape[0], ...,\n   * paddedShape[M] / blockShape[M-1], blockShape[M-1]] + remainingShape`\n   *\n   * 3. Permute dimensions of `reshapedPadded` to produce `permutedReshapedPadded`\n   * of shape: `blockShape + [batch] + [paddedShape[1] / blockShape[0], ...,\n   * paddedShape[M] / blockShape[M-1]] + remainingShape`\n   *\n   * 4. Reshape `permutedReshapedPadded` to flatten `blockShape` into the\n   * batch dimension, producing an output tensor of shape:\n   * `[batch * prod(blockShape)] + [paddedShape[1] / blockShape[0], ...,\n   * paddedShape[M] / blockShape[M-1]] + remainingShape`\n   *\n   * @doc {heading: 'Tensors', subheading: 'Transformations'}\n   */\n  function spaceToBatchND_(x, blockShape, paddings) {\n    const $x = (0, _tensor_util_env.convertToTensor)(x, 'x', 'spaceToBatchND');\n    util.assert($x.rank >= 1 + blockShape.length, () => `input rank ${$x.rank} should be > than [blockShape] ${blockShape.length}`);\n    util.assert(paddings.length === blockShape.length, () => `paddings.shape[0] ${paddings.length} must be equal to [blockShape] ${blockShape.length}`);\n    util.assert($x.shape.reduce((a, b, i) => {\n      if (i > 0 && i <= blockShape.length) {\n        return a && (b + paddings[i - 1][0] + paddings[i - 1][1]) % blockShape[i - 1] === 0;\n      }\n      return a;\n    }, true), () => `input spatial dimensions ${$x.shape.slice(1)} with paddings ${paddings.toString()} must be divisible by blockShapes ${blockShape.toString()}`);\n    const inputs = {\n      x: $x\n    };\n    const attrs = {\n      blockShape,\n      paddings\n    };\n    return _engine.ENGINE.runKernel(_kernel_names.SpaceToBatchND, inputs, attrs);\n  }\n  const spaceToBatchND = /* @__PURE__ */(0, _operation.op)({\n    spaceToBatchND_\n  });\n});","lineCount":121,"map":[[22,2,87,0,"Object"],[22,8,87,0],[22,9,87,0,"defineProperty"],[22,23,87,0],[22,24,87,0,"exports"],[22,31,87,0],[23,4,87,0,"enumerable"],[23,14,87,0],[24,4,87,0,"get"],[24,7,87,0],[24,18,87,0,"get"],[24,19,87,0],[25,6,87,0],[25,13,87,0,"spaceToBatchND"],[25,27,87,0],[26,4,87,0],[27,2,87,0],[28,2,17,0],[28,6,17,0,"_engine"],[28,13,17,0],[28,16,17,0,"require"],[28,23,17,0],[28,24,17,0,"_dependencyMap"],[28,38,17,0],[29,2,18,0],[29,6,18,0,"_kernel_names"],[29,19,18,0],[29,22,18,0,"require"],[29,29,18,0],[29,30,18,0,"_dependencyMap"],[29,44,18,0],[30,2,19,0],[30,6,19,0,"_tensor_util_env"],[30,22,19,0],[30,25,19,0,"require"],[30,32,19,0],[30,33,19,0,"_dependencyMap"],[30,47,19,0],[31,2,20,0],[31,6,20,0,"_util"],[31,11,20,0],[31,14,20,0,"require"],[31,21,20,0],[31,22,20,0,"_dependencyMap"],[31,36,20,0],[32,2,20,0],[32,6,20,0,"util"],[32,10,20,0],[32,13,20,0,"_interopNamespace"],[32,30,20,0],[32,31,20,0,"_util"],[32,36,20,0],[33,2,21,0],[33,6,21,0,"_operation"],[33,16,21,0],[33,19,21,0,"require"],[33,26,21,0],[33,27,21,0,"_dependencyMap"],[33,41,21,0],[34,2,1,0],[35,0,2,0],[36,0,3,0],[37,0,4,0],[38,0,5,0],[39,0,6,0],[40,0,7,0],[41,0,8,0],[42,0,9,0],[43,0,10,0],[44,0,11,0],[45,0,12,0],[46,0,13,0],[47,0,14,0],[48,0,15,0],[49,0,16,0],[51,2,22,0],[52,0,23,0],[53,0,24,0],[54,0,25,0],[55,0,26,0],[56,0,27,0],[57,0,28,0],[58,0,29,0],[59,0,30,0],[60,0,31,0],[61,0,32,0],[62,0,33,0],[63,0,34,0],[64,0,35,0],[65,0,36,0],[66,0,37,0],[67,0,38,0],[68,0,39,0],[69,0,40,0],[70,0,41,0],[71,0,42,0],[72,0,43,0],[73,0,44,0],[74,0,45,0],[75,0,46,0],[76,0,47,0],[77,0,48,0],[78,0,49,0],[79,0,50,0],[80,0,51,0],[81,0,52,0],[82,0,53,0],[83,0,54,0],[84,0,55,0],[85,0,56,0],[86,0,57,0],[87,0,58,0],[88,0,59,0],[89,0,60,0],[90,0,61,0],[91,0,62,0],[92,0,63,0],[93,0,64,0],[94,0,65,0],[95,0,66,0],[96,0,67,0],[97,0,68,0],[98,0,69,0],[99,2,70,0],[99,11,70,9,"spaceToBatchND_"],[99,26,70,24,"spaceToBatchND_"],[99,27,70,25,"x"],[99,28,70,26],[99,30,70,28,"blockShape"],[99,40,70,38],[99,42,70,40,"paddings"],[99,50,70,48],[99,52,70,50],[100,4,71,4],[100,10,71,10,"$x"],[100,12,71,12],[100,15,71,15],[100,19,71,15,"convertToTensor"],[100,35,71,30],[100,36,71,30,"convertToTensor"],[100,51,71,30],[100,53,71,31,"x"],[100,54,71,32],[100,56,71,34],[100,59,71,37],[100,61,71,39],[100,77,71,55],[100,78,71,56],[101,4,72,4,"util"],[101,8,72,8],[101,9,72,9,"assert"],[101,15,72,15],[101,16,72,16,"$x"],[101,18,72,18],[101,19,72,19,"rank"],[101,23,72,23],[101,27,72,27],[101,28,72,28],[101,31,72,31,"blockShape"],[101,41,72,41],[101,42,72,42,"length"],[101,48,72,48],[101,50,72,50],[101,56,72,56],[101,70,72,70,"$x"],[101,72,72,72],[101,73,72,73,"rank"],[101,77,72,77],[101,111,72,111,"blockShape"],[101,121,72,121],[101,122,72,122,"length"],[101,128,72,128],[101,130,72,130],[101,131,72,131],[102,4,73,4,"util"],[102,8,73,8],[102,9,73,9,"assert"],[102,15,73,15],[102,16,73,16,"paddings"],[102,24,73,24],[102,25,73,25,"length"],[102,31,73,31],[102,36,73,36,"blockShape"],[102,46,73,46],[102,47,73,47,"length"],[102,53,73,53],[102,55,73,55],[102,61,73,61],[102,82,73,82,"paddings"],[102,90,73,90],[102,91,73,91,"length"],[102,97,73,97],[102,131,73,131,"blockShape"],[102,141,73,141],[102,142,73,142,"length"],[102,148,73,148],[102,150,73,150],[102,151,73,151],[103,4,74,4,"util"],[103,8,74,8],[103,9,74,9,"assert"],[103,15,74,15],[103,16,74,16,"$x"],[103,18,74,18],[103,19,74,19,"shape"],[103,24,74,24],[103,25,74,25,"reduce"],[103,31,74,31],[103,32,74,32],[103,33,74,33,"a"],[103,34,74,34],[103,36,74,36,"b"],[103,37,74,37],[103,39,74,39,"i"],[103,40,74,40],[103,45,74,45],[104,6,75,8],[104,10,75,12,"i"],[104,11,75,13],[104,14,75,16],[104,15,75,17],[104,19,75,21,"i"],[104,20,75,22],[104,24,75,26,"blockShape"],[104,34,75,36],[104,35,75,37,"length"],[104,41,75,43],[104,43,75,45],[105,8,76,12],[105,15,76,19,"a"],[105,16,76,20],[105,20,77,17],[105,21,77,18,"b"],[105,22,77,19],[105,25,77,22,"paddings"],[105,33,77,30],[105,34,77,31,"i"],[105,35,77,32],[105,38,77,35],[105,39,77,36],[105,40,77,37],[105,41,77,38],[105,42,77,39],[105,43,77,40],[105,46,77,43,"paddings"],[105,54,77,51],[105,55,77,52,"i"],[105,56,77,53],[105,59,77,56],[105,60,77,57],[105,61,77,58],[105,62,77,59],[105,63,77,60],[105,64,77,61],[105,68,78,20,"blockShape"],[105,78,78,30],[105,79,78,31,"i"],[105,80,78,32],[105,83,78,35],[105,84,78,36],[105,85,78,37],[105,90,79,20],[105,91,79,22],[106,6,80,8],[107,6,81,8],[107,13,81,15,"a"],[107,14,81,16],[108,4,82,4],[108,5,82,5],[108,7,82,7],[108,11,82,11],[108,12,82,12],[108,14,82,14],[108,20,82,20],[108,48,82,48,"$x"],[108,50,82,50],[108,51,82,51,"shape"],[108,56,82,56],[108,57,82,57,"slice"],[108,62,82,62],[108,63,82,63],[108,64,82,64],[108,65,82,65],[108,83,82,83,"paddings"],[108,91,82,91],[108,92,82,92,"toString"],[108,100,82,100],[108,101,82,101],[108,102,82,102],[108,139,82,139,"blockShape"],[108,149,82,149],[108,150,82,150,"toString"],[108,158,82,158],[108,159,82,159],[108,160,82,160],[108,162,82,162],[108,163,82,163],[109,4,83,4],[109,10,83,10,"inputs"],[109,16,83,16],[109,19,83,19],[110,6,83,21,"x"],[110,7,83,22],[110,9,83,24,"$x"],[111,4,83,27],[111,5,83,28],[112,4,84,4],[112,10,84,10,"attrs"],[112,15,84,15],[112,18,84,18],[113,6,84,20,"blockShape"],[113,16,84,30],[114,6,84,32,"paddings"],[115,4,84,41],[115,5,84,42],[116,4,85,4],[116,11,85,11,"ENGINE"],[116,18,85,17],[116,19,85,17,"ENGINE"],[116,25,85,17],[116,26,85,18,"runKernel"],[116,35,85,27],[116,36,85,28,"SpaceToBatchND"],[116,49,85,42],[116,50,85,42,"SpaceToBatchND"],[116,64,85,42],[116,66,85,44,"inputs"],[116,72,85,50],[116,74,85,52,"attrs"],[116,79,85,57],[116,80,85,58],[117,2,86,0],[118,2,87,7],[118,8,87,13,"spaceToBatchND"],[118,22,87,27],[118,25,87,30],[118,40,87,46],[118,44,87,46,"op"],[118,54,87,48],[118,55,87,48,"op"],[118,57,87,48],[118,59,87,49],[119,4,87,51,"spaceToBatchND_"],[120,2,87,67],[120,3,87,68],[120,4,87,69],[121,0,87,70],[121,3]],"functionMap":{"names":["<global>","spaceToBatchND_","util.assert$argument_1","$x.shape.reduce$argument_0"],"mappings":"AAA;ACqE;kDCE,gFD;uDCC,+FD;gCEC;KFQ,SC,oJD;CDI"},"hasCjsExports":false},"type":"js/module"}]}